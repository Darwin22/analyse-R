<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>Graphiques bivariés avec ggplot2</title>

<script src="libs/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.1/css/flatly.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.1/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.1/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.1/shim/respond.min.js"></script>
<link rel="stylesheet" href="./include/analyse-R.css" />
<script type="text/javascript" src="./libs/zeroclipboard-2.2.0/ZeroClipboard.js"></script>
<link rel="stylesheet" href="./libs/colorbox-1.6.1/colorbox.css" />
<script type="text/javascript" src="./libs/colorbox-1.6.1/jquery.colorbox-min.js"></script>
<!--- favicon --->
<link rel="apple-touch-icon" sizes="57x57" href="./images/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="./images/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="./images/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="./images/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="./images/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="./images/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="./images/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="./images/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="./images/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="./images/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="./images/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="./images/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="./images/favicon/favicon-16x16.png">
<link rel="manifest" href="./images/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="./images/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>
<div class="container-fluid main-container">

<nav>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href=".">analyse-R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="index.html">Accueil</a></li>
        <li class="dropdown">
          <a href="pem" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Prise en main <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="pem_presentation_installation.html">Présentation et Installation</a></li>
            <li><a href="pem_premier_contact.html">Premier contact</a></li>
            <li><a href="pem_premier_travail.html">Premier travail avec des données</a></li>
            <li><a href="pem_organiser_fichiers.html">Organiser ses fichiers</a></li>
            <li><a href="pem_import_export.html">Import / Export de données</a></li>
            <li><a href="pem_manipulation.html">Manipulation de données</a></li>
            <li><a href="pem_export_graphiques.html">Exporter des graphiques</a></li>
            <li><a href="pem_ou_trouver_aide.html">Où trouver de l'aide ?</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="analyses" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Analyses <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li class="dropdown-header">Statistiques introductives</li>
            <li><a href="analyses_stat_univ.html">Statistique univariée</a></li>
            <li><a href="analyses_stat_biv.html">Statistique bivariée</a></li>
            <li><a href="analyses_graph_biv.html">Graphiques bivariés avec ggplot2</a></li>
            <li><a href="analyses_donnees_pond.html">Données pondérées</a></li>
            <li class="divider"></li>
            <li class="dropdown-header">Statistiques intermédiaires</li>
            <li><a href="analyses_reglog.html">Régression logistique</a></li>
            <li><a href="analyses_acm.html">Analyse des correspondances multiples (ACM)</a></li>
            <li><a href="analyses_cah.html">Classification ascendante hiérarchique (CAH)</a></li>
            <li class="divider"></li>
            <li class="dropdown-header">Statistiques avancées</li>
            <li><a href="analyses_seq.html">Analyse de séquences</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="extra" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Extra <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li class="dropdown-header">Astuces</li>
            <li><a href="extra_age.html">Calculer un âge</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="index" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Index <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="index_concepts.html">Index des concepts</a></li>
            <li><a href="index_fonctions.html">Index des fonctions</a></li>
            <li><a href="index_extensions.html">Index des extensions</a></li>
          </ul>
        </li>
        <li><a href="analyse-R.pdf">PDF</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
          <a href="participer" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Participer <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
              <li><a href="https://github.com/larmarange/analyse-R">analyse-R sur GitHub</a></li>
          </ul>
        </li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
</nav>

<div class="row">

<div class="col-sm-9" role="main">
<article>

<div id="header">
<h1 class="title">Graphiques bivariés avec ggplot2</h1>
</div>

<div id="TOC">
<ul>
<li><a href="#les-donnees-de-lexemple">Les données de l’exemple</a><ul>
<li><a href="#nettoyage-des-donnees">Nettoyage des données</a></li>
<li><a href="#recodage-dune-variable">Recodage d’une variable</a></li>
</ul></li>
<li><a href="#visualisation-des-donnees">Visualisation des données</a><ul>
<li><a href="#visualisation-par-petits-multiples">Visualisation par <q>petits multiples</q></a></li>
<li><a href="#visualisation-en-series-temporelles">Visualisation en séries temporelles</a></li>
<li><a href="#combinaisons-delements-graphiques">Combinaisons d’éléments graphiques</a></li>
</ul></li>
<li><a href="#composition-graphique-avec-ggplot2">Composition graphique avec ggplot2</a><ul>
<li><a href="#couleurs-et-echelles">Couleurs et échelles</a></li>
<li><a href="#utilisation-des-themes">Utilisation des thèmes</a></li>
<li><a href="#export-des-graphiques">Export des graphiques</a></li>
</ul></li>
<li><a href="#pour-aller-plus-loin">Pour aller plus loin</a><ul>
<li><a href="#ressources-essentielles">Ressources essentielles</a></li>
<li><a href="#extensions-de-ggplot2">Extensions de ggplot2</a></li>
</ul></li>
</ul>
</div>

<div class="note">
Ce chapitre est tiré d’une <a href="https://github.com/briatte/aad/tree/master/reinhart-rogoff">séance de cours</a> destiné à des étudiants de L2 sans aucune connaissance de <strong>R</strong>. Cette séance de cours est elle-même inspirée d’un <a href="http://www.stat.cmu.edu/~cshalizi/uADA/13/hw/11/">exercice</a> tiré d’un cours de <a href="http://www.stat.cmu.edu/~cshalizi/">Cosma Shalizi</a>.
</div>
<p>Comme expliqué dans un <a href="pem_graphiques_de_base.html">précédent chapitre</a>, <strong>R</strong> possède un puissant moteur graphique interne, qui permet de <q>dessiner</q> dans un graphique en y rajoutant des segments, des points, du texte, ou toutes sortes d’autres symboles. Toutefois, pour produire un graphique complet avec les fonctions basiques de <strong>R</strong>, il faut un peu bricoler : d’abord, ouvrir une fenêtre ; puis rajouter des points ; puis rajouter des lignes ; tout en configurant les couleurs au fur et à mesure ; puis finir par fermer la fenêtre graphique.</p>
<p><strong>R</strong> est distribué avec une extension qui permet de moins avoir à bricoler les graphiques : <code class="pkg">lattice</code>. Mais surtout, <strong>R</strong> est aussi capable de comprendre la <q>grammaire graphique</q> <a href="https://books.google.fr/books/about/The_Grammar_of_Graphics.html">théorisée par Leland Wilkinson</a>, et traduite pour <strong>R</strong> par Hadley Wickham sous la forme de l’extension <code class="pkg">ggplot2</code><a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. Ce chapitre présente cette dernière extension à partir d’un exemple simple de visualisation de séries temporelles, puis rentre dans le détail de sa syntaxe<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a>.</p>
<div id="les-donnees-de-lexemple" class="section level2">
<h2>Les données de l’exemple</h2>
<p>Il y a quelques années, les chercheurs Carmen M. Reinhart et Kenneth S. Rogoff publiaient un article intitulé <cite><a href="http://scholar.harvard.edu/files/rogoff/files/growth_in_time_debt_aer.pdf">Growth in a Time of Debt</a></cite>, dans lequel ils faisaient la démonstration qu’un niveau élevé de dette publique nuisait à la croissance économique. Plus exactement, les deux chercheurs y défendaient l’idée que, lorsque la dette publique dépasse 90% du produit intérieur brut, ce produit cesse de croître.</p>
<p>Cette conclusion, proche du discours porté par des institutions comme le Fonds Monétaire International, a <a href="http://www.economist.com/news/finance-and-economics/21576362-seminal-analysis-relationship-between-debt-and-growth-comes-under">alimenté plusieurs argumentaires politiques</a>. Des parlementaires américains s’en ainsi sont servi pour exiger une diminution du budget fédéral, et surtout, la Commission européenne s’est appuyée sur cet argumentaire pour exiger que des pays comme la Grèce, durement frappés par la crise financière globale de 2008, adoptent des plans d’austérité drastiques.</p>
<p>Or, en tentant de reproduire les résultats de Reinhart et Rogoff, les chercheurs Thomas Herndon, Michael Ash et Robert Pollin y ont trouvé <a href="http://www.peri.umass.edu/236/hash/31e2ff374b6377b2ddec04deaa6388b1/publication/566/">de nombreuses erreurs</a>, ainsi qu’une <a href="http://www.nextnewdeal.net/rortybomb/researchers-finally-replicated-reinhart-rogoff-and-there-are-serious-problems">bête erreur de calcul</a> due à une utilisation peu attentive du logiciel <strong>Microsoft Excel</strong>. La révélation de ces erreurs donna lieu à un débat très vif entre adversaires et partisans des politiques économiques d’austérité, débat toujours autant d’actualité aujourd’hui.</p>
<p>Dans ce chapitre, on va se servir des données (corrigées) de Reinhart et Rogoff pour évaluer, de manière indépendante, la cohérence de leur argument sur le rapport entre endettement et croissance économique. Commençons par récupérer ces données au format CSV sur le site du chercheur américain <a href="http://www.stat.cmu.edu/~cshalizi/">Cosma Shalizi</a>, qui utilise ces données dans <a href="http://www.stat.cmu.edu/~cshalizi/uADA/">l’un de ses exercices de cours</a> :</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># charger l&#39;extension lisant le format CSV</span>
<span class="kw">library</span>(readr)

<span class="co"># emplacement souhaité pour le jeu de données</span>
file =<span class="st"> &quot;data/debt.csv&quot;</span>

<span class="co"># télécharger le jeu de données s&#39;il n&#39;existe pas</span>
if(!<span class="kw">file.exists</span>(file))
  <span class="kw">download.file</span>(<span class="st">&quot;http://www.stat.cmu.edu/~cshalizi/uADA/13/hw/11/debt.csv&quot;</span>,
                file, <span class="dt">mode =</span> <span class="st">&quot;wb&quot;</span>)

<span class="co"># charger les données dans l&#39;objet &#39;debt&#39;</span>
debt =<span class="st"> </span><span class="kw">read_csv</span>(file)</code></pre>
<div class="note">
Le code ci-dessus utilise la fonction <code data-pkg="readr" data-rdoc="read_csv">read_csv</code> de l’extension <code class="pkg">readr</code>, dont on a recommandé l’utilisation dans un <a href="https://larmarange.github.io/analyse-R/pem_import_export.html">précédent chapitre</a>. En l’absence de cette extension, on aurait pu utiliser la fonction de base <code data-pkg="utils" data-rdoc="read.csv">read.csv</code>.
</div>
<div id="nettoyage-des-donnees" class="section level3">
<h3>Nettoyage des données</h3>
<p>Les données de Reinhart et Rogoff contiennent, pour un échantillon de 20 pays occidentaux membres de la zone <a href="https://fr.wikipedia.org/wiki/Organisation_de_coop%C3%A9ration_et_de_d%C3%A9veloppement_%C3%A9conomiques">OCDE</a>, la croissance de leur <a href="https://fr.wikipedia.org/wiki/Produit_intérieur_brut">produit intérieur brut</a> (PIB)<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a>, et le ratio entre leur <a href="https://fr.wikipedia.org/wiki/Dette_publique">dette publique</a> et ce produit, exprimé sous la forme d’un pourcentage <q>Dette / PIB</q>. Les données vont du milieu des années 1940 à la fin des années 2000. La première colonne du jeu de données ne contenant que les numéros des lignes, on va la supprimer d’entrée de jeu :</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># inspection du jeu de données</span>
<span class="kw">str</span>(debt)</code></pre>
<pre><code>Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:   1171 obs. of  5 variables:
 $ [EMPTY]: int  147 148 149 150 151 152 153 154 155 156 ...
 $ Country: chr  &quot;Australia&quot; &quot;Australia&quot; &quot;Australia&quot; &quot;Australia&quot; ...
 $ Year   : int  1946 1947 1948 1949 1950 1951 1952 1953 1954 1955 ...
 $ growth : num  -3.56 2.46 6.44 6.61 6.92 ...
 $ ratio  : num  190 177 149 126 110 ...</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># suppression de la première colonne</span>
debt =<span class="st"> </span>debt[, -<span class="dv">1</span>]</code></pre>
<p>Il faut aussi noter d’emblée que certaines mesures sont manquantes : pour certains pays, on ne dispose pas d’une mesure fiable du PIB et/ou de la dette publique. En conséquence, le nombre d’observations par pays est différent, et va de 40 observations <q>pays-année</q> pour la Grèce à 64 observations <q>pays-année</q> pour plusieurs pays comme l’Australie ou les États-Unis :</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(debt$Country)</code></pre>
<pre><code>
  Australia     Austria     Belgium      Canada 
         64          59          63          64 
    Denmark     Finland      France     Germany 
         56          64          54          59 
     Greece     Ireland       Italy       Japan 
         40          63          59          54 
Netherlands New Zealand      Norway    Portugal 
         53          64          64          58 
      Spain      Sweden          UK          US 
         42          64          63          64 </code></pre>
</div>
<div id="recodage-dune-variable" class="section level3">
<h3>Recodage d’une variable</h3>
<p>Dernière manipulation préalable avant l’analyse : on va calculer la décennie de chaque observation, en divisant l’année de mesure par 10, et en multipliant la partie entière de ce résultat par 10. Cette manipulation très simple donne <q>1940</q> pour les mesures des années 1940 à 1949, <q>1950</q> pour les années 1950-1959, et ainsi de suite.</p>
<pre class="sourceCode r"><code class="sourceCode r">debt$Decade =<span class="st"> </span><span class="kw">factor</span>(<span class="dv">10</span> *<span class="st"> </span>debt$Year%/%<span class="dv">10</span>)</code></pre>
<p>Voici, pour terminer, les premières lignes du jeu de données sur lequel on travaille :</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(debt)</code></pre>
<pre><code>    Country Year    growth     ratio Decade
1 Australia 1946 -3.557951 190.41908   1940
2 Australia 1947  2.459475 177.32137   1940
3 Australia 1948  6.437534 148.92981   1940
4 Australia 1949  6.611994 125.82870   1940
5 Australia 1950  6.920201 109.80940   1950
6 Australia 1951  4.272612  87.09448   1950</code></pre>
</div>
</div>
<div id="visualisation-des-donnees" class="section level2">
<h2>Visualisation des données</h2>
<p>Chargeons à présent l’extension graphique <code class="pkg">ggplot2</code> dont nous allons nous servir dans ce chapitre, et dans de nombreux chapitres suivants :</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)</code></pre>
<p>Procédons désormais à quelques visualisations très simples de ces données. On dispose de trois variables continues : l’année, le taux de croissance du PIB, et le ratio <q>Dette publique / PIB</q>. Si l’on souhaite visualiser la croissance du PIB au cours du temps, la solution basique dans <strong>R</strong> s’écrit de la manière suivante :</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(debt, <span class="kw">plot</span>(Year, growth))</code></pre>
<p><img src="images/analyses_graph_biv/unnamed-chunk-7-1.png" title="" alt="" width="1050" /></p>
<p>Le code de la visualisation est très simple et se lit : <q>avec l’objet <code>debt</code>, construire le graphique montrant l’année d’observation <var>Year</var> en abcisse et le taux de croissance du PIB <var>growth</var> en ordonnée</q>. Le code est compris de cette manière par <strong>R</strong> car la fonction <code>plot</code> comprend le premier argument comme étant la variable à représenter sur l’axe horizontal <code>x</code>, et le second comme la variable à représenter sur l’axe vertical <code>y</code>.</p>
<p>Le même graphique s’écrit de la manière suivante avec l’extension <code class="pkg">ggplot2</code> :</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(debt, <span class="kw">qplot</span>(Year, growth))</code></pre>
<p><img src="images/analyses_graph_biv/unnamed-chunk-8-1.png" title="" alt="" width="1050" /></p>
<p>Comme on peut le voir, le code est très proche du code utilisé dans <q><strong>R</strong> base</q>, la syntaxe signifiant toujours : <q>avec le jeu de données <code>debt</code>, visualiser les variables <var>Year</var> sur l’axe <code>x</code> et <var>growth</var> sur l’axe <code>y</code></q>. Le résultat est similaire, bien que plusieurs paramètres graphiques aient changé : le fond gris clair, en particulier, est caractéristique du thème graphique par défaut de <code class="pkg">ggplot2</code>, que l’on apprendra à modifier plus loin.</p>
<p>Par ailleurs, dans les deux exemples précédents, on a écrit <code>with(debt, ...)</code> pour indiquer que l’on travaillait avec l’objet <code>debt</code>. Lorsque l’on travaille avec l’extension <code class="pkg">ggplot2</code>, il est toutefois plus commun d’utiliser l’argument <code>data</code> pour indiquer ce choix :</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(Year, growth, <span class="dt">data =</span> debt)</code></pre>
<div id="visualisation-par-petits-multiples" class="section level3">
<h3>Visualisation par <q>petits multiples</q></h3>
<p>Cherchons désormais à mieux comprendre les variations du taux de croissance du PIB au fil des années.</p>
<p>Dans les graphiques précédents, on voit clairement que ce taux est très variable dans l’immédiat après-guerre, puis qu’il oscille entre environ -5% et +15%, puis qu’il semble chuter dramatiquement à la fin des années 2000, marquées par la crise financière globale. Mais comment visualiser ces variations pour chacun des vingt pays de l’échantillon ?</p>
<p>On va ici utiliser le principe de la visualisation par <q><a href="http://www.juiceanalytics.com/writing/better-know-visualization-small-multiples/">petits multiples</a></q>, c’est-à-dire que l’on va reproduire le même graphique pour chacun des pays, et visualiser l’ensemble de ces graphiques dans une même fenêtre. Concrètement, il va donc s’agir de montrer la croissance annuelle du PIB en faisant apparaître chaque pays dans une facette différente du graphique.</p>
<p><code class="pkg">ggplot2</code> permet d’effectuer cette opération en rajoutant au graphique précédent, au moyen de l’opérateur <code>+</code>, l’élément <code>facet_wrap(~ Country)</code> au graphique, qui utilise la syntaxe <q>équation</q> de <strong>R</strong>, et qui signifie <q>construire le graphique pour chaque valeur différente de la variable <var>Country</var></q>. Par défaut, ces <q>facettes</q> sont classées par ordre alphabétique :</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(Year, growth, <span class="dt">data =</span> debt) +
<span class="st">  </span><span class="kw">facet_wrap</span>(~<span class="st"> </span>Country)</code></pre>
<p><img src="images/analyses_graph_biv/unnamed-chunk-10-1.png" title="" alt="" width="1050" /></p>
<p>Voilà qui est beaucoup plus clair ! On aperçoit bien, dans ce graphique, les variations très importantes de croissance du PIB dans un pays comme l’Autriche, ruinée après la Seconde guerre mondiale, ou l’Irlande, très durement frappée par la crise financière globale en 2008 et 2009. On aperçoit aussi où se trouvent les données manquantes : voir le graphique de l’Espagne, par exemple.</p>
<p>Il faut noter ici un élément essentiel de la grammaire graphique de <code class="pkg">ggplot2</code>, qui utilise une syntaxe additive, où différents éléments et paramètres graphiques peuvent être combinés en les additionnant, ce qui permet de construire et de modifier des graphiques de manière cumulative, pas à pas. Cette caractéristique permet de tâtonner, et de construire progressivement des graphiques très complets.</p>
</div>
<div id="visualisation-en-series-temporelles" class="section level3">
<h3>Visualisation en séries temporelles</h3>
<p>Enfin, pour produire le même graphique que ci-dessus en utilisant des lignes plutôt que des points, il suffit d’utiliser l’argument <code>geom = &quot;line&quot;</code>, ce qui peut être considéré comme une meilleure manière de visualiser des séries temporelles, mais qui tend aussi à rendre plus difficile la détection des périodes pour lesquelles il manque des données (voir, à nouveau, le graphique pour l’Espagne) :</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="dt">data =</span> debt, <span class="dt">y =</span> growth, <span class="dt">x =</span> Year, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(~<span class="st"> </span>Country)</code></pre>
<p><img src="images/analyses_graph_biv/unnamed-chunk-11-1.png" title="" alt="" width="1050" /></p>
<p>Dans ce dernier exemple, on a défini l’axe <code>y</code> avant de définir l’axe <code>x</code>, en écrivant ces arguments de manière explicite ; de même, on a commencé par spécifier l’argument <code>data</code>, et l’on a terminé par l’argument <code>geom</code>. Cet ordre d’écriture permet de conserver une forme de cohérence dans l’écriture des fonctions graphiques.</p>
</div>
<div id="combinaisons-delements-graphiques" class="section level3">
<h3>Combinaisons d’éléments graphiques</h3>
<p>On n’a pas encore visualisé le ratio <q>Dette publique / PIB</q>, l’autre variable du raisonnement de Reinhart et Rogoff. C’est l’occasion de voir comment rajouter des titres aux axes des graphiques, et d’utiliser les lignes en même temps que des points, toujours grâce à l’argument <code>geom</code>, qui peut prendre plusieurs valeurs (ici, <code>&quot;point&quot;</code> produit les points et <code>&quot;line&quot;</code> produit les lignes) :</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="dt">data =</span> debt, <span class="dt">y =</span> ratio, <span class="dt">x =</span> Year, <span class="dt">geom =</span> <span class="kw">c</span>(<span class="st">&quot;line&quot;</span>, <span class="st">&quot;point&quot;</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(~<span class="st"> </span>Country) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="st">&quot;Ratio dette publique / produit intérieur brut (%)</span><span class="ch">\n</span><span class="st">&quot;</span>)</code></pre>
<p><img src="images/analyses_graph_biv/unnamed-chunk-12-1.png" title="" alt="" width="1050" /></p>
<p>Dans ce graphique, on a combiné deux <q>objets géométriques</q> (<code>geom</code>) pour afficher à la fois des points et des lignes. On a ensuite défini les titres des axes, en supprimant celui de l’axe <code>x</code>, et en rajoutant un peu d’espace entre le titre de l’axe <code>y</code> et l’axe lui-même grâce à la chaîne de caractères finale <code>\n</code>, qui rajoute une ligne vide entre ces deux éléments.</p>
<p>Les différents exemples vus dans cette section montrent qu’il va falloir apprendre un minimum de syntaxe graphique pour parvenir à produire des graphiques avec <code class="pkg">ggplot2</code>. Ce petit investissement permet de savoir très vite produire de très nombreux types de graphiques, assez élégants de surcroît, et très facilement modifiables à l’aide de toutes sortes de paramètres optionnels.</p>
<div class="important">
Aussi élégants que soient vos graphiques, il ne vous dispense évidemment pas de réfléchir à ce que vous êtes en train de visualiser, un graphique très élégant pouvant naturellement être complètement erroné, en particulier si les données de base du graphique ont été mal mesurées… ou endommagées.
</div>
</div>
</div>
<div id="composition-graphique-avec-ggplot2" class="section level2">
<h2>Composition graphique avec ggplot2</h2>
<p>La section précédente a montré comment utiliser la fonction <code data-pkg="ggplot2" data-rdoc="qplot">qplot</code> (<q><em>quick plot</em></q>). La syntaxe complète de l’extension <code class="pkg">ggplot2</code> passe par une autre fonction, <code data-pkg="ggplot2" data-rdoc="ggplot">ggplot</code>, qui permet de mieux comprendre les différents éléments de sa grammaire graphique. Dans cette section, on va détailler cette syntaxe pour en tirer un graphique plus complexe que les précédents.</p>
<p>Commençons par créer un <q>treillis de base</q> au graphique :</p>
<pre class="sourceCode r"><code class="sourceCode r">p =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> debt, <span class="kw">aes</span>(<span class="dt">y =</span> growth, <span class="dt">x =</span> ratio))</code></pre>
<p>Aucun graphique ne s’affiche ici : en effet, ce que l’on a stocké, dans l’objet <code>p</code>, n’est pas un graphique complet, mais une base de travail. Cette base définit les coordonnées <code>x</code> et <code>y</code> du graphique dans l’argument <code data-pkg="ggplot2" data-rdoc="aes">aes</code> (“<em>aesthetics</em>”). Ici, on a choisi de mettre la variable dépendante de Reinhart et Rogoff, <var>growth</var> (le taux de croissance du PIB), sur l’axe <code>y</code>, et la variable indépendante <var>ratio</var> (le ratio <q>Dette publique / PIB</q>) sur l’axe <code>x</code>.</p>
<p>Rajoutons désormais un objet géométrique, <code data-pkg="ggplot2" data-rdoc="geom_point">geom_point</code>, qui va projeter, sur le graphique, des points aux coordonnées précédemment définies, et divisons le graphique par un <q>petit multiple</q>, en projetant les points de chaque décennie dans une facette différente du graphique. Ce graphique propose une décomposition temporelle de la relation étudiée par Reinhart et Rogoff :</p>
<pre class="sourceCode r"><code class="sourceCode r">p +<span class="st"> </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">facet_grid</span>(. ~<span class="st"> </span>Decade)</code></pre>
<p><img src="images/analyses_graph_biv/unnamed-chunk-14-1.png" title="" alt="" width="1050" /></p>
<div class="note">
Le paramètre <code data-pkg="ggplot2" data-rdoc="facet_grid">facet_grid</code>, qui utilise aussi la syntaxe <q>équation</q>, permet de créer des facettes plus compliquées que celles créées par le paramètre <code data-pkg="ggplot2" data-rdoc="facet_wrap">facet_wrap</code>, même si, dans nos exemples, on aurait pu utiliser aussi bien l’un que l’autre.
</div>
<p>Le graphique ci-dessus présente un problème fréquent : l’axe horizontal du graphique, très important puisque Reinhart et Rogoff évoquent un seuil <q>fatidique</q>, pour la croissance, de 90% du PIB, est illisible. Grâce à l’argument <code data-pkg="ggplot2" data-rdoc="continuous_scale">scale_x_continuous</code>, on va pouvoir clarifier cet axe en n’y faisant figurer que certaines valeurs :</p>
<pre class="sourceCode r"><code class="sourceCode r">p +<span class="st"> </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">facet_grid</span>(. ~<span class="st"> </span>Decade) +
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">200</span>, <span class="dt">by =</span> <span class="dv">100</span>))</code></pre>
<p><img src="images/analyses_graph_biv/unnamed-chunk-15-1.png" title="" alt="" width="1050" /></p>
<p>Ces réglages nous conviennent : on va donc les sauvegarder dans l’objet <code>p</code>, de manière à continuer de construire notre graphique en incluant ces différents éléments.</p>
<pre class="sourceCode r"><code class="sourceCode r">p =<span class="st"> </span>p +<span class="st"> </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">facet_grid</span>(. ~<span class="st"> </span>Decade) +
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">200</span>, <span class="dt">by =</span> <span class="dv">100</span>))</code></pre>
<div id="couleurs-et-echelles" class="section level3">
<h3>Couleurs et échelles</h3>
<p>Abordons désormais un élément-clé de <code class="pkg">ggplot2</code> : la manipulation des paramètres esthétiques. Précédemment, on n’a montré que deux de ces paramètres : <code>x</code> et <code>y</code>, les coordonnées du graphique. Mais ces paramètres peuvent aussi influencer la couleur des points de notre graphique comme le montre l’exemple suivant :</p>
<pre class="sourceCode r"><code class="sourceCode r">p +<span class="st"> </span><span class="kw">aes</span>(<span class="dt">color =</span> ratio &lt;<span class="st"> </span><span class="dv">90</span>)</code></pre>
<p><img src="images/analyses_graph_biv/unnamed-chunk-17-1.png" title="" alt="" width="1050" /></p>
<p>Qu’a-t-on fait ici ? On a rajouté, au graphique stocké dans <code>p</code>, un paramètre esthétique qui détermine la couleur de ses points en fonction d’une inégalité, <code>ratio &lt; 90</code>, qui est vraie quand le ratio <q>Dette publique / PIB</q> est inférieur au seuil <q>fatidique</q> de Reinhart et Rogoff, et fausse quand ce ratio dépasse ce seuil. Les couleurs des points correspondent aux couleurs par défaut de <code class="pkg">ggplot2</code>, que l’on peut très facilement modifier avec une autre <a href="http://docs.ggplot2.org/current/scale_brewer.html">variante</a> du paramètre <code data-pkg="ggplot2" data-rdoc="scale_brewer">scale</code> :</p>
<pre class="sourceCode r"><code class="sourceCode r">p +<span class="st"> </span><span class="kw">aes</span>(<span class="dt">color =</span> ratio &lt;<span class="st"> </span><span class="dv">90</span>) +<span class="st"> </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>)</code></pre>
<p><img src="images/analyses_graph_biv/unnamed-chunk-18-1.png" title="" alt="" width="1050" /></p>
<p>Ici, on a fait appel à la palette de couleur <code>Set1</code> de l’éventail de couleurs <a href="http://colorbrewer2.org/">ColorBrewer</a>, qui est automatiquement disponible dans <code class="pkg">ggplot2</code>, et qui est contenu dans l’extension <code class="pkg">RColorBrewer</code>. La palette de couleurs que l’on a choisie affiche les points situés au-dessus du seuil <q>fatidique</q> de Reinhart et Rogoff en rouge, les autres en bleu.</p>
<p>Que peut-on dire, à ce stade, du seuil <q>fatidique</q> de Reinhart et Rogoff ? On peut observer qu’après la Seconde guerre mondiale, de nombreux pays sont <em>déjà</em> endettés au-delà de ce seuil, et dégagent <em>déjà</em> moins de croissance que les autres. Sur la base de cette trajectoire, de nombreux critiques de Reinhart et Rogoff ont fait remarquer que le raisonnement de Reinhart et Rogoff pose en réalité un sérieux problème d’<a href="http://www.nextnewdeal.net/rortybomb/guest-post-reinhartrogoff-and-growth-time-debt">inversion du rapport causal</a> entre endettement et croissance au cours du temps.</p>
<p>Envisageons une nouvelle modification des paramètres graphiques. La légende du graphique, qui affiche <code>FALSE</code> et <code>TRUE</code> en fonction de l’inégalité <code>ratio &lt; 90</code>, peut être déroutante. Clarifions un peu cette légende en supprimant son titre et en remplaçant les libellés (“<em>labels</em>”) <code>FALSE</code> et <code>TRUE</code> par leur signification :</p>
<pre class="sourceCode r"><code class="sourceCode r">p =<span class="st"> </span>p +<span class="st"> </span><span class="kw">aes</span>(<span class="dt">color =</span> ratio &lt;<span class="st"> </span><span class="dv">90</span>) +
<span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="st">&quot;&quot;</span>, <span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>,
                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;ratio &gt; 90&quot;</span>, <span class="st">&quot;ratio &lt; 90&quot;</span>))</code></pre>
<p>Dans le bloc de code ci-dessus, on a stocké l’ensemble de nos modifications dans l’objet <code>p</code>, sans l’afficher ; en effet, on souhaite encore procéder à une dernière modification, en rajoutant une <a href="https://fr.wikipedia.org/wiki/Régression_locale">régression locale</a> à travers les points de chaque facette<a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a>. Après consultation de la documentation de <code class="pkg">ggplot2</code> <a href="http://docs.ggplot2.org/current/geom_smooth.html">ici</a> et <a href="http://docs.ggplot2.org/current/stat_smooth.html">là</a>, on en arrive au code ci-dessous, où <code>p</code> produit le graphique précédent et <code data-pkg="ggplot2" data-rdoc="geom_smooth">geom_smooth</code> produit la régression locale :</p>
<pre class="sourceCode r"><code class="sourceCode r">p +<span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>,
                <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)</code></pre>
<p><img src="images/analyses_graph_biv/unnamed-chunk-20-1.png" title="" alt="" width="1050" /></p>
<p>Le graphique permet d’évaluer de manière encore un peu plus précise l’argument de Reinhart et Rogoff, et en particulier la nature pas si <q>fatidique</q> du seuil de 90% du ratio “Dette publique / PIB”, qui sans être une bonne nouvelle pour l’économie, ne détermine pas <q>fatidiquement</q> la direction du taux de croissance : si c’était le cas, toutes les courbes du graphique ressembleraient à celles des années 2000. Autrement dit, l’argumentaire de Reinhart et Rogoff laisse clairement à désirer.</p>
</div>
<div id="utilisation-des-themes" class="section level3">
<h3>Utilisation des thèmes</h3>
<p>Reprenons notre graphique de départ. On va, pour terminer cette démonstration, en construire une version imprimable en noir et blanc, ce qui signifie qu’au lieu d’utiliser des couleurs pour distinguer les points en-deçà et au-delà du seuil <q>fatidique</q> de Reinhart et Rogoff, on va utiliser une ligne verticale, produite par <code data-pkg="ggplot2" data-rdoc="geom_vline">geom_vline</code> et affichée en pointillés par le paramètre <code>lty</code> (“<em>linetype</em>”) :</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> debt, <span class="kw">aes</span>(<span class="dt">y =</span> growth, <span class="dt">x =</span> ratio)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) +
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">90</span>, <span class="dt">lty =</span> <span class="st">&quot;dotted&quot;</span>) +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) +
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">200</span>, <span class="dt">by =</span> <span class="dv">100</span>)) +
<span class="st">  </span><span class="kw">facet_grid</span>(. ~<span class="st"> </span>Decade) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Taux de croissance du produit intérieur brut</span><span class="ch">\n</span><span class="st">&quot;</span>,
       <span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Ratio dette publique / produit intérieur brut (%)&quot;</span>,
       <span class="dt">title =</span> <span class="st">&quot;Données Reinhart et Rogoff corrigées, 1946-2009</span><span class="ch">\n</span><span class="st">&quot;</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>() +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>),
        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="kw">rel</span>(<span class="dv">1</span>)),
        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</code></pre>
<p><img src="images/analyses_graph_biv/unnamed-chunk-21-1.png" title="" alt="" width="1050" /></p>
<p>Ce graphique utilise tous les éléments présentés dans ce chapitre, ainsi qu’une dernière nouveauté : l’utilisation d’un thème graphique différent du thème par défaut de <code class="pkg">ggplot2</code>. Le thème par défaut, qui s’appelle <code>theme_grey</code>, est ici remplacé par un thème moins chargé, <code>theme_bw</code> (“<em>black and white</em>”), que l’on a modifié en y rajoutant <a href="http://docs.ggplot2.org/current/theme.html">quelques paramètres supplémentaires</a> :</p>
<ul>
<li>le paramètre <code>strip.background</code> détermine la couleur du rectangle contenant les titres des facettes, c’est-à-dire les décennies observées ;</li>
<li>le paramètre <code>strip.text</code> détermine la taille des titres des facettes, qui sont ici affichés dans la même taille de texte que le reste du texte ;</li>
<li>et le paramètre <code>panel.grid</code> supprime ici les guides du graphique grâce à l’élément vide <code>element_blank</code>, de manière à en alléger la lecture.</li>
</ul>
<p>Ces différents réglages peuvent être sauvegardés de manière à créer des thèmes réutilisables, comme <a href="https://github.com/jrnold/ggthemes/blob/master/README.md#examples">ceux de l’extension <code class="pkg">ggthemes</code></a>, ce qui permet par exemple de créer un thème entièrement blanc dans lequel on peut ensuite projeter une carte, ou de produire une série de graphiques homogènes d’un point de vue esthétique.</p>
</div>
<div id="export-des-graphiques" class="section level3">
<h3>Export des graphiques</h3>
<p>Les graphiques produits par <code class="pkg">ggplot2</code> peuvent être sauvegardés manuellement, comme expliqué dans le chapitre <q><a href="pem_export_graphiques.html">Exporter des graphiques</a></q>, ou programmatiquement. Pour sauvegarder le dernier graphique affiché par <code class="pkg">ggplot2</code> au format PNG, il suffit d’utiliser la fonction <code data-pkg="ggplot2" data-rdoc="ggsave">ggsave</code>, qui permet d’en régler la taille (en pouces) et la résolution (en pixels par pouce ; 72 par défaut) :</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsave</span>(<span class="st">&quot;reinhart-rogoff.png&quot;</span>, <span class="dt">width =</span> <span class="dv">11</span>, <span class="dt">height =</span> <span class="dv">8</span>)</code></pre>
<p>De la même manière, pour sauvegarder n’importe quel graphique construit avec <code class="pkg">ggplot2</code> et stocké dans un objet, il suffit de préciser le nom de cet objet, comme ci-dessous, où l’on sauvegarde le graphique contenu dans l’objet <code>p</code> au format vectoriel PDF, qui préserve la netteté du texte et des autres éléments du graphique à n’importe quelle résolution d’affichage :</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsave</span>(<span class="st">&quot;reinhart-rogoff.pdf&quot;</span>, <span class="dt">plot =</span> p,
       <span class="dt">width =</span> <span class="dv">11</span>, <span class="dt">height =</span> <span class="dv">8</span>)</code></pre>
</div>
</div>
<div id="pour-aller-plus-loin" class="section level2">
<h2>Pour aller plus loin</h2>
<p>Ce chapitre n’a pu faire la démonstration que d’une infime partie des manières d’utiliser <code class="pkg">ggplot2</code>. En voici une dernière illustration, qui donne une idée des différents types de graphiques que l’extension permet de produire dès que l’on connaît les principaux éléments de sa syntaxe :</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> debt, <span class="kw">aes</span>(<span class="dt">x =</span> ratio &gt;<span class="st"> </span><span class="dv">90</span>, <span class="dt">y =</span> growth)) +
<span class="st">  </span><span class="kw">geom_boxplot</span>() +
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;&lt; 90&quot;</span>, <span class="st">&quot;90+&quot;</span>)) +
<span class="st">  </span><span class="kw">facet_grid</span>(. ~<span class="st"> </span>Decade) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Taux de croissance du produit intérieur brut</span><span class="ch">\n</span><span class="st">&quot;</span>,
       <span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Ratio dette publique / produit intérieur brut (%)&quot;</span>,
       <span class="dt">title =</span> <span class="st">&quot;Données Reinhart et Rogoff corrigées, 1946-2009</span><span class="ch">\n</span><span class="st">&quot;</span>) +
<span class="st">  </span><span class="kw">theme_linedraw</span>() +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="kw">rel</span>(<span class="dv">1</span>)),
        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</code></pre>
<p><img src="images/analyses_graph_biv/unnamed-chunk-24-1.png" title="" alt="" width="1050" /></p>
<p>Le code ci-dessus est somme toute très proche du code présenté dans le reste du texte, et en même temps, on a basculé de la visualisation sous forme de série temporelles à une visualisation par <em>boxplots</em>. Ces basculements sont très faciles à envisager dès que l’on maîtrise les principaux éléments de <code class="pkg">ggplot2</code>, <code>geom</code>, <code>scale</code> et <code>facet</code>, et les paramètres <code>labs</code> et <code>theme</code> pour effectuer les finitions.</p>
<div id="ressources-essentielles" class="section level3">
<h3>Ressources essentielles</h3>
<p>Pour tout ce qui concerne l’utilisation de <code class="pkg">ggplot2</code>, <a href="http://ggplot2.org/book/">l’ouvrage de Wickham</a>, <a href="https://github.com/hadley/ggplot2-book">en cours d’actualisation</a>, est la ressource essentielle à consulter. <a href="https://books.google.fr/books?id=ob0VAAAAQBAJ">L’ouvrage de Winston Chang</a>, qui contient des <a href="http://www.cookbook-r.com/Graphs/">dizaines d’exemples</a>, le complète utilement, de même que la <a href="http://docs.ggplot2.org/current/">documentation en ligne</a> de l’extension. Enfin, le site <a href="https://stackoverflow.com/questions/tagged/ggplot2">StackOverflow</a> contient de très nombreuses questions/réponses sur les subtilités de sa syntaxe.</p>
<p>On trouve aussi très facilement, ailleurs sur Internet, des dizaines de <em>tutorials</em> et autres <em>cheatsheets</em> pour <code class="pkg">ggplot2</code>, <a href="http://zevross.com/blog/2014/08/04/beautiful-plotting-in-r-a-ggplot2-cheatsheet-3/">ici</a> ou <a href="http://www.rstudio.com/wp-content/uploads/2015/04/ggplot2-cheatsheet.pdf">là</a> par exemple.</p>
</div>
<div id="extensions-de-ggplot2" class="section level3">
<h3>Extensions de ggplot2</h3>
<p>Il faut signaler, pour terminer, quelques-unes des différentes extensions inspirées de <code class="pkg">ggplot2</code>, dont la plupart sont encore en cours de développement, mais qui permettent d’ores et déjà de produire des centaines de types de graphiques différents, à partir d’une syntaxe graphique proche de celle présentée dans ce chapitre :</p>
<ul>
<li>l’extension <code class="pkg">ggfortify</code> permet de <a href="https://github.com/sinhrks/ggfortify/blob/master/README.rst#examples">visualiser les résultats de différentes fonctions de modélisation</a> avec <code class="pkg">ggplot2</code> ;</li>
<li>l’extension <code class="pkg">ggmap</code> permet de visualiser des fonds de carte et d’y superposer des éléments graphiques rédigés avec <code class="pkg">ggplot2</code> ;</li>
<li>l’extension <code class="pkg">GGally</code> rajoute quelques types de graphiques à ceux que <code class="pkg">ggplot2</code> peut produire par défaut ;</li>
<li>et des extensions comme <code class="pkg">ggvis</code> permettent de <a href="http://ggvis.rstudio.com/">produire des graphiques interactifs</a> en utilisant la syntaxe de base de <code class="pkg">ggplot2</code>.</li>
</ul>
<p>On reviendra sur ces extensions dans un chapitre plus avancé. Pour l’instant, on se contentera des éléments de syntaxe présentés dans ce chapitre, qui seront très souvent mobilisés dans les chapitres suivants, de manière à pleinement illustrer la richesse et la flexibilité de <code class="pkg">ggplot2</code>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Voir l’excellente <a href="http://ggplot2.org/">documentation de l’extension</a> et les autres ressources citées en fin de texte.<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Bien que l’on ait fait le choix de présenter l’extension <code class="pkg">ggplot2</code> plutôt que l’extension <code class="pkg">lattice</code>, celle-ci reste un excellent choix pour la visualisation, notamment, de <a href="http://www.magesblog.com/2013/09/using-planelgroups-in-lattice.html">panels</a> et de <a href="http://www.fromthebottomoftheheap.net/2013/10/23/time-series-plots-with-lattice-and-ggplot/">séries temporelles</a>. On trouve de <a href="https://procomun.wordpress.com/2015/04/14/mapping-flows-in-r-with-data-table-and-lattice/">très beaux exemples</a> d’utilisation de <code class="pkg">lattice</code> en ligne, mais un peu moins de documentation, et beaucoup moins d’extensions, que pour <code class="pkg">ggplot2</code>.<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>Ce produit est mesuré en <a href="https://fr.wikipedia.org/wiki/Produit_intérieur_brut_réel">termes réels</a>, de manière à ce que le calcul de sa croissance ne soit pas affecté par l’inflation.<a href="#fnref3">↩</a></p></li>
<li id="fn4"><p>La régression locale est une variante du calcul de la <a href="https://fr.wikipedia.org/wiki/Moyenne_glissante">moyenne glissante</a> (ou <q>moyenne mobile</q>) d’une courbe.<a href="#fnref4">↩</a></p></li>
</ol>
</div>

</article>
</div>

<div class="col-sm-3" role="complementary">
<nav class="hidden-print hidden-xs" id="nav_sidebar">
</nav>
</div>

</div>

<script>
// manage active state of menu based on current page
$(document).ready(function () {

    // active menu
    href = window.location.pathname;
    href = href.substr(href.lastIndexOf('/') + 1);
    if (href=='') href = 'index.html';
    $('a[href="' + href + '"]').parent().addClass('active');

    // manage active menu header
    if (href.startsWith('pem_'))
      $('a[href="' + 'pem' + '"]').parent().addClass('active');
    else if (href.startsWith('analyses_'))
      $('a[href="' + 'analyses' + '"]').parent().addClass('active');
    else if (href.startsWith('extra_'))
      $('a[href="' + 'extra' + '"]').parent().addClass('active');
    else if (href.startsWith('index_'))
      $('a[href="' + 'index' + '"]').parent().addClass('active');

    // élargir la page d'accueil
    if (href=='index.html') $('.col-sm-9').attr('class','col-sm-12');

    // sidebar
    $("#nav_sidebar").append($("#TOC").html());
    $("#nav_sidebar ul").addClass("nav nav-stacked");
    $("#TOC").addClass("visible-xs-block");
    $('body').scrollspy({
      target: '#nav_sidebar',
      offset: 40
    });

    // Identifier les <pre> fermant
    $('pre').next("*:not(pre)").prev().addClass('last'); // Dernier <pre> de chaque groupe contigu de <pre>
    $('pre').parent().each(function (){
      $(this).children('pre').last().addClass('last');
    }); // Si <pre> est le dernier enfant de son parent

    // Ajout liens rdocumentation et tooltip
    $("code[data-pkg]").each(function( index ) {
      pkg = $(this).attr('data-pkg');
      if ($(this).attr('data-rdoc') !== undefined) {
        rdocumentation = $(this).attr('data-rdoc');
      } else {
        rdocumentation = $(this).text();
      }
      fonction = $(this).text();
      $(this).wrap('<a href="http://www.rdocumentation.org/packages/'+pkg+'/functions/'+rdocumentation+'">');
      $(this).attr('data-toggle','tooltip');
      $(this).attr('data-placement','top');
      $(this).attr('title','package : ' + pkg);
      $('[data-toggle="tooltip"]').tooltip();
    });

    $("code.pkg").each(function( index ) {
      $(this).wrap('<a href="http://www.rdocumentation.org/packages/'+$(this).text()+'">');
    });

    // Figures
    $("figure").each(function( index ) {
      if ($(this).children("figcaption").length > 0)
        $(this).children("figcaption:first").prepend('<span class="figure-number">Figure '+(index+1)+'.</span> ');
      else
        $(this).append($("<figcaption>").append('<span class="figure-number">Figure '+(index+1)+'</span>'));
    });

    // Colorbox
    jQuery('div img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).attr('alt');
      }
    });
    jQuery('div img').css('cursor', 'pointer');
    jQuery('figure img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).parent().children("figcaption").text();
      }
    });
    jQuery('figure img').css('cursor', 'pointer');

    // ZeroClipboard
    $('pre.r').parent().each(function(){
      $(this).children('pre.r').first().before('<div class="zero-clipboard hidden-print hidden-xs"><button class="btn-clipboard">Copier</button></div>');
    }); // Il peut arriver que le pre ne soit pas précédé (cf. figures)
    $('*:not(pre):not(.zero-clipboard) + pre.r').before('<div class="zero-clipboard hidden-print hidden-xs"><button class="btn-clipboard">Copier</button></div>');
    $('pre.last').after(function() {
      if ($(this).hasClass("r")) res = $(this).text(); else res = "";
      $(this).prevUntil('*:not(pre)','pre.r').each(function() {
        res = $(this).text() + '\n' + res;
      });
      return '<div class="clipboard">' + res + '</div>';
    });
    $('.zero-clipboard').each(function(index){
      $(this).children('.btn-clipboard').attr('data-clipboard-target','clipboard_'+index);
      $(this).nextAll("div.clipboard").first().attr('id','clipboard_'+index);
    });
    var client = new ZeroClipboard( $(".btn-clipboard") );
    client.on( "ready", function( readyEvent ) {
      // alert( "ZeroClipboard SWF is ready!" );
      client.on( "aftercopy", function( event ) {
        // `this` === `client`
        // `event.target` === the element that was clicked
        //event.target.style.display = "none";
        $(event.target).parent().before('<div class="alert alert-success"><a href="#" class="close" data-dismiss="alert">&times;</a>Le code <strong>R</strong> de l’exemple a été copié dans le presse-papier.</div>');
      } );
    } );

});
</script>

<!-- disqus -->
<div class="row">
  <div id="disqus_thread" class="col-sm-9" role="complementary"></div>
</div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'analyse-r'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Veuillez activer JavaScript pour voir les <a href="http://disqus.com/?ref_noscript">les commentaires gérés avec Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">Les commentaires sont hébergés par <span class="logo-disqus">Disqus</span>.</a>

</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>


</body>
</html>
