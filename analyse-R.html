<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<title>analyse-R</title>

<script src="libs/jquery-1.11.0/jquery.min.js"></script>
<link href="include/flatly.print.css" rel="stylesheet" />
<link href="include/analyse-R.css" rel="stylesheet" />

</head>

<body>

<style type = "text/css">
/* CSS générées par knitr */

.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}

code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}

code{white-space: pre;}

table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }

pre:not([class]) {
  background-color: white;
}

/* Print CSS */
@media print {
  math {margin: 11px auto;}

  .main-container {margin:0; padding:0; max-width: 100%;}
  img {max-width: 100%;}

  @page {
		size: A4;
		margin: 2.5cm; padding: 0;
 		@bottom {content: "\2013\0000a0\0000a0\0000a0\0000a0" counter(page) "\0000a0\0000a0\0000a0\0000a0\2013"; font-size: 9pt; font-family: Lato, 'Helvetica Neue', Helvetica, Arial, sans-serif;}
		@footnotes {
			border-top: solid #999 thin;
			padding-top: 8pt;
			footnote-style-position: inside;
    }
	}
	@page:first {
  	@bottom { content: normal;}
	  @top-left { content:normal;}
		@top-right { content:normal;}
  }
  @page:left{
    @top-left {content: "analyse-R\0000a0\0000a0\2013\0000a0\0000a0" string(titre_doc);
    font-style: italic; font-size: 9pt; font-family: Lato, 'Helvetica Neue', Helvetica, Arial, sans-serif;}
  }
  @page:right{
    @top-right {content: string(titre_chap); font-style: italic; font-size: 9pt; font-family: Lato, 'Helvetica Neue', Helvetica, Arial, sans-serif;}
  }
  @page:blank{
		@bottom { content: normal;}
	  @top-left { content:normal;}
		@top-right { content:normal;}
	}

  article {string-set: titre_chap "";} /* éviter en-tête en début de chapitre */
	h1 {string-set: titre_chap content();}
	article:first-child .jumbotron h1 {string-set: titre_doc content();}

	body {font-size: 10pt; color: black;}
	pre {font-size: 10pt;}
	h1 {font-size:36pt; margin-top: 3cm; margin-bottom: 1cm; padding:0; color: #2c3e50;}
	article:first-child h1:first-child {margin-top: 0; margin-bottom: .5cm; padding:0; font-size: 48pt;}
	article:first-child .jumbotron h1 {font-size: 32pt;  color: #2c3e50;}
	article:first-child .jumbotron {margin-bottom: 5cm;}
	h2 {font-size: 20pt; margin-top: 1cm; margin-bottom: .5cm; padding:0; color: #2c3e50;}
	h3 {font-size: 16pt; margin-top: 1cm; margin-bottom: .5cm; padding:0; color: #2c3e50;}
	h4 {font-size: 11pt; margin-top: 1cm; margin-bottom: .5cm; padding:0; color: #2c3e50;}
	blockquote p {font-size: 11pt;}
	pre {font-size: 9pt;}

	/* Page-break */
	article, #tdm {page-break-before: right;}
	#presentation {page-break-before: always;}
	article:first-child {page-break-before: auto;}
	h1, h2, h3, h4, heading, caption, pre.r {page-break-after: avoid;}
	figcaption {page-break-before: avoid;}
	figure, table, pre.r {page-break-inside: avoid;}
	div.note, div.important, #licence {page-break-inside: avoid;}

  /* Footnotes */
  .fn {
    float: footnote;
    counter-increment: footnote;
    font-size: 9pt;
  }
  article {counter-reset: footnote;}
  .fn::footnote-call {font-size: 75%; vertical-align: super; line-height: none;}

  /* Liens */
  a[href^="#"] {color: black;}
  a[href^="#"]:after { content: ", page\0000a0" target-counter(attr(href), page);}

  /* Table des matières */
  #tdm strong {font-size: 11pt;}
  .list-group-item {padding: 2pt 0; border:none;}
  a.list-group-item::after {content: leader(" . ") target-counter(attr(href), page);}
  .TOC a::after {content: leader(" . ") target-counter(attr(href), page);}
  .TOC a {color: black;}
  .TOC ul {list-style: none; padding:0; margin:0;}
  .TOC ul ul {padding-left: 0.5cm; font-size: 9pt;}
  .TOC {margin-bottom: 1cm;}

  /* Index des fonctions */
  nav.index {display: none;}
  .liste_index
    {column-count: 2; column-rule: thin solid #2c3e50; column-gap: 1cm;}
  .liste_index p
    {page-break-after: avoid; margin: 10px 0 0 0;}
  .liste_index ul a[href^="#"] {color: black;}
  .liste_index ul a[href^="#"]:after
    {content: leader(" . ") target-counter(attr(href), page);}
  .liste_index ul
  {
    list-style: none;
    padding: 0; margin: 0;
    font-size: 8pt;
    page-break-inside: avoid;
  }
  .liste_index li
    {padding-left: 0.5cm;}

  dfn {border-bottom: dotted .5pt #AAA;}

  /* Styles des exemples de fusion de tables */
  table.exemple_df td,
  table.exemple_df th {
    text-align: center;
    padding: 3px 10px;
  }
  table.exemple_df th {
    border-bottom: solid 1px #999;
  }

  table.exemple_df td + td,
  table.exemple_df th + th {
    border-left: solid 1px #999;
  }

  table.exemple_operateur td {
    font-size: 3em;
    padding: 20px;
  }

}

</style>

<div class="container-fluid main-container">
<article><div class="fluid-row" id="header">



<h1 class="title toc-ignore">analyse-R</h1>

</div>


<div class="jumbotron">
<h1>
Introduction <br>à l’analyse d’enquêtes <br>avec R et RStudio
</h1>
<p>
Dernière mise à jour : 26 septembre 2017
</p>
</div>
<div id="contributeurs" class="section level2">
<h2>Contributeurs</h2>
<p><strong>Par ordre alphabétique :</strong></p>
<p>Julien Barnier, Julien Biaudet, François Briatte, Milan Bouchet-Valat, Frédérique Giraud, Joël Gombin, Mayeul Kauffmann, Joseph Larmarange, Nicolas Robette.</p>
<p><strong>Création et Maintenance :</strong></p>
<p>Joseph Larmarange — <a href="http://joseph.larmarange.net" class="uri">http://joseph.larmarange.net</a></p>
</div>
<div id="presentation" class="section level2">
<h2>Présentation</h2>
<p>L’objectif premier d’<strong>analyse-R</strong> est de présenter comment réaliser des analyses statistiques et diverses opérations courantes (comme la manipulation de données ou la production de graphiques) avec <strong>R</strong>. Il ne s’agit pas d’un cours de statistiques : les différents chapitres présupposent donc que vous avez déjà une connaissance des différentes techniques présentées. Si vous souhaitez des précisions théoriques / méthodologiques à propos d’un certain type d’analyses, nous vous conseillons d’utiliser votre moteur de recherche préféré. En effet, on trouve sur internet de très nombreux supports de cours (sans compter les nombreux ouvrages spécialisés disponibles en libraririe).</p>
<div class="alert alert-warning" style="font-weight: bold;">
<p>
<strong>analyse-R</strong> est en cours de développement. La structuration du site et des chapitre sera probablement amenée à évoluer dans les semaines qui viennent, tout comme les contenus.
</p>
<p>
Les chapitres en cours d’écriture et/ou de refonte sont indiqués sur fond jaune orangé dans le menu situé en haut de page.
</p>
<p>
Si vous constatez des incohérences et/ou si vous avez des suggestions d’améliorations, n’hésitez pas à les signaler sur <a href="https://github.com/larmarange/analyse-R/issues" style="color: white;">https://github.com/larmarange/analyse-R/issues</a>.
</p>
</div>
</div>
<div id="tdm" class="section level2">
<h2>Table des matières</h2>
<p>Si vous débutez avec <strong>R</strong> et <strong>RStudio</strong>, nous vous conseillons de parcourir en premier lieu les chapitres suivants :</p>
<ol style="list-style-type: decimal">
<li>Manipuler &gt; Prise en main</li>
<li>Analyser &gt; Statistiques introductives</li>
<li>Manipuler &gt; Manipulations de données</li>
<li>Analyser &gt; Statistiques intermédiares</li>
</ol>
<p>puis de compléter votre lecture en fonction de vos besoins.</p>
<div id="manipuler" class="section level3">
<h3>Manipuler</h3>
<div class="row">
<div class="col-md-4">
<p>
<strong>Prise en main</strong>
</p>
<div class="list-group">
<p><a href="#presentation-et-philosophie" class="list-group-item">Présentation et Philosophie</a> <a href="#installation-de-R-et-RStudio" class="list-group-item">Installation de R et RStudio</a> <a href="#premier-contact" class="list-group-item">Premier contact</a> <a href="#premier-travail-avec-les-donnees" class="list-group-item">Premier travail avec des données</a> <a href="#extensions" class="list-group-item">Extensions</a> <a href="#vecteurs-indexation-et-assignation" class="list-group-item">Vecteurs, indexation et assignation</a> <a href="#listes-et-tableaux-de-donnes" class="list-group-item">Listes et Tableaux de données</a> <a href="#facteurs-et-vecteurs-labellises" class="list-group-item">Facteurs et vecteurs labellisés</a> <a href="#organiser-ses-fichiers" class="list-group-item">Organiser ses fichiers</a> <a href="#import-de-donnees" class="list-group-item">Import de données</a> <a href="#recodage" class="list-group-item">Recodage</a> <a href="#ou-trouver-de-l-aide" class="list-group-item">Où trouver de l’aide ?</a></p>
</div>
</div>
<div class="col-md-4">
<p>
<strong>Manipulation de données</strong>
</p>
<div class="list-group">
<p><a href="#introduction-a-dplyr" class="list-group-item">Introduction à dplyr</a> <a href="#introduction-a-data-table" class="list-group-item">Introduction à data.table</a> <a href="#doublons" class="list-group-item">Doublons</a> <a href="#tris" class="list-group-item">Tris</a> <a href="#sous-ensembles" class="list-group-item">Sous-ensembles</a> <a href="#fusion-de-tables" class="list-group-item">Fusion de tables</a> <a href="#gestion-des-dates" class="list-group-item">Gestion des dates</a> <a href="#agregation" class="list-group-item">Agrégation</a> <a href="#fonctions-a-fenetre" class="list-group-item">Fonctions à fenêtre</a> <a href="#restructuration-de-donnees" class="list-group-item">Restructuration de données</a> <a href="#manipuler-du-texte" class="list-group-item">Manipuler du texte</a> <a href="#scraping" class="list-group-item">Scraping</a></p>
</div>
</div>
<div class="col-md-4">
<p>
<strong>Exporter</strong>
</p>
<div class="list-group">
<p><a href="#export-de-donnees" class="list-group-item">Export de données</a> <a href="#export-de-graphiques" class="list-group-item">Export de graphiques</a> <a href="#export-de-tableaux" class="list-group-item">Export de tableaux</a></p>
</div>
</div>
</div>
</div>
<div id="analyser" class="section level3">
<h3>Analyser</h3>
<div class="row">
<div class="col-md-4">
<p>
<strong>Statistiques introductives</strong>
</p>
<div class="list-group">
<p><a href="#statistique-univariee" class="list-group-item">Statistique univariée</a> <a href="#statistique-bivariee" class="list-group-item">Statistique bivariée</a> <a href="#intro-ggplot2" class="list-group-item">Introduction à ggplot2</a> <a href="#graphiques-bivaries-ggplot2" class="list-group-item">Graphiques univariés et bivariés avec ggplot2</a> <a href="#donnees-ponderees" class="list-group-item">Données pondérées</a> <a href="#graphiques-de-donnees-ponderees" class="list-group-item">Graphiques de données pondérées</a></p>
</div>
</div>
<div class="col-md-4">
<p>
<strong>Statistiques intermédiaires</strong>
</p>
<div class="list-group">
<p><a href="#intervalles-de-confiance" class="list-group-item">Intervalles de confiance</a> <a href="#comparaisons-moyennes-et-proportions" class="list-group-item">Comparaisons (moyennes et proportions)</a> <a href="#definir-un-plan-d-echantillonnage-complexe" class="list-group-item">Définir un plan d’échantillonnage complexe</a> <a href="#regression-lineaire" class="list-group-item">Régression linéaire</a> <a href="#regression-logistique" class="list-group-item">Régression logistique</a> <a href="#analyse-en-composantes-principales" class="list-group-item">Analyse en composantes principales (ACP)</a> <a href="#analyse-des-correspondances-multiples" class="list-group-item">Analyse des correspondances multiples (ACM)</a> <a href="#classification-ascendante-hierarchique" class="list-group-item">Classification ascendante hiérarchique (CAH)</a></p>
</div>
</div>
<div class="col-md-4">
<p>
<strong>Statistiques avancées</strong>
</p>
<div class="list-group">
<p><a href="#modeles-lineaires-a-effets-mixtes" class="list-group-item">Modèles linéaires à effets mixtes</a> <a href="#modeles-gee" class="list-group-item">Modèles GEE</a> <a href="#series-temporelles" class="list-group-item">Séries temporelles</a> <a href="#modeles-a-temps-discret" class="list-group-item">Modèles à temps discret</a> <a href="#analyse-de-survie" class="list-group-item">Analyse de survie</a> <a href="#analyse-de-sequences" class="list-group-item">Analyse de séquences</a> <a href="#analyse-de-reseaux" class="list-group-item">Analyse de réseaux</a> <a href="#analyse-spatiale" class="list-group-item">Analyse spatiale</a></p>
</div>
</div>
</div>
</div>
<div id="approfondir" class="section level3">
<h3>Approfondir</h3>
<div class="row">
<div class="col-md-4">
<p>
<strong>Graphiques</strong>
</p>
<div class="list-group">
<p><a href="#ggplot2-la-grammaire-des-graphiques" class="list-group-item">ggplot2 : la grammaire des graphiques</a> <a href="#etendre-ggplot2" class="list-group-item">Étendre ggplot2</a> <a href="#lattice-graphiques-et-formules" class="list-group-item">lattice : graphiques et formules</a> <a href="#diagrammes" class="list-group-item">Diagrammes</a> <a href="#representer-des-flux" class="list-group-item">Représenter des flux</a> <a href="#reseaux-dynamiques" class="list-group-item">Réseaux dynamiques</a> <a href="#ggvis-les-graphiques-interactifs" class="list-group-item">ggvis : les graphiques interactifs</a> <a href="#htmlwidgets-la-puissance-du-javascript" class="list-group-item">htmlwidgets : la puissance de javascript</a> <a href="#cartes" class="list-group-item">Cartes</a></p>
</div>
</div>
<div class="col-md-4">
<p>
<strong>Programmation</strong>
</p>
<div class="list-group">
<p><a href="#conditions-et-comparaisons" class="list-group-item">Conditions et comparaisons</a> <a href="#formules" class="list-group-item">Formules</a> <a href="#structures-conditionnelles" class="list-group-item">Structures conditionnelles</a> <a href="#expressions-regulieres" class="list-group-item">Expressions régulières</a> <a href="#ecrire-ses-propres-fonctions" class="list-group-item">Écrire ses propres fonctions</a> <a href="#rmarkdown-les-rapports-automatises" class="list-group-item">R Markdown : les rapports automatisés</a> <a href="#shiny-les-interfaces-interactives" class="list-group-item">Shiny : les interfaces interactives</a> <a href="#git" class="list-group-item">Git</a> <a href="#developper-un-package" class="list-group-item">Développer un package</a></p>
</div>
</div>
<div class="col-md-4">
<p>
<strong>Divers</strong>
</p>
<div class="list-group">
<p><a href="#calculer-un-age" class="list-group-item">Calculer un âge</a> <a href="#diagramme-de-lexis" class="list-group-item">Diagramme de Lexis</a> <a href="#prevR-cartes-de-prevalence" class="list-group-item">prevR : cartes de prévalence à partir des EDS</a></p>
</div>
</div>
</div>
</div>
<div id="index" class="section level3">
<h3>Index</h3>
<div class="list-group">
<p><a href="#index-des-concepts" class="list-group-item">Index des concepts</a> <a href="#index-des-fonctions" class="list-group-item">Index des fonctions</a> <a href="#index-des-extensions" class="list-group-item">Index des extensions</a></p>
</div>
</div>
</div>
<div id="licence" class="section level2">
<h2>Licence</h2>
<p>Le contenu de ce site est diffusé sous licence <em>Creative Commons Attribution - Pas d’utilisation commerciale - Partage dans les mêmes conditions</em> (<a href="https://creativecommons.org/licenses/by-nc-sa/3.0/fr/" class="uri">https://creativecommons.org/licenses/by-nc-sa/3.0/fr/</a>).</p>
<div class="figure">
<img src="images/by-nc-sa.svg" alt="CC by-nc-sa"><p class="caption">CC by-nc-sa</p>
</div>
<p>Cela signifie donc que vous êtes libre de recopier / modifier / redistribuer les contenus d’<strong>analyse-R</strong>, à condition que vous citiez la source et que vos modifications soient elle-mêmes distribuées sous la même licence (autorisant ainsi d’autres à pouvoir réutiliser à leur tour vos ajouts).</p>
</div>
<div id="contribuer" class="section level2">
<h2>Contribuer</h2>
<p><strong>analyse-R</strong> est développé avec <strong>RStudio</strong> et le code source est librement disponible sur <strong>GitHub</strong> :<br><a href="https://github.com/larmarange/analyse-R" class="uri">https://github.com/larmarange/analyse-R</a>.</p>
<p>Ce projet se veut collaboratif. N’hésitez donc pas à proposer des corrections ou ajouts, voire même à rédiger des chapitres additionnels.</p>
</div>

</article>
<article id="presentation-et-philosophie"><div class="fluid-row" id="presentation-et-philosophie_header">



<h1 class="title toc-ignore">Présentation et Philosophie</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#presentation-et-philosophie_presentation-de-r">Présentation de R</a></li>
<li><a href="#presentation-et-philosophie_philosophie-de-r">Philosophie de R</a></li>
<li><a href="#presentation-et-philosophie_presentation-de-rstudio">Présentation de RStudio</a></li>
</ul>
</div>

<div id="presentation-et-philosophie_presentation-de-r" class="section level2">
<h2>Présentation de R</h2>
<p><strong>R</strong> est un langage orienté vers le traitement de données et l’analyse statistique dérivé du langage <strong>S</strong>. Il est développé depuis une vingtaine d’années par un groupe de volontaires de différents pays. C’est un <dfn>logiciel libre</dfn><dfn data-index="libre, logiciel"></dfn><a href="#presentation-et-philosophie_fn1" class="footnoteRef" id="presentation-et-philosophie_fnref1"><sup>1</sup></a>, publié sous licence GNU GPL.</p>
<p>L’utilisation de <strong>R</strong> présente plusieurs avantages :</p>
<ul>
<li>c’est un logiciel multiplateforme, qui fonctionne aussi bien sur des sytèmes <strong>Linux</strong>, <strong>Mac OS X</strong> ou <strong>Windows</strong> ;</li>
<li>c’est un logiciel libre, développé par ses utilisateurs et modifiable par tout un chacun ;</li>
<li>c’est un logiciel gratuit ;</li>
<li>c’est un logiciel très puissant, dont les fonctionnalités de base peuvent être étendues à l’aide de plusieurs milliers d’extensions ;</li>
<li>c’est un logiciel dont le développement est très actif et dont la communauté d’utilisateurs ne cesse de s’élargir ;</li>
<li>les possibilités de manipulation de données sous <strong>R</strong> sont en général largement supérieures à celles des autres logiciels usuels d’analyse statistique ;</li>
<li>c’est un logiciel avec d’excellentes capacités graphiques et de nombreuses possibilités d’export ;</li>
<li>avec <strong>Rmarkdown</strong><a href="#presentation-et-philosophie_fn2" class="footnoteRef" id="presentation-et-philosophie_fnref2"><sup>2</sup></a>, il est devenu très aisé de produire des rapports automatisés dans divers format (<strong>Word</strong>, <strong>PDF</strong>, <strong>HTML</strong>, …) ;</li>
<li>
<strong>R</strong> est de plus utilisé dans tous les secteurs scientifiques, y compris dans le domaine des analyses d’enquêtes et, plus généralement, des sciences sociales.</li>
</ul>
<p>Comme rien n’est parfait, on peut également trouver quelques inconvénients :</p>
<ul>
<li>le logiciel, la documentation de référence et les principales ressources sont en anglais. Il est toutefois parfaitement possible d’utiliser <strong>R</strong> sans spécialement maîtriser cette langue ;</li>
<li>il n’existe pas encore d’interface graphique pour <strong>R</strong> équivalente à celle d’autres logiciels comme <strong>SPSS</strong> ou <strong>Modalisa</strong>. <strong>R</strong> fonctionne à l’aide de <dfn>scripts</dfn> (des petits programmes) édités et exécutés au fur et à mesure de l’analyse et se rapprocherait davantage de <strong>SAS</strong> dans son utilisation (mais avec une syntaxe et une philosophie très différentes). Ce point, qui peut apparaître comme un gros handicap, s’avère après un temps d’apprentissage être un mode d’utilisation d’une grande souplesse ;</li>
<li>comme <strong>R</strong> s’apparente davantage à un langage de programmation qu’à un logiciel proprement dit, la courbe d’apprentissage peut être un peu « raide », notamment pour ceux n’ayant jamais programmé auparavant.</li>
</ul>
<p>Il est à noter que le développement autour de <strong>R</strong> a été particulièrement actif ces dernières années. On trouvera dès lors aujourd’hui de nombreuses extensions permettant de se « faciliter la vie » au quotidien, ce qui n’était pas vraiment encore le cas il y a 5 ans.</p>
</div>
<div id="presentation-et-philosophie_philosophie-de-r" class="section level2">
<h2>Philosophie de R</h2>
<p>Quelques points particuliers dans le fonctionnement de <strong>R</strong> peuvent parfois dérouter les utilisateurs habitués à d’autres logiciels :</p>
<ul>
<li>Sous <strong>R</strong>, en général, on ne voit pas directement les données sur lesquelles on travaille ; on ne dispose pas en permanence d’une vue des données sous forme de tableau<a href="#presentation-et-philosophie_fn3" class="footnoteRef" id="presentation-et-philosophie_fnref3"><sup>3</sup></a>, comme sous <strong>Modalisa ou SPSS</strong>. Ceci peut être déroutant au début, mais on se rend vite compte qu’on n’a pas besoin de voir en permanence les données pour les analyser.</li>
<li>Alors qu’avec la plupart des logiciels on réfléchira avec un fichier de données ouvert à la fois, sous <strong>R</strong> chaque fichier de données correspondra à un objet différent chargé en mémoire, permettant de manipuler très facilement plusieurs objets à la fois (par exemple dans le cadre de fusion de tables<a href="#presentation-et-philosophie_fn4" class="footnoteRef" id="presentation-et-philosophie_fnref4"><sup>4</sup></a>).</li>
<li>Avec les autres logiciels, en général la production d’une analyse génère un grand nombre de résultats de toutes sortes dans lesquels l’utilisateur est censé retrouver et isoler ceux qui l’intéressent. Avec <strong>R</strong>, c’est l’inverse : par défaut l’affichage est réduit au minimum et c’est l’utilisateur qui demande à voir des résultats supplémentaires ou plus détaillés.</li>
<li>Sous <strong>R</strong>, les résultats des analyses sont eux aussi stockés dans des objets et sont dès lors manipulables.</li>
</ul>
<p>Inhabituel au début, ce fonctionnement permet en fait assez rapidement de gagner du temps dans la conduite des analyses.</p>
</div>
<div id="presentation-et-philosophie_presentation-de-rstudio" class="section level2">
<h2>Présentation de RStudio</h2>
<p>L’interface de base de <strong>R</strong> est assez rudimentaire (voir figure ci-après).</p>
<figure><img src="images/capture_RGui.png" alt="Interface de R sous Windows"><figcaption>
Interface de R sous Windows
</figcaption></figure><p><strong>RStudio</strong> est un <dfn>environnement de développement</dfn> intégré libre, gratuit, et qui fonctionne sous <strong>Windows</strong>, <strong>Mac OS X</strong> et <strong>Linux</strong>. Il complète <strong>R</strong> et fournit un <dfn>éditeur de script</dfn> avec <dfn>coloration syntaxique</dfn>, des fonctionnalités pratiques d’édition et d’exécution du code (comme l’<dfn>autocomplétion</dfn>), un affichage simultané du code, de la console <strong>R</strong>, des fichiers, graphiques et pages d’aide, une gestion des extensions, une intégration avec des systèmes de contrôle de versions comme <strong>git</strong>, etc. Il intègre de base divers outils comme par exemple la production de rapports au format <strong>Rmarkdown</strong>. Il est en développement actif et de nouvelles fonctionnalités sont ajoutées régulièrement. Son principal défaut est d’avoir une interface uniquement anglophone.</p>
<figure><img src="images/capture_RStudio.png" alt="Interface de RStudio sous Windows"><figcaption>
Interface de RStudio sous Windows
</figcaption></figure><p>Pour une présentation plus générale de <strong>RStudio</strong> on pourra se référer au site du projet : <a href="http://www.rstudio.com/" class="uri">http://www.rstudio.com/</a>.</p>
<p><strong>RStudio</strong> peut tout à fait être utilisé pour découvrir et démarrer avec <strong>R</strong>. Les différents chapitres d’<strong>analyse-R</strong> partent du principe que vous utilisez <strong>R</strong> avec <strong>RStudio</strong>. Cependant, à part les éléments portant sur l’interface de <strong>RStudio</strong>, l’ensemble du code et des fonctions <strong>R</strong> peuvent être utilisés directement dans <strong>R</strong>, même en l’absence de <strong>RStudio</strong>.</p>
<p>La documentation de <strong>RStudio</strong> (en anglais) est disponible en ligne à <a href="https://support.rstudio.com" class="uri">https://support.rstudio.com</a>. Pour être tenu informé des dernières évolutions de <strong>RStudio</strong>, mais également de plusieurs extensions développées dans le cadre de ce projet, vous pouvez suivre le blog dédié <a href="http://blog.rstudio.org/" class="uri">http://blog.rstudio.org/</a>.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="presentation-et-philosophie_fn1"><p>Pour plus d’informations sur ce qu’est un logiciel libre, voir : <a href="http://www.gnu.org/philosophy/free-sw.fr.html" class="uri">http://www.gnu.org/philosophy/free-sw.fr.html</a>.<a href="#presentation-et-philosophie_fnref1"><U+21A9></a></p></li>
<li id="presentation-et-philosophie_fn2"><p>Voir <a href="http://rmarkdown.rstudio.com/" class="uri">http://rmarkdown.rstudio.com/</a>.<a href="#presentation-et-philosophie_fnref2"><U+21A9></a></p></li>
<li id="presentation-et-philosophie_fn3"><p>On verra qu’il est possible avec <strong>RStudio</strong> de disposer d’une telle vue.<a href="#presentation-et-philosophie_fnref3"><U+21A9></a></p></li>
<li id="presentation-et-philosophie_fn4"><p>Voir par exemple la section dédiée à ce sujet dans le <a href="pem_manipulation.html#fusion_tables">chapitre sur la manipulation de données</a>.<a href="#presentation-et-philosophie_fnref4"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="installation-de-R-et-RStudio"><div class="fluid-row" id="installation-de-R-et-RStudio_header">



<h1 class="title toc-ignore">Installation de R et RStudio</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#installation-de-R-et-RStudio_installation-de-r">Installation de R</a></li>
<li><a href="#installation-de-R-et-RStudio_installation-de-rstudio">Installation de RStudio</a></li>
<li><a href="#installation-de-R-et-RStudio_mise-a-jour-de-r-sous-windows">Mise à jour de R sous Windows</a></li>
</ul>
</div>

<p>Il est préférable de commencer par installer <strong>R</strong> avant d’installer <strong>RStudio</strong>.</p>
<div id="installation-de-R-et-RStudio_installation-de-r" class="section level2">
<h2>Installation de R</h2>
<p>Pour une <dfn>installation</dfn> sous <strong>Windows</strong>, on se rendra sur cette page : <a href="http://cran.r-project.org/bin/windows/base/" class="uri">http://cran.r-project.org/bin/windows/base/</a> et l’on suivra le premier lien pour télécharger le programme d’installation. Une fois le programme d’installation lancé, il suffira d’installer <strong>R</strong> avec les options par défaut<a href="#installation-de-R-et-RStudio_fn1" class="footnoteRef" id="installation-de-R-et-RStudio_fnref1"><sup>1</sup></a>.</p>
<p>Pour <strong>Mac OS X</strong>, les fichiers d’installation sont disponibles à <a href="http://cran.r-project.org/bin/macosx/" class="uri">http://cran.r-project.org/bin/macosx/</a>.</p>
<p>Si vous travaillez sous <strong>Linux</strong>, vous devriez pouvoir trouver <strong>R</strong> via votre gestionnaire de paquets, cela pouvant dépendre d’une distribution de <strong>Linux</strong> à une autre.</p>
</div>
<div id="installation-de-R-et-RStudio_installation-de-rstudio" class="section level2">
<h2>Installation de RStudio</h2>
<p>Une fois <strong>R</strong> correctement installé, rendez-vous sur <a href="http://www.rstudio.com/products/rstudio/download/" class="uri">http://www.rstudio.com/products/rstudio/download/</a> pour télécharger la dernière version stable de <strong>RStudio</strong>. Plus précisément, il s’agit de l’édition <em>Open Source</em> de <strong>RStudio Desktop</strong> (en effet, il existe aussi une version serveur).</p>
<p>Choisissez l’installateur correspondant à votre système d’exploitation et suivez les instructions du programme d’installation.</p>
<p>Si vous voulez tester les dernières fonctionnalités de <strong>RStudio</strong>, vous pouvez télécharger la version de développement (plus riche en fonctionnalités que la version stable, mais pouvant contenir des bugs) sur <a href="http://www.rstudio.com/products/rstudio/download/preview/" class="uri">http://www.rstudio.com/products/rstudio/download/preview/</a>.</p>
</div>
<div id="installation-de-R-et-RStudio_mise-a-jour-de-r-sous-windows" class="section level2">
<h2>Mise à jour de R sous Windows</h2>
<p>Pour mettre à jour <strong>R</strong> sous <strong>Windows</strong><dfn data-index="mise à jour, R"></dfn>, il suffit de télécharger et d’installer la dernière version du programme d’installation.</p>
<p>Petite particularité, la nouvelle version sera installée à côté de l’ancienne version. Si vous souhaitez faire de la place sur votre disque dur, vous pouvez désinstaller l’ancienne version en utilisant l’utilitaire <em>Désinstaller un programme</em> de <strong>Windows</strong>.</p>
<p>Lorsque plusieurs versions de <strong>R</strong> sont disponibles, <strong>RStudio</strong> choisit par défaut la plus récente. Il est vous est possible de spécifier à <strong>RStudio</strong> quelle version de <strong>R</strong> utiliser via le menu <em>Tools</em> &gt; <em>Global Options</em> &gt; <em>General</em>.</p>
<p>Petit défaut, les extensions (<em>packages</em>) sont installées par défaut sous <strong>Windows</strong> dans le répertoire <code>Documents de l'utilisateur &gt; R &gt; win-library &gt; x.y</code> avec <code>x.y</code> correspondant au numéro de la version de <strong>R</strong>. Ainsi, si l’on travaillait avec la version 3.0 et que l’on passe à la version 3.2, les extensions que l’on avait sous l’ancienne version ne sont plus disponibles pour la nouvelle version. Une astuce consiste à recopier le contenu du répertoire <code>3.0</code> dans le répertoire <code>3.2</code>. Puis, on lancera <strong>RStudio</strong> (s’il était déjà ouvert, on le fermera puis relancera) et on mettra à jour l’ensemble des packages, soit avec la fonction, <code data-pkg="utils">update.packages</code> soit en cliquant sur <em>Update</em> dans l’onglet <em>Packages</em> du quadrant inférieur droit.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="installation-de-R-et-RStudio_fn1"><p>Dans le cas particulier où votre ordinateur est situé derrière un <dfn>proxy</dfn>, il est préférable de choisir <em>Options de démarrage personnalisées</em> lorsque cela vous sera demandé par le programme d’installation, puis <em>Internet2</em> lorsqu’on vous demandera le mode de connexion à Internet. Ainsi, <strong>R</strong> utilisera par défaut la configuration internet du navigateur <strong>Internet Explorer</strong> et prendra ainsi en compte les paramètres du <em>proxy</em>.<a href="#installation-de-R-et-RStudio_fnref1"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="premier-contact"><div class="fluid-row" id="premier-contact_header">



<h1 class="title toc-ignore">Premier contact</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#premier-contact_linvite-de-commandes">L’invite de commandes</a></li>
<li>
<a href="#premier-contact_des-objets">Des objets</a><ul>
<li><a href="#premier-contact_objets-simples">Objets simples</a></li>
<li><a href="#premier-contact_vecteurs">Vecteurs</a></li>
</ul>
</li>
<li>
<a href="#premier-contact_des-fonctions">Des fonctions</a><ul>
<li><a href="#premier-contact_arguments">Arguments</a></li>
<li><a href="#premier-contact_quelques-fonctions-utiles">Quelques fonctions utiles</a></li>
<li><a href="#premier-contact_aide-sur-une-fonction">Aide sur une fonction</a></li>
<li><a href="#premier-contact_interpretation-des-arguments">Interprétation des arguments</a></li>
<li><a href="#premier-contact_autocompletion">Autocomplétion</a></li>
</ul>
</li>
</ul>
</div>

<div class="note">
<p>Ce chapitre est inspiré de la section <em>Prise en main</em> du support de cours <a href="https://github.com/juba/intro-r">Introduction à R</a> réalisé par Julien Barnier.</p>
</div>
<p>Une fois <strong>RStudio</strong> lancé, vous devriez obtenir une fenêtre similaire à la figure ci-après.</p>
<figure><img src="images/capture_RStudio.png" alt="Interface de RStudio au démarrage"><figcaption>
Interface de RStudio au démarrage
</figcaption></figure><p>L’<dfn>interface</dfn> de <strong>RStudio</strong> est divisée en quatre quadrants :</p>
<ul>
<li>le quadrant supérieur gauche est dédié aux différents fichiers de travail (nous y reviendrons dans le chapitre <a href="#premier-travail-avec-les-donnees">Premier travail avec les données</a>) ;</li>
<li>le quadrant inférieur gauche correspond à ce que l’on appelle la <em>console</em>, c’est-à-dire à <strong>R</strong> proprement dit ;</li>
<li>le quadrant supérieur droit permet de connaître
<ul>
<li>la liste des objets en mémoire ou <dfn>environnement de travail</dfn> (onglet <em>Environment</em>)</li>
<li>ainsi que l’<dfn>historique des commandes</dfn> saisies dans la console (onglet <em>History</em>) ;</li>
</ul>
</li>
<li>le quadrant inférieur droit affiche
<ul>
<li>la liste des fichiers du répertoire de travail (onglet <em>Files</em>),</li>
<li>les graphiques réalisés (onglet <em>Plots</em>),</li>
<li>la liste des extensions disponibles (onglet <em>Packages</em>),</li>
<li>l’aide en ligne (onglet <em>Help</em>)</li>
<li>et un <em>Viewer</em> utilisé pour visualiser certains types de graphiques au format web.</li>
</ul>
</li>
</ul>
<p>Inutile de tout retenir pour le moment. Nous aborderons chaque outil en temps utile. Pour l’heure, concentrons-nous sur la <dfn>console</dfn>, c’est-à-dire le quadrant inférieur gauche.</p>
<div id="premier-contact_linvite-de-commandes" class="section level2">
<h2>L’invite de commandes</h2>
<p>Au démarrage, la console contient un petit texte de bienvenue ressemblant à peu près à ce qui suit :</p>
<pre><code>R version 3.2.0 (2015-04-16) -- "Full of Ingredients"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

&gt;</code></pre>
<p>suivi d’une ligne commençant par le caractère <code>&gt;</code> et sur laquelle devrait se trouver votre curseur. Cette ligne est appelée l’<dfn>invite de commande</dfn> (ou <dfn>prompt</dfn> en anglais). Elle signifie que <strong>R</strong> est disponible et en attente de votre prochaine commande.</p>
<p>Nous allons tout de suite lui fournir une première commande. Tapez <code>2 + 3</code> dans la console et validez avec la touche <kbd>Entrée</kbd>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span></code></pre></div>
<pre><code>[1] 5</code></pre>
<p>En premier lieu, vous pouvez noter la convention typographique utilisée dans ce documents. Les commandes saisies dans la console sont indiquées sur un fond gris et précédé de <code>R&gt;</code>. Le résultat renvoyé par <strong>R</strong> est quant à lui affiché juste en-dessous sur fond blanc.</p>
<p>Bien, nous savons désormais que <strong>R</strong> sait faire les additions à un chiffre<a href="#premier-contact_fn1" class="footnoteRef" id="premier-contact_fnref1"><sup>1</sup></a>. Nous pouvons désormais continuer avec d’autres opérations arithmétiques de base :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">8</span> <span class="op">-</span><span class="st"> </span><span class="dv">12</span></code></pre></div>
<pre><code>[1] -4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">14</span> <span class="op">*</span><span class="st"> </span><span class="dv">25</span></code></pre></div>
<pre><code>[1] 350</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">-</span><span class="dv">3</span><span class="op">/</span><span class="dv">10</span></code></pre></div>
<pre><code>[1] -0.3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">-</span><span class="fl">0.3</span></code></pre></div>
<pre><code>[1] -0.3</code></pre>
<p>On remarquera que <strong>R</strong> est anglo-saxon. Les nombres sont donc saisies « à l’anglaise », c’est-à-dire en utilisant le point (<code>.</code>) comme séparateur pour les décimales.</p>
<div class="note">
<p>Une petite astuce très utile lorsque vous tapez des commandes directement dans la console : en utilisant les flèches Haut et Bas du clavier, vous pouvez naviguer dans l’historique des commandes tapées précédemment. Vous pouvez alors facilement réexécuter ou modifier une commande particulière.</p>
<p>Sous <strong>RStudio</strong>, l’onglet <em>History</em> du quadrant haut-droite vous permet de consulter l’historique des commandes que vous avez transmises à <strong>R</strong>.</p>
<div class="figure">
<img src="images/capture_RStudio_onglet_history.png" alt="Onglet History sous RStudio"><p class="caption">Onglet History sous RStudio</p>
</div>
<p>Un double-clic sur une commande la recopiera automatiquement dans la console. Vous pouvez également sélectionner une ou plusieurs commandes puis cliquer sur <em>To Console</em>.</p>
<p>Voir également (en anglais) : <a href="https://support.rstudio.com/hc/en-us/articles/200526217-Command-History" class="uri">https://support.rstudio.com/hc/en-us/articles/200526217-Command-History</a>.</p>
</div>
<p>Lorsqu’on fournit à <strong>R</strong> une commande incomplète, celui-ci nous propose de la compléter en nous présentant une invite de commande spéciale utilisant les signe <code>+</code>. Imaginons par exemple que nous avons malencontreusement tapé sur <kbd>Entrée</kbd> alors que nous souhaitions calculer <code>4 * 3</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">4</span> <span class="op">*</span></code></pre></div>
<p>On peut alors compléter la commande en saisissant simplement <code>3</code> :</p>
<pre class="r">4 *
+ 3
</pre>
<pre>
[1] 12
</pre>
<div class="note">
<p>Pour des commandes plus complexes, il arrive parfois qu’on se retrouve coincé avec une invite <code>+</code> sans plus savoir comment compléter la saisie correctement. On peut alors annuler la commande en utilisant la touche <kbd>Echap</kbd> ou <kbd>Esc</kbd> sous <strong>Windows</strong>.</p>
<p>Sous <strong>Linux</strong> on utilise le traditionnel <kbd>Control + C</kbd>.</p>
</div>
<p>À noter que les espaces autour des opérateurs n’ont pas d’importance lorsque l’on saisit les commandes dans <strong>R</strong>. Les trois commandes suivantes sont donc équivalentes, mais on privilégie en général la deuxième pour des raisons de lisibilité du code.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">10</span><span class="op">+</span><span class="dv">2</span>
<span class="dv">10</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span>
<span class="dv">10</span>    <span class="op">+</span><span class="st">    </span><span class="dv">2</span></code></pre></div>
</div>
<div id="premier-contact_des-objets" class="section level2">
<h2>Des objets</h2>
<div id="premier-contact_objets-simples" class="section level3">
<h3>Objets simples</h3>
<p>Faire des opérations arithmétiques, c’est bien, mais sans doute pas totalement suffisant. Notamment, on aimerait pouvoir réutiliser le résultat d’une opération sans avoir à le resaisir ou à le copier/coller.</p>
<p>Comme tout langage de programmation, <strong>R</strong> permet de faire cela en utilisant des objets. Prenons tout de suite un exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">2</span></code></pre></div>
<p>Que signifie cette commande ? L’opérateur <code data-pkg="base" data-rdoc="assignOps">&lt;-</code> est appelé <dfn>opérateur d’assignation</dfn><dfn data-index="assignation, opérateur"></dfn>. Il prend une valeur quelconque à droite et la place dans l’objet indiqué à gauche. La commande pourrait donc se lire <em>mettre la valeur 2 dans l’objet nommé <code>x</code></em>.</p>
<div class="important">
<p>Il existe trois opérateurs d’assignation sous <strong>R</strong>. Ainsi les trois écritures suivantes sont équivalentes :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">2</span>
x =<span class="st"> </span><span class="dv">2</span>
x &lt;-<span class="st"> </span><span class="dv">2</span></code></pre></div>
<p>Cependant, pour une meilleure lecture du code, il est conseillé de n’utiliser que <code>&lt;-</code>. Ainsi, l’objet créé est systématiquement affiché à gauche. De plus, le symbole <code>=</code> sert également pour écrire des conditions ou à l’intérieur de fonctions. Il est donc préférable de ne pas l’utiliser pour assigner une valeur (afin d’éviter les confusions).</p>
</div>
<p>On va ensuite pouvoir réutiliser cet objet dans d’autres calculs ou simplement afficher son contenu :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x <span class="op">+</span><span class="st"> </span><span class="dv">3</span></code></pre></div>
<pre><code>[1] 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x</code></pre></div>
<pre><code>[1] 2</code></pre>
<div class="note">
<p>Par défaut, si on donne à <strong>R</strong> seulement le nom d’un objet, il va se débrouiller pour nous présenter son contenu d’une manière plus ou moins lisible.</p>
</div>
<p>On peut utiliser autant d’objets qu’on veut. Ceux-ci peuvent contenir des nombres, des chaînes de caractères (indiquées par des guillemets droits doubles <code>"</code> ou simples <code>'</code>) et bien d’autres choses encore :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">27</span>
y &lt;-<span class="st"> </span><span class="dv">10</span>
foo &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span>y
foo</code></pre></div>
<pre><code>[1] 37</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> "Hello"</span>
foo &lt;-<span class="st"> </span>x
foo</code></pre></div>
<pre><code>[1] "Hello"</code></pre>
<div class="important">
<p>Les noms d’objets peuvent contenir des lettres, des chiffres, les symboles <code>.</code> et <code>_</code>. Ils doivent impérativement commencer par une lettre (jamais par un chiffre). <strong>R</strong> fait la différence entre les majuscules et les minuscules, ce qui signifie que <code>x</code> et <code>X</code> sont deux objets différents. On évitera également d’utiliser des caractères accentués dans les noms d’objets. Comme les espaces ne sont pas autorisés on pourra les remplacer par un point ou un tiret bas.</p>
<p>Enfin, signalons que certains noms courts sont réservés par <strong>R</strong> pour son usage interne et doivent être évités. On citera notamment <code>c</code>, <code>q</code>, <code>t</code>, <code>C</code>, <code>D</code>, <code>F</code>, <code>I</code>, <code>T</code>, <code>max</code>, <code>min</code>…</p>
</div>
<p>Dans <strong>RStudio</strong>, l’onglet <em>Environment</em> dans le quadrant supérieur droit indique la liste des objets que vous avez précédemment créés, leur type et la taille qu’ils occupent en mémoire.</p>
<figure><img src="images/capture_RStudio_onglet_environment.png" alt="Onglet Environment de RStudio"><figcaption>
Onglet Environment de RStudio
</figcaption></figure>
</div>
<div id="premier-contact_vecteurs" class="section level3">
<h3>Vecteurs</h3>
<p>Imaginons maintenant que nous avons interrogé dix personnes au hasard dans la rue et que nous avons relevé pour chacune d’elle sa taille en centimètres. Nous avons donc une série de dix nombres que nous souhaiterions pouvoir réunir de manière à pouvoir travailler sur l’ensemble de nos mesures.</p>
<p>Un ensemble de données de même nature constituent pour <strong>R</strong> un <dfn>vecteur</dfn> (en anglais <dfn>vector</dfn>) et se construit à l’aide d’une fonction nommée <code data-pkg="base">c</code><a href="#premier-contact_fn2" class="footnoteRef" id="premier-contact_fnref2"><sup>2</sup></a>. On l’utilise en lui donnant la liste de nos données, entre parenthèses, séparées par des virgules :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tailles &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">167</span>, <span class="dv">192</span>, <span class="dv">173</span>, <span class="dv">174</span>, <span class="dv">172</span>, <span class="dv">167</span>, <span class="dv">171</span>, <span class="dv">185</span>, 
  <span class="dv">163</span>, <span class="dv">170</span>)</code></pre></div>
<p>Ce faisant, nous avons créé un objet nommé <code>tailles</code> et comprenant l’ensemble de nos données, que nous pouvons afficher en saisissant simplement son nom :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tailles</code></pre></div>
<pre><code> [1] 167 192 173 174 172 167 171 185 163 170</code></pre>
<p>Que se passe-t-il s’il on créé un vecteur plus grand ?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="dv">144</span>, <span class="dv">168</span>, <span class="dv">179</span>, <span class="dv">175</span>, <span class="dv">182</span>, <span class="dv">188</span>, <span class="dv">167</span>, <span class="dv">152</span>, <span class="dv">163</span>, <span class="dv">145</span>, 
  <span class="dv">176</span>, <span class="dv">155</span>, <span class="dv">156</span>, <span class="dv">164</span>, <span class="dv">167</span>, <span class="dv">155</span>, <span class="dv">157</span>, <span class="dv">185</span>, <span class="dv">155</span>, <span class="dv">169</span>, 
  <span class="dv">124</span>, <span class="dv">178</span>, <span class="dv">182</span>, <span class="dv">195</span>, <span class="dv">151</span>, <span class="dv">185</span>, <span class="dv">159</span>, <span class="dv">156</span>, <span class="dv">184</span>, <span class="dv">172</span>)</code></pre></div>
<pre><code> [1] 144 168 179 175 182 188 167 152 163 145 176
[12] 155 156 164 167 155 157 185 155 169 124 178
[23] 182 195 151 185 159 156 184 172</code></pre>
<p>On a bien notre suite de trente tailles, mais on peut remarquer la présence de nombres entre crochets au début de chaque ligne (<code>[1]</code>, <code>[12]</code> et <code>[23]</code>). En fait ces nombres entre crochets indiquent la position du premier élément de la ligne dans notre vecteur. Ainsi, le 155 en début de deuxième ligne est le 12<sup>e</sup> élément du vecteur, tandis que le 182 de la troisième ligne est à la 23<sup>e</sup> position.</p>
<p>On en déduira d’ailleurs que lorsque l’on fait :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">2</span></code></pre></div>
<pre><code>[1] 2</code></pre>
<p><strong>R</strong> considère en fait le nombre 2 comme un vecteur à un seul élément.</p>
<p>On peut appliquer des opérations arithmétiques simples directement sur des vecteurs :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tailles &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">167</span>, <span class="dv">192</span>, <span class="dv">173</span>, <span class="dv">174</span>, <span class="dv">172</span>, <span class="dv">167</span>, <span class="dv">171</span>, <span class="dv">185</span>, 
  <span class="dv">163</span>, <span class="dv">170</span>)
tailles <span class="op">+</span><span class="st"> </span><span class="dv">20</span></code></pre></div>
<pre><code> [1] 187 212 193 194 192 187 191 205 183 190</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tailles<span class="op">/</span><span class="dv">100</span></code></pre></div>
<pre><code> [1] 1.67 1.92 1.73 1.74 1.72 1.67 1.71 1.85 1.63
[10] 1.70</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tailles<span class="op">^</span><span class="dv">2</span></code></pre></div>
<pre><code> [1] 27889 36864 29929 30276 29584 27889 29241
 [8] 34225 26569 28900</code></pre>
<p>On peut aussi combiner des vecteurs entre eux. L’exemple suivant calcule l’indice de masse corporelle à partir de la taille et du poids :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tailles &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">167</span>, <span class="dv">192</span>, <span class="dv">173</span>, <span class="dv">174</span>, <span class="dv">172</span>, <span class="dv">167</span>, <span class="dv">171</span>, <span class="dv">185</span>, 
  <span class="dv">163</span>, <span class="dv">170</span>)
poids &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">86</span>, <span class="dv">74</span>, <span class="dv">83</span>, <span class="dv">50</span>, <span class="dv">78</span>, <span class="dv">66</span>, <span class="dv">66</span>, <span class="dv">51</span>, <span class="dv">50</span>, <span class="dv">55</span>)
tailles.m &lt;-<span class="st"> </span>tailles<span class="op">/</span><span class="dv">100</span>
imc &lt;-<span class="st"> </span>poids<span class="op">/</span>(tailles.m<span class="op">^</span><span class="dv">2</span>)
imc</code></pre></div>
<pre><code> [1] 30.83653 20.07378 27.73230 16.51473 26.36560
 [6] 23.66524 22.57105 14.90139 18.81892 19.03114</code></pre>
<div class="important">
<p>Quand on fait des opérations sur les vecteurs, il faut veiller à soit utiliser un vecteur et un chiffre (dans des opérations du type <code>v * 2</code> ou <code>v + 10</code>), soit à utiliser des vecteurs de même longueur (dans des opérations du type <code>u + v</code>).</p>
<p>Si on utilise des vecteurs de longueur différentes, on peut avoir quelques surprises. Quand <strong>R</strong> effectue une opération avec deux vecteurs de longueurs différentes, il recopie le vecteur le plus court de manière à lui donner la même taille que le plus long, ce qui s’appelle la règle de <dfn>recyclage</dfn> (<dfn lang="en">recycling rule</dfn>). Ainsi, <code>c(1,2) + c(4,5,6,7,8)</code> vaudra l’équivalent de <code>c(1,2,1,2,1) + c(4,5,6,7,8)</code>.</p>
</div>
<p>On a vu jusque-là des vecteurs composés de nombres, mais on peut tout à fait créer des vecteurs composés de chaînes de caractères, représentant par exemple les réponses à une question ouverte ou fermée :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reponse &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Bac+2"</span>, <span class="st">"Bac"</span>, <span class="st">"CAP"</span>, <span class="st">"Bac"</span>, <span class="st">"Bac"</span>, <span class="st">"CAP"</span>, 
  <span class="st">"BEP"</span>)
reponse</code></pre></div>
<pre><code>[1] "Bac+2" "Bac"   "CAP"   "Bac"   "Bac"  
[6] "CAP"   "BEP"  </code></pre>
<p>Enfin, notons que l’on peut accéder à un élément particulier du vecteur en faisant suivre le nom du vecteur de crochets contenant le numéro de l’élément désiré. Par exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reponse &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Bac+2"</span>, <span class="st">"Bac"</span>, <span class="st">"CAP"</span>, <span class="st">"Bac"</span>, <span class="st">"Bac"</span>, <span class="st">"CAP"</span>, 
  <span class="st">"BEP"</span>)
reponse[<span class="dv">2</span>]</code></pre></div>
<pre><code>[1] "Bac"</code></pre>
<p>Cette opération s’appelle l’<dfn>indexation</dfn> d’un vecteur. Il s’agit ici de sa forme la plus simple, mais il en existe d’autres beaucoup plus complexes. L’indexation des vecteurs et des tableaux dans <strong>R</strong> est l’un des éléments particulièrement souples et puissants du langage (mais aussi l’un des plus délicats à comprendre et à maîtriser). Nous en reparlerons dans le chapitre sur la <a href="pem_manipulation.html#indexation">manipulation de données</a>.</p>
<div class="note">
<p>Sous <strong>RStudio</strong>, vous avez du remarquer que ce dernier effectue une <dfn>coloration syntaxique</dfn>. Lorsque vous tapez une commande, les valeurs numériques sont affichées dans une certaine couleur, les valeurs textuelles dans une autre et les noms des fonctions dans une troisième. De plus, si vous tapez une parenthèse ouvrante, <strong>RStudio</strong> va créer automatiquement après le curseur la parenthèse fermante correspondante (de même avec les guillements ou les crochets). Si vous placez le curseur juste après une parenthèse fermante, la parenthèse ouvrante correspondante sera surlignée, ce qui sera bien pratique lors de la rédaction de commandes complexes.</p>
</div>
</div>
</div>
<div id="premier-contact_des-fonctions" class="section level2">
<h2>Des fonctions</h2>
<p>Nous savons désormais faire des opérations simples sur des nombres et des vecteurs, stocker ces données et résultats dans des objets pour les réutiliser par la suite.</p>
<p>Pour aller un peu plus loin nous allons aborder, après les objets, l’autre concept de base de <strong>R</strong>, à savoir les <dfn data-index="fonction">fonctions</dfn>. Une fonction se caractérise de la manière suivante :</p>
<ul>
<li>elle a un nom ;</li>
<li>elle accepte des <dfn data-index="argument">arguments</dfn> (qui peuvent avoir un nom ou pas) ;</li>
<li>elle retourne un résultat et peut effectuer une action comme dessiner un graphique ou lire un fichier.</li>
</ul>
<p>En fait rien de bien nouveau puisque nous avons déjà utilisé plusieurs fonctions jusqu’ici, dont la plus visible est la fonction <code data-pkg='"base'>c</code>. Dans la ligne suivante :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reponse &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Bac+2"</span>, <span class="st">"Bac"</span>, <span class="st">"CAP"</span>, <span class="st">"Bac"</span>, <span class="st">"Bac"</span>, <span class="st">"CAP"</span>, 
  <span class="st">"BEP"</span>)</code></pre></div>
<p>on fait appel à la fonction nommée <code data-pkg="base">c</code>, on lui passe en arguments (entre parenthèses et séparées par des virgules) une série de chaînes de caractères et elle retourne comme résultat un vecteur de chaînes de caractères, que nous stockons dans l’objet <code>reponse</code>.</p>
<p>Prenons tout de suite d’autres exemples de fonctions courantes :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tailles &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">167</span>, <span class="dv">192</span>, <span class="dv">173</span>, <span class="dv">174</span>, <span class="dv">172</span>, <span class="dv">167</span>, <span class="dv">171</span>, <span class="dv">185</span>, 
  <span class="dv">163</span>, <span class="dv">170</span>)
<span class="kw">length</span>(tailles)</code></pre></div>
<pre><code>[1] 10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(tailles)</code></pre></div>
<pre><code>[1] 173.4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>(tailles)</code></pre></div>
<pre><code>[1] 76.71111</code></pre>
<p>Ici, la fonction <code data-pkg="base">length</code> nous renvoie le nombre d’éléments du vecteur, la fonction <code data-pkg="base">mean</code> nous donne la moyenne des éléments du vecteur et fonction <code data-pkg="stats" data-rdoc="cor">var</code> sa variance.</p>
<div id="premier-contact_arguments" class="section level3">
<h3>Arguments</h3>
<p>Les arguments de la fonction lui sont indiqués entre parenthèses, juste après son nom. En général les premiers arguments passés à la fonction sont des données servant au calcul et les suivants des paramètres influant sur ce calcul. Ceux-ci sont en général transmis sous la forme d’argument nommés.</p>
<p>Reprenons l’exemple des tailles précédent :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tailles &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">167</span>, <span class="dv">192</span>, <span class="dv">173</span>, <span class="dv">174</span>, <span class="dv">172</span>, <span class="dv">167</span>, <span class="dv">171</span>, <span class="dv">185</span>, 
  <span class="dv">163</span>, <span class="dv">170</span>)</code></pre></div>
<p>Imaginons que le deuxième enquêté n’ait pas voulu nous répondre. Nous avons alors dans notre vecteur une <dfn>valeur manquante</dfn>. Celle-ci est symbolisée dans <strong>R</strong> par le code <code>NA</code><dfn data-index="NA"></dfn> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tailles &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">167</span>, <span class="ot">NA</span>, <span class="dv">173</span>, <span class="dv">174</span>, <span class="dv">172</span>, <span class="dv">167</span>, <span class="dv">171</span>, <span class="dv">185</span>, 
  <span class="dv">163</span>, <span class="dv">170</span>)</code></pre></div>
<p>Recalculons notre taille moyenne :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(tailles)</code></pre></div>
<pre><code>[1] NA</code></pre>
<p>Et oui, par défaut, <strong>R</strong> renvoie <code>NA</code> pour un grand nombre de calculs (dont la moyenne) lorsque les données comportent une valeur manquante. On peut cependant modifier ce comportement en fournissant un paramètre supplémentaire à la fonction <code data-pkg="base">mean</code>, nommé <code>na.rm</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(tailles, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>[1] 171.3333</code></pre>
<p>Positionner le paramètre <code>na.rm</code> à <code>TRUE</code> (vrai) indique à la fonction <code data-pkg="base">mean</code> de ne pas tenir compte des valeurs manquantes dans le calcul.</p>
<p>Lorsqu’on passe un argument à une fonction de cette manière, c’est-à-dire sous la forme <code>nom=valeur</code>, on parle d’<dfn>argument nommé</dfn>.</p>
<div class="important">
<p><code>NA</code> signifie <em>not available</em>. Cette valeur particulière peut être utilisée pour indiquer une valeur manquante pour tout type de liste (nombres, textes, valeurs logique, etc.).</p>
</div>
</div>
<div id="premier-contact_quelques-fonctions-utiles" class="section level3">
<h3>Quelques fonctions utiles</h3>
<p>Récapitulons la liste des fonctions que nous avons déjà rencontrées :</p>
<table>
<thead><tr class="header">
<th align="left">Fonction</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code data-pkg="base">c</code></td>
<td align="left">construit un vecteur à partir d’une série de valeurs</td>
</tr>
<tr class="even">
<td align="left"><code data-pkg="base">length</code></td>
<td align="left">nombre d’éléments d’un vecteur</td>
</tr>
<tr class="odd">
<td align="left"><code data-pkg="base">mean</code></td>
<td align="left">moyenne d’un vecteur de type numérique</td>
</tr>
<tr class="even">
<td align="left"><code data-pkg="stats" data-rdoc="cor">var</code></td>
<td align="left">variance d’un vecteur de type numérique</td>
</tr>
<tr class="odd">
<td align="left">
<code data-pkg="base" data-rdoc="Arithmetic">+</code>, <code data-pkg="base" data-rdoc="Arithmetic">-</code>, <code data-pkg="base" data-rdoc="Arithmetic">*</code>, <code data-pkg="base" data-rdoc="Arithmetic">/</code>
</td>
<td align="left">opérateurs mathématiques de base</td>
</tr>
<tr class="even">
<td align="left"><code data-pkg="base" data-rdoc="Arithmetic">ˆ</code></td>
<td align="left">passage à la puissance</td>
</tr>
</tbody>
</table>
<p>On peut rajouter les fonctions de base suivantes :</p>
<table>
<thead><tr class="header">
<th align="left">Fonction</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code data-pkg="base" data-rdoc="Extremes">min</code></td>
<td align="left">valeur minimale d’un vecteur numérique</td>
</tr>
<tr class="even">
<td align="left"><code data-pkg="base" data-rdoc="Extremes">max</code></td>
<td align="left">valeur maximale d’un vecteur numérique</td>
</tr>
<tr class="odd">
<td align="left"><code data-pkg="stats">sd</code></td>
<td align="left">écart-type d’un vecteur numérique</td>
</tr>
<tr class="even">
<td align="left"><code data-pkg="base" data-rdoc="Colon">:</code></td>
<td align="left">génère une séquence de nombres. <code>1:4</code> équivaut à <code>c(1,2,3,4)</code>
</td>
</tr>
</tbody>
</table>
</div>
<div id="premier-contact_aide-sur-une-fonction" class="section level3">
<h3>Aide sur une fonction</h3>
<p>Il est très fréquent de ne plus se rappeler quels sont les paramètres d’une fonction ou le type de résultat qu’elle retourne. Dans ce cas on peut très facilement accéder à l’<dfn>aide</dfn> décrivant une fonction particulière avec <code data-pkg='="utils"' data-rdoc='="Question"'>?</code> ou <code data-pkg="utils">help</code>. Ainsi, pour obtenir de l’aide sur la fonction <code data-pkg="base">mean</code>, on saisira l’une des deux entrées équivalentes suivantes :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?mean
<span class="kw">help</span>(<span class="st">"mean"</span>)</code></pre></div>
<div class="note">
<p>L’utilisation du raccourci <code data-pkg='="utils"' data-rdoc='="Question"'>?</code> ne fonctionne pas pour certains opérateurs comme <code data-pkg="base" data-rdoc="Arithmetic">*</code>. Dans ce cas on pourra utiliser <code>?'*'</code> ou bien simplement <code>help("*")</code>.</p>
</div>
<p>Sous <strong>RStudio</strong>, le fichier d’aide associé apparaitra dans le quadrant inférieur droit sous l’onglet <em>Help</em>.</p>
<figure><img src="images/capture_RStudio_onglet_help.png" alt="Onglet Help de RStudio"><figcaption>
Onglet Help de RStudio
</figcaption></figure><p>Cette page décrit (en anglais) la fonction, ses arguments, son résultat, le tout accompagné de diverses notes, références et exemples. Ces pages d’aide contiennent à peu près tout ce que vous pourrez chercher à savoir, mais elles ne sont pas toujours d’une lecture aisée.</p>
<p>Un autre cas très courant dans <strong>R</strong> est de ne pas se souvenir ou de ne pas connaître le nom de la fonction effectuant une tâche donnée. Dans ce cas on se reportera aux différentes manières de trouver de l’aide décrites dans le chapitre <a href="#ou-trouver-de-l-aide">Où trouver de l’aide ?</a>.</p>
</div>
<div id="premier-contact_interpretation-des-arguments" class="section level3">
<h3>Interprétation des arguments</h3>
<p>Prenons l’exemple de la fonction <code data-pkg="base">format</code> dont la version de base permet de mettre en forme un nombre. Affichons le fichier d’aide associé.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="st">`</span><span class="dt">?</span><span class="st">`</span>(format)</code></pre></div>
<p>La section <em>Usage</em> présente les arguments de cette fonction et leur valeur par défaut :</p>
<pre>
format(x, trim = FALSE, digits = NULL, nsmall = 0L,
       justify = c("left", "right", "centre", "none"),
       width = NULL, na.encode = TRUE, scientific = NA,
       big.mark = "",   big.interval = 3L,
       small.mark = "", small.interval = 5L,
       decimal.mark = ".", zero.print = NULL,
       drop0trailing = FALSE, ...)
</pre>
<p>Regardons ce que cette fonction peut faire. Passons-lui un vecteur avec deux nombres :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">format</span>(<span class="kw">c</span>(<span class="fl">12.3</span>, <span class="dv">5678</span>))</code></pre></div>
<pre><code>[1] "  12.3" "5678.0"</code></pre>
<p>Elle renvoie un vecteur de chaînes de caractères. Le nombre de décimales a été harmonisé et des espaces ont été ajoutés au début du premier nombre afin que l’ensemble des valeurs soient alignées vers la droite.</p>
<p>L’argument <code>trim</code> permet de supprimer les espaces ajoutés en début de chaîne.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">format</span>(<span class="kw">c</span>(<span class="fl">12.3</span>, <span class="dv">5678</span>), <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>[1] "12.3"   "5678.0"</code></pre>
<p>Dans le cas présent, nous avons saisi les arguments de la fonction sans les nommer. Dès lors, <strong>R</strong> considère l’ordre dans lesquels nous avons saisi les arguments, ordre qui correspond à celui du fichier d’aide. Il a dès lors considéré que <code>c(12.3, 5678)</code> correspond à la valeur attribuée à <code>x</code> et que <code>TRUE</code> est la valeur attribuée à <code>trim</code>.</p>
<p>L’argument <code>nsmall</code> permet d’indiquer le nombre minimum de décimales que l’on souhaite afficher. Il est en quatrième position. Dès lors, pour pouvoir le renseigner avec des <dfn data-index="argument non nommé">arguments non nommés</dfn>, il faut fournir également une valeur pour le troisième argument <code>digits</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">format</span>(<span class="kw">c</span>(<span class="fl">12.3</span>, <span class="dv">5678</span>), <span class="ot">TRUE</span>, <span class="ot">NULL</span>, <span class="dv">2</span>)</code></pre></div>
<pre><code>[1] "12.30"   "5678.00"</code></pre>
<p>Ce n’est pas forcément ce qu’il y a de plus pratique. D’où l’intérêt des <dfn data-index="argument nommé">arguments nommés</dfn>. En précisant <code>nsmall =</code> dans l’appel de la fonction, on pourra indiquer que l’on souhaite modifier spécifiquement cet argument. Lorsque l’on utilise des arguments non nommés, l’ordre n’importe plus puisque <strong>R</strong> sera en capacité de reconnaître ses petits.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">format</span>(<span class="dt">nsmall =</span> <span class="dv">2</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="fl">12.3</span>, <span class="dv">5678</span>))</code></pre></div>
<pre><code>[1] "  12.30" "5678.00"</code></pre>
<p>À l’usage, on aura le plus souvent recours à une combinaison d’arguments non nommés et d’arguments nommés. On indiquera les premiers arguments (qui correspondent en général aux données de départ) sans les nommer et on précisera les options souhaitées avec des arguments nommés. Par exemple, pour un affichage à la française :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">format</span>(<span class="kw">c</span>(<span class="fl">12.3</span>, <span class="dv">5678</span>), <span class="dt">decimal.mark =</span> <span class="st">","</span>, <span class="dt">big.mark =</span> <span class="st">" "</span>)</code></pre></div>
<pre><code>[1] "   12,3" "5 678,0"</code></pre>
<p>Lorsque l’on regarde la section <em>Usage</em> du fichier d’aide, il apparait que certains arguments, suivi par le symbole <code>=</code>, ont une valeur par défaut. Il n’est donc pas nécessaire de les inclure dans l’appel de la fonction, auquel cas la valeur pas défaut sera prise en compte. Par contre, d’autres arguments, ici <code>x</code>, n’ont pas de valeur par défaut et il est donc nécessaire de fournir systématiquement une valeur.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">format</span>(<span class="dt">decimal.mark =</span> <span class="st">","</span>)</code></pre></div>
<pre><code>Error in format.default(decimal.mark = ","): l'argument "x" est manquant, avec aucune valeur par défaut</code></pre>
<p>Enfin, pour certaines fonctions, on verra parfois apparaître le symbole <code>...</code> Ce dernier correspond à un nombre indéterminé d’arguments. Il peut s’agir, comme dans le cas de <code data-pkg="base">format</code> d’arguments additionnels qui seront utilisés dans certains cas de figure, ou bien d’arguments qui seront transmis à une fonction secondaire appelée par la fonction principale, ou encore, comme pour le cas de la fonction <code data-pkg="base">c</code>, de la possibilité de saisir un nombre indéfini de données sources.</p>
</div>
<div id="premier-contact_autocompletion" class="section level3">
<h3>Autocomplétion</h3>
<p><strong>RStudio</strong> fournit un outil bien pratique appelé <dfn>autocomplétion</dfn><a href="#premier-contact_fn3" class="footnoteRef" id="premier-contact_fnref3"><sup>3</sup></a>. Saisissez les premières lettres d’une fonction, par exemple <code>me</code> puis appuyez sur la touche <kbd>Tabulation</kbd>. <strong>RStudio</strong> affichera la liste des fonctions dont le nom commence par <code>me</code> ainsi qu’un court descriptif de chacune. Un appui sur la touche <kbd>Entrée</kbd> provoquera la saisie du nom complet de la fonction choisie.</p>
<figure><img src="images/capture_RStudio_autocompletion.png" alt="Auto-complétion sous RStudio"><figcaption>
Auto-complétion sous RStudio
</figcaption></figure><p>À l’intérieur des parenthèses d’une fonction, vous pouvez utiliser l’autocomplétion pour retrouver un argument de cette fonction.</p>
<p>Vous pouvez également utiliser l’autocomplétion pour retrouver le nom d’un objet que vous avez précédemment créé.</p>
<p>Pour plus de détails, voir la documentation officielle de <strong>RStudio</strong> (<a href="https://support.rstudio.com/hc/en-us/articles/205273297-Code-Completion" class="uri">https://support.rstudio.com/hc/en-us/articles/205273297-Code-Completion</a>).</p>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="premier-contact_fn1"><p>La présence du <code>[1]</code> en début de ligne sera expliquée par la suite dans la section sur les <a href="#premier-contact_vecteurs">vecteurs</a>.<a href="#premier-contact_fnref1"><U+21A9></a></p></li>
<li id="premier-contact_fn2"><p><code data-pkg="base">c</code> est l’abbréviation de <em>combine</em>. Le nom de cette fonction est très court car on l’utilise très souvent.<a href="#premier-contact_fnref2"><U+21A9></a></p></li>
<li id="premier-contact_fn3"><p>En bon français, il faudrait dire <em>complètement automatique</em>.<a href="#premier-contact_fnref3"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="premier-travail-avec-les-donnees"><div class="fluid-row" id="premier-travail-avec-les-donnees_header">



<h1 class="title toc-ignore">Premier travail avec des données</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#premier-travail-avec-les-donnees_regrouper-les-commandes-dans-des-scripts">Regrouper les commandes dans des scripts</a></li>
<li><a href="#premier-travail-avec-les-donnees_ajouter-des-commentaires">Ajouter des commentaires</a></li>
<li><a href="#premier-travail-avec-les-donnees_tableaux-de-donnees">Tableaux de données</a></li>
<li><a href="#premier-travail-avec-les-donnees_inspecter">Inspection visuelle des données</a></li>
<li><a href="#premier-travail-avec-les-donnees_structure-du-tableau">Structure du tableau</a></li>
<li><a href="#premier-travail-avec-les-donnees_acceder-aux-variables">Accéder aux variables</a></li>
<li><a href="#premier-travail-avec-les-donnees_la-fonction-str">La fonction str</a></li>
<li><a href="#premier-travail-avec-les-donnees_quelques-calculs-simples">Quelques calculs simples</a></li>
<li><a href="#premier-travail-avec-les-donnees_nos-premiers-graphiques">Nos premiers graphiques</a></li>
<li><a href="#premier-travail-avec-les-donnees_et-ensuite">Et ensuite ?</a></li>
</ul>
</div>

<div class="note">
<p>Ce chapitre est inspiré de la section <em>Premier travail avec les données</em> du support de cours <a href="https://github.com/juba/intro-r">Introduction à R</a> réalisé par Julien Barnier.</p>
</div>
<div id="premier-travail-avec-les-donnees_regrouper-les-commandes-dans-des-scripts" class="section level2">
<h2>Regrouper les commandes dans des scripts</h2>
<p>Jusqu’à maintenant nous avons utilisé uniquement la console pour communiquer avec <strong>R</strong> via l’invite de commandes. Le principal problème de ce mode d’interaction est qu’une fois qu’une commande est tapée, elle est pour ainsi dire « perdue », c’est-à-dire qu’on doit la saisir à nouveau si on veut l’exécuter une seconde fois. L’utilisation de la console est donc restreinte aux petites commandes « jetables », le plus souvent utilisées comme test.</p>
<p>La plupart du temps, les commandes seront stockées dans un fichier à part, que l’on pourra facilement ouvrir, éditer et exécuter en tout ou partie si besoin. On appelle en général ce type de fichier un <dfn>script</dfn><dfn data-index="fichier de commandes"></dfn>.</p>
<p>Pour comprendre comment cela fonctionne, dans <strong>RStudio</strong> cliquez sur l’icône en haut à gauche représentant un fichier avec un signe plus vert, puis choisissez <em>R script</em>.</p>
<figure><img src="images/capture_RStudio_new_R_script.png" alt="Créer un nouveau script R dans RStudio"><figcaption>
Créer un nouveau script R dans RStudio
</figcaption></figure><p>Un nouvel onglet apparaît dans le quadrant supérieur gauche.</p>
<figure><img src="images/capture_RStudio_onglet_R_script.png" alt="Onglet d’un script R dans RStudio"><figcaption>
Onglet d’un script R dans RStudio
</figcaption></figure><p>Nous pouvons désormais y saisir des commandes. Par exemple, tapez sur la première ligne la commande suivante : <code>2 + 2</code>. Ensuite, cliquez sur l’icône <em>Run</em> (en haut à droite de l’onglet du script) ou bien pressez simulatément les touches <kbd>CTRL</kbd> et <kbd>Entrée</kbd><a href="#premier-travail-avec-les-donnees_fn1" class="footnoteRef" id="premier-travail-avec-les-donnees_fnref1"><sup>1</sup></a>.</p>
<p>Les lignes suivantes ont dû faire leur apparition dans la console :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span></code></pre></div>
<pre><code>[1] 4</code></pre>
<p>Voici donc comment soumettre rapidement à <strong>R</strong> les commandes saisies dans votre fichier. Vous pouvez désormais l’enregistrer, l’ouvrir plus tard, et en exécuter tout ou partie. À noter que vous avez plusieurs possibilités pour soumettre des commandes à <strong>R</strong> :</p>
<ul>
<li>vous pouvez exécuter la ligne sur laquelle se trouve votre curseur en cliquant sur <em>Run</em> ou en pressant simulatément les touches <kbd>CTRL</kbd> et <kbd>Entrée</kbd> ;</li>
<li>vous pouvez sélectionner plusieurs lignes contenant des commandes et les exécuter toutes en une seule fois exactement de la même manière ;</li>
<li>vous pouvez exécuter d’un coup l’intégralité de votre fichier en cliquant sur l’icône <em>Source</em>.</li>
</ul>
<p>La plupart du travail sous <strong>R</strong> consistera donc à éditer un ou plusieurs fichiers de commandes et à envoyer régulièrement les commandes saisies à <strong>R</strong> en utilisant les raccourcis clavier <em>ad hoc</em>.</p>
<p>Pour plus d’information sur l’utilisation des scripts <strong>R</strong> dans <strong>RStudio</strong>, voir (en anglais) : <a href="https://support.rstudio.com/hc/en-us/articles/200484448-Editing-and-Executing-Code" class="uri">https://support.rstudio.com/hc/en-us/articles/200484448-Editing-and-Executing-Code</a>.</p>
<div class="note">
<p>Quand vous enregistrez un script sous <strong>RStudio</strong>, il est possible qu’il vous demande de choisir un type d’encodage des caractères (<em>Choose Encoding</em>). Si tel est le cas, utilisez de préférence <strong>UTF-8</strong>.</p>
</div>
</div>
<div id="premier-travail-avec-les-donnees_ajouter-des-commentaires" class="section level2">
<h2>Ajouter des commentaires</h2>
<p>Un <dfn>commentaire</dfn> est une ligne ou une portion de ligne qui sera ignorée par <strong>R</strong>. Ceci signifie qu’on peut y écrire ce qu’on veut et qu’on va les utiliser pour ajouter tout un tas de commentaires à notre code permettant de décrire les différentes étapes du travail, les choses à se rappeler, les questions en suspens, etc.</p>
<p>Un commentaire sous <strong>R</strong> commence par un ou plusieurs symboles <code>#</code> (qui s’obtient avec les touches <kbd>Alt Gr</kbd> et <kbd>3</kbd> sur les claviers de type PC). Tout ce qui suit ce symbole jusqu’à la fin de la ligne est considéré comme un commentaire. On peut créer une ligne entière de commentaire en la faisant débuter par <code>##</code>. Par exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Tableau croisé de la CSP par le nombre de livres
## lus.  Attention au nombre de non réponses !</code></pre></div>
<p>On peut aussi créer des commentaires pour une ligne en cours :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">2</span>  <span class="co"># On met 2 dans x, parce qu'il le vaut bien</span></code></pre></div>
<div class="important">
<p>Dans tous les cas, il est très important de documenter ses fichiers <strong>R</strong> au fur et à mesure, faute de quoi on risque de ne plus y comprendre grand chose si on les reprend ne serait-ce que quelques semaines plus tard.</p>
</div>
<p>Avec <strong>RStudio</strong>, vous pouvez également utiliser les commentaires pour créer des <dfn data-index="section">sections</dfn> au sein de votre script et naviguer plus rapidement. Il suffit de faire suivre une ligne de commentaires d’au moins 4 signes moins (<code>----</code>). Par exemple, si vous saisissez ceci dans votre script :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Créer les objets ----

x &lt;-<span class="st"> </span><span class="dv">2</span>
y &lt;-<span class="st"> </span><span class="dv">5</span>

## Calculs ----

x <span class="op">+</span><span class="st"> </span>y</code></pre></div>
<p>Vous verrez apparaître en bas à gauche de la fenêtre du script un symbole dièse orange. Si vous cliquez dessus, un menu de navigation s’affichera vous permettant de vous déplacez rapidement au sein de votre script. Pour plus d’information, voir la documentation de <strong>RStudio</strong> (en anglais) : <a href="https://support.rstudio.com/hc/en-us/articles/200484568-Code-Folding-and-Sections" class="uri">https://support.rstudio.com/hc/en-us/articles/200484568-Code-Folding-and-Sections</a>.</p>
<figure><img src="images/capture_RStudio_navigation_script.png" alt="Navigation rapide dans les scripts sous RStudio"><figcaption>
Navigation rapide dans les scripts sous RStudio
</figcaption></figure><p>Note : on remarquera au passage que le titre de l’onglet est affiché en rouge et suivi d’une astérisque (<code>*</code>), nous indiquant ainsi qu’il y a des modifications non enregistrées dans notre fichier.</p>
</div>
<div id="premier-travail-avec-les-donnees_tableaux-de-donnees" class="section level2">
<h2>Tableaux de données</h2>
<p>Dans cette partie nous allons utiliser un jeu de données inclus dans l’extension <code class="pkg">questionr</code>. L’installation d’extension est décrite dans le chapitre <a href="#extensions">Extensions</a>.</p>
<p>Le jeu de données en question est un extrait de l’enquête <em>Histoire de vie</em> réalisée par l’INSEE en 2003. Il contient 2000 individus et 20 variables. Pour pouvoir utiliser ces données, il faut d’abord charger l’extension <code class="pkg">questionr</code> (après l’avoir installée, bien entendu). Le chargement d’une extension en mémoire se fait à l’aide de la fonction <code data-pkg="base">library</code>. Sous <strong>RStudio</strong>, vous pouvez également charger une extension en allant dans l’onglet <em>Packages</em> du quadrant inférieur droit qui liste l’ensemble des packages disponibles et en cliquant la case à cocher située à gauche du nom du package désiré.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)</code></pre></div>
<p>Puis nous allons indiquer à <strong>R</strong> que nous souhaitons accéder au jeu de données <code data-pkg="questionr">hdv2003</code> à l’aide de la fonction <code data-pkg="utils">data</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(hdv2003)</code></pre></div>
<p>Bien. Et maintenant, elles sont où mes données ? Et bien elles se trouvent dans un objet nommé <code>hdv2003</code> désormais chargé en mémoire et accessible directement. D’ailleurs, cet objet est maintenant visible dans l’onglet <em>Environment</em> du quadrant supérieur droit.</p>
<p>Essayons de taper son nom à l’invite de commande :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hdv2003</code></pre></div>
<p>Le résultat (non reproduit ici) ne ressemble pas forcément à grand-chose… Il faut se rappeler que par défaut, lorsqu’on lui fournit seulement un nom d’objet, <strong>R</strong> essaye de l’afficher de la manière la meilleure (ou la moins pire) possible. La réponse à la commande <code>hdv2003</code> n’est donc rien moins que l’affichage des données brutes contenues dans cet objet.</p>
<p>Ce qui signifie donc que l’intégralité de notre jeu de données est inclus dans l’objet nommé <code>hdv2003</code> ! En effet, dans <strong>R</strong>, un objet peut très bien contenir un simple nombre, un vecteur ou bien le résultat d’une enquête tout entier. Dans ce cas, les objets sont appelés des <dfn data-index="data frame" lang="en">data frames</dfn>, ou <dfn data-index="tableau de donnée">tableaux de données</dfn>. Ils peuvent être manipulés comme tout autre objet. Par exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span>hdv2003</code></pre></div>
<p>va entraîner la copie de l’ensemble de nos données dans un nouvel objet nommé <code>d</code>, ce qui peut paraître parfaitement inutile mais a en fait l’avantage de fournir un objet avec un nom beaucoup plus court, ce qui diminuera la quantité de texte à saisir par la suite.</p>
<p><strong>Résumons</strong></p>
<p>Comme nous avons désormais décidé de saisir nos commandes dans un script et non plus directement dans la console, les premières lignes de notre fichier de travail sur les données de l’enquête <em>Histoire de vie</em> pourraient donc ressembler à ceci :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Chargement des extensions nécessaires ----
<span class="kw">library</span>(questionr)
## Jeu de données hdv2003 ----
<span class="kw">data</span>(hdv2003)
d &lt;-<span class="st"> </span>hdv2003</code></pre></div>
</div>
<div id="premier-travail-avec-les-donnees_inspecter" class="section level2">
<h2>Inspection visuelle des données</h2>
<p>La particularité de <strong>R</strong> par rapport à d’autres logiciels comme <strong>Modalisa</strong> ou <strong>SPSS</strong> est de ne pas proposer, par défaut, de vue des données sous forme de tableau. Ceci peut parfois être un peu déstabilisant dans les premiers temps d’utilisation, même si l’on perd vite l’habitude et qu’on finit par se rendre compte que « voir » les données n’est pas forcément un gage de productivité ou de rigueur dans le traitement.</p>
<p>Néanmoins, <strong>R</strong> propose une interface permettant de visualiser le contenu d’un tableau de données à l’aide de la fonction <code data-pkg="utils">View</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">View</span>(d)</code></pre></div>
<p>Sous <strong>RStudio</strong>, on peut aussi afficher la <dfn>visionneusee</dfn> (<dfn lang="en">viewer</dfn>) en cliquant sur la petite icône en forme de tableau située à droite de la ligne d’un tableau de données dans l’onglet <em>Environment</em> du quadrant supérieur droit (cf. figure ci-après).</p>
<figure><img src="images/capture_RStudio_icone_viewer.png" alt="Icône pour afficher une vue du contenu d’un tableau"><figcaption>
Icône pour afficher une vue du contenu d’un tableau
</figcaption></figure><p>Dans tous les cas, <strong>RStudio</strong> lancera le <em>viewer</em> dans un onglet dédié dans le quadrant supérieur gauche. Le visualiseur de <strong>RStudio</strong> est plus avancé que celui-de base fournit par <strong>R</strong>. Il est possible de trier les données selon une variable en cliquant sur le nom de cette dernière. Il y a également un champs de recherche et un bouton <em>Filter</em> donnant accès à des options de filtrage avancées.</p>
<figure><img src="images/capture_RStudio_data_viewer.png" alt="La visionneuse de données de RStudio"><figcaption>
La visionneuse de données de RStudio
</figcaption></figure>
</div>
<div id="premier-travail-avec-les-donnees_structure-du-tableau" class="section level2">
<h2>Structure du tableau</h2>
<p>Avant de travailler sur les données, nous allons essayer de comprendre comment elles sont structurées. Lors de l’import de données depuis un autre logiciel (que nous aborderons dans un autre <a href="#import-de-donnees">chapitre</a>), il s’agira souvent de vérifier que l’importation s’est bien déroulée.</p>
<p>Nous avons déjà vu qu’un tableau de données est organisé en lignes et en colonnes, les lignes correspondant aux <dfn data-index="observation">observations</dfn> et les colonnes aux <dfn data-index="variable">variables</dfn>. Les fonctions <code data-pkg="base">nrow</code>, <code data-pkg="base" data-rdoc="nrow">ncol</code> et <code data-pkg="base">dim</code> donnent respectivement le nombre de lignes, le nombre de colonnes et les dimensions de notre tableau. Nous pouvons donc d’ores et déjà vérifier que nous avons bien 2000 lignes et 20 colonnes :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(d)</code></pre></div>
<pre><code>[1] 2000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ncol</span>(d)</code></pre></div>
<pre><code>[1] 20</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(d)</code></pre></div>
<pre><code>[1] 2000   20</code></pre>
<p>La fonction <code data-pkg="base">names</code> donne les noms des colonnes de notre tableau, c’est-à-dire les noms des variables :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(d)</code></pre></div>
<pre><code> [1] "id"            "age"          
 [3] "sexe"          "nivetud"      
 [5] "poids"         "occup"        
 [7] "qualif"        "freres.soeurs"
 [9] "clso"          "relig"        
[11] "trav.imp"      "trav.satisf"  
[13] "hard.rock"     "lecture.bd"   
[15] "peche.chasse"  "cuisine"      
[17] "bricol"        "cinema"       
[19] "sport"         "heures.tv"    </code></pre>
</div>
<div id="premier-travail-avec-les-donnees_acceder-aux-variables" class="section level2">
<h2>Accéder aux variables</h2>
<p><code>d</code> représente donc l’ensemble de notre tableau de données. Nous avons vu que si l’on saisit simplement <code>d</code> à l’invite de commandes, on obtient un affichage du tableau en question. Mais comment accéder aux variables, c’est à dire aux colonnes de notre tableau ?</p>
<p>La réponse est simple : on utilise le nom de l’objet, suivi de l’opérateur <code data-pkg="base" data-rdoc="Extract">$</code>, suivi du nom de la variable, comme ceci :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>sexe</code></pre></div>
<p>Au regard du résultat (non reproduit ici), on constate alors que <strong>R</strong> a bien accédé au contenu de notre variable <var>sexe</var> du tableau <code>d</code> et a affiché son contenu, c’est-à-dire l’ensemble des valeurs prises par la variable.</p>
<p>Les fonctions <code data-pkg="utils">head</code> et <code data-pkg="utils" data-rdoc="head">tail</code> permettent d’afficher seulement les premières (respectivement les dernières) valeurs prises par la variable. On peut leur passer en argument le nombre d’éléments à afficher :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(d<span class="op">$</span>nivetud)</code></pre></div>
<pre><code>[1] Enseignement superieur y compris technique superieur
[2] &lt;NA&gt;                                                
[3] Derniere annee d'etudes primaires                   
[4] Enseignement superieur y compris technique superieur
[5] Derniere annee d'etudes primaires                   
[6] Enseignement technique ou professionnel court       
8 Levels: N'a jamais fait d'etudes ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(d<span class="op">$</span>age, <span class="dv">10</span>)</code></pre></div>
<pre><code> [1] 52 42 50 41 46 45 46 24 24 66</code></pre>
<p>À noter que ces fonctions marchent aussi pour afficher les lignes du tableau <code>d</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(d, <span class="dv">2</span>)</code></pre></div>
<pre><code>  id age  sexe
1  1  28 Femme
2  2  23 Femme
                                               nivetud
1 Enseignement superieur y compris technique superieur
2                                                 &lt;NA&gt;
     poids                 occup  qualif
1 2634.398 Exerce une profession Employe
2 9738.396       Etudiant, eleve    &lt;NA&gt;
  freres.soeurs clso                       relig
1             8  Oui Ni croyance ni appartenance
2             2  Oui Ni croyance ni appartenance
       trav.imp    trav.satisf hard.rock
1 Peu important Insatisfaction       Non
2          &lt;NA&gt;           &lt;NA&gt;       Non
  lecture.bd peche.chasse cuisine bricol cinema
1        Non          Non     Oui    Non    Non
2        Non          Non     Non    Non    Oui
  sport heures.tv
1   Non         0
2   Oui         1</code></pre>
</div>
<div id="premier-travail-avec-les-donnees_la-fonction-str" class="section level2">
<h2>La fonction str</h2>
<p>La fonction <code data-pkg="utils">str</code> est plus complète que <code data-pkg="base">names</code>. Elle liste les différentes variables, indique leur type et donne le cas échéant des informations supplémentaires ainsi qu’un échantillon des premières valeurs prises par cette variable :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(d)</code></pre></div>
<pre><code>'data.frame':   2000 obs. of  20 variables:
 $ id           : int  1 2 3 4 5 6 7 8 9 10 ...
 $ age          : int  28 23 59 34 71 35 60 47 20 28 ...
 $ sexe         : Factor w/ 2 levels "Homme","Femme": 2 2 1 1 2 2 2 1 2 1 ...
 $ nivetud      : Factor w/ 8 levels "N'a jamais fait d'etudes",..: 8 NA 3 8 3 6 3 6 NA 7 ...
 $ poids        : num  2634 9738 3994 5732 4329 ...
 $ occup        : Factor w/ 7 levels "Exerce une profession",..: 1 3 1 1 4 1 6 1 3 1 ...
 $ qualif       : Factor w/ 7 levels "Ouvrier specialise",..: 6 NA 3 3 6 6 2 2 NA 7 ...
 $ freres.soeurs: int  8 2 2 1 0 5 1 5 4 2 ...
 $ clso         : Factor w/ 3 levels "Oui","Non","Ne sait pas": 1 1 2 2 1 2 1 2 1 2 ...
 $ relig        : Factor w/ 6 levels "Pratiquant regulier",..: 4 4 4 3 1 4 3 4 3 2 ...
 $ trav.imp     : Factor w/ 4 levels "Le plus important",..: 4 NA 2 3 NA 1 NA 4 NA 3 ...
 $ trav.satisf  : Factor w/ 3 levels "Satisfaction",..: 2 NA 3 1 NA 3 NA 2 NA 1 ...
 $ hard.rock    : Factor w/ 2 levels "Non","Oui": 1 1 1 1 1 1 1 1 1 1 ...
 $ lecture.bd   : Factor w/ 2 levels "Non","Oui": 1 1 1 1 1 1 1 1 1 1 ...
 $ peche.chasse : Factor w/ 2 levels "Non","Oui": 1 1 1 1 1 1 2 2 1 1 ...
 $ cuisine      : Factor w/ 2 levels "Non","Oui": 2 1 1 2 1 1 2 2 1 1 ...
 $ bricol       : Factor w/ 2 levels "Non","Oui": 1 1 1 2 1 1 1 2 1 1 ...
 $ cinema       : Factor w/ 2 levels "Non","Oui": 1 2 1 2 1 2 1 1 2 2 ...
 $ sport        : Factor w/ 2 levels "Non","Oui": 1 2 2 2 1 2 1 1 1 2 ...
 $ heures.tv    : num  0 1 0 2 3 2 2.9 1 2 2 ...</code></pre>
<p>La première ligne nous informe qu’il s’agit bien d’un tableau de données avec 2000 observations et 20 variables. Vient ensuite la liste des variables. La première se nomme <var>id</var> et est de type <dfn>entier</dfn> (<em>int</em><dfn data-index="integer" lang="en"></dfn>). La seconde se nomme <var>age</var> et est de type <dfn data-index="numérique, variable">numérique</dfn><dfn data-index="variable numérique"></dfn><dfn data-index="numeric" lang="en"></dfn>. La troisième se nomme <var>sexe</var>, il s’agit d’un <dfn>facteur</dfn> (<dfn lang="en">factor</dfn>).</p>
<p>Un facteur est une variable pouvant prendre un nombre limité de <dfn data-index="modalité, facteur">modalités</dfn> (<dfn data-index="level, factor" lang="en">levels</dfn>). Ici notre variable a deux modalités possibles : « Homme » et « Femme ». Ce type de variable est décrit plus en détail dans le chapitre sur la <a href="pem_manipulation.html#variables">manipulation de données</a>.</p>
<div class="important">
<p>La fonction <code data-pkg="utils">str</code> est essentielle à connaître et peut s’appliquer à n’importe quel type d’objet. C’est un excellent moyen de connaître en détail la <dfn>structure d’un objet</dfn>. Cependant, les résultats peuvent être parfois trop détaillés et on lui priviligiera dans certains cas la fonction <code data-pkg="questionr">describe</code> que l’on abordera dans les prochains chapitres, cependant moins générique puisque ne s’appliquant qu’à des tableaux de données et à des vecteurs, tandis que <code data-pkg="utils">str</code> peut s’appliquer à absolument <strong>tout</strong> objet, y compris des fonctions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">describe</span>(d)</code></pre></div>
<pre><code>[2000 obs. x 20 variables] tbl_df tbl data.frame

$id: 
integer: 1 2 3 4 5 6 7 8 9 10 ...
min: 1 - max: 2000 - NAs: 0 (0%) - 2000 unique values

$age: 
integer: 28 23 59 34 71 35 60 47 20 28 ...
min: 18 - max: 97 - NAs: 0 (0%) - 78 unique values

$sexe: 
nominal factor: "Femme" "Femme" "Homme" "Homme" "Femme" "Femme" "Femme" "Homme" "Femme" "Homme" ...
2 levels: Homme | Femme
NAs: 0 (0%)

$nivetud: 
nominal factor: "Enseignement superieur y compris technique superieur" NA "Derniere annee d'etudes primaires" "Enseignement superieur y compris technique superieur" "Derniere annee d'etudes primaires" "Enseignement technique ou professionnel court" "Derniere annee d'etudes primaires" "Enseignement technique ou professionnel court" NA "Enseignement technique ou professionnel long" ...
8 levels: N'a jamais fait d'etudes | A arrete ses etudes, avant la derniere annee d'etudes primaires | Derniere annee d'etudes primaires | 1er cycle | 2eme cycle | Enseignement technique ou professionnel court | Enseignement technique ou professionnel long | Enseignement superieur y compris technique superieur
NAs: 112 (0.1%)

$poids: 
numeric: 2634.3982157 9738.3957759 3994.1024587 5731.6615081 4329.0940022 8674.6993828 6165.8034861 12891.640759 7808.8720636 2277.160471 ...
min: 78.0783403 - max: 31092.14132 - NAs: 0 (0%) - 1877 unique values

$occup: 
nominal factor: "Exerce une profession" "Etudiant, eleve" "Exerce une profession" "Exerce une profession" "Retraite" "Exerce une profession" "Au foyer" "Exerce une profession" "Etudiant, eleve" "Exerce une profession" ...
7 levels: Exerce une profession | Chomeur | Etudiant, eleve | Retraite | Retire des affaires | Au foyer | Autre inactif
NAs: 0 (0%)

$qualif: 
nominal factor: "Employe" NA "Technicien" "Technicien" "Employe" "Employe" "Ouvrier qualifie" "Ouvrier qualifie" NA "Autre" ...
7 levels: Ouvrier specialise | Ouvrier qualifie | Technicien | Profession intermediaire | Cadre | Employe | Autre
NAs: 347 (0.2%)

$freres.soeurs: 
integer: 8 2 2 1 0 5 1 5 4 2 ...
min: 0 - max: 22 - NAs: 0 (0%) - 19 unique values

$clso: 
nominal factor: "Oui" "Oui" "Non" "Non" "Oui" "Non" "Oui" "Non" "Oui" "Non" ...
3 levels: Oui | Non | Ne sait pas
NAs: 0 (0%)

$relig: 
nominal factor: "Ni croyance ni appartenance" "Ni croyance ni appartenance" "Ni croyance ni appartenance" "Appartenance sans pratique" "Pratiquant regulier" "Ni croyance ni appartenance" "Appartenance sans pratique" "Ni croyance ni appartenance" "Appartenance sans pratique" "Pratiquant occasionnel" ...
6 levels: Pratiquant regulier | Pratiquant occasionnel | Appartenance sans pratique | Ni croyance ni appartenance | Rejet | NSP ou NVPR
NAs: 0 (0%)

$trav.imp: 
nominal factor: "Peu important" NA "Aussi important que le reste" "Moins important que le reste" NA "Le plus important" NA "Peu important" NA "Moins important que le reste" ...
4 levels: Le plus important | Aussi important que le reste | Moins important que le reste | Peu important
NAs: 952 (0.5%)

$trav.satisf: 
nominal factor: "Insatisfaction" NA "Equilibre" "Satisfaction" NA "Equilibre" NA "Insatisfaction" NA "Satisfaction" ...
3 levels: Satisfaction | Insatisfaction | Equilibre
NAs: 952 (0.5%)

$hard.rock: 
nominal factor: "Non" "Non" "Non" "Non" "Non" "Non" "Non" "Non" "Non" "Non" ...
2 levels: Non | Oui
NAs: 0 (0%)

$lecture.bd: 
nominal factor: "Non" "Non" "Non" "Non" "Non" "Non" "Non" "Non" "Non" "Non" ...
2 levels: Non | Oui
NAs: 0 (0%)

$peche.chasse: 
nominal factor: "Non" "Non" "Non" "Non" "Non" "Non" "Oui" "Oui" "Non" "Non" ...
2 levels: Non | Oui
NAs: 0 (0%)

$cuisine: 
nominal factor: "Oui" "Non" "Non" "Oui" "Non" "Non" "Oui" "Oui" "Non" "Non" ...
2 levels: Non | Oui
NAs: 0 (0%)

$bricol: 
nominal factor: "Non" "Non" "Non" "Oui" "Non" "Non" "Non" "Oui" "Non" "Non" ...
2 levels: Non | Oui
NAs: 0 (0%)

$cinema: 
nominal factor: "Non" "Oui" "Non" "Oui" "Non" "Oui" "Non" "Non" "Oui" "Oui" ...
2 levels: Non | Oui
NAs: 0 (0%)

$sport: 
nominal factor: "Non" "Oui" "Oui" "Oui" "Non" "Oui" "Non" "Non" "Non" "Oui" ...
2 levels: Non | Oui
NAs: 0 (0%)

$heures.tv: 
numeric: 0 1 0 2 3 2 2.9 1 2 2 ...
min: 0 - max: 12 - NAs: 5 (0%) - 30 unique values</code></pre>
</div>
</div>
<div id="premier-travail-avec-les-donnees_quelques-calculs-simples" class="section level2">
<h2>Quelques calculs simples</h2>
<p>Maintenant que nous savons accéder aux variables, effectuons quelques calculs simples comme la moyenne, la médiane, le minimum et le maximum, à l’aide des fonctions <code data-pkg="base">mean</code>, <code data-pkg="stats">median</code>, <code data-pkg="base" data-rdoc="Extrems">min</code> et <code data-pkg="base" data-rdoc="Extrems">max</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(d<span class="op">$</span>age)</code></pre></div>
<pre><code>[1] 48.157</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">median</span>(d<span class="op">$</span>age)</code></pre></div>
<pre><code>[1] 48</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">min</span>(d<span class="op">$</span>age)</code></pre></div>
<pre><code>[1] 18</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">max</span>(d<span class="op">$</span>age)</code></pre></div>
<pre><code>[1] 97</code></pre>
<div class="note">
<p>Au sens strict, il ne s’agit pas d’un véritable âge moyen puisqu’il faudrait ajouter 0,5 à cette valeur calculée, un âge moyen se calculant à partir d’âges exacts et non à partir d’âges révolus. Voir le chapitre <a href="#calculer-un-age">Calculer un âge</a>.</p>
</div>
<p>On peut aussi très facilement obtenir un tri à plat à l’aide la fonction <code data-pkg="base">table</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(d<span class="op">$</span>qualif)</code></pre></div>
<pre><code>
      Ouvrier specialise         Ouvrier qualifie 
                     203                      292 
              Technicien Profession intermediaire 
                      86                      160 
                   Cadre                  Employe 
                     260                      594 
                   Autre 
                      58 </code></pre>
<p>La fonction <code data-pkg="base">summary</code>, bien pratique, permet d’avoir une vue résumée d’une variable. Elle s’applique à tout type d’objets (y compris un tableau de données entier) et s’adapte à celui-ci.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(d<span class="op">$</span>age)</code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  18.00   35.00   48.00   48.16   60.00   97.00 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(d<span class="op">$</span>qualif)</code></pre></div>
<pre><code>      Ouvrier specialise         Ouvrier qualifie 
                     203                      292 
              Technicien Profession intermediaire 
                      86                      160 
                   Cadre                  Employe 
                     260                      594 
                   Autre                     NA's 
                      58                      347 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(d)</code></pre></div>
<pre><code>       id              age           sexe     
 Min.   :   1.0   Min.   :18.00   Homme: 899  
 1st Qu.: 500.8   1st Qu.:35.00   Femme:1101  
 Median :1000.5   Median :48.00               
 Mean   :1000.5   Mean   :48.16               
 3rd Qu.:1500.2   3rd Qu.:60.00               
 Max.   :2000.0   Max.   :97.00               
                                              
                                                 nivetud   
 Enseignement technique ou professionnel court       :463  
 Enseignement superieur y compris technique superieur:441  
 Derniere annee d'etudes primaires                   :341  
 1er cycle                                           :204  
 2eme cycle                                          :183  
 (Other)                                             :256  
 NA's                                                :112  
     poids                            occup     
 Min.   :   78.08   Exerce une profession:1049  
 1st Qu.: 2221.82   Chomeur              : 134  
 Median : 4631.19   Etudiant, eleve      :  94  
 Mean   : 5535.61   Retraite             : 392  
 3rd Qu.: 7626.53   Retire des affaires  :  77  
 Max.   :31092.14   Au foyer             : 171  
                    Autre inactif        :  83  
                      qualif    freres.soeurs   
 Employe                 :594   Min.   : 0.000  
 Ouvrier qualifie        :292   1st Qu.: 1.000  
 Cadre                   :260   Median : 2.000  
 Ouvrier specialise      :203   Mean   : 3.283  
 Profession intermediaire:160   3rd Qu.: 5.000  
 (Other)                 :144   Max.   :22.000  
 NA's                    :347                   
          clso     
 Oui        : 936  
 Non        :1037  
 Ne sait pas:  27  
                   
                   
                   
                   
                         relig    
 Pratiquant regulier        :266  
 Pratiquant occasionnel     :442  
 Appartenance sans pratique :760  
 Ni croyance ni appartenance:399  
 Rejet                      : 93  
 NSP ou NVPR                : 40  
                                  
                         trav.imp  
 Le plus important           : 29  
 Aussi important que le reste:259  
 Moins important que le reste:708  
 Peu important               : 52  
 NA's                        :952  
                                   
                                   
         trav.satisf  hard.rock  lecture.bd
 Satisfaction  :480   Non:1986   Non:1953  
 Insatisfaction:117   Oui:  14   Oui:  47  
 Equilibre     :451                        
 NA's          :952                        
                                           
                                           
                                           
 peche.chasse cuisine    bricol     cinema    
 Non:1776     Non:1119   Non:1147   Non:1174  
 Oui: 224     Oui: 881   Oui: 853   Oui: 826  
                                              
                                              
                                              
                                              
                                              
 sport        heures.tv     
 Non:1277   Min.   : 0.000  
 Oui: 723   1st Qu.: 1.000  
            Median : 2.000  
            Mean   : 2.247  
            3rd Qu.: 3.000  
            Max.   :12.000  
            NA's   :5       </code></pre>
</div>
<div id="premier-travail-avec-les-donnees_nos-premiers-graphiques" class="section level2">
<h2>Nos premiers graphiques</h2>
<p><strong>R</strong> est très puissant en termes de représentations graphiques, notamment grâce à des extensions dédiées. Pour l’heure contentons-nous d’un premier essai à l’aide de la fonction générique <code data-pkg="graphics">plot</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(d<span class="op">$</span>sexe)</code></pre></div>
<img src="graphs/premier-travail-avec-les-donnees/unnamed-chunk-21-1.png" width="1050"><figcaption>
Nombre d’observations par sexe
</figcaption></figure><p>Essayons avec deux variables :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(d<span class="op">$</span>hard.rock, d<span class="op">$</span>age)</code></pre></div>
<img src="graphs/premier-travail-avec-les-donnees/unnamed-chunk-22-1.png" width="1050"><figcaption>
Âge des enquêtés selon qu’ils écoutent ou non du hard rock
</figcaption></figure><p>Il semblerait bien que les amateurs de hard rock soient plus jeunes.</p>
</div>
<div id="premier-travail-avec-les-donnees_et-ensuite" class="section level2">
<h2>Et ensuite ?</h2>
<p>Nous n’avons qu’entr’aperçu les possibilités de <strong>R</strong>. Avant de pouvoir nous lancer dans des analyses statisques, il est préférable de revenir un peu aux fondamentaux de <strong>R</strong> (les types d’objets, la syntaxe, le recodage de variables…) mais aussi comment installer des extensions, importer des données, etc. Nous vous conseillons donc de poursuivre la lecture de la section <em>Prise en main</em> puis de vous lancer à l’assault de la section <em>Statistique introductive</em>.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="premier-travail-avec-les-donnees_fn1"><p>Sous <strong>Mac OS X</strong>, on utilise les touches <kbd>Pomme</kbd> et <kbd>Entrée</kbd>.<a href="#premier-travail-avec-les-donnees_fnref1"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="extensions"><div class="fluid-row" id="extensions_header">



<h1 class="title toc-ignore">Extensions</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#extensions_presentation">Présentation</a></li>
<li><a href="#extensions_le-tidyverse">Le <q>tidyverse</q></a></li>
<li><a href="#extensions_installation-depuis-cran">Installation depuis CRAN</a></li>
<li><a href="#extensions_installation-depuis-github">Installation depuis GitHub</a></li>
<li><a href="#extensions_mise-a-jour-des-extensions">Mise à jour des extensions</a></li>
</ul>
</div>

<div id="extensions_presentation" class="section level2">
<h2>Présentation</h2>
<p>L’installation par défaut du logiciel <strong>R</strong> contient le cœur du programme ainsi qu’un ensemble de fonctions de base fournissant un grand nombre d’outils de traitement de données et d’analyse statistiques.</p>
<p><strong>R</strong> étant un logiciel libre, il bénéficie d’une forte communauté d’utilisateurs qui peuvent librement contribuer au développement du logiciel en lui ajoutant des fonctionnalités supplémentaires. Ces contributions prennent la forme d’<dfn data-index="extension">extensions</dfn> (<dfn data-index="package" lang="en">packages</dfn>) pouvant être installées par l’utilisateur et fournissant alors diverses fonctionnalités supplémentaires.</p>
<p>Il existe un très grand nombre d’extensions (plus de 6500 à ce jour), qui sont diffusées par un réseau baptisé <strong>CRAN</strong> (<dfn lang="en">Comprehensive R Archive Network</dfn><dfn data-index="CRAN"></dfn>).</p>
<p>La liste de toutes les extensions disponibles sur <strong>CRAN</strong> est disponible ici : <a href="http://cran.r-project.org/web/packages/" class="uri">http://cran.r-project.org/web/packages/</a>.</p>
<p>Pour faciliter un peu le repérage des extensions, il existe un ensemble de regroupements thématiques (économétrie, finance, génétique, données spatiales…) baptisés <dfn data-index="task view" lang="en">Task views</dfn> : <a href="http://cran.r-project.org/web/views/" class="uri">http://cran.r-project.org/web/views/</a>.</p>
<p>On y trouve notamment une <em>Task view</em> dédiée aux sciences sociales, listant de nombreuses extensions potentiellement utiles pour les analyses statistiques dans ce champ disciplinaire : <a href="http://cran.r-project.org/web/views/SocialSciences.html" class="uri">http://cran.r-project.org/web/views/SocialSciences.html</a>.</p>
</div>
<div id="extensions_le-tidyverse" class="section level2">
<h2>Le <q>tidyverse</q>
</h2>
<p>Hadley Wickham est professeur associé à l’université de Rice et scientifique en chef à <strong>Rstudio</strong>. Il a développé de nombreux extensions pour <strong>R</strong> (plus d’une cinquantaine à ce jours) qui, pour la plupart, fonctionne de manière harmonisée entre elles. Par ailleurs, la plupart s’intègre parfaitement avec <strong>RStudio</strong>. Cet ensemble d’extenions est appelé <dfn>tidyverse</dfn> et est développé sur GitHub : <a href="https://github.com/tidyverse/" class="uri">https://github.com/tidyverse/</a>. Une présentation plus générale du <dfn>tidyverse</dfn> est disponible sur le site de RStudio (<a href="https://www.rstudio.com/products/rpackages/" class="uri">https://www.rstudio.com/products/rpackages/</a>) et sur un sité dédié (<a href="http://tidyverse.org/" class="uri">http://tidyverse.org/</a>).</p>
<p>Pour certaines tâches, il peut exister plusieurs solutions / extensions différentes pour les réaliser. Dans la mesure où il n’est pas possible d’être exhaustif, nous avons fait le choix dans le cadre d’<strong>analyse-R</strong> de choisir en priorité, lorsque cela est possible, les extensions du <dfn>tidyverse</dfn>, en particulier <code class="pkg">haven</code>, <code class="pkg">readr</code> et <code class="pkg">readxl</code> pour l’import de données, <code class="pkg">dplyr</code>, <code class="pkg">tidyr</code> ou <code class="pkg">reshape2</code> pour la manipulation de données, <code class="pkg">ggplot2</code> pour les graphiques, <code class="pkg">lubridate</code> pour la gestion des dates, <code class="pkg">forcats</code> pour la manipulation des facteurs ou encore <code class="pkg">stringr</code> pour la manipulation de chaînes de caractères.</p>
<p>Il existe par ailleurs une extension homonyme <code class="pkg">tidyverse</code>. L’installation (voir ci-dessous) de cette extension permets l’installation automatique de l’ensemble des autres extensions du <df>tidyverse</df>. Le chargement de cette extension avec la fonction <code data-pkg="base">library</code> (voir ci-après) permets de charger en mémoire en une seule opération les principales extensions du <dfn>tidyverse</dfn>, à savoir <code class="pkg">ggplot2</code>, <code class="pkg">tibble</code>, <code class="pkg">tidyr</code>, <code class="pkg">readr</code>, <code class="pkg">purrr</code> et <code class="pkg">dplyr</code>.</p>
</div>
<div id="extensions_installation-depuis-cran" class="section level2">
<h2>Installation depuis CRAN</h2>
<p>L’installation d’une extension se fait par la fonction <code data-pkg="utils">install.packages</code>, à qui on fournit le nom de l’extension. Par exemple, si on souhaite installer l’extension <strong>ade4</strong> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"ade4"</span>, <span class="dt">dep =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>L’option <code>dep=TRUE</code> indique à <strong>R</strong> de télécharger et d’installer également toutes les extensions dont l’extension choisie dépend pour son fonctionnement.</p>
<p>Sous <strong>RStudio</strong>, on pourra également cliquer sur <em>Install</em> dans l’onglet <em>Packages</em> du quadrant inférieur droit.</p>
<p>Une fois l’extension installée, elle peut être appelée depuis la console ou un fichier script avec la fonction <code data-pkg="base">library</code> ou la fonction <code data-pkg="base" data-rdoc="library">require</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ade4)</code></pre></div>
<p>À partir de là, on peut utiliser les fonctions de l’extension, consulter leur page d’aide en ligne, accéder aux jeux de données qu’elle contient, etc.</p>
<p>Pour mettre à jour l’ensemble des extensions installées, <dfndata-index jour extensions> la fonction <code data-pkg="utils">update.packages</code> suffit :</dfndata-index></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">update.packages</span>()</code></pre></div>
<p>Sous <strong>RStudio</strong>, on pourra alternativement cliquer sur <em>Update</em> dans l’onglet <em>Packages</em> du quadrant inférieur droit.</p>
<p>Si on souhaite désinstaller une extension précédemment installée, on peut utiliser la fonction <code data-pkg="utils">remove.packages</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">remove.packages</span>(<span class="st">"ade4"</span>)</code></pre></div>
<div class="important">
<p>Il est important de bien comprendre la différence entre <code data-pkg="utils">install.packages</code> et <code data-pkg="base">library</code>. La première va chercher les extensions sur internet et les installe en local sur le disque dur de l’ordinateur. On n’a besoin d’effectuer cette opération qu’une seule fois. La seconde lit les informations de l’extension sur le disque dur et les met à disposition de <strong>R</strong>. On a besoin de l’exécuter à chaque début de session ou de script.</p>
</div>
</div>
<div id="extensions_installation-depuis-github" class="section level2">
<h2>Installation depuis GitHub</h2>
<p>Certains packages sont développés sur <a href="https://github.com/"><strong>GitHub</strong></a>. Dès lors, la version de développement sur <strong>GitHub</strong> peut contenir des fonctions qui ne sont pas encore disponibles dans la version stable disponible sur <strong>CRAN</strong>. Ils arrivent aussi parfois que certains packages ne soient disponibles que sur <strong>GitHub</strong>.</p>
<p>L’installation d’un package depuis <strong>GitHub</strong> est très facile grâce à la fonction <code data-pkg="devtools">install_github</code> de l’extension <code class="pkg">devtools</code> (que l’on aura préalablement installée depuis <strong>CRAN</strong> ;-) ).</p>
</div>
<div id="extensions_mise-a-jour-des-extensions" class="section level2">
<h2>Mise à jour des extensions</h2>
<p>Il est facile de mettre à jour l’ensemble des extensions installées, soit avec la fonction, <code data-pkg="utils">update.packages</code> soit en cliquant sur <em>Update</em> dans l’onglet <em>Packages</em> du quadrant inférieur droit.</p>
</div>

</article>
<article id="vecteurs-indexation-et-assignation"><div class="fluid-row" id="vecteurs-indexation-et-assignation_header">



<h1 class="title toc-ignore">Vecteurs, indexation et assignation</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#vecteurs-indexation-et-assignation_presentation-des-vecteurs">Présentation des vecteurs</a></li>
<li><a href="#vecteurs-indexation-et-assignation_les-principaux-types-de-vecteurs">Les principaux types de vecteurs</a></li>
<li>
<a href="#vecteurs-indexation-et-assignation_creation">Création</a><ul>
<li><a href="#vecteurs-indexation-et-assignation_la-fonction-c">La fonction c</a></li>
<li><a href="#vecteurs-indexation-et-assignation_la-fonction-rep">La fonction rep</a></li>
<li><a href="#vecteurs-indexation-et-assignation_la-fonction-seq">La fonction seq</a></li>
<li><a href="#vecteurs-indexation-et-assignation_loperateur">L’opérateur :</a></li>
</ul>
</li>
<li><a href="#vecteurs-indexation-et-assignation_longueur-dun-vecteur">Longueur d’un vecteur</a></li>
<li><a href="#vecteurs-indexation-et-assignation_quelques-vecteurs-remarquables">Quelques vecteurs remarquables</a></li>
<li><a href="#vecteurs-indexation-et-assignation_combiner-des-vecteurs">Combiner des vecteurs</a></li>
<li><a href="#vecteurs-indexation-et-assignation_valeurs-manquantes">Valeurs manquantes</a></li>
<li><a href="#vecteurs-indexation-et-assignation_indexation-par-position">Indexation par position</a></li>
<li><a href="#vecteurs-indexation-et-assignation_des-vecteurs-nommes">Des vecteurs nommés</a></li>
<li><a href="#vecteurs-indexation-et-assignation_indexation-par-nom">Indexation par nom</a></li>
<li><a href="#vecteurs-indexation-et-assignation_indexation-par-condition">Indexation par condition</a></li>
<li><a href="#vecteurs-indexation-et-assignation_assignation-par-indexation">Assignation par indexation</a></li>
<li><a href="#vecteurs-indexation-et-assignation_en-resume">En résumé</a></li>
</ul>
</div>

<p>Nous allons reprendre plusieurs éléments de base du langage <strong>R</strong> que nous avons déjà abordé mais de manière plus formelle. Une bonne compréhension des bases du langage, bien qu’un peu ardue de prime abord, permets de comprendre le sens des commandes que l’on utilise et de pleinement exploiter la puissance que <strong>R</strong> offre en matière de manipulation de données.</p>
<p>Dans ce chapitre, nous reviendrons sur les vecteurs, tandis que les listes et les tableaux de données seront abordés dans un <a href="#listes-et-tableaux-de-donnes">chapitre dédié</a>.</p>
<div id="vecteurs-indexation-et-assignation_presentation-des-vecteurs" class="section level2">
<h2>Présentation des vecteurs</h2>
<p>Les <dfn data-index="vecteur">vecteurs</dfn> sont l’un des objets de bases de <strong>R</strong> et correspondent à une <q>liste de valeurs</q>. Leurs propriétés fondamentales sont :</p>
<ul>
<li>les vecteurs sont unidimensionnels (i.e. c’est un objet à une seule dimension, à la différence d’une matrice par exemple) ;</li>
<li>toutes les valeurs d’un vecteur sont d’un seul et même type ;</li>
<li>les vecteurs ont une longueur qui correspond au nombre de valeurs contenues dans le vecteur.</li>
</ul>
</div>
<div id="vecteurs-indexation-et-assignation_les-principaux-types-de-vecteurs" class="section level2">
<h2>Les principaux types de vecteurs</h2>
<p>Dans <strong>R</strong>, il existe quatre types fondamentaux de vecteurs :</p>
<ul>
<li>les <dfn data-index="nombre réel">nombres réels</dfn><dfn data-index="réel, nombre"></dfn> (c’est-à-dire les nombres décimaux que nous utilisons au quotidien),</li>
<li>les <dfn data-index="nombre entier">nombres entiers</dfn><dfn data-index="entier, nombre"></dfn>,</li>
<li>les <dfn data-index="chaîne de caractères">chaînes de caratères</dfn><dfn data-index="caractères, chaîne"></dfn> (qui correspondent à du <dfn>texte</dfn>) et</li>
<li>les <dfn data-index="valeur logique">valeurs logiques</dfn><dfn data-index="logique, valeur"></dfn> ou <dfn data-index="valeur booléenne">valeurs booléennes</dfn><dfn data-index="booléenne, valeur"></dfn>, à savoir <q>vrai</q> ou <q>faux</q>.</li>
</ul>
<p>Pour connaître la nature d’un objet, le plus simple est d’utiliser la fonction <code data-pkg="base">class</code>. Par exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(<span class="fl">12.5</span>)</code></pre></div>
<pre><code>[1] "numeric"</code></pre>
<p>La réponse <code>"numeric"</code> nous indique qu’il s’agit d’un nombre réel. Parfois, vous pourrez rencontrer le terme <code>"double"</code> qui désigne également les nombres réels. Notez que <strong>R</strong> étant anglophone, la décimale est indiquée avec un point (<code>.</code>) et non avec une virgule comme c’est l’usage en français.</p>
<p>Essayons avec un nombre entier :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(<span class="dv">3</span>)</code></pre></div>
<pre><code>[1] "numeric"</code></pre>
<p>Sous <strong>R</strong>, lorsqu’on l’on tape un nombre sans autre précision, il est considéré par défaut comme un nombre réel. Pour indiquer spécifiquement que l’on veut un nombre entier, il faut rajouter le suffixe <code>L</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(3L)</code></pre></div>
<pre><code>[1] "integer"</code></pre>
<p>Au quotidien, il arrive rarement d’avoir à utiliser ce suffixe, mais il est tonjour bon de le connaître au cas où vous le rencontriez dans des manuels ou des exemples de code.</p>
<p>Pour saisir une chaîne de caractères, on aura recours aux doubles guillemets droits (<code>"</code>) :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(<span class="st">"abc"</span>)</code></pre></div>
<pre><code>[1] "character"</code></pre>
<p>Il est également possible d’utiliser des guillemets simples (<code>'</code>), dès lors que l’on utilise bien le même type de guillemets pour indiquer le début et la fin de la chaîne de caractères (par exemple <code>'abc'</code>).</p>
<p>Enfin, les valeurs logiques s’indiquent avec <code>TRUE</code> pour vrai et <code>FALSE</code> pour faux. Il est aussi possible d’utiliser les raccourcis <code>T</code> et <code>F</code>. Attention à bien utiliser les majuscules, <strong>R</strong> étant sensible à la casse.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(<span class="ot">TRUE</span>)</code></pre></div>
<pre><code>[1] "logical"</code></pre>
<p>En résumé, les classes <strong>R</strong> des quatre types fondamentaux de vecteur sont :</p>
<table>
<thead><tr class="header">
<th align="left">Exemple</th>
<th align="left">Classe R</th>
<th align="left">Type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>5L</code></td>
<td align="left"><dfn lang="en">integer</dfn></td>
<td align="left">nombre entier</td>
</tr>
<tr class="even">
<td align="left"><code>3.14</code></td>
<td align="left"><dfn lang="en">numeric</dfn></td>
<td align="left">nombre réel</td>
</tr>
<tr class="odd">
<td align="left"><code>"abcd"</code></td>
<td align="left"><dfn lang="en">character</dfn></td>
<td align="left">chaîne de caractères</td>
</tr>
<tr class="even">
<td align="left"><code>TRUE</code></td>
<td align="left"><dfn lang="en">logical</dfn></td>
<td align="left">booléenne</td>
</tr>
</tbody>
</table>
<p>En plus des types de base, il existe de nombreuses autres classes de vecteurs dans <strong>R</strong> que nous aborderons ultérieurement dans d’autres chapitres. Les plus courantes sont :</p>
<table>
<thead><tr class="header">
<th align="left">Classe R</th>
<th align="left">Type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">factor</td>
<td align="left"><a href="#facteurs-et-vecteurs-labellises_facteurs">facteur</a></td>
</tr>
<tr class="even">
<td align="left">labelled</td>
<td align="left"><a href="#facteurs-et-vecteurs-labellises_labelled">vecteur labellisé</a></td>
</tr>
<tr class="odd">
<td align="left">Date</td>
<td align="left"><a href="#gestion-des-dates">date</a></td>
</tr>
<tr class="even">
<td align="left">POSIXct</td>
<td align="left"><a href="#gestion-des-dates">date et heure</a></td>
</tr>
</tbody>
</table>
</div>
<div id="vecteurs-indexation-et-assignation_creation" class="section level2">
<h2>Création</h2>
<div id="vecteurs-indexation-et-assignation_la-fonction-c" class="section level3">
<h3>La fonction c</h3>
<p>Pour créer un vecteur, on utilisera la fonction <code data-pkg="base">c</code>, la lettre <q>c</q> étant un raccourci du mot anglais <i lang="en">combine</i> puisque cette fonction permet de combiner des valeurs individuelles dans un vecteur unique. Il suffit de lui passer la liste des valeurs à combiner :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">taille &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.88</span>, <span class="fl">1.65</span>, <span class="fl">1.92</span>, <span class="fl">1.76</span>)
taille</code></pre></div>
<pre><code>[1] 1.88 1.65 1.92 1.76</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(taille)</code></pre></div>
<pre><code>[1] "numeric"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sexe &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"h"</span>, <span class="st">"f"</span>, <span class="st">"h"</span>, <span class="st">"f"</span>)
sexe</code></pre></div>
<pre><code>[1] "h" "f" "h" "f"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(sexe)</code></pre></div>
<pre><code>[1] "character"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">urbain &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>)
urbain</code></pre></div>
<pre><code>[1]  TRUE  TRUE FALSE FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(urbain)</code></pre></div>
<pre><code>[1] "logical"</code></pre>
<p>Nous l’avons vu, toutes les valeurs d’un vecteur doivent obligatoirement du même type. Dès lors, si l’on essaie de combiner des valeurs de différents types, <strong>R</strong> essaiera de les convertir au mieux. Par exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(2L, <span class="fl">3.14</span>, <span class="st">"a"</span>)
x</code></pre></div>
<pre><code>[1] "2"    "3.14" "a"   </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(x)</code></pre></div>
<pre><code>[1] "character"</code></pre>
<p>Dans le cas présent, toutes les valeurs ont été converties en chaînes de caractères.</p>
</div>
<div id="vecteurs-indexation-et-assignation_la-fonction-rep" class="section level3">
<h3>La fonction rep</h3>
<p>Dans certaines situations, on peut avoir besoin de créer un vecteur d’une certaine longeur mais dont toutes les valeurs sont identiques. Cela se réalise facilement avec <code data-pkg="base">rep</code> à qui l’on indiquera la valeur à répéter puis le nombre de répétitions :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rep</span>(<span class="dv">2</span>, <span class="dv">10</span>)</code></pre></div>
<pre><code> [1] 2 2 2 2 2 2 2 2 2 2</code></pre>
<p>On peut aussi lui indiquer plusieurs valeurs qui seront alors répétées en boucle :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>), <span class="dv">3</span>)</code></pre></div>
<pre><code>[1] "a" "b" "a" "b" "a" "b"</code></pre>
</div>
<div id="vecteurs-indexation-et-assignation_la-fonction-seq" class="section level3">
<h3>La fonction seq</h3>
<p>Dans d’autres situations, on peut avoir besoin de créer un vecteur contenant une suite de valeurs, ce qui se réalise aisément avec <code data-pkg="base">seq</code> à qui l’on précisera les arguments <code>from</code> (point de départ), <code>to</code> (point d’arrivée) et <code>by</code> (pas). Quelques exemples valent mieux qu’un long discours :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>)</code></pre></div>
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">seq</span>(<span class="dv">5</span>, <span class="dv">17</span>, <span class="dt">by =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>[1]  5  7  9 11 13 15 17</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">0</span>)</code></pre></div>
<pre><code> [1] 10  9  8  7  6  5  4  3  2  1  0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">seq</span>(<span class="dv">100</span>, <span class="dv">10</span>, <span class="dt">by =</span> <span class="op">-</span><span class="dv">10</span>)</code></pre></div>
<pre><code> [1] 100  90  80  70  60  50  40  30  20  10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">seq</span>(<span class="fl">1.23</span>, <span class="fl">5.67</span>, <span class="dt">by =</span> <span class="fl">0.33</span>)</code></pre></div>
<pre><code> [1] 1.23 1.56 1.89 2.22 2.55 2.88 3.21 3.54 3.87
[10] 4.20 4.53 4.86 5.19 5.52</code></pre>
</div>
<div id="vecteurs-indexation-et-assignation_loperateur" class="section level3">
<h3>L’opérateur :</h3>
<p>L’opérateur <code>:</code> est un raccourci de la fonction <code>seq</code> pour créer une suite de nombres entiers. Il s’utilise ainsi :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span><span class="op">:</span><span class="dv">5</span></code></pre></div>
<pre><code>[1] 1 2 3 4 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">24</span><span class="op">:</span><span class="dv">32</span></code></pre></div>
<pre><code>[1] 24 25 26 27 28 29 30 31 32</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">55</span><span class="op">:</span><span class="dv">43</span></code></pre></div>
<pre><code> [1] 55 54 53 52 51 50 49 48 47 46 45 44 43</code></pre>
<p>Nous verrons un peu plus loin que ce raccourci est fort pratique.</p>
</div>
</div>
<div id="vecteurs-indexation-et-assignation_longueur-dun-vecteur" class="section level2">
<h2>Longueur d’un vecteur</h2>
<p>Un vecteur dispose donc d’une <dfn data-index="longueur, vecteur">longueur</dfn> qui correspond aux nombres de valeurs qui le compose. Elle s’obtient avec <code data-pkg="base">length</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(taille)</code></pre></div>
<pre><code>[1] 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(<span class="kw">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>))</code></pre></div>
<pre><code>[1] 2</code></pre>
<p>Il est possible de faire un vecteur de longeur nulle avec <code>c()</code>. Bien évidemment sa longueur est zéro.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(<span class="kw">c</span>())</code></pre></div>
<pre><code>[1] 0</code></pre>
</div>
<div id="vecteurs-indexation-et-assignation_quelques-vecteurs-remarquables" class="section level2">
<h2>Quelques vecteurs remarquables</h2>
<p><strong>R</strong> fournit quelques vecteurs particuliers qui sont directement accessibles :</p>
<ul>
<li>
<code data-pkg="base" data-rdoc="Constants">LETTERS</code> : les 26 lettres de l’alphabet en majuscules</li>
<li>
<code data-pkg="base" data-rdoc="Constants">letters</code> : les 26 lettres de l’alphabet en minuscules</li>
<li>
<code data-pkg="base" data-rdoc="Constants">month.name</code> : les noms des 12 mois de l’année en anglais</li>
<li>
<code data-pkg="base" data-rdoc="Constants">month.abb</code> : la version abrégée des 12 mois en anglais</li>
<li>
<code data-pkg="base" data-rdoc="Constants">pi</code> : la constante mathématique p</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">LETTERS</code></pre></div>
<pre><code> [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K"
[12] "L" "M" "N" "O" "P" "Q" "R" "S" "T" "U" "V"
[23] "W" "X" "Y" "Z"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">letters</code></pre></div>
<pre><code> [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k"
[12] "l" "m" "n" "o" "p" "q" "r" "s" "t" "u" "v"
[23] "w" "x" "y" "z"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(letters)</code></pre></div>
<pre><code>[1] 26</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">month.name</code></pre></div>
<pre><code> [1] "January"   "February"  "March"    
 [4] "April"     "May"       "June"     
 [7] "July"      "August"    "September"
[10] "October"   "November"  "December" </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">month.abb</code></pre></div>
<pre><code> [1] "Jan" "Feb" "Mar" "Apr" "May" "Jun" "Jul"
 [8] "Aug" "Sep" "Oct" "Nov" "Dec"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(month.abb)</code></pre></div>
<pre><code>[1] 12</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pi</code></pre></div>
<pre><code>[1] 3.141593</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(pi)</code></pre></div>
<pre><code>[1] 1</code></pre>
</div>
<div id="vecteurs-indexation-et-assignation_combiner-des-vecteurs" class="section level2">
<h2>Combiner des vecteurs</h2>
<p>Pour combiner des vecteurs, rien de plus simple. Il suffit d’utiliser <code data-pkd="base">c</code> ! Les valeurs des différents vecteurs seront mises bout à bout pour créer un unique vecteur.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>)
<span class="kw">length</span>(x)</code></pre></div>
<pre><code>[1] 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">0</span>)
<span class="kw">length</span>(y)</code></pre></div>
<pre><code>[1] 6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)
z</code></pre></div>
<pre><code> [1] 2 1 3 4 9 1 2 6 3 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(z)</code></pre></div>
<pre><code>[1] 10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">min_maj &lt;-<span class="st"> </span><span class="kw">c</span>(letters, LETTERS)
min_maj</code></pre></div>
<pre><code> [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k"
[12] "l" "m" "n" "o" "p" "q" "r" "s" "t" "u" "v"
[23] "w" "x" "y" "z" "A" "B" "C" "D" "E" "F" "G"
[34] "H" "I" "J" "K" "L" "M" "N" "O" "P" "Q" "R"
[45] "S" "T" "U" "V" "W" "X" "Y" "Z"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(min_maj)</code></pre></div>
<pre><code>[1] 52</code></pre>
</div>
<div id="vecteurs-indexation-et-assignation_valeurs-manquantes" class="section level2">
<h2>Valeurs manquantes</h2>
<p>Lorsque l’on travaille avec des données d’enquêtes, il est fréquent que certaines données soient manquantes, en raison d’un refus du participant de répondre à une question donnée ou d’un oubli ou d’un dystonctionnement du matériel de mesure, etc.</p>
<p>Une <dfn>valeur manquante</dfn><dfn data-index="manquante, valeur"></dfn> s’indique sous <strong>R</strong> avec <code>NA</code> (pour <em>not available</em>). Cette valeur peut s’appliquer à n’importe quel type de vecteur, qu’il soit numérique, textuel ou logique.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">taille &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.88</span>, <span class="ot">NA</span>, <span class="fl">1.65</span>, <span class="fl">1.92</span>, <span class="fl">1.76</span>, <span class="ot">NA</span>)
sexe &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"h"</span>, <span class="st">"f"</span>, <span class="ot">NA</span>, <span class="st">"h"</span>, <span class="ot">NA</span>, <span class="st">"f"</span>)</code></pre></div>
<p>Les valeurs manquantes sont prises en compte dans le calcul de la longeur du vecteur.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(taille)</code></pre></div>
<pre><code>[1] 6</code></pre>
<p>Il ne faut pas confondre <code data-pkg="base">NA</code> avec un autre objet que l’on rencontre sous <strong>R</strong> et appelé <code data-pkg="base">NULL</code> qui représente l’<q>objet vide</q>. <code>NULL</code> ne contient absolument rien du tout. La différence se comprends mieux lorsque que l’on essaie de combiner ces objets :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="ot">NULL</span>, <span class="ot">NULL</span>, <span class="ot">NULL</span>)</code></pre></div>
<pre><code>NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(<span class="kw">c</span>(<span class="ot">NULL</span>, <span class="ot">NULL</span>, <span class="ot">NULL</span>))</code></pre></div>
<pre><code>[1] 0</code></pre>
<p>On peut combiner <code>NULL</code> avec <code>NULL</code>, du vide plus du vide renverra toujours du vide dont la dimension est égale à zéro.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>)</code></pre></div>
<pre><code>[1] NA NA NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(<span class="kw">c</span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>))</code></pre></div>
<pre><code>[1] 3</code></pre>
<p>Par contre, un vecteur composé de trois valeurs manquantes a une longueur de 3, même si toutes ses valeurs sont manquantes.</p>
</div>
<div id="vecteurs-indexation-et-assignation_indexation-par-position" class="section level2">
<h2>Indexation par position</h2>
<p>L’<dfn>indexation</dfn> est l’une des fonctionnalités les plus puissantes mais aussi les plus difficiles à maîtriser de <strong>R</strong>. Il s’agit d’opérations permettant de sélectionner des sous-ensembles de valeurs en fonction de différents critères. Il existe trois types d’indexation : (i) l’indexation par position, (ii) l’indexation par nom et (iii) l’indexation par condition. Le principe est toujours le même : on indique entre crochets (<code>[]</code>) ce que l’on souhaite garder ou non.</p>
<p>Pour rappel, les crochets s’obtiennent sur un clavier français de type PC en appuyant sur la touche <kbd>Alt Gr</kbd> et la touche <kbd>(</kbd> ou <kbd>)</kbd>.</p>
<p>Commençons par l’<dfn>indexation par position</dfn><dfn data-index="position, indexation"></dfn> encore appelée <dfn>indexation directe</dfn>. Ce mode le plus simple d’indexation consiste à indiquer la position des éléments à conserver.</p>
<p>Reprenons notre vecteur <code>taille</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">taille</code></pre></div>
<pre><code>[1] 1.88   NA 1.65 1.92 1.76   NA</code></pre>
<p>Si on souhaite le premier élément du vecteur, on peut faire :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">taille[<span class="dv">1</span>]</code></pre></div>
<pre><code>[1] 1.88</code></pre>
<p>Si on souhaite les trois premiers éléments ou les éléments 2, 5 et 6 :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">taille[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</code></pre></div>
<pre><code>[1] 1.88   NA 1.65</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">taille[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">6</span>)]</code></pre></div>
<pre><code>[1]   NA 1.76   NA</code></pre>
<p>Si on veut le dernier élément :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">taille[<span class="kw">length</span>(taille)]</code></pre></div>
<pre><code>[1] NA</code></pre>
<p>Il est tout à fait possible de sélectionner les valeurs dans le désordre :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">taille[<span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">3</span>)]</code></pre></div>
<pre><code>[1] 1.76 1.88 1.92 1.65</code></pre>
<p>Dans le cadre de l’indexation par position, il est également possible de spécifier des nombres négatifs. Auquel cas, cela signifiera <q>toutes les valeurs sauf celles-là</q>. Par exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">taille[<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">5</span>)]</code></pre></div>
<pre><code>[1]   NA 1.65 1.92   NA</code></pre>
<p>À noter, si l’on indique une position au-delà de la longueur du vecteur, <strong>R</strong> renverra <code>NA</code>. Par exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">taille[<span class="dv">23</span><span class="op">:</span><span class="dv">25</span>]</code></pre></div>
<pre><code>[1] NA NA NA</code></pre>
</div>
<div id="vecteurs-indexation-et-assignation_des-vecteurs-nommes" class="section level2">
<h2>Des vecteurs nommés</h2>
<p>Les différentes valeurs d’un vecteur peuvent être nommés. Une première manière de nommer les éléments d’un vecteur est de le faire à sa création :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sexe &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">Michel =</span> <span class="st">"h"</span>, <span class="dt">Anne =</span> <span class="st">"f"</span>, <span class="dt">Dominique =</span> <span class="ot">NA</span>, 
  <span class="dt">Jean =</span> <span class="st">"h"</span>, <span class="dt">Claude =</span> <span class="ot">NA</span>, <span class="dt">Marie =</span> <span class="st">"f"</span>)</code></pre></div>
<p>Lorsque l’on affiche le vecteur, la présentation change quelque peu.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sexe</code></pre></div>
<pre><code>   Michel      Anne Dominique      Jean    Claude 
      "h"       "f"        NA       "h"        NA 
    Marie 
      "f" </code></pre>
<p>La liste des noms s’obient avec <code data-pkg="base">names</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(sexe)</code></pre></div>
<pre><code>[1] "Michel"    "Anne"      "Dominique"
[4] "Jean"      "Claude"    "Marie"    </code></pre>
<p>Pour ajouter ou modifier les noms d’un vecteur, on doit attribuer un nouveau vecteur de noms :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(sexe) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Michael"</span>, <span class="st">"Anna"</span>, <span class="st">"Dom"</span>, <span class="st">"John"</span>, 
  <span class="st">"Alex"</span>, <span class="st">"Mary"</span>)
sexe</code></pre></div>
<pre><code>Michael    Anna     Dom    John    Alex    Mary 
    "h"     "f"      NA     "h"      NA     "f" </code></pre>
<p>Pour supprimer tout les noms, il y a la fonction <code data-pkg="base">unname</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">anonyme &lt;-<span class="st"> </span><span class="kw">unname</span>(sexe)
anonyme</code></pre></div>
<pre><code>[1] "h" "f" NA  "h" NA  "f"</code></pre>
</div>
<div id="vecteurs-indexation-et-assignation_indexation-par-nom" class="section level2">
<h2>Indexation par nom</h2>
<p>Lorsqu’un vecteur est nommé, il est dès lors possible d’accéder à ses valeurs à partir de leur nom. Il s’agit de l’<dfn>indexation par nom</dfn><dfn data-index="nom, indexation"></dfn>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sexe[<span class="st">"Anna"</span>]</code></pre></div>
<pre><code>Anna 
 "f" </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sexe[<span class="kw">c</span>(<span class="st">"Mary"</span>, <span class="st">"Michael"</span>, <span class="st">"John"</span>)]</code></pre></div>
<pre><code>   Mary Michael    John 
    "f"     "h"     "h" </code></pre>
<p>Par contre il n’est pas possible d’utiliser l’opérateur <code>-</code> comme pour l’indexation directe. Pour exclure un élément en fonction de son nom, on doit utiliser une autre forme d’indexation, l’indexation par condition, expliquée dans la section suivante. On peut ainsi faire…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sexe[<span class="kw">names</span>(sexe) <span class="op">!=</span><span class="st"> "Dom"</span>]</code></pre></div>
<p>… pour sélectionner tous les éléments sauf celui qui s’appelle <q>Dom</q>.</p>
</div>
<div id="vecteurs-indexation-et-assignation_indexation-par-condition" class="section level2">
<h2>Indexation par condition</h2>
<p>L’<dfn>indexation par condition</dfn><dfn data-index="condition, indexation"></dfn> consiste à fournir un vecteur logique indiquant si chaque élément doit être inclu (si <code>TRUE</code>) ou exclu (si <code>FALSE</code>). Par exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sexe</code></pre></div>
<pre><code>Michael    Anna     Dom    John    Alex    Mary 
    "h"     "f"      NA     "h"      NA     "f" </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sexe[<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>)]</code></pre></div>
<pre><code>Michael    John 
    "h"     "h" </code></pre>
<p>Écrire manuellement une telle condition n’est pas très pratique à l’usage. Mais supposons que nous ayons également à notre disposition les deux vecteurs suivants, également de longueur 6.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">urbain &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">TRUE</span>)
poids &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">80</span>, <span class="dv">63</span>, <span class="dv">75</span>, <span class="dv">87</span>, <span class="dv">82</span>, <span class="dv">67</span>)</code></pre></div>
<p>Le vecteur <code>urbain</code> est un vecteur logique. On peut directement l’utiliser pour avoir le sexe des enquêtés habitant en milieu urbain :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sexe[urbain]</code></pre></div>
<pre><code>Michael    Alex    Mary 
    "h"      NA     "f" </code></pre>
<p>Supposons que l’on souhaite maintenant avoir la taille des individus pesant 80 kilogrammes ou plus. Nous pouvons effectuer une comparaison à l’aide des <dfn data-index="opérateur de comparaison">opérateurs de comparaison</dfn><dfn data-index="comparaison, opérateur"></dfn> suivants :</p>
<table>
<thead><tr class="header">
<th align="left">Opérateur de comparaison</th>
<th align="left">Signification</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>==</code></td>
<td align="left">égal à</td>
</tr>
<tr class="even">
<td align="left"><code>!=</code></td>
<td align="left">différent de</td>
</tr>
<tr class="odd">
<td align="left"><code>&gt;</code></td>
<td align="left">strictement supérieur à</td>
</tr>
<tr class="even">
<td align="left"><code>&lt;</code></td>
<td align="left">strictement inférieur à</td>
</tr>
<tr class="odd">
<td align="left"><code>&gt;=</code></td>
<td align="left">supérieur ou égal à</td>
</tr>
<tr class="even">
<td align="left"><code>&lt;=</code></td>
<td align="left">inférieur ou égal à</td>
</tr>
</tbody>
</table>
<p>Voyons tout de suite un exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">poids <span class="op">&gt;=</span><span class="st"> </span><span class="dv">80</span></code></pre></div>
<pre><code>[1]  TRUE FALSE FALSE  TRUE  TRUE FALSE</code></pre>
<p>Que s’est-il passé ? Nous avons fourni à <strong>R</strong> une condition et il nous a renvoyé un vecteur logique avec autant d’éléments qu’il y’a d’observations et dont la valeur est <code>TRUE</code> si la condition est remplie et <code>FALSE</code> dans les autres cas. Nous pouvons alors utiliser ce vecteur logique pour obtenir la taille des participants pesant 80 kilogrammes ou plus :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">taille[poids <span class="op">&gt;=</span><span class="st"> </span><span class="dv">80</span>]</code></pre></div>
<pre><code>[1] 1.88 1.92 1.76</code></pre>
<p>On peut combiner ou modifier des conditions à l’aide des <dfn data-index="opérateur logique">opérateurs logiques</dfn><dfn data-index="logique, opérateur"></dfn> habituels :</p>
<table>
<thead><tr class="header">
<th align="left">Opérateur logique</th>
<th align="left">Signification</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>&amp;</code></td>
<td align="left">et logique</td>
</tr>
<tr class="even">
<td align="left"><code>|</code></td>
<td align="left">ou logique</td>
</tr>
<tr class="odd">
<td align="left"><code>!</code></td>
<td align="left">négation logique</td>
</tr>
</tbody>
</table>
<p>Comment les utilise-t-on ? Voyons tout de suite un exemple. Supposons que je veuille identifier les personnes pesant 80 kilogrammes ou plus <strong>et</strong> vivant en milieu urbain :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">poids <span class="op">&gt;=</span><span class="st"> </span><span class="dv">80</span> <span class="op">&amp;</span><span class="st"> </span>urbain</code></pre></div>
<pre><code>[1]  TRUE FALSE FALSE FALSE  TRUE FALSE</code></pre>
<p>Les résultats sont différents si je souhaite isoler les personnes pesant 80 kilogrammes ou plus <strong>ou</strong> vivant milieu urbain :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">poids <span class="op">&gt;=</span><span class="st"> </span><span class="dv">80</span> <span class="op">|</span><span class="st"> </span>urbain</code></pre></div>
<pre><code>[1]  TRUE FALSE FALSE  TRUE  TRUE  TRUE</code></pre>
<p>Une remarque importante : quand l’un des termes d’une condition comporte une <dfn>valeur manquante</dfn><dfn data-index="manquante, valeur"></dfn> (<code>NA</code>), le résultat de cette condition n’est pas toujours <code>TRUE</code> ou <code>FALSE</code>, il peut aussi être à son tour une valeur manquante.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">taille</code></pre></div>
<pre><code>[1] 1.88   NA 1.65 1.92 1.76   NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">taille <span class="op">&gt;</span><span class="st"> </span><span class="fl">1.8</span></code></pre></div>
<pre><code>[1]  TRUE    NA FALSE  TRUE FALSE    NA</code></pre>
<p>On voit que le test <code>NA &gt; 1.8</code> ne renvoie ni vrai ni faux, mais <code>NA</code>.</p>
<p>Une autre conséquence importante de ce comportement est qu’on ne peut pas utiliser l’opérateur l’expression <code>== NA</code> pour tester la présence de valeurs manquantes. On utilisera à la place la fonction <em>ad hoc</em> <code data-pkg="base" data-rdoc="NA">is.na</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.na</span>(taille <span class="op">&gt;</span><span class="st"> </span><span class="fl">1.8</span>)</code></pre></div>
<pre><code>[1] FALSE  TRUE FALSE FALSE FALSE  TRUE</code></pre>
<p>Pour compliquer encore un peu le tout, lorsqu’on utilise une condition pour l’indexation, si la condition renvoie <code>NA</code>, <strong>R</strong> ne sélectionne pas l’élément mais retourne quand même la valeur <code>NA</code>. Ceci a donc des conséquences sur le résultat d’une indexation par comparaison.</p>
<p>Par exemple si je cherche à connaître le poids des personnes mesurant 1,80 mètre ou plus :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">taille</code></pre></div>
<pre><code>[1] 1.88   NA 1.65 1.92 1.76   NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">poids</code></pre></div>
<pre><code>[1] 80 63 75 87 82 67</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">poids[taille <span class="op">&gt;</span><span class="st"> </span><span class="fl">1.8</span>]</code></pre></div>
<pre><code>[1] 80 NA 87 NA</code></pre>
<p>Les éléments pour lesquels la taille n’est pas connue ont été transformés en <code>NA</code>, ce qui n’influera pas le calcul d’une moyenne. Par contre, lorsqu’on utilisera assignation et indexation ensemble, cela peut créer des problèmes. Il est donc préférable lorsque l’on a des valeurs manquantes de les exclure ainsi :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">poids[taille <span class="op">&gt;</span><span class="st"> </span><span class="fl">1.8</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(taille)]</code></pre></div>
<pre><code>[1] 80 87</code></pre>
<p>Pour plus de détails sur les conditions et le calcul logique dans <strong>R</strong>, on pourra se référer au <a href="#conditions-et-comparaisons">chapitre dédié</a>.</p>
</div>
<div id="vecteurs-indexation-et-assignation_assignation-par-indexation" class="section level2">
<h2>Assignation par indexation</h2>
<p>Dans tous les exemples précédents, on a utilisé l’indexation pour extraire une partie d’un vecteur, en plaçant l’opération d’indexation à droite de l’opérateur <code>&lt;-</code>.</p>
<p>Mais l’indexation peut également être placée à gauche de cet opérateur d’<dfn>assignation</dfn>. Dans ce cas, les éléments sélectionnés par l’indexation sont alors remplacés par les valeurs indiquées à droite de l’opérateur <code>&lt;-</code>.</p>
<p>Prenons donc un exemple simple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span>
v</code></pre></div>
<pre><code>[1] 1 2 3 4 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">3</span>
v</code></pre></div>
<pre><code>[1] 3 2 3 4 5</code></pre>
<p>Cette fois, au lieu d’utiliser quelque chose comme <code>x &lt;- v[1]</code>, qui aurait placé la valeur du premier élément de <code>v</code> dans <code>x</code>, on a utilisé <code>v[1] &lt;- 3</code>, ce qui a mis à jour le premier élément de <code>v</code> avec la valeur 3. Ceci fonctionne également pour les différents types d’indexation évoqués précédemment :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sexe[<span class="st">"Alex"</span>] &lt;-<span class="st"> "f"</span></code></pre></div>
<p>Enfin on peut modifier plusieurs éléments d’un seul coup soit en fournissant un vecteur, soit en profitant du mécanisme de <dfn>recyclage</dfn>. Les deux commandes suivantes sont ainsi rigoureusement équivalentes :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sexe[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>)] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>)
sexe[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>)] &lt;-<span class="st"> "Homme"</span></code></pre></div>
<p>L’assignation par indexation peut aussi être utilisée pour ajouter une ou plusieurs valeurs à un vecteur :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(sexe)</code></pre></div>
<pre><code>[1] 6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sexe[<span class="dv">7</span>] &lt;-<span class="st"> "f"</span>
sexe</code></pre></div>
<pre><code>Michael    Anna     Dom    John    Alex    Mary 
"Homme"     "f" "Homme" "Homme"     "f"     "f" 
        
    "f" </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(sexe)</code></pre></div>
<pre><code>[1] 7</code></pre>
<p>On commence à voir comment l’utilisation de l’indexation par conditions et de l’assignation va nous permettre de faire des recodages (que nous aborderons plus en détail dans un <a href="#recodage">chapitre dédié</a>).</p>
</div>
<div id="vecteurs-indexation-et-assignation_en-resume" class="section level2">
<h2>En résumé</h2>
<ul>
<li>Un vecteur est un objet unidimensionnel contenant une liste de valeurs qui sont toutes du même type (entières, numériques, textuelles ou logiques).</li>
<li>La fonction <code data-pkg="base">class</code> permets de connaître le type de vecteur et la fonction <code data-pkg="base">length</code> sa longueur, c’est-à-dire le nombre d’éléments du vecteur.</li>
<li>La fonction <code data-pkg="base">c</code> sert à créer et à combiner des vecteurs.</li>
<li>Les valeurs manquantes sont représentées avec <code>NA</code>. Un vecteur peut être nommé, c’est-à-dire qu’un nom textuel a été associé à chaque élément. Cela peut se faire lors da sa création ou avec la fonction <code data-pkg="base">names</code>.</li>
<li>L’indexation consiste à extraire certains éléments d’un vecteur. Pour cela, on indique ce que l’on souhaite extraire entre crochets (<code>[]</code>) juste après le nom du vecteur. Le type d’indexation dépend du type d’information transmise.</li>
<li>S’il s’agit de nombres entiers, c’est l’indexation par position : les nombres représent la position dans le vecteur des éléments que l’on souhaite extraire. Un nombre négatif s’interprète comme <q>tous les éléments sauf celui-là</q>.</li>
<li>Si l’on indique des chaînes de caractères, c’est l’indexation par nom : on indique le nom des éléments que l’on souhaite extraire. Cette forme d’indexation ne fonctionne que si le vecteur est nommé.</li>
<li>Si l’on transmets des valeurs logiques, le plus souvent sous la forme d’une condition, c’est l’indexation par condition : <code>TRUE</code> indique les éléments à extraire et <code>FALSE</code> les éléments à exclure. Il faut être vigilant aux valeurs manquantes (<code>NA</code>) dans ce cas précis.</li>
<li>Enfin, il est possible de ne modifier que certains éléments d’un vecteur en ayant recours à la fois à l’indexation (<code>[]</code>) et à l’assignation (<code>&lt;-</code>).</li>
</ul>
</div>

</article>
<article id="listes-et-tableaux-de-donnes"><div class="fluid-row" id="listes-et-tableaux-de-donnes_header">



<h1 class="title toc-ignore">Listes et Tableaux de données</h1>

</div>

<div class="TOC">
<ul>
<li>
<a href="#listes-et-tableaux-de-donnes_listes">Listes</a><ul>
<li><a href="#listes-et-tableaux-de-donnes_proprietes-et-creation">Propriétés et création</a></li>
<li><a href="#listes-et-tableaux-de-donnes_indexation">Indexation</a></li>
</ul>
</li>
<li>
<a href="#listes-et-tableaux-de-donnes_tableaux-de-donnees">Tableaux de données</a><ul>
<li><a href="#listes-et-tableaux-de-donnes_proprietes-et-creation-1">Propriétés et création</a></li>
<li><a href="#listes-et-tableaux-de-donnes_indexation-1">Indexation</a></li>
<li><a href="#listes-et-tableaux-de-donnes_afficher-les-donnees">Afficher les données</a></li>
</ul>
</li>
<li><a href="#listes-et-tableaux-de-donnes_en-resume">En résumé</a></li>
</ul>
</div>

<div class="note">
<p>Il est préférable d’avoir déjà lu le chapitre <a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a> avant d’aborder celui-ci.</p>
</div>
<div id="listes-et-tableaux-de-donnes_listes" class="section level2">
<h2>Listes</h2>
<p>Par nature, les vecteurs ne peuvent contenir que des valeurs de même type (numériques, textuels ou logique). Or, on peut avoir besoin de représenter des objets plus complexes composés d’éléments disparates. C’est ce que permettent les <dfn data-index="liste">listes</dfn>.</p>
<div id="listes-et-tableaux-de-donnes_proprietes-et-creation" class="section level3">
<h3>Propriétés et création</h3>
<p>Une liste se créée tout simplement avec la fonction <code data-pkg="base">list</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">l1 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="st">"abc"</span>)
l1</code></pre></div>
<pre><code>[[1]]
[1] 1 2 3 4 5

[[2]]
[1] "abc"</code></pre>
<p>Une liste est un ensemble d’objets, quels qu’ils soient, chaque élément d’une liste pouvant avoir ses propres dimensions. Dans notre exemple précédent, nous avons créée une liste <code>l1</code> composée de deux élements : un vecteur d’entiers de longeur 5 et un vecteur textuel de longueur 1. La longueur d’une liste correspond aux nombres d’éléments qu’elle contient et s’obtient avec <code data-pkg="base">length</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(l1)</code></pre></div>
<pre><code>[1] 2</code></pre>
<p>Comme les vecteurs, une liste peut être nommées et les noms des éléments d’une liste accessibles avec <code data-pkg="base">names</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">l2 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">minuscules =</span> letters, <span class="dt">majuscules =</span> LETTERS, 
  <span class="dt">mois =</span> month.name)
l2</code></pre></div>
<pre><code>$minuscules
 [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k"
[12] "l" "m" "n" "o" "p" "q" "r" "s" "t" "u" "v"
[23] "w" "x" "y" "z"

$majuscules
 [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K"
[12] "L" "M" "N" "O" "P" "Q" "R" "S" "T" "U" "V"
[23] "W" "X" "Y" "Z"

$mois
 [1] "January"   "February"  "March"    
 [4] "April"     "May"       "June"     
 [7] "July"      "August"    "September"
[10] "October"   "November"  "December" </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(l2)</code></pre></div>
<pre><code>[1] 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(l2)</code></pre></div>
<pre><code>[1] "minuscules" "majuscules" "mois"      </code></pre>
<p>Que se passe-t-il maintenant si l’on effectue la commande suivante ?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">l &lt;-<span class="st"> </span><span class="kw">list</span>(l1, l2)</code></pre></div>
<p>À votre avis, quelle est la longueur de cette nouvelle liste <code>l</code> ? 5 ?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(l)</code></pre></div>
<pre><code>[1] 2</code></pre>
<p>Et bien non ! Elle est de longeur 2, car nous avons créé une liste composée de deux éléments qui sont eux-mêmes des listes. Cela est plus lisible si l’on fait appel à la fonction <code data-pkg="utils">str</code> qui permet de visualiser la structure d’un objet.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(l)</code></pre></div>
<pre><code>List of 2
 $ :List of 2
  ..$ : int [1:5] 1 2 3 4 5
  ..$ : chr "abc"
 $ :List of 3
  ..$ minuscules: chr [1:26] "a" "b" "c" "d" ...
  ..$ majuscules: chr [1:26] "A" "B" "C" "D" ...
  ..$ mois      : chr [1:12] "January" "February" "March" "April" ...</code></pre>
<p>Une liste peut contenir tout type d’objets, y compris d’autres listes. Pour combiner les éléments d’une liste, il faut utiliser la fonction <code data-pkg="base">append</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">l &lt;-<span class="st"> </span><span class="kw">append</span>(l1, l2)
<span class="kw">length</span>(l)</code></pre></div>
<pre><code>[1] 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(l)</code></pre></div>
<pre><code>List of 5
 $           : int [1:5] 1 2 3 4 5
 $           : chr "abc"
 $ minuscules: chr [1:26] "a" "b" "c" "d" ...
 $ majuscules: chr [1:26] "A" "B" "C" "D" ...
 $ mois      : chr [1:12] "January" "February" "March" "April" ...</code></pre>
<p>On peut noter en passant qu’une liste peut tout à fait n’être que partiellement nommée.</p>
</div>
<div id="listes-et-tableaux-de-donnes_indexation" class="section level3">
<h3>Indexation</h3>
<p>Les crochets simples (<code>[]</code>) fonctionnent comme pour les vecteurs. On peut utiliser à la fois l’<dfn>indexation par position</dfn><dfn data-index="position, indexation"></dfn>, l’<dfn>indexation par nom</dfn><dfn data-index="nom, indexation"></dfn> et l’<dfn>indexation par condition</dfn><dfn data-index="condition, indexation"></dfn>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">l</code></pre></div>
<pre><code>[[1]]
[1] 1 2 3 4 5

[[2]]
[1] "abc"

$minuscules
 [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k"
[12] "l" "m" "n" "o" "p" "q" "r" "s" "t" "u" "v"
[23] "w" "x" "y" "z"

$majuscules
 [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K"
[12] "L" "M" "N" "O" "P" "Q" "R" "S" "T" "U" "V"
[23] "W" "X" "Y" "Z"

$mois
 [1] "January"   "February"  "March"    
 [4] "April"     "May"       "June"     
 [7] "July"      "August"    "September"
[10] "October"   "November"  "December" </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">l[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>)]</code></pre></div>
<pre><code>[[1]]
[1] 1 2 3 4 5

$minuscules
 [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k"
[12] "l" "m" "n" "o" "p" "q" "r" "s" "t" "u" "v"
[23] "w" "x" "y" "z"

$majuscules
 [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K"
[12] "L" "M" "N" "O" "P" "Q" "R" "S" "T" "U" "V"
[23] "W" "X" "Y" "Z"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">l[<span class="kw">c</span>(<span class="st">"majuscules"</span>, <span class="st">"minuscules"</span>)]</code></pre></div>
<pre><code>$majuscules
 [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K"
[12] "L" "M" "N" "O" "P" "Q" "R" "S" "T" "U" "V"
[23] "W" "X" "Y" "Z"

$minuscules
 [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k"
[12] "l" "m" "n" "o" "p" "q" "r" "s" "t" "u" "v"
[23] "w" "x" "y" "z"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">l[<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>)]</code></pre></div>
<pre><code>[[1]]
[1] 1 2 3 4 5

[[2]]
[1] "abc"

$mois
 [1] "January"   "February"  "March"    
 [4] "April"     "May"       "June"     
 [7] "July"      "August"    "September"
[10] "October"   "November"  "December" </code></pre>
<p>Même si l’on extrait un seul élément, l’extraction obtenue avec les crochets simples renvoie toujours une liste, ici composée d’un seul élément :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(l[<span class="dv">1</span>])</code></pre></div>
<pre><code>List of 1
 $ : int [1:5] 1 2 3 4 5</code></pre>
<p>Supposons que je souhaite calculer la moyenne des valeurs du premier élément de ma liste. Essayons la commande suivante :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(l[<span class="dv">1</span>])</code></pre></div>
<pre><code>Warning in mean.default(l[1]): argument is not
numeric or logical: returning NA</code></pre>
<pre><code>[1] NA</code></pre>
<p>Nous obtenons un message d’erreur. En effet, <strong>R</strong> ne sait pas calculer une moyenne à partir d’une liste. Ce qu’il lui faut, c’est un vecteur de valeurs numériques. Autrement dit, ce que nous cherchons à obtenir c’est le contenu même du premier élément de notre liste et non une liste à un seul élément.</p>
<p>C’est ici que les doubles crochets (<code>[[]]</code>) vont rentrer en jeu. Pour ces derniers, nous pourrons utiliser l’indexation par position ou l’indexation par nom, mais pas l’indexation par condition. De plus, le critère que l’on indiquera doit indiquer <em>un et un seul</em> élément de notre liste. Au lieu de renvoyer une liste à un élément, les doubles crochets vont renvoyer l’élément désigné. Vite, un exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(l[<span class="dv">1</span>])</code></pre></div>
<pre><code>List of 1
 $ : int [1:5] 1 2 3 4 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(l[[<span class="dv">1</span>]])</code></pre></div>
<pre><code> int [1:5] 1 2 3 4 5</code></pre>
<p>Maintenant, nous pouvons calculer notre moyenne :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(l[[<span class="dv">1</span>]])</code></pre></div>
<pre><code>[1] 3</code></pre>
<p>Nous pouvons aussi tester l’indexation par nom.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">l[[<span class="st">"mois"</span>]]</code></pre></div>
<pre><code> [1] "January"   "February"  "March"    
 [4] "April"     "May"       "June"     
 [7] "July"      "August"    "September"
[10] "October"   "November"  "December" </code></pre>
<p>Mais il faut avouer que cette écriture avec doubles crochets et guillemets est un peu lourde. Heureusement, un nouvel acteur entre en scène : le symbole dollar (<code>$</code>). C’est un raccourci des doubles crochets pour l’indexation par nom. Que l’on utilise ainsi :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">l<span class="op">$</span>mois</code></pre></div>
<pre><code> [1] "January"   "February"  "March"    
 [4] "April"     "May"       "June"     
 [7] "July"      "August"    "September"
[10] "October"   "November"  "December" </code></pre>
<p>Les écritures <code>l$mois</code> et <code>l[["mois"]]</code> sont équivalentes. Attention ! Cela ne fonctionne que pour l’indexation par nom.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">l<span class="op">$</span><span class="dv">1</span></code></pre></div>
<pre><code>Error: unexpected numeric constant in "l$1"</code></pre>
<p>L’<dfn>assignation par indexation</dfn><dfn data-index="indexation, assignation"></dfn> fonctionne également avec les doubles crochets ou le signe dollar :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">l[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">"un"</span>, <span class="st">"vecteur"</span>, <span class="st">"textuel"</span>))
l<span class="op">$</span>mois &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Janvier"</span>, <span class="st">"Février"</span>, <span class="st">"Mars"</span>)
l</code></pre></div>
<pre><code>[[1]]
[1] 1 2 3 4 5

[[2]]
[[2]][[1]]
[1] "un"      "vecteur" "textuel"


$minuscules
 [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k"
[12] "l" "m" "n" "o" "p" "q" "r" "s" "t" "u" "v"
[23] "w" "x" "y" "z"

$majuscules
 [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K"
[12] "L" "M" "N" "O" "P" "Q" "R" "S" "T" "U" "V"
[23] "W" "X" "Y" "Z"

$mois
[1] "Janvier" "Février" "Mars"   </code></pre>
</div>
</div>
<div id="listes-et-tableaux-de-donnes_tableaux-de-donnees" class="section level2">
<h2>Tableaux de données</h2>
<p>Il y a un type d’objets que nous avons déjà abordé dans le chapitre <a href="#premier-travail-avec-les-donnees">Premier travail avec les données</a>, il s’agit du <dfn>tableau de données</dfn><dfn data-index="données, tableau"></dfn> ou <dfn lang="en">data frame</dfn> en anglais.</p>
<div id="listes-et-tableaux-de-donnes_proprietes-et-creation-1" class="section level3">
<h3>Propriétés et création</h3>
<p>Dans <strong>R</strong>, les tableaux de données sont tout simplement des listes avec quelques propriétés spéficiques :</p>
<ul>
<li>les tableaux de données ne peuvent contenir que des vecteurs ;</li>
<li>tous les vecteurs d’un tableau de données ont la même longueur ;</li>
<li>tous les éléments d’un tableau de données sont nommés et ont chacun un nom unique.</li>
</ul>
<p>Dès lors, un tableau de données correspond aux fichiers de données que l’on a l’habitude de manipuler dans d’autres logiciels de statistiques comme <strong>SPSS</strong> ou <strong>Stata</strong>. Les variables sont organisées en colonnes et les observations en lignes.</p>
<p>On peut créer un tableau de données avec la fonction <code data-pkg="base">data.frame</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sexe =</span> <span class="kw">c</span>(<span class="st">"f"</span>, <span class="st">"f"</span>, <span class="st">"h"</span>, <span class="st">"h"</span>), <span class="dt">age =</span> <span class="kw">c</span>(<span class="dv">52</span>, 
  <span class="dv">31</span>, <span class="dv">29</span>, <span class="dv">35</span>), <span class="dt">blond =</span> <span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>))
df</code></pre></div>
<pre><code>  sexe age blond
1    f  52 FALSE
2    f  31  TRUE
3    h  29  TRUE
4    h  35 FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(df)</code></pre></div>
<pre><code>'data.frame':   4 obs. of  3 variables:
 $ sexe : Factor w/ 2 levels "f","h": 1 1 2 2
 $ age  : num  52 31 29 35
 $ blond: logi  FALSE TRUE TRUE FALSE</code></pre>
<p>La fonction <code data-pkg="base">data.frame</code> a un gros défaut : si on ne désactive pas l’option <code>stringsAsFactors</code> elle transforme les chaînes de caractères, ici la variable <var>sexe</var> en facteurs (un type de vecteur que nous aborderons plus en détail dans un <a href="#facteurs-et-vecteurs-labellises">prochain chapitre</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sexe =</span> <span class="kw">c</span>(<span class="st">"f"</span>, <span class="st">"f"</span>, <span class="st">"h"</span>, <span class="st">"h"</span>), <span class="dt">age =</span> <span class="kw">c</span>(<span class="dv">52</span>, 
  <span class="dv">31</span>, <span class="dv">29</span>, <span class="dv">35</span>), <span class="dt">blond =</span> <span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>), 
  <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
df</code></pre></div>
<pre><code>  sexe age blond
1    f  52 FALSE
2    f  31  TRUE
3    h  29  TRUE
4    h  35 FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(df)</code></pre></div>
<pre><code>'data.frame':   4 obs. of  3 variables:
 $ sexe : chr  "f" "f" "h" "h"
 $ age  : num  52 31 29 35
 $ blond: logi  FALSE TRUE TRUE FALSE</code></pre>
<p>Un tableau de données étant une liste, la fonction <code data-pkg="base">length</code> renverra le nombre d’éléments de la liste, donc dans le cas présent le nombre de variables et <code data-pkg="base">names</code> leurs noms :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(df)</code></pre></div>
<pre><code>[1] 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(df)</code></pre></div>
<pre><code>[1] "sexe"  "age"   "blond"</code></pre>
<p>Comme tous les éléments d’un tableau de données ont la même longeur, cet objet peut être vu comme bidimensionnel. Les fonctions <code data-pkg="base">nrow</code>, <code data-pkg="base" data-rdoc="nrow">ncol</code> et <code data-pkg="base">dim</code> donnent respectivement le nombre de lignes, le nombre de colonnes et les dimensions de notre tableau.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(df)</code></pre></div>
<pre><code>[1] 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ncol</span>(df)</code></pre></div>
<pre><code>[1] 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(df)</code></pre></div>
<pre><code>[1] 4 3</code></pre>
<p>De plus, tout comme les colonnes ont un nom, il est aussi possible de nommer les lignes avec <code data-pkg="base">row.names</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">row.names</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Anna"</span>, <span class="st">"Mary-Ann"</span>, <span class="st">"Michael"</span>, <span class="st">"John"</span>)
df</code></pre></div>
<pre><code>         sexe age blond
Anna        f  52 FALSE
Mary-Ann    f  31  TRUE
Michael     h  29  TRUE
John        h  35 FALSE</code></pre>
</div>
<div id="listes-et-tableaux-de-donnes_indexation-1" class="section level3">
<h3>Indexation</h3>
<p>Les tableaux de données étant des listes, nous pouvons donc utiliser les crochets simples (<code>[]</code>), les crochets doubles (<code>[[]]</code>) et le symbole dollar (<code>$</code>) pour extraire des parties de notre tableau, de la même manière que pour n’importe quelle liste.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df[<span class="dv">1</span>]</code></pre></div>
<pre><code>         sexe
Anna        f
Mary-Ann    f
Michael     h
John        h</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>[1] "f" "f" "h" "h"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>sexe</code></pre></div>
<pre><code>[1] "f" "f" "h" "h"</code></pre>
<p>Cependant, un tableau de données étant un objet bidimensionnel, il est également possible d’extraire des données sur deux dimensions, à savoir un premier critère portant sur les lignes et un second portant sur les colonnes. Pour cela, nous utiliserons les crochets simples (<code>[]</code>) en séparant nos deux critères par une virgule (<code>,</code>).</p>
<p>Un premier exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df</code></pre></div>
<pre><code>         sexe age blond
Anna        f  52 FALSE
Mary-Ann    f  31  TRUE
Michael     h  29  TRUE
John        h  35 FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df[<span class="dv">3</span>, <span class="dv">2</span>]</code></pre></div>
<pre><code>[1] 29</code></pre>
<p>Cette première commande indique que nous souhaitons la troisième ligne de la seconde colonne, autrement dit l’âge de Michael. Le même résultat peut être obtenu avec l’indexation par nom, l’indexation par condition, ou un mélange de tout ça.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df[<span class="st">"Michael"</span>, <span class="st">"age"</span>]</code></pre></div>
<pre><code>[1] 29</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df[<span class="kw">c</span>(F, F, T, F), <span class="kw">c</span>(<span class="kw">c</span>(F, T, F))]</code></pre></div>
<pre><code>[1] 29</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df[<span class="dv">3</span>, <span class="st">"age"</span>]</code></pre></div>
<pre><code>[1] 29</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df[<span class="st">"Michael"</span>, <span class="dv">2</span>]</code></pre></div>
<pre><code>[1] 29</code></pre>
<p>Il est également possible de ne préciser qu’un seul critère. Par exemple, si je souhaite les deux premières observations, ou les variables <var>sexe</var> et <var>blond</var> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, ]</code></pre></div>
<pre><code>         sexe age blond
Anna        f  52 FALSE
Mary-Ann    f  31  TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df[, <span class="kw">c</span>(<span class="st">"sexe"</span>, <span class="st">"blond"</span>)]</code></pre></div>
<pre><code>         sexe blond
Anna        f FALSE
Mary-Ann    f  TRUE
Michael     h  TRUE
John        h FALSE</code></pre>
<p>Il a suffit de laisser un espace vide avant ou après la virgule. ATTENTION ! Il est cependant impératif de laisser la virgule pour indiquer à <strong>R</strong> que l’on souhaite effectuer une indexation à deux dimensions. Si l’on oublie la virgule, cela nous ramène au mode de fonctionnement des listes. Et le résultat n’est pas forcément le même :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df[<span class="dv">2</span>, ]</code></pre></div>
<pre><code>         sexe age blond
Mary-Ann    f  31  TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df[, <span class="dv">2</span>]</code></pre></div>
<pre><code>[1] 52 31 29 35</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df[<span class="dv">2</span>]</code></pre></div>
<pre><code>         age
Anna      52
Mary-Ann  31
Michael   29
John      35</code></pre>
<div class="note">
<p>Au passage, on pourra noter quelques subtilités sur le résultat renvoyé.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(df[<span class="dv">2</span>, ])</code></pre></div>
<pre><code>'data.frame':   1 obs. of  3 variables:
 $ sexe : chr "f"
 $ age  : num 31
 $ blond: logi TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(df[, <span class="dv">2</span>])</code></pre></div>
<pre><code> num [1:4] 52 31 29 35</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(df[<span class="dv">2</span>])</code></pre></div>
<pre><code>'data.frame':   4 obs. of  1 variable:
 $ age: num  52 31 29 35</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(df[[<span class="dv">2</span>]])</code></pre></div>
<pre><code> num [1:4] 52 31 29 35</code></pre>
<p><code>df[2, ]</code> signifie que l’on veut toutes les variables pour le second individu. Le résultat est un tableau de données à une ligne et trois colonnes. <code>df[2]</code> correspond au mode d’extraction des listes et renvoie donc une liste à un élément, en l’occurence un tableau de données à quatre observations et une variable. <code>df[[2]]</code> quant à lui renvoie le contenu de cette variable, soit un vecteur numérique de longeur quatre. Reste <code>df[, 2]</code> qui signifie renvoie toutes les observations pour la seconde colonne. Or l’<dfn>indexation bidimensionnelle</dfn> a un fonctionnement un peu particulier : par défaut cela renvoie un tableau de données mais s’il n’y a qu’une seule variable dans l’extraction, c’est un vecteur qui est renvoyé. Pour plus de détails, on pourra consulter l’entrée d’aide de <code data-pkg="base" data-rdoc="Extract.data.frame">[.data.frame</code>.</p>
</div>
</div>
<div id="listes-et-tableaux-de-donnes_afficher-les-donnees" class="section level3">
<h3>Afficher les données</h3>
<p>Prenons un tableau de données un peu plus conséquent, en l’occurence un jeu de données disponible dans l’extension <code class="pkg">questionr</code> et correspondant à un extrait de l’enquête <em>Histoire de vie</em> réalisée par l’INSEE en 2003. Il contient 2000 individus et 20 variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">data</span>(hdv2003)
d &lt;-<span class="st"> </span>hdv2003</code></pre></div>
<p>Si l’on demande à afficher l’objet <code>d</code> dans la console (résultat non reproduit ici), <strong>R</strong> va afficher l’ensemble du contenu de <code>d</code> à l’écran ce qui, sur un tableau de cette taille, ne sera pas très lisible. Pour une exploration visuelle, le plus simple est souvent d’utiliser la <dfn>visionneuse</dfn> intégrée à <strong>RStudio</strong> et que l’on peut appeller avec la fonction <code data-pkg="utils">View</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">View</span>(d)</code></pre></div>
<p>Les fonctions <code data-pkg="utils">head</code> et <code data-pkg="utils" data-rdoc="head">tail</code>, qui marchent également sur les vecteurs, permettent d’afficher seulement les premières (respectivement les dernières) lignes d’un tableau de données :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(d)</code></pre></div>
<pre><code>  id age  sexe
1  1  28 Femme
2  2  23 Femme
3  3  59 Homme
4  4  34 Homme
5  5  71 Femme
6  6  35 Femme
                                               nivetud
1 Enseignement superieur y compris technique superieur
2                                                 &lt;NA&gt;
3                    Derniere annee d'etudes primaires
4 Enseignement superieur y compris technique superieur
5                    Derniere annee d'etudes primaires
6        Enseignement technique ou professionnel court
     poids                 occup     qualif
1 2634.398 Exerce une profession    Employe
2 9738.396       Etudiant, eleve       &lt;NA&gt;
3 3994.102 Exerce une profession Technicien
4 5731.662 Exerce une profession Technicien
5 4329.094              Retraite    Employe
6 8674.699 Exerce une profession    Employe
  freres.soeurs clso                       relig
1             8  Oui Ni croyance ni appartenance
2             2  Oui Ni croyance ni appartenance
3             2  Non Ni croyance ni appartenance
4             1  Non  Appartenance sans pratique
5             0  Oui         Pratiquant regulier
6             5  Non Ni croyance ni appartenance
                      trav.imp    trav.satisf
1                Peu important Insatisfaction
2                         &lt;NA&gt;           &lt;NA&gt;
3 Aussi important que le reste      Equilibre
4 Moins important que le reste   Satisfaction
5                         &lt;NA&gt;           &lt;NA&gt;
6            Le plus important      Equilibre
  hard.rock lecture.bd peche.chasse cuisine
1       Non        Non          Non     Oui
2       Non        Non          Non     Non
3       Non        Non          Non     Non
4       Non        Non          Non     Oui
5       Non        Non          Non     Non
6       Non        Non          Non     Non
  bricol cinema sport heures.tv
1    Non    Non   Non         0
2    Non    Oui   Oui         1
3    Non    Non   Oui         0
4    Oui    Oui   Oui         2
5    Non    Non   Non         3
6    Non    Oui   Oui         2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(d, <span class="dv">2</span>)</code></pre></div>
<pre><code>       id age  sexe
1999 1999  24 Femme
2000 2000  66 Femme
                                           nivetud
1999 Enseignement technique ou professionnel court
2000  Enseignement technique ou professionnel long
         poids                 occup  qualif
1999 13740.810 Exerce une profession Employe
2000  7709.513              Au foyer Employe
     freres.soeurs clso
1999             2  Non
2000             3  Non
                          relig
1999 Appartenance sans pratique
2000 Appartenance sans pratique
                         trav.imp trav.satisf
1999 Moins important que le reste   Equilibre
2000                         &lt;NA&gt;        &lt;NA&gt;
     hard.rock lecture.bd peche.chasse cuisine
1999       Non        Non          Non     Non
2000       Non        Oui          Non     Oui
     bricol cinema sport heures.tv
1999    Non    Oui   Non       0.3
2000    Non    Non   Non       0.0</code></pre>
<p>L’extension <code class="pkg">dplyr</code>, que nous n’aborderons en détails que <a href="#introduction-a-dplyr">plus tard</a>, propose une fonction <code data-pkg="tibble">glimpse</code> (ce qui signifie <q>aperçu</q> en anglais) qui permet de visualiser rapidement et de manière condensée le contenu d’un tableau de données.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">glimpse</span>(d)</code></pre></div>
<pre><code>Observations: 2,000
Variables: 20
$ id            &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8,...
$ age           &lt;int&gt; 28, 23, 59, 34, 71, 35,...
$ sexe          &lt;fctr&gt; Femme, Femme, Homme, H...
$ nivetud       &lt;fctr&gt; Enseignement superieur...
$ poids         &lt;dbl&gt; 2634.3982, 9738.3958, 3...
$ occup         &lt;fctr&gt; Exerce une profession,...
$ qualif        &lt;fctr&gt; Employe, NA, Technicie...
$ freres.soeurs &lt;int&gt; 8, 2, 2, 1, 0, 5, 1, 5,...
$ clso          &lt;fctr&gt; Oui, Oui, Non, Non, Ou...
$ relig         &lt;fctr&gt; Ni croyance ni apparte...
$ trav.imp      &lt;fctr&gt; Peu important, NA, Aus...
$ trav.satisf   &lt;fctr&gt; Insatisfaction, NA, Eq...
$ hard.rock     &lt;fctr&gt; Non, Non, Non, Non, No...
$ lecture.bd    &lt;fctr&gt; Non, Non, Non, Non, No...
$ peche.chasse  &lt;fctr&gt; Non, Non, Non, Non, No...
$ cuisine       &lt;fctr&gt; Oui, Non, Non, Oui, No...
$ bricol        &lt;fctr&gt; Non, Non, Non, Oui, No...
$ cinema        &lt;fctr&gt; Non, Oui, Non, Oui, No...
$ sport         &lt;fctr&gt; Non, Oui, Oui, Oui, No...
$ heures.tv     &lt;dbl&gt; 0.0, 1.0, 0.0, 2.0, 3.0...</code></pre>
<p>L’extension <code class="pkg">questionr</code> propose une fonction <code data-pkg="questionr">lookfor</code> qui permet de lister les différentes variables d’un fichier de données :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lookfor</span>(d)</code></pre></div>
<pre><code>        variable
1             id
2            age
3           sexe
4        nivetud
5          poids
6          occup
7         qualif
8  freres.soeurs
9           clso
10         relig
11      trav.imp
12   trav.satisf
13     hard.rock
14    lecture.bd
15  peche.chasse
16       cuisine
17        bricol
18        cinema
19         sport
20     heures.tv</code></pre>
<p>Lorsque l’on a un gros tableau de données avec de nombreuses variables, il peut être difficile de retrouver la ou les variables d’intérêt. Il est possible d’indiquer à <code data-pkg="questionr">lookfor</code> un mot-clé pour limiter la recherche. Par exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lookfor</span>(d, <span class="st">"trav"</span>)</code></pre></div>
<pre><code>      variable
11    trav.imp
12 trav.satisf</code></pre>
<p>Il est à noter que si la recherche n’est pas sensible à la casse (i.e. aux majuscules et aux minuscules), elle est sensible aux accents.</p>
<p>La méthode <code data-pkg="base">summary</code> qui fonctionne sur tout type d’objet permet d’avoir quelques statistiques de base sur les différentes variables de notre tableau, les statistiques affichées dépendant du type de variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(d)</code></pre></div>
<pre><code>       id              age           sexe     
 Min.   :   1.0   Min.   :18.00   Homme: 899  
 1st Qu.: 500.8   1st Qu.:35.00   Femme:1101  
 Median :1000.5   Median :48.00               
 Mean   :1000.5   Mean   :48.16               
 3rd Qu.:1500.2   3rd Qu.:60.00               
 Max.   :2000.0   Max.   :97.00               
                                              
                                                 nivetud   
 Enseignement technique ou professionnel court       :463  
 Enseignement superieur y compris technique superieur:441  
 Derniere annee d'etudes primaires                   :341  
 1er cycle                                           :204  
 2eme cycle                                          :183  
 (Other)                                             :256  
 NA's                                                :112  
     poids                            occup     
 Min.   :   78.08   Exerce une profession:1049  
 1st Qu.: 2221.82   Chomeur              : 134  
 Median : 4631.19   Etudiant, eleve      :  94  
 Mean   : 5535.61   Retraite             : 392  
 3rd Qu.: 7626.53   Retire des affaires  :  77  
 Max.   :31092.14   Au foyer             : 171  
                    Autre inactif        :  83  
                      qualif    freres.soeurs   
 Employe                 :594   Min.   : 0.000  
 Ouvrier qualifie        :292   1st Qu.: 1.000  
 Cadre                   :260   Median : 2.000  
 Ouvrier specialise      :203   Mean   : 3.283  
 Profession intermediaire:160   3rd Qu.: 5.000  
 (Other)                 :144   Max.   :22.000  
 NA's                    :347                   
          clso     
 Oui        : 936  
 Non        :1037  
 Ne sait pas:  27  
                   
                   
                   
                   
                         relig    
 Pratiquant regulier        :266  
 Pratiquant occasionnel     :442  
 Appartenance sans pratique :760  
 Ni croyance ni appartenance:399  
 Rejet                      : 93  
 NSP ou NVPR                : 40  
                                  
                         trav.imp  
 Le plus important           : 29  
 Aussi important que le reste:259  
 Moins important que le reste:708  
 Peu important               : 52  
 NA's                        :952  
                                   
                                   
         trav.satisf  hard.rock  lecture.bd
 Satisfaction  :480   Non:1986   Non:1953  
 Insatisfaction:117   Oui:  14   Oui:  47  
 Equilibre     :451                        
 NA's          :952                        
                                           
                                           
                                           
 peche.chasse cuisine    bricol     cinema    
 Non:1776     Non:1119   Non:1147   Non:1174  
 Oui: 224     Oui: 881   Oui: 853   Oui: 826  
                                              
                                              
                                              
                                              
                                              
 sport        heures.tv     
 Non:1277   Min.   : 0.000  
 Oui: 723   1st Qu.: 1.000  
            Median : 2.000  
            Mean   : 2.247  
            3rd Qu.: 3.000  
            Max.   :12.000  
            NA's   :5       </code></pre>
<p>On peut également appliquer <code data-pkg="base">summary</code> à une variable particulière.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(d<span class="op">$</span>sexe)</code></pre></div>
<pre><code>Homme Femme 
  899  1101 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(d<span class="op">$</span>age)</code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  18.00   35.00   48.00   48.16   60.00   97.00 </code></pre>
<p>L’extension <code class="pkg">questionr</code> fournit également une fonction bien pratique pour décrire les différentes variables d’un tableau de données. Il s’agit de <code data-pkg="questionr">describe</code>. Faisons de suite un essai :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">describe</span>(d)</code></pre></div>
<pre><code>[2000 obs. x 20 variables] tbl_df tbl data.frame

$id: 
integer: 1 2 3 4 5 6 7 8 9 10 ...
min: 1 - max: 2000 - NAs: 0 (0%) - 2000 unique values

$age: 
integer: 28 23 59 34 71 35 60 47 20 28 ...
min: 18 - max: 97 - NAs: 0 (0%) - 78 unique values

$sexe: 
nominal factor: "Femme" "Femme" "Homme" "Homme" "Femme" "Femme" "Femme" "Homme" "Femme" "Homme" ...
2 levels: Homme | Femme
NAs: 0 (0%)

$nivetud: 
nominal factor: "Enseignement superieur y compris technique superieur" NA "Derniere annee d'etudes primaires" "Enseignement superieur y compris technique superieur" "Derniere annee d'etudes primaires" "Enseignement technique ou professionnel court" "Derniere annee d'etudes primaires" "Enseignement technique ou professionnel court" NA "Enseignement technique ou professionnel long" ...
8 levels: N'a jamais fait d'etudes | A arrete ses etudes, avant la derniere annee d'etudes primaires | Derniere annee d'etudes primaires | 1er cycle | 2eme cycle | Enseignement technique ou professionnel court | Enseignement technique ou professionnel long | Enseignement superieur y compris technique superieur
NAs: 112 (0.1%)

$poids: 
numeric: 2634.3982157 9738.3957759 3994.1024587 5731.6615081 4329.0940022 8674.6993828 6165.8034861 12891.640759 7808.8720636 2277.160471 ...
min: 78.0783403 - max: 31092.14132 - NAs: 0 (0%) - 1877 unique values

$occup: 
nominal factor: "Exerce une profession" "Etudiant, eleve" "Exerce une profession" "Exerce une profession" "Retraite" "Exerce une profession" "Au foyer" "Exerce une profession" "Etudiant, eleve" "Exerce une profession" ...
7 levels: Exerce une profession | Chomeur | Etudiant, eleve | Retraite | Retire des affaires | Au foyer | Autre inactif
NAs: 0 (0%)

$qualif: 
nominal factor: "Employe" NA "Technicien" "Technicien" "Employe" "Employe" "Ouvrier qualifie" "Ouvrier qualifie" NA "Autre" ...
7 levels: Ouvrier specialise | Ouvrier qualifie | Technicien | Profession intermediaire | Cadre | Employe | Autre
NAs: 347 (0.2%)

$freres.soeurs: 
integer: 8 2 2 1 0 5 1 5 4 2 ...
min: 0 - max: 22 - NAs: 0 (0%) - 19 unique values

$clso: 
nominal factor: "Oui" "Oui" "Non" "Non" "Oui" "Non" "Oui" "Non" "Oui" "Non" ...
3 levels: Oui | Non | Ne sait pas
NAs: 0 (0%)

$relig: 
nominal factor: "Ni croyance ni appartenance" "Ni croyance ni appartenance" "Ni croyance ni appartenance" "Appartenance sans pratique" "Pratiquant regulier" "Ni croyance ni appartenance" "Appartenance sans pratique" "Ni croyance ni appartenance" "Appartenance sans pratique" "Pratiquant occasionnel" ...
6 levels: Pratiquant regulier | Pratiquant occasionnel | Appartenance sans pratique | Ni croyance ni appartenance | Rejet | NSP ou NVPR
NAs: 0 (0%)

$trav.imp: 
nominal factor: "Peu important" NA "Aussi important que le reste" "Moins important que le reste" NA "Le plus important" NA "Peu important" NA "Moins important que le reste" ...
4 levels: Le plus important | Aussi important que le reste | Moins important que le reste | Peu important
NAs: 952 (0.5%)

$trav.satisf: 
nominal factor: "Insatisfaction" NA "Equilibre" "Satisfaction" NA "Equilibre" NA "Insatisfaction" NA "Satisfaction" ...
3 levels: Satisfaction | Insatisfaction | Equilibre
NAs: 952 (0.5%)

$hard.rock: 
nominal factor: "Non" "Non" "Non" "Non" "Non" "Non" "Non" "Non" "Non" "Non" ...
2 levels: Non | Oui
NAs: 0 (0%)

$lecture.bd: 
nominal factor: "Non" "Non" "Non" "Non" "Non" "Non" "Non" "Non" "Non" "Non" ...
2 levels: Non | Oui
NAs: 0 (0%)

$peche.chasse: 
nominal factor: "Non" "Non" "Non" "Non" "Non" "Non" "Oui" "Oui" "Non" "Non" ...
2 levels: Non | Oui
NAs: 0 (0%)

$cuisine: 
nominal factor: "Oui" "Non" "Non" "Oui" "Non" "Non" "Oui" "Oui" "Non" "Non" ...
2 levels: Non | Oui
NAs: 0 (0%)

$bricol: 
nominal factor: "Non" "Non" "Non" "Oui" "Non" "Non" "Non" "Oui" "Non" "Non" ...
2 levels: Non | Oui
NAs: 0 (0%)

$cinema: 
nominal factor: "Non" "Oui" "Non" "Oui" "Non" "Oui" "Non" "Non" "Oui" "Oui" ...
2 levels: Non | Oui
NAs: 0 (0%)

$sport: 
nominal factor: "Non" "Oui" "Oui" "Oui" "Non" "Oui" "Non" "Non" "Non" "Oui" ...
2 levels: Non | Oui
NAs: 0 (0%)

$heures.tv: 
numeric: 0 1 0 2 3 2 2.9 1 2 2 ...
min: 0 - max: 12 - NAs: 5 (0%) - 30 unique values</code></pre>
<p>Comme on le voit sur cet exemple, <code data-pkg="questionr">describe</code> nous affiche le type des variables, les premières valeurs de chacune, le nombre de valeurs manquantes, le nombre de valeurs différentes (uniques) ainsi que quelques autres informations suivant le type de variables.</p>
<p>Il est possible de restreindre l’affichage à seulement quelques variables en indiquant le nom de ces dernières.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">describe</span>(d, <span class="st">"age"</span>, <span class="st">"trav.satisf"</span>)</code></pre></div>
<pre><code>[2000 obs. x 20 variables] tbl_df tbl data.frame

$age: 
integer: 28 23 59 34 71 35 60 47 20 28 ...
min: 18 - max: 97 - NAs: 0 (0%) - 78 unique values

$trav.satisf: 
nominal factor: "Insatisfaction" NA "Equilibre" "Satisfaction" NA "Equilibre" NA "Insatisfaction" NA "Satisfaction" ...
3 levels: Satisfaction | Insatisfaction | Equilibre
NAs: 952 (0.5%)</code></pre>
<p>On peut également transmettre juste une variable :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">describe</span>(d<span class="op">$</span>sexe)</code></pre></div>
<pre><code>Warning in table(labelled::to_factor(x, levels),
exclude = exclude, useNA = "ifany"): 'exclude'
containing NA and 'useNA' != "no"' are a bit
contradicting</code></pre>
<pre><code>[2000 obs.] 
nominal factor: "Femme" "Femme" "Homme" "Homme" "Femme" "Femme" "Femme" "Homme" "Femme" "Homme" ...
2 levels: Homme | Femme
NAs: 0 (0%)

         n   %
Homme  899  45
Femme 1101  55
Total 2000 100</code></pre>
</div>
</div>
<div id="listes-et-tableaux-de-donnes_en-resume" class="section level2">
<h2>En résumé</h2>
<p><strong>Les Listes</strong></p>
<ul>
<li>Les listes sont des objets unidimensionnels pouvant contenir tout type d’objet, y compris d’autres listes.</li>
<li>Elles ont une longueur que l’obtient avec <code data-pkg="base">length</code>.</li>
<li>On créé une liste avec <code data-pkg="base">list</code> et on peut fusionner des listes avec <code data-pkg="base">append</code>.</li>
<li>Tout comme les vecteurs, les listes peuvent être nommées et les noms des éléments s’obtiennent avec <code data-pkg="base">names</code>.</li>
<li>Les crochets simples (<code>[]</code>) permettent de sélectionner les éléments d’une liste, en utilisant l’indexation par position, l’indexation par nom ou l’indexation par condition. Cela renvoie toujours une autre liste.</li>
<li>Les doubles crochets (<code>[[]]</code>) renvoient directement le contenu d’un élément de la liste que l’on aura sélectionné par position ou par nom.</li>
<li>Le symbole <code>$</code> est un raccourci pour facilement sélectionner un élément par son nom, <code>liste$nom</code> étant équivalent à <code>liste[["nom"]]</code>.</li>
</ul>
<p><strong>Les Tableaux de données</strong></p>
<ul>
<li>Les tableaux de données sont des listes avec des propriétés particulières :
<ol style="list-style-type: lower-roman">
<li>tous les éléments sont des vecteurs ;</li>
<li>tous les vecteurs ont la même longueur ;</li>
<li>tous les vecteurs ont un nom et ce nom est unique.</li>
</ol>
</li>
<li>On peut créer un tableau de données avec <code data-pkg="base">data.frame</code>.</li>
<li>Les tableaux de données correspondent aux fichiers de données que l’on utilise usuellement dans d’autres logiciels de statistiques : les variables sont représentées en colonnes et les observations en lignes.</li>
<li>Ce sont des objets bidimensionnels : <code data-pkg="base" data-rdoc="nrow">ncol</code> renvoit le nombre de colonnes et <code data-pkg="base">nrow</code> le nombre de lignes.</li>
<li>Les doubles crochets (<code>[[]]</code>) et le symbole dollar (<code>$</code>) fonctionnent comme pour les listes et permettent d’accéder aux variables.</li>
<li>Il est possible d’utiliser des coordonnées bidimensionnelles avec les crochets simples (<code>[]</code>) en indiquant un critère sur les lignes puis un critère sur les colonnes, séparés par une virgule (<code>,</code>).</li>
</ul>
</div>

</article>
<article id="facteurs-et-vecteurs-labellises"><div class="fluid-row" id="facteurs-et-vecteurs-labellises_header">



<h1 class="title toc-ignore">Facteurs et vecteurs labellisés</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#facteurs-et-vecteurs-labellises_facteurs">Facteurs</a></li>
<li>
<a href="#facteurs-et-vecteurs-labellises_labelled">Vecteurs labellisés</a><ul>
<li><a href="#facteurs-et-vecteurs-labellises_les-etiquettes-de-variable">Les étiquettes de variable</a></li>
<li><a href="#facteurs-et-vecteurs-labellises_les-etiquettes-de-valeur">Les étiquettes de valeur</a></li>
<li><a href="#facteurs-et-vecteurs-labellises_assignation-et-condition">Assignation et condition</a></li>
<li><a href="#facteurs-et-vecteurs-labellises_quelques-fonctions-supplementaires">Quelques fonctions supplémentaires</a></li>
</ul>
</li>
</ul>
</div>

<p>Dans le chapire sur les <a href="#vecteurs-indexation-et-assignation">vecteurs</a>, nous avons abordé les types fondementaux de vecteurs (numériques, textuels, logiques). Mais il existe de nombreux autres classes de vecteurs afin de représenter des données diverses (comme les dates). Dans ce chapitre, nous nous intéressons plus particulièrement aux <dfn data-index="variable catégorielle">variables catégorielles</dfn><dfn data-index="catégorielle, variable"></dfn>.</p>
<p>Les <dfn data-index="facteur">facteurs</dfn> (ou <dfn data-index="factor" lang="en">factors</dfn> an anglais) sont un type de vecteur géré nativement par <strong>R</strong> et utilisés dans de nombreux domaines (modèles statistiques, représentations graphiques, …).</p>
<p>Les facteurs sont souvent mis en regard des <dfn data-index="donnée labelissée">données labellisées</dfn><dfn data-index="labellisée, donnée"></dfn><dfn data-index="labelled data"></dfn> telles qu’elles sont utilisées dans d’autres logiciels comme <strong>SPSS</strong> ou <strong>Stata</strong>. Or, les limites propres aux facteurs font qu’ils ne sont pas adpatés pour rendre compte des différents usages qui sont fait des données labellisées. Plusieurs extensions (telles que <code class="pkg">memisc</code> ou <code class="pkg">Hmisc</code>) ont proposé leur propre solution qui, bien qu’elles apportaient un plus pour la gestion des données labellisées, ne permettaient pas que celles-ci soient utilisées en dehors de ces extensions ou des extensions compatibles. Nous aborderons ici une nouvelle classe de vecteurs, la classe <code data-pkg="labelled">labelled</code>, introduite par l’extension <code class="pkg">haven</code> (que nous aborderons dans le cadre de l’<a href="#import-de-donnees">import de données</a>) et qui peut être manipulée avec l’extension homonyme <code class="pkg">labelled</code>.</p>
<div id="facteurs-et-vecteurs-labellises_facteurs" class="section level2">
<h2>Facteurs</h2>
<p>Dans ce qui suit on travaillera sur le jeu de données tiré de l’enquête <em>Histoire de vie</em>, fourni avec l’extension <code class="pkg">questionr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">data</span>(hdv2003)
d &lt;-<span class="st"> </span>hdv2003</code></pre></div>
<p>Jetons un œil à la liste des variables de <code>d</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(d)</code></pre></div>
<pre><code>'data.frame':   2000 obs. of  20 variables:
 $ id           : int  1 2 3 4 5 6 7 8 9 10 ...
 $ age          : int  28 23 59 34 71 35 60 47 20 28 ...
 $ sexe         : Factor w/ 2 levels "Homme","Femme": 2 2 1 1 2 2 2 1 2 1 ...
 $ nivetud      : Factor w/ 8 levels "N'a jamais fait d'etudes",..: 8 NA 3 8 3 6 3 6 NA 7 ...
 $ poids        : num  2634 9738 3994 5732 4329 ...
 $ occup        : Factor w/ 7 levels "Exerce une profession",..: 1 3 1 1 4 1 6 1 3 1 ...
 $ qualif       : Factor w/ 7 levels "Ouvrier specialise",..: 6 NA 3 3 6 6 2 2 NA 7 ...
 $ freres.soeurs: int  8 2 2 1 0 5 1 5 4 2 ...
 $ clso         : Factor w/ 3 levels "Oui","Non","Ne sait pas": 1 1 2 2 1 2 1 2 1 2 ...
 $ relig        : Factor w/ 6 levels "Pratiquant regulier",..: 4 4 4 3 1 4 3 4 3 2 ...
 $ trav.imp     : Factor w/ 4 levels "Le plus important",..: 4 NA 2 3 NA 1 NA 4 NA 3 ...
 $ trav.satisf  : Factor w/ 3 levels "Satisfaction",..: 2 NA 3 1 NA 3 NA 2 NA 1 ...
 $ hard.rock    : Factor w/ 2 levels "Non","Oui": 1 1 1 1 1 1 1 1 1 1 ...
 $ lecture.bd   : Factor w/ 2 levels "Non","Oui": 1 1 1 1 1 1 1 1 1 1 ...
 $ peche.chasse : Factor w/ 2 levels "Non","Oui": 1 1 1 1 1 1 2 2 1 1 ...
 $ cuisine      : Factor w/ 2 levels "Non","Oui": 2 1 1 2 1 1 2 2 1 1 ...
 $ bricol       : Factor w/ 2 levels "Non","Oui": 1 1 1 2 1 1 1 2 1 1 ...
 $ cinema       : Factor w/ 2 levels "Non","Oui": 1 2 1 2 1 2 1 1 2 2 ...
 $ sport        : Factor w/ 2 levels "Non","Oui": 1 2 2 2 1 2 1 1 1 2 ...
 $ heures.tv    : num  0 1 0 2 3 2 2.9 1 2 2 ...</code></pre>
<p>Nous voyons que de nombreuses variables de ce tableau de données, telles que <var>sexe</var> ou <var>nivetud</var>, sont du type facteur.</p>
<p>Les facteurs prennent leurs valeurs dans un ensemble de modalités prédéfinies et ne peuvent en prendre d’autres. La liste des valeurs possibles est donnée par la fonction <code data-pkg="base">levels</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(d<span class="op">$</span>sexe)</code></pre></div>
<pre><code>[1] "Homme" "Femme"</code></pre>
<p>Si on veut modifier la valeur du sexe du premier individu de notre tableau de données avec une valeur non autorisée, on obient un message d’erreur et une valeur manquante est utilisée à la place :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>sexe[<span class="dv">1</span>] &lt;-<span class="st"> "Chihuahua"</span></code></pre></div>
<pre><code>Warning in `[&lt;-.factor`(`*tmp*`, 1, value =
structure(c(NA, 2L, 1L, 1L, : invalid factor
level, NA generated</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>sexe[<span class="dv">1</span>]</code></pre></div>
<pre><code>[1] &lt;NA&gt;
Levels: Homme Femme</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>sexe[<span class="dv">1</span>] &lt;-<span class="st"> "Homme"</span>
d<span class="op">$</span>sexe[<span class="dv">1</span>]</code></pre></div>
<pre><code>[1] Homme
Levels: Homme Femme</code></pre>
<p>On peut très facilement créer un facteur à partir d’une variable textuelle avec la fonction <code data-pkg="base">factor</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">"H"</span>, <span class="st">"H"</span>, <span class="st">"F"</span>, <span class="st">"H"</span>))
v</code></pre></div>
<pre><code>[1] H H F H
Levels: F H</code></pre>
<p>Par défaut, les niveaux d’un facteur nouvellement créés sont l’ensemble des valeurs de la variable textuelle, ordonnées par ordre alphabétique. Cette ordre des niveaux est utilisé à chaque fois qu’on utilise des fonctions comme <code data-pkg="base">table</code>, par exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(v)</code></pre></div>
<pre><code>v
F H 
1 3 </code></pre>
<p>On peut modifier cet ordre au moment de la création du facteur en utilisant l’option <code>levels</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">"H"</span>, <span class="st">"H"</span>, <span class="st">"F"</span>, <span class="st">"H"</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">"H"</span>, 
  <span class="st">"F"</span>))
<span class="kw">table</span>(v)</code></pre></div>
<pre><code>v
H F 
3 1 </code></pre>
<p>On peut aussi modifier l’ordre des niveaux d’une variable déjà existante :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>qualif &lt;-<span class="st"> </span><span class="kw">factor</span>(d<span class="op">$</span>qualif, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">"Ouvrier specialise"</span>, 
  <span class="st">"Ouvrier qualifie"</span>, <span class="st">"Employe"</span>, <span class="st">"Technicien"</span>, <span class="st">"Profession intermediaire"</span>, 
  <span class="st">"Cadre"</span>, <span class="st">"Autre"</span>))
<span class="kw">table</span>(d<span class="op">$</span>qualif)</code></pre></div>
<pre><code>
      Ouvrier specialise         Ouvrier qualifie 
                     203                      292 
                 Employe               Technicien 
                     594                       86 
Profession intermediaire                    Cadre 
                     160                      260 
                   Autre 
                      58 </code></pre>
<div class="note">
<p>L’extension <code class="pkg">questionr</code> propose une <em>interface interactive</em> pour le réordonnancement des niveaux d’un facteur. Cette fonction, nommée <code data-pkg="questionr">iorder</code>, vous permet de réordonner les modalités de manière graphique et de générer le code <strong>R</strong> correspondant.</p>
<p>Dans l’exemple précédant, si vous exécutez :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">iorder</span>(d, <span class="st">"qualif"</span>)</code></pre></div>
<p><strong>RStudio</strong> devrait ouvrir une fenêtre semblable à celle de la figure ci-dessous.</p>
<div class="figure">
<img src="images/capture_iorder.png" alt="Interface de la commande iorder"><p class="caption">Interface de la commande iorder</p>
</div>
<p>Vous pouvez alors déplacer les modalités par glisser-déposer, vérifier le résultat dans l’onglet <em>Vérification</em> et, une fois le résultat satisfaisant, récupérer le code généré pour l’inclure dans votre script.</p>
</div>
<p>On peut également modifier les niveaux eux-mêmes. Imaginons que l’on souhaite créer une nouvelle variable <em>qualif.abr</em> contenant les noms abrégés des catégories socioprofessionnelles de <em>qualif</em>. On peut alors procéder comme suit :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>qualif.abr &lt;-<span class="st"> </span><span class="kw">factor</span>(d<span class="op">$</span>qualif, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">"Ouvrier specialise"</span>, 
  <span class="st">"Ouvrier qualifie"</span>, <span class="st">"Employe"</span>, <span class="st">"Technicien"</span>, <span class="st">"Profession intermediaire"</span>, 
  <span class="st">"Cadre"</span>, <span class="st">"Autre"</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"OS"</span>, <span class="st">"OQ"</span>, <span class="st">"Empl"</span>, 
  <span class="st">"Tech"</span>, <span class="st">"Interm"</span>, <span class="st">"Cadre"</span>, <span class="st">"Autre"</span>))
<span class="kw">table</span>(d<span class="op">$</span>qualif.abr)</code></pre></div>
<pre><code>
    OS     OQ   Empl   Tech Interm  Cadre  Autre 
   203    292    594     86    160    260     58 </code></pre>
<p>Dans ce qui précède, le paramètre <code>levels</code> de <code data-pkg="base">factor</code> permet de spécifier quels sont les niveaux retenus dans le facteur résultat, ainsi que leur ordre. Le paramètre <code>labels</code>, lui, permet de modifier les noms de ces niveaux dans le facteur résultat. Il est donc capital d’indiquer les noms de <code>labels</code> exactement dans le même ordre que les niveaux de <code>levels</code>. Pour s’assurer de ne pas avoir commis d’erreur, il est recommandé d’effectuer un tableau croisé entre l’ancien et le nouveau facteur :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(d<span class="op">$</span>qualif, d<span class="op">$</span>qualif.abr)</code></pre></div>
<pre><code>                          
                            OS  OQ Empl Tech
  Ouvrier specialise       203   0    0    0
  Ouvrier qualifie           0 292    0    0
  Employe                    0   0  594    0
  Technicien                 0   0    0   86
  Profession intermediaire   0   0    0    0
  Cadre                      0   0    0    0
  Autre                      0   0    0    0
                          
                           Interm Cadre Autre
  Ouvrier specialise            0     0     0
  Ouvrier qualifie              0     0     0
  Employe                       0     0     0
  Technicien                    0     0     0
  Profession intermediaire    160     0     0
  Cadre                         0   260     0
  Autre                         0     0    58</code></pre>
<p>On a donc ici un premier moyen d’effectuer un recodage des modalités d’une variable de type facteur. D’autres méthodes existent, que nous aborderons dans le chapitre <a href="#recodage">Recodage</a>.</p>
<p>À noter que par défaut, les valeurs manquantes ne sont pas considérées comme un niveau de facteur. On peut cependant les transformer en niveau en utilisant la fonction <code data-pkg="base" data-rdoc="factor">addNA</code>. Ceci signifie cependant qu’elle ne seront plus considérées comme manquantes par <strong>R</strong> mais comme une modalité à part entière :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(d<span class="op">$</span>trav.satisf)</code></pre></div>
<pre><code>  Satisfaction Insatisfaction      Equilibre 
           480            117            451 
          NA's 
           952 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(<span class="kw">addNA</span>(d<span class="op">$</span>trav.satisf))</code></pre></div>
<pre><code>  Satisfaction Insatisfaction      Equilibre 
           480            117            451 
          &lt;NA&gt; 
           952 </code></pre>
<p>La fonction <code data-pkg="questionr">addNAstr</code> de l’extension <code class="pkg">questionr</code> fait la même chose mais permet de spécifier l’étiquette de la modalité des valeurs manquantes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">summary</span>(<span class="kw">addNAstr</span>(d<span class="op">$</span>trav.satisf, <span class="st">"Manquant"</span>))</code></pre></div>
<pre><code>  Satisfaction Insatisfaction      Equilibre 
           480            117            451 
      Manquant 
           952 </code></pre>
</div>
<div id="facteurs-et-vecteurs-labellises_labelled" class="section level2">
<h2>Vecteurs labellisés</h2>
<p><dfn data-index="vecteur labellisé"></dfn><dfn data-index="labellisé, vecteur"></dfn>Nous abordons ici une nouvelle classe de vecteurs, la classe <code data-pkg="labelled">labelled</code>, introduite récemment par l’extension <code class="pkg">haven</code> (que nous aborderons dans le cadre de l’<a href="#import-de-donnees">import de données</a>) et qui peut être manipulée avec l’extension homonyme <code class="pkg">labelled</code>.</p>
<p>Pour cette section, nous allons utiliser d’autres données d’exemple, également disponibles dans l’extension <code class="pkg">questionr</code>. Il s’agit d’un ensemble de trois tableaux de données (<code>menages</code>, <code>femmes</code> et <code>enfants</code>) contenant les données d’une enquête de fécondité. Commençons par les charger en mémoire :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">data</span>(fecondite)</code></pre></div>
<p>Pour ailleurs, nous allons avoir besoin de l’extension <code class="pkg">labelled</code> qui permet de manipuler ces données labellisées.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(labelled)</code></pre></div>
<div id="facteurs-et-vecteurs-labellises_les-etiquettes-de-variable" class="section level3">
<h3>Les étiquettes de variable</h3>
<p>Les <dfn data-index="étiquette de variable">étiquettes de variable</dfn><dfn data-index="variable, étiquette"></dfn> permettent de donner un nom long, plus explicite, aux différentes colonnes d’un tableau de données (ou encore directement à un vecteur autonome).</p>
<p>La visonneuse de données de <strong>RStudio</strong> sait reconnaître et afficher ces étiquettes de variable lorsqu’elles existent. Essayez par exemple la commande suivante :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">View</span>(femmes)</code></pre></div>
<p>Les fonctions <code data-pkg="questionr">lookfor</code> et <code data-pkg="questionr">describe</code> de l’extension <code class="pkg">questionr</code> affichent également les étiquettes de variables lorsqu’elles existent.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lookfor</span>(femmes, <span class="st">"rés"</span>)</code></pre></div>
<pre><code>  variable               label
7   milieu Milieu de résidence
8   region Région de résidence</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">describe</span>(femmes<span class="op">$</span>id_femme)</code></pre></div>
<pre><code>[2000 obs.] Identifiant de l'enquêtée
numeric: 391 1643 85 881 1981 1072 1978 1607 738 1656 ...
min: 1 - max: 2000 - NAs: 0 (0%) - 2000 unique values</code></pre>
<p>Pour manipuler les étiquettes de variable, il suffit d’utiliser la fonction <code data-pkg="labelled">var_label</code> de l’extension <code class="pkg">labelled</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var_label</span>(femmes<span class="op">$</span>id_menage)</code></pre></div>
<pre><code>[1] "Identifiant du ménage"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var_label</span>(femmes<span class="op">$</span>id_menage) &lt;-<span class="st"> "ID du ménage auquel elle appartient"</span>
<span class="kw">var_label</span>(femmes<span class="op">$</span>id_menage)</code></pre></div>
<pre><code>[1] "ID du ménage auquel elle appartient"</code></pre>
<p>On utilisera la valeur <code>NULL</code> pour supprimer une étiquette :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>)
<span class="kw">var_label</span>(v)</code></pre></div>
<pre><code>NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var_label</span>(v) &lt;-<span class="st"> "Ma variable"</span>
<span class="kw">var_label</span>(v)</code></pre></div>
<pre><code>[1] "Ma variable"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var_label</span>(v) &lt;-<span class="st"> </span><span class="ot">NULL</span>
<span class="kw">var_label</span>(v)</code></pre></div>
<pre><code>NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var_label</span>(v) &lt;-<span class="st"> "Une autre étiquette"</span>
<span class="kw">var_label</span>(v)</code></pre></div>
<pre><code>[1] "Une autre étiquette"</code></pre>
<p>Le fait d’ajouter une étiquette à un vecteur ne modifie en rien son type. Regardons la structure de notre objet <code>v</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(v)</code></pre></div>
<pre><code> atomic [1:5] 1 5 2 4 1
 - attr(*, "label")= chr "Une autre étiquette"</code></pre>
<p>Que voit-on ? Notre vecteur possède maintenant ce qu’on appelle un <dfn>attribut</dfn>, c’est-à-dire une information supplémentaire qui lui est attachée. Un objet peut avoir plusieurs attributs. Ici, notre étiquette de variable est strocké dans un attribut nommé <code>"label"</code>. Cela ne modifie en rien sa nature. Il ne s’agit que d’information en plus. Toutes les fonctions ne tiennent pas compte des étiquettes de variable. Peu importe ! La présence d’un attribut ne les empêchera de fonctionner. De même, même si l’extension <code class="pkg">labelled</code> n’est pas installée sur votre machine, vous pourrez toujours manipuler vos données comme si de rien n’était.</p>
<p>On peut associer une étiquette de variable à n’importe quel type de variable, qu’elle soit numérique, textuelle, un facteur ou encore des dates.</p>
</div>
<div id="facteurs-et-vecteurs-labellises_les-etiquettes-de-valeur" class="section level3">
<h3>Les étiquettes de valeur</h3>
<p>Les <dfn data-index="étiquette de valeur">étiquettes de valeur</dfn><dfn data-index="valeur, étiquette"></dfn> consistent à attribuer une étiquette textuelle à certaines valeurs d’un vecteur. Elles ne peuvent s’appliquer qu’aux vecteurs numériques ou textuels.</p>
<p>Lorsqu’un vecteur possède des étiquettes de valeur, sa classe change et devient <code data-pkg="labelled">labelled</code>. Regardons déjà quelques exemples. Tout d’abord, jetons un apercu au contenu de l’objet <code>femmes</code> grace à la fonction <code data-pkg="dplyr">glimpse</code> de l’extension <code class="pkg">dplyr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">glimpse</span>(femmes)</code></pre></div>
<pre><code>Observations: 2,000
Variables: 17
$ id_femme       &lt;dbl&gt; 391, 1643, 85, 881, 19...
$ id_menage      &lt;dbl&gt; 381, 1515, 85, 844, 17...
$ poids          &lt;dbl&gt; 1.803150, 1.803150, 1....
$ date_entretien &lt;date&gt; 2012-05-05, 2012-01-2...
$ date_naissance &lt;date&gt; 1997-03-07, 1982-01-0...
$ age            &lt;dbl&gt; 15, 30, 33, 43, 25, 18...
$ milieu         &lt;dbl+lbl&gt; 2, 2, 2, 2, 2, 2, ...
$ region         &lt;dbl+lbl&gt; 4, 4, 4, 4, 4, 3, ...
$ educ           &lt;dbl+lbl&gt; 0, 0, 0, 0, 1, 0, ...
$ travail        &lt;dbl+lbl&gt; 1, 1, 0, 1, 1, 0, ...
$ matri          &lt;dbl+lbl&gt; 0, 2, 2, 2, 1, 0, ...
$ religion       &lt;dbl+lbl&gt; 1, 3, 2, 3, 2, 2, ...
$ journal        &lt;dbl+lbl&gt; 0, 0, 0, 0, 0, 0, ...
$ radio          &lt;dbl+lbl&gt; 0, 1, 1, 0, 0, 1, ...
$ tv             &lt;dbl+lbl&gt; 0, 0, 0, 0, 0, 1, ...
$ nb_enf_ideal   &lt;dbl+lbl&gt; 4, 4, 4, 4, 4, 5, ...
$ test           &lt;dbl+lbl&gt; 0, 9, 0, 0, 1, 0, ...</code></pre>
<p>Il apparaît que la variable <var>region est de type <code data-pkg="labelled">labelled</code>. On peut le confirmer avec <code data-pkg="base">class</code>.</var></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(femmes<span class="op">$</span>region)</code></pre></div>
<pre><code>[1] "labelled"</code></pre>
<p>Regardons les premières valeurs prises par cette variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(femmes<span class="op">$</span>region)</code></pre></div>
<pre><code>&lt;Labelled double&gt;
[1] 4 4 4 4 4 3

Labels:
 value label
     1  Nord
     2   Est
     3   Sud
     4 Ouest</code></pre>
<p>Nous voyons que quatre étiquettes de valeurs ont été associées à notre variable. Le code 1 correspond ainsi à la région <q>Nord</q>, le code 2 à la région <q>Est</q>, etc. Laissons de côté pour le moment la colonne <code>is_na</code> que nous aborderons dans une prochaine section.</p>
<p>La liste des étiquettes est également renvoyée par la fonction <code data-pkg="questionr">describe</code> de <code class="pkg">questionr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">describe</span>(femmes<span class="op">$</span>region)</code></pre></div>
<pre><code>Warning in table(labelled::to_factor(x, levels),
exclude = exclude, useNA = "ifany"): 'exclude'
containing NA and 'useNA' != "no"' are a bit
contradicting</code></pre>
<pre><code>[2000 obs.] Région de résidence
labelled double: 4 4 4 4 4 3 3 3 3 3 ...
min: 1 - max: 4 - NAs: 0 (0%) - 4 unique values
4 value labels: [1] Nord [2] Est [3] Sud [4] Ouest

             n     %
[1] Nord   707  35.4
[2] Est    324  16.2
[3] Sud    407  20.3
[4] Ouest  562  28.1
Total     2000 100.0</code></pre>
<p>L’extension <code class="pkg">labelled</code> fournit la fonction <code data-pkg="labelled">val_labels</code> qui renvoie la liste des étiquettes de valeurs d’une variable sous la forme d’un vecteur nommé et la fonction <code data-pkg="labelled" data-rdoc="val_labels">val_label</code> (notez l’absence de ‘s’) qui renvoie l’étiquette associée à une valeur particulière. S’il n’y a pas d’étiquette de valeur, ces fonctions renvoient <code>NULL</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">val_labels</span>(femmes<span class="op">$</span>region)</code></pre></div>
<pre><code> Nord   Est   Sud Ouest 
    1     2     3     4 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">val_label</span>(femmes<span class="op">$</span>region, <span class="dv">2</span>)</code></pre></div>
<pre><code>[1] "Est"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">val_label</span>(femmes<span class="op">$</span>region, <span class="dv">6</span>)</code></pre></div>
<pre><code>NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">val_labels</span>(femmes<span class="op">$</span>age)</code></pre></div>
<pre><code>NULL</code></pre>
<p>Re-regardons d’un peu plus près les premières valeurs de notre variable <var>region</var>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(femmes<span class="op">$</span>region)</code></pre></div>
<pre><code>&lt;Labelled double&gt;
[1] 4 4 4 4 4 3

Labels:
 value label
     1  Nord
     2   Est
     3   Sud
     4 Ouest</code></pre>
<p>On s’aperçoit qu’il s’agit de valeurs numériques. Et l’affichage indique que notre variable est plus précisément du type <code>labelled double</code>. Pour rappel, <code>double</code> est synonyme de <code>numeric</code>. Autrement dit, la classe <code data-pkg="labelled">labelled</code> ne modifie pas le type sous-jacent d’un vecteur, que l’on peut toujours obtenir avec la fonction <code data-pkg="base">typeof</code>. Nous pouvons également tester si notre variable est numérique avec la fonction <code data-pkg="base" data-rdoc="numeric">is.numeric</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">typeof</span>(femmes<span class="op">$</span>region)</code></pre></div>
<pre><code>[1] "double"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.numeric</span>(femmes<span class="op">$</span>region)</code></pre></div>
<pre><code>[1] TRUE</code></pre>
<p>À la différence des facteurs, le type original d’une variable labellisée n’est pas modifié par la présence d’étiquettes de valeur. Ainsi, il reste possible de calculer une moyenne à partir de notre variable <var>region</var> (même si cela n’est pas pertinent ici d’un point de vue sémantique).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(femmes<span class="op">$</span>region)</code></pre></div>
<pre><code>[1] 2.412</code></pre>
<p>Avec un facteur, nous aurions eu un bon message d’erreur.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(d<span class="op">$</span>nivetud)</code></pre></div>
<pre><code>Warning in mean.default(d$nivetud): argument is
not numeric or logical: returning NA</code></pre>
<pre><code>[1] NA</code></pre>
<p>Nous allons voir qu’il est aussi possible d’associer des étiquettes de valeurs à des vecteurs textuels. Créons tout d’abord un vecteur textuel qui nous servira d’exemple.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"f"</span>, <span class="st">"f"</span>, <span class="st">"h"</span>, <span class="st">"f"</span>, <span class="st">"h"</span>)
v</code></pre></div>
<pre><code>[1] "f" "f" "h" "f" "h"</code></pre>
<p>Le plus facile pour lui associer des étiquettes de valeur est d’utiliser <code data-pkg="labelled" data-rdoc="val_labels">val_label</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">val_label</span>(v, <span class="st">"f"</span>) &lt;-<span class="st"> "femmes"</span>
<span class="kw">val_label</span>(v, <span class="st">"h"</span>) &lt;-<span class="st"> "hommes"</span>
v</code></pre></div>
<pre><code>&lt;Labelled character&gt;
[1] f f h f h

Labels:
 value  label
     f femmes
     h hommes</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">typeof</span>(v)</code></pre></div>
<pre><code>[1] "character"</code></pre>
<p>Notre vecteur <code>v</code> a automatiquement été transformé en un vecteur de la classe <code>labelled</code>. Mais son type sous-jacent est resté <code>"character"</code>. Par ailleurs, les données elle-même n’ont pas été modifiées et ont conservé leurs valeurs originales.</p>
<p>Il est également possible de définir/modifier/supprimer l’ensemble des étiquettes de valeur d’une variable avec <code data-pkg="labelled">val_labels</code> en lui assignant un vecteur nommé.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">val_labels</span>(v) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">Homme =</span> <span class="st">"h"</span>, <span class="dt">Femme =</span> <span class="st">"f"</span>, <span class="st">`</span><span class="dt">Valeur indéterminée</span><span class="st">`</span> =<span class="st"> "i"</span>)
v</code></pre></div>
<pre><code>&lt;Labelled character&gt;
[1] f f h f h

Labels:
 value               label
     h               Homme
     f               Femme
     i Valeur indéterminée</code></pre>
<p>Comme précédemment, on utilisera <code>NULL</code> pour supprimer une ou toutes les étiquettes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">val_label</span>(v, <span class="st">"i"</span>) &lt;-<span class="st"> </span><span class="ot">NULL</span>
v</code></pre></div>
<pre><code>&lt;Labelled character&gt;
[1] f f h f h

Labels:
 value label
     h Homme
     f Femme</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">val_labels</span>(v) &lt;-<span class="st"> </span><span class="ot">NULL</span>
v</code></pre></div>
<pre><code>[1] "f" "f" "h" "f" "h"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(v)</code></pre></div>
<pre><code>[1] "character"</code></pre>
<p>Si l’on supprime toutes les étiquettes de valeur, alors notre vecteur retrouve sa classe initiale.</p>
</div>
<div id="facteurs-et-vecteurs-labellises_assignation-et-condition" class="section level3">
<h3>Assignation et condition</h3>
<p>Les étiquettes de valeur sont plus souples que les facteurs, en ce sens qu’il n’est pas obligatoire d’indiquer une étiquette pour chaque valeur prise par une variable. Alors qu’il n’est pas possible avec un facteur d’assigner une valeur qui n’a pas été préalablement définie comme une des modalités possibles du facteur, nous n’avons pas cette limite avec les vecteurs labellisés.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">femmes<span class="op">$</span>region[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">5</span></code></pre></div>
<p>Important : quand on assigne une valeur à un facteur, on doit transmettre le texte correspondant à la modalité, alors que pour un vecteur labellisé on transmettra le code sous-jacent (pour rappel, les étiquettes de valeur ne sont qu’une information additionnelle).</p>
<p>De plus, nous avons vu que les données initiales n’étaient pas modifiées par l’ajout ou la suppression d’étiquettes de valeur, alors que pour les facteurs ce n’est pas vrai. Pour mieux comprendre, essayons la commande suivante :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unclass</span>(<span class="kw">factor</span>(v))</code></pre></div>
<pre><code>[1] 1 1 2 1 2
attr(,"levels")
[1] "f" "h"</code></pre>
<p>Un facteur stocke de manière interne les valeurs sous la forme d’une suite d’entiers, démarrant toujours par 1, forcément consécutifs, et dont les valeurs dépendent de l’ordre des facteurs. Pour s’en rendre compte :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unclass</span>(<span class="kw">factor</span>(v, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">"h"</span>, <span class="st">"f"</span>)))</code></pre></div>
<pre><code>[1] 2 2 1 2 1
attr(,"levels")
[1] "h" "f"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unclass</span>(<span class="kw">factor</span>(v, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">"f"</span>, <span class="st">"h"</span>)))</code></pre></div>
<pre><code>[1] 1 1 2 1 2
attr(,"levels")
[1] "f" "h"</code></pre>
<p>Ce qui importe pour un facteur ce sont les modalités de ce dernier tandis que pour un vecteur labellisé ce sont les valeurs du vecteur elles-mêmes. Cela reste vrai pour l’écriture de conditions.</p>
<p>Prenons un premier exemple avec un facteur :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">describe</span>(d<span class="op">$</span>sexe)</code></pre></div>
<pre><code>Warning in table(labelled::to_factor(x, levels),
exclude = exclude, useNA = "ifany"): 'exclude'
containing NA and 'useNA' != "no"' are a bit
contradicting</code></pre>
<pre><code>[2000 obs.] 
nominal factor: "Homme" "Femme" "Homme" "Homme" "Femme" "Femme" "Femme" "Homme" "Femme" "Homme" ...
2 levels: Homme | Femme
NAs: 0 (0%)

         n   %
Homme  900  45
Femme 1100  55
Total 2000 100</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(d<span class="op">$</span>sexe <span class="op">==</span><span class="st"> "Homme"</span>)</code></pre></div>
<pre><code>
FALSE  TRUE 
 1100   900 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(d<span class="op">$</span>sexe <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</code></pre></div>
<pre><code>
FALSE 
 2000 </code></pre>
<p>La condition valide est celle utilisant <code>"Homme"</code> qui est la valeur de la modalité du facteur.</p>
<p>Et avec un vecteur labellisé ?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">describe</span>(femmes<span class="op">$</span>milieu)</code></pre></div>
<pre><code>Warning in table(labelled::to_factor(x, levels),
exclude = exclude, useNA = "ifany"): 'exclude'
containing NA and 'useNA' != "no"' are a bit
contradicting</code></pre>
<pre><code>[2000 obs.] Milieu de résidence
labelled double: 2 2 2 2 2 2 2 2 2 2 ...
min: 1 - max: 2 - NAs: 0 (0%) - 2 unique values
2 value labels: [1] urbain [2] rural

              n     %
[1] urbain  912  45.6
[2] rural  1088  54.4
Total      2000 100.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(femmes<span class="op">$</span>milieu <span class="op">==</span><span class="st"> "urbain"</span>)</code></pre></div>
<pre><code>
FALSE 
 2000 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(femmes<span class="op">$</span>milieu <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</code></pre></div>
<pre><code>
FALSE  TRUE 
 1088   912 </code></pre>
<p>Ici, pour être valide, la condition doit porter sur les valeurs de la variable elle-même et non sur les étiquette.</p>
</div>
<div id="facteurs-et-vecteurs-labellises_quelques-fonctions-supplementaires" class="section level3">
<h3>Quelques fonctions supplémentaires</h3>
<p>L’extension <code class="pkg">labelled</code> fournit quelques fonctions supplémentaires qui peuvent s’avérer utiles :</p>
<ul>
<li>
<code data-pkg="labelled">labelled</code> pour créer directement des vecteurs labellisés ;</li>
<li>
<code data-pkg="labelled">nolabel_to_na</code> pour convertir les valeurs n’ayant pas d’étiquette en <code>NA</code> ;</li>
<li>
<code data-pkg="labelled">val_labels_to_na</code> qui, à l’inverse, converti les valeurs avec étiquette en <code>NA</code> ;</li>
<li>
<code data-pkg="labelled">sort_val_labels</code> pour trier l’ordre des étiquettes de valeurs.</li>
</ul>
<p>On pourra se réferrer à l’aide de chacune de ces fonctions.</p>
<p>L’<a href="#import-de-donnees">import de données labellisées</a> et le <a href="#recodage">recodage de variables</a> (dont la conversion d’un vecteur labellisé en facteur) seront quant à eux abordés dans les prochains chapitres.</p>
</div>
</div>

</article>
<article id="organiser-ses-fichiers"><div class="fluid-row" id="organiser-ses-fichiers_header">



<h1 class="title toc-ignore">Organiser ses fichiers</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#organiser-ses-fichiers_le-repertoire-de-travail">Le répertoire de travail</a></li>
<li>
<a href="#organiser-ses-fichiers_les-projets-dans-rstudio">Les projets dans RStudio</a><ul>
<li><a href="#organiser-ses-fichiers_creer-un-nouveau-projet">Créer un nouveau projet</a></li>
<li><a href="#organiser-ses-fichiers_fonctionnement-par-defaut-des-projets">Fonctionnement par défaut des projets</a></li>
<li><a href="#organiser-ses-fichiers_options-des-projets">Options des projets</a></li>
<li><a href="#organiser-ses-fichiers_naviguer-dun-projet-a-un-autre">Naviguer d’un projet à un autre</a></li>
<li><a href="#organiser-ses-fichiers_voir-aussi">Voir aussi</a></li>
</ul>
</li>
<li><a href="#organiser-ses-fichiers_appeler-un-script-depuis-un-autre-script">Appeler un script depuis un autre script</a></li>
</ul>
</div>

<div id="organiser-ses-fichiers_le-repertoire-de-travail" class="section level2">
<h2>Le répertoire de travail</h2>
<p>À chaque fois que l’on demandera à <strong>R</strong> de charger ou d’enregistrer un fichier (en particulier lorsque l’on cherchera à importer des données, voir le <a href="#import-de-donnees">chapitre dédié</a>), <strong>R</strong> évaluera le nom du fichier qu’on lui a transmis par rapport au <dfn>répertoire de travail</dfn> actuellement défini, qui correspond au répertoire dans lequel <strong>R</strong> est actuellement en train de s’exécuter.</p>
<p>Pour connaître de le répertoire de travail actuel, on pourra utiliser la fonction <code data-pkg="base">getwd</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">getwd</span>()</code></pre></div>
<p>Lorsque l’on travaille sous <strong>RStudio</strong>, le répertoire de travail est également affiché dans le quadrant inférieur droit, en gris, à la droite du mot <em>Console</em> (voir la capture d’écran ci-après).</p>
<figure><img src="images/capture_RStudio_workingdir.png" alt="Affichage du répertoire de travail sous RStudio"><figcaption>
Affichage du répertoire de travail sous RStudio
</figcaption></figure><p>Le symbole <code>~</code> correspond dans ce cas-là au répertoire utilisateur système, dont l’emplacement dépend du système d’exploitation. Sous <strong>Windows</strong>, il s’agit du répertoire <em>Mes documents</em> ou <em>Documents</em> (le nom varie suivant la version de <strong>Windows</strong>).</p>
<p>Le répertoire de travail peut être modifié avec la fonction <code data-pkg="base" data-rdoc="getwd">setwd</code> ou, sous <strong>RStudio</strong>, via le menu <em>Session &gt; Set Working Directory</em>. Cependant, nous allons voir que nous n’aurons en pratique presque jamais besoin de le faire si l’on travaille avec <strong>RStudio</strong>.</p>
</div>
<div id="organiser-ses-fichiers_les-projets-dans-rstudio" class="section level2">
<h2>Les projets dans RStudio</h2>
<p><strong>RStudio</strong> dispose d’une fonctionnalité très pratique pour organiser son travail en différents <dfn date-inedx="projet, RStudio">projets</dfn>.</p>
<p>L’idée principale est de réunir tous les fichiers / documents relatifs à un même projet (que ce soit les données, les scripts, les rapports automatisés…) dans un répertoire dédié<a href="#organiser-ses-fichiers_fn1" class="footnoteRef" id="organiser-ses-fichiers_fnref1"><sup>1</sup></a>.</p>
<p>Le menu <em>Projects</em> est accessible via une icône dédiée située tout en haut à droite (voir la capture d’écran ci-après).</p>
<figure><img src="images/capture_RStudio_icone_projet.png" alt="Accès au menu Projects sous RStudio"><figcaption>
Accès au menu Projects sous RStudio
</figcaption></figure><div id="organiser-ses-fichiers_creer-un-nouveau-projet" class="section level3">
<h3>Créer un nouveau projet</h3>
<p>Dans le menu <em>Projects</em> on sélectionnera l’option <em>New project</em>. <strong>RStudio</strong> nous demandera dans un premier temps si l’on souhaite créer un projet (i) dans un nouveau répertoire, (ii) dans un répertoire déjà existant ou bien (iii) à partir d’un <dfn>gestionnaire de versions</dfn> (<strong>Git</strong> ou <strong>SVN</strong>).</p>
<figure><img src="images/capture_RStudio_nouveau_projet.png" alt="Options de création de projet sous RStudio"><figcaption>
Options de création de projet sous RStudio
</figcaption></figure><p>Si vous débutez avec <strong>R</strong>, laissez de côté pour le moment les gestionnaires de versions qui sont destinés aux utilisateurs avancés (et présentés dans le chapitre <a href="#git">Git</a>). Dans le cadre d’un usage courant, on aura recours à <em>New Directory</em>.</p>
<p><strong>RStudio</strong> nous demande alors le type de projet que l’on souhaite créer : (i) un projet vide, (ii) une extension <strong>R</strong> ou (iii) une application <strong>Shiny</strong>.</p>
<figure><img src="images/capture_RStudio_types_projet.png" alt="Les différents types de projet sous RStudio"><figcaption>
Les différents types de projet sous RStudio
</figcaption></figure><p>Il est encore un peu tôt pour se lancer dans la création de sa propre extension pour <strong>R</strong> (voir le chapitre <a href="#developper-un-package">Développer un package</a>). Les applications <strong>Shiny</strong> (voir le <a href="#shiny-les-interfaces-interactives">chapitre dédié</a>) sont des applications webs interactives. Là encore, on attendra une meilleure maîtrise de <strong>R</strong> pour se lancer dans ce type de projets. Dans un contexte d’analyse d’enquêtes, on choisira dès lors <em>Empty project</em>.</p>
<figure><img src="images/capture_RStudio_create_new_project.png" alt="Création d’un projet dans un nouveau répertoire avec RStudio"><figcaption>
Création d’un projet dans un nouveau répertoire avec RStudio
</figcaption></figure><p>En premier lieu, on indiquera le nom de notre projet, qui sera également le nom du répertoire qui sera créé pour stocker les données du projet. Puis, on indiquera le répertoire parent, c’est-à-dire le répertoire dans lequel le répertoire de notre projet sera créé.</p>
<p>Les deux options suivantes concernent que les utilisateurs avancés. <strong>RStudio</strong> nous demande s’il on veut activer <strong>Git</strong> sur ce projet (<strong>Git</strong> étant un gestionnaire de versions, l’option n’étant affichée que si <strong>Git</strong> est installé sur votre PC) et s’il on souhaite utiliser l’extension <code class="pkg">packrat</code> sur ce projet. <code class="pkg">packrat</code> permet une gestion des extensions utilisées, projet par projet, ce qui n’est vraiment utile que dans le cadre d’analyses bien spécifiques.</p>
<p>Il ne nous reste plus qu’à cliquer sur <em>Create Project</em>.</p>
</div>
<div id="organiser-ses-fichiers_fonctionnement-par-defaut-des-projets" class="section level3">
<h3>Fonctionnement par défaut des projets</h3>
<p>Lorsque l’on ouvre un projet, <strong>RStudio</strong> effectue différentes actions :</p>
<ul>
<li>le nom du projet est affiché en haut à droite à côté de l’icône projets ;</li>
<li>une nouvelle session <strong>R</strong> est exécutée (ainsi s’il on passe d’un projet à un autre, les objets du projet qu’on vient de fermer ne sont plus en mémoire) ;</li>
<li>le répertoire de travail de <strong>R</strong> est défini comme étant le répertoire du projet (d’où le fait que l’on n’a pas à se préoccuper de définir le répertoire de travail lorsque l’on travaille avec des projets <strong>RStudio</strong>) ;</li>
<li>les objets créés (et sauvegardés dans le fichier <code>.Rdata</code>) lors d’une précédente séance de travail sont chargés en mémoire ;</li>
<li>l’historique des commandes saisies lors de nos précédentes séances de travail sont chargées dans l’onglet <em>History</em> ;</li>
<li>les scripts ouverts lors d’une précédente séance de travail sont automatiquement ouverts ;</li>
<li>divers paramètres de <strong>RStudio</strong> sont restaurés dans l’état dans lequel ils étaient la dernière fois que l’on a travaillé sur ce projet.</li>
</ul>
<p>Autrement dit, lorsque l’on ouvre un projet <strong>RStudio</strong>, on revient à l’état de notre projet tel qu’il était la dernière fois que l’on a travaillé dessus. Pratique, non ?</p>
<p>Petite précision toutefois, les extensions que l’on avait chargées en mémoire avec la fonction <code data-pkg="base">library</code> ne sont pas systématiquement rechargées en mémoire. Il faudra donc les appeler à nouveau lors de notre séance de travail.</p>
</div>
<div id="organiser-ses-fichiers_options-des-projets" class="section level3">
<h3>Options des projets</h3>
<p>Via le menu <em>Projects &gt; Projects options</em> (accessible via l’icône projets en haut à droite), il est possible de personnaliser plusieurs options spécifiquement pour ce projet.</p>
<p>On retiendra surtout les 3 options principales de l’onglet <em>General</em> :</p>
<ul>
<li>à l’ouverture du projet, doit-on charger en mémoire les objets sauvegardés lors d’une précédente séance de travail ?</li>
<li>à la fermeture du projet, doit-son sauvegarder (dans le fichier <code>.Rdata</code>) les différents objets en mémoire ? Si l’on choisit l’option <em>Ask</em>, alors une fenêtre vous demandera s’il faut faire cette sauvegarde chaque fois que vous fermerez le projet.</li>
<li>à la fermeture du projet, faut-il sauver l’historique des commandes ?</li>
</ul>
</div>
<div id="organiser-ses-fichiers_naviguer-dun-projet-a-un-autre" class="section level3">
<h3>Naviguer d’un projet à un autre</h3>
<p><strong>RStudio</strong> se souvient des derniers projets sur lesquels vous avez travaillé. Lorsque vous cliquez sur le menu projets, vous verrez une liste de ces différents projets. Il suffit de cliquer sur le nom du projet désiré pour fermer automatiquement le projet en cours et ouvrir le projet désiré.</p>
<p>Votre projet n’apparait pas dans la liste ? Pas de panique. Il suffit de sélectionner <em>Open project</em> puis de parcourir vos répertoires pour indiquer à <strong>RStudio</strong> le projet à ouvrir.</p>
<p>Vous pouvez noter au passage une option <em>Open project in new window</em> qui permet d’ouvrir un projet dans une nouvelle fenêtre. En effet, il est tout à fait possible d’avoir plusieurs projets ouverts en même temps. Dans ce cas là, chaque projet aura sa propre session <strong>R</strong>. Les objets chargés en mémoire pour le projet A ne seront pas accessibles dans le cadre du projet B et inversement.</p>
</div>
<div id="organiser-ses-fichiers_voir-aussi" class="section level3">
<h3>Voir aussi</h3>
<p>On pourra se référer à la documentation officielle de <strong>RStudio</strong> : <a href="https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects" class="uri">https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects</a>.</p>
</div>
</div>
<div id="organiser-ses-fichiers_appeler-un-script-depuis-un-autre-script" class="section level2">
<h2>Appeler un script depuis un autre script</h2>
<p>Au sein d’un même projet, on peut avoir plusieurs <dfn data-index="script">scripts <strong>R</strong></dfn>. Cela permet de mieux organiser son code. Par exemple, on pourra avoir un premier script chargé d’importer les données, un second dédié à la création de nouvelles variables et un troisième dédié aux analyses statistiques.</p>
<p>Il est possible d’appeler un script au sein d’un autre script à l’aide de la fonction <code data-pkg="base">source</code> à laquelle on précisera le nom de fichier du script en question.</p>
<p>Supposons par exemple que l’on ait préparé un script <code>preparation.R</code> chargé d’importer les données et de les mettre en forme. Au debut de notre script <code>analyses.R</code>, on pourra indiquer :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">"preparation.R"</span>)</code></pre></div>
<p>Si l’on exécute notre script <code>analyses.R</code>, au moment de l’appel à <code>source("preparation.R")</code>, le fichier <code>preparation.R</code> sera chargé en mémoire et exécuté, puis le programme continuera avec les commandes suivant du fichier <code>analyses.R</code>.</p>
<p>Ici, on a indiqué à <code data-pkg="base">source</code> le fichier <code>preparation.R</code> sans mention de répertoire. Dès lors, <strong>R</strong> va aller chercher ce fichier dans le répertoire de travail. Sur un gros projet, on peut être amené à organiser ses fichiers en plusieurs sous-répertoires pour une meilleure lisibilité. Dès lors, il faudra indiquer le <dfn>chemin relatif</dfn> pour accéder à un fichier, c’est-à-dire le chemin à partir du répertoire de travail. Supposons que notre fichier <code>preparation.R</code> est enregistré dans un sous-répertoire <code>import</code>. Dans ce cas-là, on appelera notre fichier ainsi :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">"import/preparation.R"</span>)</code></pre></div>
<div class="note">
<p>On remarquera qu’on a utilisé une barre oblique ou <em>slash</em> (<code>/</code>) entre le nom du répertoire et le nom du fichier, ce qui est l’usage courant sous <strong>Linux</strong> et <strong>Mac OS X</strong>, tandis que sous <strong>Windows</strong> on utilise d’ordinaire une barre oblique inversée ou <em>antislash</em> (<code>\</code>). Sous <strong>R</strong>, on utilisera toujours la barre oblique simple (<code>/</code>), <strong>R</strong> sachant « retrouver ses petits » selon le système d’exploitation.</p>
<p>Par ailleurs, l’<dfn>autocomplétion</dfn> de <strong>RStudio</strong> fonctionne aussi pour les noms de fichiers. Essayez par exemple d’appuyer sur la touche <kbd>Tab</kbd> après avoir taper les premières lettres du nom de votre fichier.</p>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="organiser-ses-fichiers_fn1"><p>Dans lequel il sera possible de créer des sous-répertoires.<a href="#organiser-ses-fichiers_fnref1"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="import-de-donnees"><div class="fluid-row" id="import-de-donnees_header">



<h1 class="title toc-ignore">Import de données</h1>

</div>

<div class="TOC">
<ul>
<li>
<a href="#import-de-donnees_importer-des-fichiers-texte">Importer des fichiers texte</a><ul>
<li><a href="#import-de-donnees_structure-dun-fichier-texte">Structure d’un fichier texte</a></li>
<li><a href="#import-de-donnees_interface-graphique-avec-rstudio">Interface graphique avec RStudio</a></li>
<li><a href="#import-de-donnees_dans-un-script">Dans un script</a></li>
</ul>
</li>
<li>
<a href="#import-de-donnees_importer-depuis-des-logiciels-de-statistique">Importer depuis des logiciels de statistique</a><ul>
<li><a href="#import-de-donnees_spss">SPSS</a></li>
<li><a href="#import-de-donnees_sas">SAS</a></li>
<li><a href="#import-de-donnees_stata">Stata</a></li>
<li><a href="#import-de-donnees_excel">Excel</a></li>
<li><a href="#import-de-donnees_dbase">dBase</a></li>
</ul>
</li>
<li>
<a href="#import-de-donnees_donnees-spatiales">Données spatiales</a><ul>
<li><a href="#import-de-donnees_shapefile">Shapefile</a></li>
<li><a href="#import-de-donnees_rasters">Rasters</a></li>
</ul>
</li>
<li><a href="#import-de-donnees_autres-sources">Autres sources</a></li>
<li><a href="#import-de-donnees_sauver-ses-donnees">Sauver ses données</a></li>
</ul>
</div>

<p><dfn data-index="données, exporter"></dfn><dfn data-index="exporter des données"></dfn></p>
<div class="important">
<p>Importer des données est souvent l’une des première opérations que l’on effectue lorsque l’on débute sous <strong>R</strong>, et ce n’est pas la moins compliquée. En cas de problème il ne faut donc pas hésiter à demander de l’aide par les différents moyens disponibles (voir le chapitre <a href="#ou-trouver-de-l-aide">Où trouver de l’aide ?</a>) avant de se décourager.</p>
<p>N’hésitez donc pas à relire régulièrement ce chapitre en fonction de vos besoins.</p>
<p>Avant toute chose, il est impératif de bien organiser ses différents fichiers (voir le <a href="#organiser-ses-fichiers">chapitre dédié</a>). Concernant les données sources que l’on utilisera pour ses analyses, je vous recommande de les placer dans un sous-répertoire dédié de votre projet.</p>
<p>Lorsque l’on importe des données, il est également impératif de vérifier que l’import s’est correctement déroulé (voir la section <a href="#premier-travail-avec-les-donnees_inspecter">Inspecter les données</a> du chapitre <em>Premier travail avec les données</em>).</p>
</div>
<div id="import-de-donnees_importer-des-fichiers-texte" class="section level2">
<h2>Importer des fichiers texte</h2>
<p>Les <dfn data-index="fichier texte">fichiers texte</dfn><dfn data-index="texte, fichier"></dfn> constituent un des formats les plus largement supportés par la majorité des logiciels statistiques. Presque tous permettent d’exporter des données dans un format texte, y compris les tableurs comme <strong>Libre Office</strong>, <strong>Open Office</strong> ou <strong>Excel</strong>.</p>
<p>Cependant, il existe une grande variétés de format texte, qui peuvent prendre différents noms selon les outils, tels que <dfn data-index="texte tabulé, fichier">texte tabulé</dfn> ou <em>texte (séparateur : tabulation)</em>, <strong><dfn data-index="CSV, fichier">CSV</dfn></strong> <dfn data-index="fichier CSV"></dfn> (pour <em>comma-separated value</em>, sachant que suivant les logiciels le séparateur peut être une virgule ou un point-virgule).</p>
<div id="import-de-donnees_structure-dun-fichier-texte" class="section level3">
<h3>Structure d’un fichier texte</h3>
<p>Dès lors, avant d’importer un fichier texte dans <strong>R</strong>, il est indispensable de regarder comment ce dernier est structuré. Il importe de prendre note des éléments suivants :</p>
<ul>
<li>La première ligne contient-elle le nom des variables ? Ici c’est le cas.</li>
<li>Quel est le caractère séparateur entre les différentes variables (encore appelé <dfn>séparateur de champs</dfn>) ? Dans le cadre d’un fichier <strong>CSV</strong>, il aurait pu s’agir d’une virgule ou d’un point-virgule.</li>
<li>Quel est le caractère utilisé pour indiquer les décimales (le <dfn>séparateur décimal</dfn>) ? Il s’agit en général d’un point (à l’anglo-saxonne) ou d’une virgule (à la française).</li>
<li>Les valeurs textuelles sont-elles encadrées par des guillemets et, si oui, s’agit-il de guillements simple (<code>'</code>) ou de guillemets doubles (<code>"</code>) ?</li>
<li>Pour les variables textuelles, y a-t-il des <dfn data-index="valeur manquante">valeurs manquantes</dfn> <dfn data-index="manquante, valeur"></dfn> et si oui comment sont-elles indiquées ? Par exemple, le texte <code>NA</code> est parfois utilisé.</li>
</ul>
<p>Il ne faut pas hésitez à ouvrir le fichier avec un éditeur de texte pour le regarder de plus près.</p>
</div>
<div id="import-de-donnees_interface-graphique-avec-rstudio" class="section level3">
<h3>Interface graphique avec RStudio</h3>
<p><strong>RStudio</strong> fournit une interface graphique pour faciliter l’import d’un fichier texte. Pour cela, il suffit d’aller dans le menu <em>File &gt; Import Dataset</em> et de choisir l’option <em>From CSV</em><a href="#import-de-donnees_fn1" class="footnoteRef" id="import-de-donnees_fnref1"><sup>1</sup></a>. Cette option est également disponible via l’onglet <em>Environment</em> dans le quadrant haut-droite.</p>
<p>Pour la suite de la démonstration, nous allons utiliser le ficheir exemple <a href="http://larmarange.github.io/analyse-R/data/exemple_texte_tabule.txt" class="uri">http://larmarange.github.io/analyse-R/data/exemple_texte_tabule.txt</a>.</p>
<figure><img src="images/capture_RStudio_import_dataset.png" alt="Importer un fichier texte avec RStudio"><figcaption>
Importer un fichier texte avec RStudio
</figcaption></figure><p>L’interface de <strong>RStudio</strong> vous présente sous <em>Import Options</em> les différentes options d’import disponible. La section <em>Data Preview</em> vous permet de voir en temps réel comment les données sont importées. La section <em>Code Preview</em> vous indique le code <strong>R</strong> correspondant à vos choix. Il n’y a plus qu’à le copier/coller dans un de vos scripts ou à cliquer sur <strong>Import</strong> pour l’exécuter.</p>
<p>Vous pourrez remarquer que <strong>RStudio</strong> fait appel à l’extension <code class="pkg">readr</code> du <dfn>tidyverse</dfn> pour l’import des données via la fonction <code data-pkg="readr" data-rdoc="read_delim">read_csv</code>.</p>
<p><code class="pkg">readr</code> essaie de deviner le type de chacune des colonnes, en se basant sur les premières observations. En cliquant sur le nom d’une colonne, il est possible de modifier le type de la variable importée. Il est également possible d’exclure une colonne de l’import (<em>skip</em>).</p>
</div>
<div id="import-de-donnees_dans-un-script" class="section level3">
<h3>Dans un script</h3>
<p>L’interface graphique de <strong>RStudio</strong> fournit le code d’import. On peut également l’adapter à ces besoins en consultant la page d’aide de <code data-pkg="readr" data-rdoc="read_delim">read_csv</code> pour plus de détails. Par exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)
d &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">"http://larmarange.github.io/analyse-R/data/exemple_texte_tabule.txt"</span>, 
  <span class="dt">delim =</span> <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>, <span class="dt">quote =</span> <span class="st">"'"</span>)</code></pre></div>
<pre><code>Parsed with column specification:
cols(
  Sexe = col_character(),
  Age = col_integer(),
  Taille = col_number(),
  Etudes = col_character()
)</code></pre>
<p>Le premier élément peut être un lien internet ou bien le chemin local vers un fichier. Afin d’organiser au mieux vos fichiers, voir le chapitre <a href="#organiser-ses-fichiers">Organiser ses fichiers</a>.</p>
<div class="note">
<p>Certains caractères sont parfois précédés d’une barre oblique inversée ou <em>antislash</em> (<code>\</code>). Cela correspond à des caractères spéciaux. En effet, <code>"</code> est utilisé pour délimiter dans le code le début et la fin d’une chaîne de caractères. Comment indiquer à <strong>R</strong> le caractère <code>"</code> proprement dit. Et bien avec <code>\"</code>. De même, <code>\t</code> sera interprété comme une tabulation et non comme la lettre <code>t</code>.</p>
<p>Pour une liste complète des caractères spéciaux, voir <code>?Quotes</code>.</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(d)</code></pre></div>
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d</code></pre></div>
<pre><code># A tibble: 7 × 4
   Sexe   Age Taille     Etudes
  &lt;chr&gt; &lt;int&gt;  &lt;dbl&gt;      &lt;chr&gt;
1     F    45    167   primaire
2     H    32    183       &lt;NA&gt;
3     H    24    172  supérieur
4     F    36    164 secondaire
5     F    23    154  supérieur
6     H    18    162   primaire
7     F    34    168 secondaire</code></pre>
<p>L’objet renvoyé est un tableau de données ou <dfn lang="en">data.frame</dfn>. Plus précisément, il s’agit d’un <dfn lang="en">tibble</dfn>, c’est-à-dire un tableau de données légèrement amélioré facilement utilisable avec les différentes extensions du <dfn>tidyverse</dfn>. Pas de panique, c’est un tableau de données comme les autres. Disons qu’il est possible de faire un peu plus de choses avec. Pour cela, voir le chapitre <a href="#introduction-a-dplyr">Introduction à dplyr</a>.</p>
<p><code class="pkg">readr</code> propose plusieurs fonctions proches : <code data-pkg="readr" data-rdoc="read_delim">read_delim</code>, <code data-pkg="readr" data-rdoc="read_delim">read_csv</code>, <code data-pkg="readr" data-rdoc="read_delim">read_csv2</code> et <code data-pkg="readr" data-rdoc="read_delim">read_tsv</code>. Elles fonctionnent toutes de manière identique et ont les mêmes arguments. Seule différence, les valeurs par défaut de certainsparamètres.</p>
<div class="note">
<p>Dans des manuels ou des exemples en ligne, vous trouverez parfois mention des fonctions <code data-pkg="utils" data-rdoc="read.table">read.table</code>, <code data-pkg="utils" data-rdoc="read.table">read.csv</code>, <code data-pkg="utils" data-rdoc="read.table">read.csv2</code>, <code data-pkg="utils" data-rdoc="read.table">read.delim</code> ou encore <code data-pkg="utils" data-rdoc="read.table">read.delim2</code>. Il s’agit des fonctions natives et historiques de <strong>R</strong> (extension <code class="pkg">utils</code>) dédiées à l’import de fichiers textes. Elles sont similaires à celles de <code class="pkg">readr</code> dans l’idée générale mais diffèrent dans leurs détails et les traitements effectués sur les données (pas de détection des dates par exemple). Pour plus d’information, vous pouvez vous référer à la page d’aide de ces fonctions.</p>
</div>
</div>
</div>
<div id="import-de-donnees_importer-depuis-des-logiciels-de-statistique" class="section level2">
<h2>Importer depuis des logiciels de statistique</h2>
<p>Plusieurs extensions existent pour importer des fichiers de données issus d’autres logiciels de statistiques. En premier lieu, il y a <code class="pkg">foreign</code>, installée par défaut avec <strong>R</strong> et décrite en détails dans le manuel <cite>R Data Import/Export</cite> disponible sur <a href="http://cran.r-project.org/manuals.html" class="uri">http://cran.r-project.org/manuals.html</a>. Un des soucis majeurs de cette extension réside dans la manière dont elle traite les <dfn data-index="métadonnée">métadonnées</dfn> utilisées en particulier dans les fichiers <strong>SAS</strong>, <strong>SPSS</strong> et <strong>Stata</strong>, à savoir les <dfn data-index="étiquette de variable">étiquettes de variable</dfn><dfn data-index="variable, étiquette"></dfn>, les <dfn data-index="étiquette de valeur">étiquettes de valeur</dfn><dfn data-index="valeur, étiquette"></dfn> et les <dfn data-index="valeur manquante déclarée">valeurs manquantes déclarées</dfn><dfn data-index="manquante, valeur"></dfn>. En effet, chaque fonction va importer ces métadonnées sous la forme d’<dfn data-index="attribut">attributs</dfn> dont le nom diffère d’une fonction à l’autre. Par ailleurs, selon les options retenues, les <dfn data-index="variable labellisée">variables labellisées</dfn><dfn data-index="labellisée, variable"></dfn> seront parfois transformées ou non en <dfn data-index="facteur">facteurs</dfn>. Enfin, <code class="pkg">foreign</code> ne sait pas toujours importer les différents types de variables représentant des dates et des heures.</p>
<p>L’extension <code class="pkg">haven</code> (qui fait partie du <q lang="en">tidyverse</q>) tente de remédier à plusieurs des limitations rencontrées avec <code class="pkg">foreign</code> :</p>
<ul>
<li>le format des métadonnées importé est uniforme, quel que soit le type de fichier source (<strong>SAS</strong>, <strong>SPSS</strong> ou <strong>Stata</strong>) ;</li>
<li>les variables labellisées ne sont pas transformées en facteurs, mais héritent d’une nouvelle classe <code data-pkg="haven">labelled</code>, la valeur initiale restant inchangée ;</li>
<li>les différents formats de date sont convertis dans des classes <strong>R</strong> appropriées, utilisables en particulier avec <code class="pkg">lubridate</code> ;</li>
<li>
<code class="pkg">haven</code> peut lire les fichiers <strong>SAS natifs</strong> (extension <code>.sas7bdat</code>) ce que ne peut pas faire <code class="pkg">foreign</code> ;</li>
<li>
<code class="pkg">haven</code> peut lire les fichiers <strong>Stata</strong> 13 et 14, alors que <code class="pkg">foreign</code> ne sait lire ces fichiers que jusqu’à la version 12 ;</li>
<li>les tableaux de données produits ont directement la classe <code data-pkg="dplyr">tbl_df</code> ce qui permets d’utiliser directement les fonctionnalités de l’extension <code class="pkg">dplyr</code>.</li>
</ul>
<p>À noter, il est également possible d’utiliser l’interface graphique de <strong>RStudio</strong> pour l’import des fichiers <strong>SPSS</strong>, <strong>Stata</strong>, <strong>SAS</strong> et <strong>Excel</strong>.</p>
<div class="important">
<p><strong>Données labellisées</strong></p>
<p>À la différence de <code class="pkg">foreign</code>, <code class="pkg">haven</code> ne convertit pas les variables avec des étiquettes de valeurs en <dfn data-index="facteur">facteurs</dfn> mais en <dfn data-index="vecteur labellisé">vecteurs labellisés</dfn><dfn data-index="labellisé, vecteur"></dfn> du type <code data-pkg="haven">labelled</code> qui sont présentés en détail dans le chapitre <a href="#facteurs-et-vecteurs-labellises_labelled">Facteurs et vecteurs labellisés</a>.</p>
</div>
<div id="import-de-donnees_spss" class="section level3">
<h3>SPSS</h3>
<p>Les fichiers générés par <strong>SPSS</strong><dfn data-index="SPSS, fichier"></dfn> sont de deux types : les fichiers <strong>SPSS natifs</strong> natifs (extension <code>.sav</code>) et les fichiers au format <strong>SPSS export</strong> (extension <code>.por</code>).</p>
<p>Dans les deux cas, on aura recours à la fonction <code data-pkg="haven">read_spss</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(haven)
donnees &lt;-<span class="st"> </span><span class="kw">read_spss</span>(<span class="st">"data/fichier.sav"</span>)</code></pre></div>
<div class="important">
<p><strong>Gestion des valeurs manquantes</strong></p>
<p>Dans <strong>SPSS</strong>, il est possible de définir des valeurs à considérées comme manquantes. Plus précisément jusqu’à 3 valeurs spécfiques et/ou les valeurs comprises entre un minimum et un maximum. Par défaut, <code data-pkg="haven">read_spss</code> convertir toutes ces valeurs en <code>NA</code> lors de l’import.</p>
<p>Or, il est parfois important de garder les différentes valeurs originelles, notamment dans le cadre de l’analyse de données d’enquête, un manquant du type <q>ne sait pas</q> n’étant pas équivalent à un manquant du type <q>refus</q> ou du type <q>variable non collectée</q>.</p>
<p>Dès lors, nous vous recommandons d’appeler <code data-pkg="haven">read_spss</code> avec l’option <code>user_na = TRUE</code>. Dans ce cas-là, les valeurs manquantes définies dans <strong>SPSS</strong> ne seront pas converties en <code>NA</code>, tout en conservant la définition des valeurs définies comme manquantes. Il sera alors toujours possible de convertir, dans un second temps et en fonction des besoins, ces valeurs à considérer comme manquantes en <code>NA</code> grace aux fonctions de l’extension <code>labelled</code>, en particulier <code data-pkg="labelled" data-rdoc="remove_labels">user_na_to_na</code>, <code data-pkg="labelled">na_values</code> et <code data-pkg="labelled" data-rdoc="na_values">na_range</code>.</p>
<p>À noter que les fonctions <code data-pkg="questionr">describe</code> et <code data-pkg="questionr">freq</code> de l’extension <code class="pkg">questionr</code> que nous arboderons dans d’autres chapitres savent exploiter ces valeurs à considérer comme manquantes.</p>
</div>
<div class="note">
<p>Si vous préférez utiliser l’extension <code class="pkg">foreign</code>, la fonction correspondante est <code data-kg="foreign">read.spss</code>. On indiquera à la fonction de renvoyer un tableau de données avec l’argument <code>to.data.frame = TRUE</code>.</p>
<p>Par défaut, les variables numériques pour lesquelles des <dfn data-inndex="étiquette de valeur">étiquettes de valeurs</dfn><dfn data-index="valeur, étiquette"></dfn> ont été définies sont transformées en variables de type <dfn>facteur</dfn>, les étiquettes définies dans <strong>SPSS</strong> étant utilisées comme <em>labels</em> du facteur. De même, si des <dfn data-index="valeur manquante">valeurs manquantes</dfn> ont été définies dans <strong>SPSS</strong>, ces dernières seront toutes transformées en <code>NA</code> (<strong>R</strong> ne permettant pas de gérer plusieurs types de valeurs manquantes). Ce comportement peut être modifié avec <code>use.value.labels</code> et <code>use.missings</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(foreign)
donnees &lt;-<span class="st"> </span><span class="kw">read.spss</span>(<span class="st">"data/fichier.sav"</span>, <span class="dt">to.data.frame =</span> <span class="ot">TRUE</span>, 
  <span class="dt">use.value.labels =</span> <span class="ot">FALSE</span>, <span class="dt">use.missings =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Il est important de noter que <code data-pkg="foreign">read.spss</code> de l’extension <code class="pkg">foreign</code> ne sait pas importer les dates. Ces dernières sont donc automatiquement transformées en valeurs numériques.</p>
<p><strong>SPSS</strong> stocke les dates sous la forme du nombre de secondes depuis le début du calendrier grégorien, à savoir le 14 octobre 1582. Dès lors, si l’on des dates dans un fichier <strong>SPSS</strong> et que ces dernières ont été converties en valeurs numériques, on pourra essayer la commande suivante :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">donnees<span class="op">$</span>date &lt;-<span class="st"> </span><span class="kw">as.POSIXlt</span>(donnees<span class="op">$</span>date, <span class="dt">origin =</span> <span class="st">"1582-10-14"</span>)</code></pre></div>
</div>
</div>
<div id="import-de-donnees_sas" class="section level3">
<h3>SAS</h3>
<p>Les <dfn data-index="SAS, fichier">fichiers <strong>SAS</strong></dfn> se présentent en général sous deux format : format <strong>SAS export</strong> (extension <code>.xport</code> ou <code>.xpt</code>) ou format <strong>SAS natif</strong> (extension <code>.sas7bdat</code>).</p>
<p>Les fichiers <strong>SAS natifs</strong> peuvent être importées directement avec <code data-pkg="haven">read_sas</code> de l’extension <code class="pkg">haven</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(haven)
donnees &lt;-<span class="st"> </span><span class="kw">read_sas</span>(<span class="st">"data/fichier.sas7bdat"</span>)</code></pre></div>
<p>Au besoin, on pourra préciser en deuxième argument le nom d’un fichier <strong>SAS catalogue</strong> (extension <code>.sas7bcat</code>) contenant les métadonnées du fichier de données.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(haven)
donnees &lt;-<span class="st"> </span><span class="kw">read_sas</span>(<span class="st">"data/fichier.sas7bdat"</span>, <span class="st">"data/fichier.sas7bcat"</span>)</code></pre></div>
<p>Les fichiers au format <strong>SAS export</strong> peuvent être importés via la fonction <code data-pkg="foreign">read.xport</code> de l’extension <code class="pkg">foreign</code>. Celle-ci s’utilise très simplement, en lui passant le nom du fichier en argument :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(foreign)
donnees &lt;-<span class="st"> </span><span class="kw">read.xport</span>(<span class="st">"data/fichier.xpt"</span>)</code></pre></div>
</div>
<div id="import-de-donnees_stata" class="section level3">
<h3>Stata</h3>
<p>Pour les <dfn data-index="Stata, fichier">fichiers <strong>Stata</strong></dfn> (extension <code>.dta</code>), on aura recours aux fonctions <code data-pkg="haven">read_dta</code> et <code data-pkg="haven" data-rdoc="read_dta">read_stata</code> de l’extension <code class="pkg">haven</code>. Ces deux fonctions sont identiques.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(haven)
donnees &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">"data/fichier.dta"</span>)</code></pre></div>
<div class="important">
<p><strong>Gestion des valeurs manquantes</strong></p>
<p>Dans <strong>Stata</strong>, il est possible de définir plusieurs types de valeurs manquantes, qui sont notées sous la forme <code>.a</code> à <code>.z</code>. Pour conserver cette information lors de l’import, <code class="pkg">haven</code> a introduit dans <strong>R</strong> le concept de <dfn lang="en">tagged NA</dfn> ou <dfn lang="en">tagged missing value</dfn>. Plus de détails sur ces données manquantes <q>étiquettées</q>, on se référera à la page d’aide de la fonction <code data-pkg="haven">tagged_na</code>.</p>
</div>
<div class="note">
<p>Si l’on préfère utiliser l’extension <code class="pkg">foreign</code>, on aura recours à la fonction <code data-pkg="foreign">read.dta</code>.</p>
<p>L’option <code>convert.factors</code> indique si les variables labellisées doit être converties automatiquement en facteurs. Pour un résultat similaire à celui de <code class="pkg">haven</code>, on choisira donc :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(foreign)
donnees &lt;-<span class="st"> </span><span class="kw">read.dta</span>(, <span class="dt">convert.factors =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>L’option <code>convert.dates</code> permet de convertir les dates du format <strong>Stata</strong> dans un format de dates géré par <strong>R</strong>. Cependant, cela ne marche pas toujours. Dans ces cas là, l’opération suivante peut fonctionner. Sans garantie néanmoins, il est toujours vivement conseillé de vérifier le résultat obtenu !</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">donnees<span class="op">$</span>date &lt;-<span class="st"> </span><span class="kw">as.Date</span>(donnees<span class="op">$</span>Date, <span class="dt">origin =</span> <span class="st">"1960-01-01"</span>)</code></pre></div>
</div>
</div>
<div id="import-de-donnees_excel" class="section level3">
<h3>Excel</h3>
<p>Une première approche pour importer des données <strong>Excel</strong> dans <strong>R</strong> consiste à les exporter depuis <strong>Excel</strong> dans un fichier texte (texte tabulé ou <strong>CSV</strong>) puis de suivre la procédure d’importation d’un fichier texte.</p>
<p>Une feuille <strong>Excel</strong> peut également être importée directement avec l’extension <code class="pkg">readxl</code> qui appartient à la même famille que <code class="pkg">haven</code> et <code class="pkg">readr</code>.</p>
<p>La fonction <code data-pkg="readxl">read_excel</code> permet d’importer à la fois des fichiers <code>.xls</code> (<strong>Excel</strong> 2003 et précédents) et <code>.xlsx</code> (<strong>Excel</strong> 2007 et suivants).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readxl)
donnees &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">"data/fichier.xlsx"</span>)</code></pre></div>
<p>Une seule feuille de calculs peut être importée à la fois. On pourra préciser la feuille désirée avec <code>sheet</code> en indiquant soit le nom de la feuille, soit sa position (première, seconde, …).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">donnees &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">"data/fichier.xlsx"</span>, <span class="dt">sheet =</span> <span class="dv">3</span>)
donnees &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">"data/fichier.xlsx"</span>, <span class="dt">sheet =</span> <span class="st">"mes_donnees"</span>)</code></pre></div>
<p>On pourra préciser avec <code>col_names</code> si la première ligne contient le nom des variables.</p>
<p>Par défaut, <code data-pkg="readxl">read_excel</code> va essayer de deviner le type (numérique, textuelle, date) de chaque colonne. Au besoin, on pourra indiquer le type souhaité de chaque colonne avec <code>col_types</code>.</p>
<p><strong>RStudio</strong> propose également pour les fichiers <strong>Excel</strong> un assitant d’importation, similaire à celui pour les fichiers texte, permettant de faciliter l’import.</p>
<div class="note">
<p>Une alternative est l’extension <code class="pkg">xlsx</code> qui propose deux fonctions différentes pour importer des fichiers <strong>Excel</strong> : <code data-pkg="xlsx">read.xlsx</code> et <code data-pkg="xlsx" data-rdoc="read.xlsx">read.xlsx2</code>. La finalité est la même mais leur fonctionnement interne est différent. En cas de difficultés d’import, on pourra tester l’autre. Il est impératif de spécifier la position de la feuille de calculs que l’on souhaite importer.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(xlsx)
donnees &lt;-<span class="st"> </span><span class="kw">read.xlsx</span>(<span class="st">"data/fichier.xlsx"</span>, <span class="dv">1</span>)</code></pre></div>
</div>
</div>
<div id="import-de-donnees_dbase" class="section level3">
<h3>dBase</h3>
<p>L’Insee et d’autres producteur de données diffusent leurs fichiers au format <strong>dBase</strong> (extension <code>.dbf</code>). Ceux-ci sont directement lisibles dans <strong>R</strong> avec la fonction <code data-pkg="foreign">read.dbf</code> de l’extension <code class="pkg">foreign</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(foreign)
donnees &lt;-<span class="st"> </span><span class="kw">read.dbf</span>(<span class="st">"data/fichier.dbf"</span>)</code></pre></div>
<p>La principale limitation des <dfn data-index="dBase, fichier">fichiers <strong>dBase</strong></dfn> est de ne pas gérer plus de 256 colonnes. Les tables des enquêtes de l’Insee sont donc parfois découpées en plusieurs fichiers <code>.dbf</code> qu’il convient de fusionner avec la fonction <code data-pkg="base">merge</code>. L’utilisation de cette fonction est détaillée dans le chapitre sur la <a href="#fusion-de-tables">fusion de tables</a>.</p>
</div>
</div>
<div id="import-de-donnees_donnees-spatiales" class="section level2">
<h2>Données spatiales</h2>
<div id="import-de-donnees_shapefile" class="section level3">
<h3>Shapefile</h3>
<p>Les <dfn date-index="shapefile, fichier">fichiers <strong>Shapefile</strong></dfn> sont couramment utilisés pour échanger des données géoréférencées. La majorité des logiciels de <strong>SIG</strong> (systèmes d’informations géographiques) sont en capacité d’importer et d’exporter des données dans ce format.</p>
<p>Un <strong>shapefile</strong> contient toute l’information liée à la géométrie des objets décrits, qui peuvent être :</p>
<ul>
<li>des points</li>
<li>des lignes</li>
<li>des polygones</li>
</ul>
<p>Son extension est classiquement <code>.shp</code> et il est toujours accompagné de deux autres fichiers de même nom et d’extensions :</p>
<ul>
<li>un fichier <code>.dbf</code>, qui contient les données attributaires relatives aux objets contenus dans le <strong>shapefile</strong>
</li>
<li>un fichier <code>.shx</code>, qui stocke l’index de la géométrie</li>
</ul>
<p>D’autres fichiers peuvent être également fournis :</p>
<ul>
<li>
<code>.sbn</code> et <code>.sbx</code> - index spatial des formes.</li>
<li>
<code>.fbn</code> et <code>.fbx</code> - index spatial des formes pour les shapefile en lecture seule</li>
<li>
<code>.ain</code> et <code>.aih</code> - index des attributs des champs actifs dans une table ou dans une table d’attributs du thème</li>
<li>
<code>.prj</code> - information sur le système de coordonnées</li>
<li>
<code>.shp.xml</code> - métadonnées du shapefile.</li>
<li>
<code>.atx</code> - fichier d’index des attributs pour le fichier <code>.dbf</code>
</li>
<li><code>.qix</code></li>
</ul>
<p>En premier lieu, il importe que tous les fichiers qui compose un même <strong>shapefile</strong> soit situés dans le même répertoire et aient le même nom (seule l’extension étant différente).</p>
<p>L’extension <code class="pkg">maptools</code> fournit les fonctions permettant d’importer un <strong>shapefile</strong> dans <strong>R</strong>. Le résultat obtenu utilisera l’une des différentes classes spatiales fournies par l’extension <code class="pkg">sp</code>.</p>
<p>La fonction générique d’import est <code data-pkg="maptools">readShapeSpatial</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(maptools)
donnees_spatiales &lt;-<span class="st"> </span><span class="kw">readShapeSpatial</span>(<span class="st">"data/fichier.shp"</span>)</code></pre></div>
<p>Si l’on connait déjà le type de données du <strong>shapefile</strong> (points, lignes ou polygones), on pourra utiliser directement <code data-pkg="maptools">readShapePoints</code>, <code data-pkg="maptools">readShapeLines</code> ou <code data-pkg="maptools">readShapePoly</code>.</p>
</div>
<div id="import-de-donnees_rasters" class="section level3">
<h3>Rasters</h3>
<p>Il existe de multiples formats pour stocker des données matricielles spatiales. L’un des plus communs est le format <strong>ASCII grid</strong> aussi connu sous le nom de <strong>Arc/Info ASCII grid</strong> ou <strong>ESRI grid</strong>. L’extension de ce format n’est pas toujours uniforme. On trouve parfois <code>.asc</code> ou encore <code>.ag</code> voir même <code>.txt</code>.</p>
<p>Pour importer ce type de fichier, on pourra avoir recours à la fonction <code data-pkg="maptools">readAsciiGrid</code> de l’extension <code class="pkg">maptools</code>. Le résultat sera, par défaut, au format <code data-pkg="sp" data-rdoc="SpatialGridDataFrame-class">SpatialGridDataFrame</code> de l’extension <code class="pkg">sp</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(maptools)
donnees_spatiales &lt;-<span class="st"> </span><span class="kw">readAsciiGrid</span>(<span class="st">"data/fichier.asc"</span>)</code></pre></div>
<p>L’extension <code class="pkg">raster</code> permet d’effectuer de multiples manipulations sur les données du type <dfn data-index="raster, fichier">raster</dfn>. Elle est en capacité d’importer des données depuis différents formats (plus précisément les formats pris en charge par la librairie <strong>GDAL</strong>, <a href="http://www.gdal.org/" class="uri">http://www.gdal.org/</a>).</p>
<p>De plus, les fichiers raster pouvant être particulièrement volumineux (jusqu’à plusieurs Go de données), l’extension <code class="pkg">raster</code> est capable de travailler sur un fichier raster sans avoir à le charger intégralement en mémoire.</p>
<p>Pour plus d’informations, voir les fonctions <code data-pkg="raster">raster</code> et <code data-pkg="raster">getValues</code>.</p>
</div>
</div>
<div id="import-de-donnees_autres-sources" class="section level2">
<h2>Autres sources</h2>
<p><strong>R</strong> offre de très nombreuses autres possibilités pour accéder aux données. Il est ainsi possible d’importer des données depuis d’autres applications qui n’ont pas été évoquées (<strong>Epi Info</strong>, <strong>S-Plus</strong>, etc.), de se connecter à un système de base de données relationelle type <strong>MySQL</strong>, de lire des données via <strong>ODBC</strong> ou des connexions réseau, etc.</p>
<p>Pour plus d’informations on consultera le manuel <em>R Data Import/Export</em> :<br><a href="http://cran.r-project.org/manuals.html" class="uri">http://cran.r-project.org/manuals.html</a>.</p>
<p>Pour les données <strong>SQL</strong>, on pourra utiliser les fonctionnalités de <code class="pkg">dplyr</code> dans ce domaine, voir <a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/databases.html" class="uri">https://cran.rstudio.com/web/packages/dplyr/vignettes/databases.html</a>.</p>
</div>
<div id="import-de-donnees_sauver-ses-donnees" class="section level2">
<h2>Sauver ses données</h2>
<p><strong>R</strong> dispose également de son propre format pour sauvegarder et échanger des données. On peut sauver n’importe quel objet créé avec <strong>R</strong> et il est possible de sauver plusieurs objets dans un même fichier. L’usage est d’utiliser l’extension <code>.RData</code> pour les fichiers de données <strong>R</strong>. La fonction à utiliser s’appelle tout simplement <code data-pkg="base">save</code>.</p>
<p>Par exemple, si l’on souhaite sauvegarder son tableau de données <code>d</code> ainsi que les objets <code>tailles</code> et <code>poids</code> dans un fichier <code>export.RData</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">save</span>(d, tailles, poids, <span class="dt">file =</span> <span class="st">"export.RData"</span>)</code></pre></div>
<p>À tout moment, il sera toujours possible de recharger ces données en mémoire à l’aide de la fonction <code data-pkg="base">load</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">"export.RData"</span>)</code></pre></div>
<div class="important">
<p>Si entre temps vous aviez modifié votre tableau <code>d</code>, vos modifications seront perdues. En effet, si lors du chargement de données, un objet du même nom existe en mémoire, ce dernier sera remplacé par l’objet importé.</p>
</div>
<p>La fonction <code data-pkg="base" data-rdoc="save">save.image</code> est un raccourci pour sauvergarder tous les objets de la session de travail dans le fichier <code>.RData</code> (un fichier un peu étrange car il n’a pas de nom mais juste une extension). Lors de la fermeture de <strong>RStudio</strong>, il vous sera demandé si vous souhaitez enregistrer votre session. Si vous répondez <em>Oui</em>, c’est cette fonction <code data-pkg="base" data-rdoc="save">save.image</code> qui sera appliquée.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">save.image</span>()</code></pre></div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="import-de-donnees_fn1"><p>L’option CSV fonctionne pour tous les fichiers de type texte, même si votre fichier a une autre extension, <code>.txt</code> par exemple<a href="#import-de-donnees_fnref1"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="recodage"><div class="fluid-row" id="recodage_header">



<h1 class="title toc-ignore">Recodage</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#recodage_renommer-des-variables">Renommer des variables</a></li>
<li>
<a href="#recodage_convertir-une-variable">Convertir une variable</a><ul>
<li><a href="#recodage_variable-numerique-ou-textuelle-en-facteur">Variable numérique ou textuelle en facteur</a></li>
<li><a href="#recodage_conversion-dun-facteur">Conversion d’un facteur</a></li>
<li><a href="#recodage_conversion-dun-vecteur-labellise">Conversion d’un vecteur labellisé</a></li>
</ul>
</li>
<li><a href="#recodage_decouper_en_classes">Découper une variable numérique en classes</a></li>
<li><a href="#recodage_regrouper_modalites">Regrouper les modalités d’une variable</a></li>
<li><a href="#recodage_variables-calculees">Variables calculées</a></li>
<li><a href="#recodage_combiner-plusieurs-variables">Combiner plusieurs variables</a></li>
<li><a href="#recodage_variables-scores">Variables scores</a></li>
<li><a href="#recodage_verification-des-recodages">Vérification des recodages</a></li>
<li><a href="#recodage_recodage-et-data.table">Recodage et data.table</a></li>
</ul>
</div>

<div class="note">
<p>La version originale de ce chapitre a été écrite par Julien Barnier dans le cadre du support de cours <a href="https://github.com/juba/intro-r">Introduction à R</a>.</p>
</div>
<p>Le <dfn>recodage de variables</dfn><dfn data-index="variable, recodage"></dfn> est une opération extrêmement fréquente lors du traitement d’enquête. Celui-ci utilise soit l’une des formes d’indexation décrites précédemment, soit des fonctions <em>ad hoc</em> de <strong>R</strong>.</p>
<p>On passe ici en revue différents types de recodage parmi les plus courants. Les exemples s’appuient, comme précédemment, sur l’extrait de l’enquête <em>Histoire de vie</em> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">data</span>(hdv2003)
d &lt;-<span class="st"> </span>hdv2003</code></pre></div>
<div id="recodage_renommer-des-variables" class="section level2">
<h2>Renommer des variables</h2>
<p>Une opération courante lorsqu’on a importé des variables depuis une source de données externe consiste à renommer les variables importées. Sous <strong>R</strong> les noms de variables doivent être à la fois courts et explicites.</p>
<div class="important">
<p>Les noms de variables peuvent contenir des lettres, des chiffres (mais ils ne peuvent pas commencer par un chiffre), les symboles <code>.</code> et <code>_</code> et doivent commencer par une lettre. <strong>R</strong> fait la différence entre les majuscules et les minuscules, ce qui signifie que <var>x</var> et <var>X</var> sont deux noms de variable différents. On évitera également d’utiliser des caractères accentués dans les noms de variable. Comme les espaces ne sont pas autorisés, on pourra les remplacer par un point ou un tiret bas.</p>
</div>
<p>On peut lister les noms des variables d’un tableau de données (<em>data.frame</em>) à l’aide de la fonction <code data-pkg="base">names</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(d)</code></pre></div>
<pre><code> [1] "id"            "age"          
 [3] "sexe"          "nivetud"      
 [5] "poids"         "occup"        
 [7] "qualif"        "freres.soeurs"
 [9] "clso"          "relig"        
[11] "trav.imp"      "trav.satisf"  
[13] "hard.rock"     "lecture.bd"   
[15] "peche.chasse"  "cuisine"      
[17] "bricol"        "cinema"       
[19] "sport"         "heures.tv"    </code></pre>
<p>Cette fonction peut également être utilisée pour renommer l’ensemble des variables. Si par exemple on souhaitait passer les noms de toutes les variables en majuscules, on pourrait faire :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d.maj &lt;-<span class="st"> </span>d
<span class="kw">names</span>(d.maj) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"ID"</span>, <span class="st">"AGE"</span>, <span class="st">"SEXE"</span>, <span class="st">"NIVETUD"</span>, <span class="st">"POIDS"</span>, 
  <span class="st">"OCCUP"</span>, <span class="st">"QUALIF"</span>, <span class="st">"FRERES.SOEURS"</span>, <span class="st">"CLSO"</span>, <span class="st">"RELIG"</span>, 
  <span class="st">"TRAV.IMP"</span>, <span class="st">"TRAV.SATISF"</span>, <span class="st">"HARD.ROCK"</span>, <span class="st">"LECTURE.BD"</span>, 
  <span class="st">"PECHE.CHASSE"</span>, <span class="st">"CUISINE"</span>, <span class="st">"BRICOL"</span>, <span class="st">"CINEMA"</span>, 
  <span class="st">"SPORT"</span>, <span class="st">"HEURES.TV"</span>)
<span class="kw">summary</span>(d.maj<span class="op">$</span>SEXE)</code></pre></div>
<pre><code>Homme Femme 
  899  1101 </code></pre>
<p>Ce type de renommage peut être utile lorsqu’on souhaite passer en revue tous les noms de variables d’un fichier importé pour les corriger le cas échéant. Pour faciliter un peu ce travail pas forcément passionnant, on peut utiliser la fonction <code data-pkg="base">dput</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dput</span>(<span class="kw">names</span>(d))</code></pre></div>
<pre><code>c("id", "age", "sexe", "nivetud", "poids", "occup", "qualif", 
"freres.soeurs", "clso", "relig", "trav.imp", "trav.satisf", 
"hard.rock", "lecture.bd", "peche.chasse", "cuisine", "bricol", 
"cinema", "sport", "heures.tv")</code></pre>
<p>On obtient en résultat la liste des variables sous forme de vecteur déclaré. On n’a plus alors qu’à copier/coller cette chaîne, rajouter <code>names(d) &lt;-</code> devant et modifier un à un les noms des variables.</p>
<p>Si on souhaite seulement modifier le nom d’une variable, on peut utiliser la fonction <code data-pkg="questionr">rename.variable</code> de l’extension <code class="pkg">questionr</code>. Celle-ci prend en argument le tableau de données, le nom actuel de la variable et le nouveau nom. Par exemple, si on veut renommer la variable <var>bricol</var> du tableau de données <code>d</code> en <var>bricolage</var> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span><span class="kw">rename.variable</span>(d, <span class="st">"bricol"</span>, <span class="st">"bricolage"</span>)
<span class="kw">table</span>(d<span class="op">$</span>bricolage)</code></pre></div>
<pre><code>
 Non  Oui 
1147  853 </code></pre>
</div>
<div id="recodage_convertir-une-variable" class="section level2">
<h2>Convertir une variable</h2>
<p>Il peut arriver qu’on veuille transformer une variable d’un type dans un autre.</p>
<div id="recodage_variable-numerique-ou-textuelle-en-facteur" class="section level3">
<h3>Variable numérique ou textuelle en facteur</h3>
<p>Par exemple, on peut considérer que la variable numérique <var>freres.soeurs</var> est une « fausse » variable numérique et qu’une représentation sous forme de facteur serait plus adéquate. Dans ce cas il suffit de faire appel à la fonction <code data-pkg="base">factor</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>fs.fac &lt;-<span class="st"> </span><span class="kw">factor</span>(d<span class="op">$</span>freres.soeurs)
<span class="kw">levels</span>(d<span class="op">$</span>fs.fac)</code></pre></div>
<pre><code> [1] "0"  "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8" 
[10] "9"  "10" "11" "12" "13" "14" "15" "16" "18"
[19] "22"</code></pre>
<p>La conversion d’une variable caractères en facteur se fait de la même manière.</p>
<p>La conversion d’un facteur ou d’une variable numérique en variable caractères peut se faire à l’aide de la fonction <code data-pkg="base" data-rdoc="character">as.character</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>fs.char &lt;-<span class="st"> </span><span class="kw">as.character</span>(d<span class="op">$</span>freres.soeurs)
d<span class="op">$</span>qualif.char &lt;-<span class="st"> </span><span class="kw">as.character</span>(d<span class="op">$</span>qualif)</code></pre></div>
</div>
<div id="recodage_conversion-dun-facteur" class="section level3">
<h3>Conversion d’un facteur</h3>
<p>La conversion d’un facteur en caractères est fréquemment utilisé lors des recodages du fait qu’il est impossible d’ajouter de nouvelles modalités à un facteur de cette manière. Par exemple, la première des commandes suivantes génère un message d’avertissement, tandis que les deux autres fonctionnent :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d.temp &lt;-<span class="st"> </span>d
d.temp<span class="op">$</span>qualif[d.temp<span class="op">$</span>qualif <span class="op">==</span><span class="st"> "Ouvrier specialise"</span>] &lt;-<span class="st"> "Ouvrier"</span></code></pre></div>
<pre><code>Warning in `[&lt;-.factor`(`*tmp*`, d.temp$qualif ==
"Ouvrier specialise", : invalid factor level, NA
generated</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>qualif.char &lt;-<span class="st"> </span><span class="kw">as.character</span>(d<span class="op">$</span>qualif)
d<span class="op">$</span>qualif.char[d<span class="op">$</span>qualif.char <span class="op">==</span><span class="st"> "Ouvrier specialise"</span>] &lt;-<span class="st"> "Ouvrier"</span></code></pre></div>
<p>Dans le premier cas, le message d’avertissement indique que toutes les modalités « Ouvrier specialise » de notre variable <var>qualif</var> ont été remplacées par des valeurs manquantes <code>NA</code>.</p>
<p>Enfin, une variable de type caractères dont les valeurs seraient des nombres peut être convertie en variable numérique avec la fonction <code data-pkg="base" data-rdoc="numeric">as.numeric</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"1"</span>, <span class="st">"3.1415"</span>, <span class="st">"4"</span>, <span class="st">"5.6"</span>, <span class="st">"1"</span>, <span class="st">"4"</span>)
v</code></pre></div>
<pre><code>[1] "1"      "3.1415" "4"      "5.6"    "1"     
[6] "4"     </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.numeric</span>(v)</code></pre></div>
<pre><code>[1] 1.0000 3.1415 4.0000 5.6000 1.0000 4.0000</code></pre>
<div class="important">
<p>Lorsque l’on convertit un facteur avec <code data-pkg="base" data-rdoc="numeric">as.numeric</code>, on obtient le numéro de chaque facteur (première modalité, seconde modalité, etc.). Si la valeur numérique qui nous intéresse est en fait contenu dans le nom des modalités, il faut convertir au préalable notre facteur en variable textuelle.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vf &lt;-<span class="st"> </span><span class="kw">factor</span>(v)
vf</code></pre></div>
<pre><code>[1] 1      3.1415 4      5.6    1      4     
Levels: 1 3.1415 4 5.6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.numeric</span>(vf)</code></pre></div>
<pre><code>[1] 1 2 3 4 1 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(vf))</code></pre></div>
<pre><code>[1] 1.0000 3.1415 4.0000 5.6000 1.0000 4.0000</code></pre>
<p>ATTENTION : la valeur numérique associée à chaque étiquette d’un facteur change lorsque l’on modifie l’ordre des étiquettes d’un facteur. Dès lors, il est <strong>fortement déconseillé</strong> de convertir un facteur en variable numérique.</p>
</div>
</div>
<div id="recodage_conversion-dun-vecteur-labellise" class="section level3">
<h3>Conversion d’un vecteur labellisé</h3>
<p>Nous avons abordé dans un <a href="#facteurs-et-vecteurs-labellises_labelled">chapitre précédent</a> la gestion de données labellisées à l’aide de l’extension <code class="pkg">labelled</code>. Les vecteurs labellisés sont beaucoup plus souples que les facteurs lors de la préparation des données, puisque la liste des modalités autorisées n’est pas fixée à l’avance. De plus, cela permet également de documenter au-fur-et-à-mesure les nouvelles variables que l’on créé.</p>
<p>Nous verrons dans les chapitres d’analyse, notamment quand il s’agit de calculer des modèles, qu’il est nécessaire de coder les variables catégorielles sous forme de facteurs. Il est très facile de convertir ubn vecteur labellisé en facteur à l’aide la fonction <code data-pkg="labelled">to_factor</code> de l’extension <code class="pkg">labelled</code><a href="#recodage_fn1" class="footnoteRef" id="recodage_fnref1"><sup>1</sup></a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(labelled)
v &lt;-<span class="st"> </span><span class="kw">labelled</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="ot">NA</span>), <span class="kw">c</span>(<span class="dt">oui =</span> <span class="dv">1</span>, <span class="st">`</span><span class="dt">peut-être</span><span class="st">`</span> =<span class="st"> </span><span class="dv">2</span>, 
  <span class="dt">non =</span> <span class="dv">3</span>, <span class="st">`</span><span class="dt">ne sait pas</span><span class="st">`</span> =<span class="st"> </span><span class="dv">9</span>))
v</code></pre></div>
<pre><code>&lt;Labelled double&gt;
[1]  1  2  9  3  3  2 NA

Labels:
 value       label
     1         oui
     2   peut-être
     3         non
     9 ne sait pas</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">to_factor</span>(v)</code></pre></div>
<pre><code>[1] oui         peut-être   ne sait pas
[4] non         non         peut-être  
[7] &lt;NA&gt;       
Levels: oui peut-être non ne sait pas</code></pre>
<p>Il possible d’indiquer si l’on souhaite, comme étiquettes du facteur, utiliser les étiquettes de valeur (par défaut), les valeurs elles-mêmes, ou bien les étiquettes de valeurs préfixées par la valeur d’origine indiquée entre crochets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">to_factor</span>(v, <span class="st">"l"</span>)</code></pre></div>
<pre><code>[1] oui         peut-être   ne sait pas
[4] non         non         peut-être  
[7] &lt;NA&gt;       
Levels: oui peut-être non ne sait pas</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">to_factor</span>(v, <span class="st">"v"</span>)</code></pre></div>
<pre><code>[1] 1    2    9    3    3    2    &lt;NA&gt;
Levels: 1 2 3 9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">to_factor</span>(v, <span class="st">"p"</span>)</code></pre></div>
<pre><code>[1] [1] oui         [2] peut-être  
[3] [9] ne sait pas [3] non        
[5] [3] non         [2] peut-être  
[7] &lt;NA&gt;           
4 Levels: [1] oui [2] peut-être ... [9] ne sait pas</code></pre>
<p>Par défaut, les étiquettes du facteur seront triés selon l’ordre des étiquettes de valeur. Mais cela peut être modifié avec l’argument <code>sort_levels</code> si l’on préfère trier selon les valeurs ou selon l’ordre alphabétique des étiquettes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">to_factor</span>(v, <span class="dt">sort_levels =</span> <span class="st">"v"</span>)</code></pre></div>
<pre><code>[1] oui         peut-être   ne sait pas
[4] non         non         peut-être  
[7] &lt;NA&gt;       
Levels: oui peut-être non ne sait pas</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">to_factor</span>(v, <span class="dt">sort_levels =</span> <span class="st">"l"</span>)</code></pre></div>
<pre><code>[1] oui         peut-être   ne sait pas
[4] non         non         peut-être  
[7] &lt;NA&gt;       
Levels: ne sait pas non oui peut-être</code></pre>
<p>D’autres options sont disponibles. On se réferra à la documentation complète de la fonction.</p>
</div>
</div>
<div id="recodage_decouper_en_classes" class="section level2">
<h2>Découper une variable numérique en classes</h2>
<p>Le premier type de recodage consiste à découper une variable de type numérique en un certain nombre de classes. On utilise pour cela la fonction <code data-pkg="base">cut</code>.</p>
<p>Celle-ci prend, outre la variable à découper, un certain nombre d’arguments :</p>
<ul>
<li>
<code>breaks</code> indique soit le nombre de classes souhaité, soit, si on lui fournit un vecteur, les limites des classes ;</li>
<li>
<code>labels</code> permet de modifier les noms de modalités attribués aux classes ;</li>
<li>
<code>include.lowest</code> et <code>right</code> influent sur la manière dont les valeurs situées à la frontière des classes seront inclues ou exclues ;</li>
<li>
<code>dig.lab</code> indique le nombre de chiffres après la virgule à conserver dans les noms de modalités.</li>
</ul>
<p>Prenons tout de suite un exemple et tentons de découper notre variable <var>age</var> en cinq classes et de placer le résultat dans une nouvelle variable nommée <var>age5cl</var> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>age5cl &lt;-<span class="st"> </span><span class="kw">cut</span>(d<span class="op">$</span>age, <span class="dv">5</span>)
<span class="kw">table</span>(d<span class="op">$</span>age5cl)</code></pre></div>
<pre><code>
(17.9,33.8] (33.8,49.6] (49.6,65.4] (65.4,81.2] 
        454         628         556         319 
(81.2,97.1] 
         43 </code></pre>
<p>Par défaut <strong>R</strong> nous a bien créé cinq classes d’amplitudes égales. La première classe va de 16,9 à 32,2 ans (en fait de 17 à 32), etc.</p>
<p>Les frontières de classe seraient plus présentables si elles utilisaient des nombres ronds. On va donc spécifier manuellement le découpage souhaité, par tranches de 20 ans :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>age20 &lt;-<span class="st"> </span><span class="kw">cut</span>(d<span class="op">$</span>age, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">100</span>))
<span class="kw">table</span>(d<span class="op">$</span>age20)</code></pre></div>
<pre><code>
  (0,20]  (20,40]  (40,60]  (60,80] (80,100] 
      72      660      780      436       52 </code></pre>
<p>On aurait pu tenir compte des âges extrêmes pour la première et la dernière valeur :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">range</span>(d<span class="op">$</span>age)</code></pre></div>
<pre><code>[1] 18 97</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>age20 &lt;-<span class="st"> </span><span class="kw">cut</span>(d<span class="op">$</span>age, <span class="kw">c</span>(<span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">97</span>))
<span class="kw">table</span>(d<span class="op">$</span>age20)</code></pre></div>
<pre><code>
(18,20] (20,40] (40,60] (60,80] (80,97] 
     55     660     780     436      52 </code></pre>
<p>Les symboles dans les noms attribués aux classes ont leur importance : <code>(</code> signifie que la frontière de la classe est exclue, tandis que <code>[</code> signifie qu’elle est incluse. Ainsi, <code>(20,40]</code> signifie « strictement supérieur à 20 et inférieur ou égal à 40 ».</p>
<p>On remarque que du coup, dans notre exemple précédent, la valeur minimale, 18, est exclue de notre première classe, et qu’une observation est donc absente de ce découpage. Pour résoudre ce problème on peut soit faire commencer la première classe à 17, soit utiliser l’option <code>include.lowest=TRUE</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>age20 &lt;-<span class="st"> </span><span class="kw">cut</span>(d<span class="op">$</span>age, <span class="kw">c</span>(<span class="dv">17</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">97</span>))
<span class="kw">table</span>(d<span class="op">$</span>age20)</code></pre></div>
<pre><code>
(17,20] (20,40] (40,60] (60,80] (80,97] 
     72     660     780     436      52 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>age20 &lt;-<span class="st"> </span><span class="kw">cut</span>(d<span class="op">$</span>age, <span class="kw">c</span>(<span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">97</span>), <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>)
<span class="kw">table</span>(d<span class="op">$</span>age20)</code></pre></div>
<pre><code>
[18,20] (20,40] (40,60] (60,80] (80,97] 
     72     660     780     436      52 </code></pre>
<p>On peut également modifier le sens des intervalles avec l’option <code>right=FALSE</code>, et indiquer manuellement les noms des modalités avec <code>labels</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>age20 &lt;-<span class="st"> </span><span class="kw">cut</span>(d<span class="op">$</span>age, <span class="kw">c</span>(<span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">97</span>), <span class="dt">right =</span> <span class="ot">FALSE</span>, 
  <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>)
<span class="kw">table</span>(d<span class="op">$</span>age20)</code></pre></div>
<pre><code>
[18,20) [20,40) [40,60) [60,80) [80,97] 
     48     643     793     454      62 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>age20 &lt;-<span class="st"> </span><span class="kw">cut</span>(d<span class="op">$</span>age, <span class="kw">c</span>(<span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">97</span>), <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>, 
  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"&lt;20ans"</span>, <span class="st">"21-40 ans"</span>, <span class="st">"41-60ans"</span>, <span class="st">"61-80ans"</span>, 
    <span class="st">"&gt;80ans"</span>))
<span class="kw">table</span>(d<span class="op">$</span>age20)</code></pre></div>
<pre><code>
   &lt;20ans 21-40 ans  41-60ans  61-80ans    &gt;80ans 
       72       660       780       436        52 </code></pre>
<div class="note">
<p>L’extension <code class="pkg">questionr</code> propose une interface interactive à la fonction <code data-pkg="base">cut</code>, nommée <code data-pkg="questionr">icut</code>. Elle s’utilise de la manière suivante :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">icut</span>(d, age)</code></pre></div>
<p><strong>RStudio</strong> devrait ouvrir une fenêtre semblable à l’image ci-dessous.</p>
<div class="figure">
<img src="images/capture_icut.png" alt="Capture d’écran d’icut"><p class="caption">Capture d’écran d’icut</p>
</div>
<p>Vous pouvez alors indiquer les limites de vos classes ainsi que quelques options complémentaires. Ces limites sont représentées graphiquement sur l’histogramme de la variable d’origine.</p>
<p>L’onglet <em>Vérification</em> affiche un tri à plat et un graphique en barres de la nouvelle variable. Une fois le résultat satisfaisant, vous pouvez récupérer le code généré pour l’inclure dans votre script.</p>
<p>L’extension <code class="pkg">questionr</code> propose aussi une fonction <code data-pkg="questionr">quant.cut</code> permettant de découper une variable numérique en un nombre de classes donné ayant des efffectifs semblables. Il suffit de lui passer le nombre de classes en argument :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>age6cl &lt;-<span class="st"> </span><span class="kw">quant.cut</span>(d<span class="op">$</span>age, <span class="dv">6</span>)
<span class="kw">table</span>(d<span class="op">$</span>age6cl)</code></pre></div>
<pre><code>
    [18,30)     [30,39)     [39,48) [48,55.667) 
        302         337         350         344 
[55.667,66)     [66,97] 
        305         362 </code></pre>
<p><code data-pkg="questionr">quant.cut</code> admet les mêmes autres options que <code data-pkg="base">cut</code> (<code>include.lowest</code>, <code>right</code>, <code>labels</code>… ).</p>
</div>
</div>
<div id="recodage_regrouper_modalites" class="section level2">
<h2>Regrouper les modalités d’une variable</h2>
<p>Pour regrouper les modalités d’une variable qualitative (d’un facteur le plus souvent), on peut utiliser directement l’indexation.</p>
<p>Ainsi, si on veut recoder la variable <var>qualif</var> dans une variable <var>qualif.reg</var> plus « compacte », on peut utiliser :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(d<span class="op">$</span>qualif)</code></pre></div>
<pre><code>
      Ouvrier specialise         Ouvrier qualifie 
                     203                      292 
              Technicien Profession intermediaire 
                      86                      160 
                   Cadre                  Employe 
                     260                      594 
                   Autre 
                      58 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>qualif.reg[d<span class="op">$</span>qualif <span class="op">==</span><span class="st"> "Ouvrier specialise"</span>] &lt;-<span class="st"> "Ouvrier"</span>
d<span class="op">$</span>qualif.reg[d<span class="op">$</span>qualif <span class="op">==</span><span class="st"> "Ouvrier qualifie"</span>] &lt;-<span class="st"> "Ouvrier"</span>
d<span class="op">$</span>qualif.reg[d<span class="op">$</span>qualif <span class="op">==</span><span class="st"> "Employe"</span>] &lt;-<span class="st"> "Employe"</span>
d<span class="op">$</span>qualif.reg[d<span class="op">$</span>qualif <span class="op">==</span><span class="st"> "Profession intermediaire"</span>] &lt;-<span class="st"> "Intermediaire"</span>
d<span class="op">$</span>qualif.reg[d<span class="op">$</span>qualif <span class="op">==</span><span class="st"> "Technicien"</span>] &lt;-<span class="st"> "Intermediaire"</span>
d<span class="op">$</span>qualif.reg[d<span class="op">$</span>qualif <span class="op">==</span><span class="st"> "Cadre"</span>] &lt;-<span class="st"> "Cadre"</span>
d<span class="op">$</span>qualif.reg[d<span class="op">$</span>qualif <span class="op">==</span><span class="st"> "Autre"</span>] &lt;-<span class="st"> "Autre"</span>
<span class="kw">table</span>(d<span class="op">$</span>qualif.reg)</code></pre></div>
<pre><code>
        Autre         Cadre       Employe 
           58           260           594 
Intermediaire       Ouvrier 
          246           495 </code></pre>
<p>On aurait pu représenter ce recodage de manière plus compacte, notamment en commençant par copier le contenu de <var>qualif</var> dans <var>qualif.reg</var>, ce qui permet de ne pas s’occuper de ce qui ne change pas.</p>
<p>Il est cependant nécessaire de ne pas copier <var>qualif</var> sous forme de facteur, sinon on ne pourrait ajouter de nouvelles modalités. On copie donc la version caractères de <var>qualif</var> grâce à la fonction <code data-pkg="base" data-rdoc="character">as.character</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>qualif.reg &lt;-<span class="st"> </span><span class="kw">as.character</span>(d<span class="op">$</span>qualif)
d<span class="op">$</span>qualif.reg[d<span class="op">$</span>qualif <span class="op">==</span><span class="st"> "Ouvrier specialise"</span>] &lt;-<span class="st"> "Ouvrier"</span>
d<span class="op">$</span>qualif.reg[d<span class="op">$</span>qualif <span class="op">==</span><span class="st"> "Ouvrier qualifie"</span>] &lt;-<span class="st"> "Ouvrier"</span>
d<span class="op">$</span>qualif.reg[d<span class="op">$</span>qualif <span class="op">==</span><span class="st"> "Profession intermediaire"</span>] &lt;-<span class="st"> "Intermediaire"</span>
d<span class="op">$</span>qualif.reg[d<span class="op">$</span>qualif <span class="op">==</span><span class="st"> "Technicien"</span>] &lt;-<span class="st"> "Intermediaire"</span>
<span class="kw">table</span>(d<span class="op">$</span>qualif.reg)</code></pre></div>
<pre><code>
        Autre         Cadre       Employe 
           58           260           594 
Intermediaire       Ouvrier 
          246           495 </code></pre>
<p>On peut faire une version encore plus compacte en utilisant l’opérateur logique <em>ou</em> (<code>|</code>) :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>qualif.reg &lt;-<span class="st"> </span><span class="kw">as.character</span>(d<span class="op">$</span>qualif)
d<span class="op">$</span>qualif.reg[d<span class="op">$</span>qualif <span class="op">==</span><span class="st"> "Ouvrier specialise"</span> <span class="op">|</span><span class="st"> </span>d<span class="op">$</span>qualif <span class="op">==</span><span class="st"> </span>
<span class="st">  "Ouvrier qualifie"</span>] &lt;-<span class="st"> "Ouvrier"</span>
d<span class="op">$</span>qualif.reg[d<span class="op">$</span>qualif <span class="op">==</span><span class="st"> "Profession intermediaire"</span> <span class="op">|</span><span class="st"> </span>
<span class="st">  </span>d<span class="op">$</span>qualif <span class="op">==</span><span class="st"> "Technicien"</span>] &lt;-<span class="st"> "Intermediaire"</span>
<span class="kw">table</span>(d<span class="op">$</span>qualif.reg)</code></pre></div>
<pre><code>
        Autre         Cadre       Employe 
           58           260           594 
Intermediaire       Ouvrier 
          246           495 </code></pre>
<p>Enfin, pour terminer ce petit tour d’horizon, on peut également remplacer l’opérateur <code>|</code> par <code>%in%</code>, qui peut parfois être plus lisible :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>qualif.reg &lt;-<span class="st"> </span><span class="kw">as.character</span>(d<span class="op">$</span>qualif)
d<span class="op">$</span>qualif.reg[d<span class="op">$</span>qualif <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"Ouvrier specialise"</span>, 
  <span class="st">"Ouvrier qualifie"</span>)] &lt;-<span class="st"> "Ouvrier"</span>
d<span class="op">$</span>qualif.reg[d<span class="op">$</span>qualif <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"Profession intermediaire"</span>, 
  <span class="st">"Technicien"</span>)] &lt;-<span class="st"> "Intermediaire"</span>
<span class="kw">table</span>(d<span class="op">$</span>qualif.reg)</code></pre></div>
<pre><code>
        Autre         Cadre       Employe 
           58           260           594 
Intermediaire       Ouvrier 
          246           495 </code></pre>
<p>Dans tous les cas le résultat obtenu est une variable de type caractère. On pourra la convertir en facteur par un simple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>qualif.reg &lt;-<span class="st"> </span><span class="kw">factor</span>(d<span class="op">$</span>qualif.reg)</code></pre></div>
<p>Si on souhaite recoder les valeurs manquantes, il suffit de faire appel à la fonction <code data-pkg="base" data-rdoc="NA">is.na</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(d<span class="op">$</span>trav.satisf)</code></pre></div>
<pre><code>
  Satisfaction Insatisfaction      Equilibre 
           480            117            451 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>trav.satisf.reg &lt;-<span class="st"> </span><span class="kw">as.character</span>(d<span class="op">$</span>trav.satisf)
d<span class="op">$</span>trav.satisf.reg[<span class="kw">is.na</span>(d<span class="op">$</span>trav.satisf)] &lt;-<span class="st"> "Manquant"</span>
<span class="kw">table</span>(d<span class="op">$</span>trav.satisf.reg)</code></pre></div>
<pre><code>
     Equilibre Insatisfaction       Manquant 
           451            117            952 
  Satisfaction 
           480 </code></pre>
<div class="note">
<p><code class="pkg">questionr</code> propose une interface interactive pour le recodage d’une variable qualitative (renommage et regroupement de modalités). Cette fonction, nommée <code data-pkg="questionr">irec</code>, s’utilise de la manière suivante :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">irec</span>(d, qualif)</code></pre></div>
<p><strong>RStudio</strong> va alors ouvrir une fenêtre semblable à l’image ci-dessous :</p>
<div class="figure">
<img src="images/capture_irec.png" alt="Capture de irec"><p class="caption">Capture de irec</p>
</div>
<p>Vous pouvez alors sélectionner différentes options, et pour chaque ancienne modalité, indiquer la nouvelle valeur correspondante. Pour regrouper des modalités, il suffit de leur assigner des nouvelles valeurs identiques. Dans tous les cas n’hésitez pas à expérimenter, l’interface se contente de générer du code <strong>R</strong> à copier/coller dans votre script mais ne l’exécute pas, et ne modifie donc jamais vos données !</p>
<p>L’onglet <em>Vérification</em> affiche un tri croisé de l’ancienne et de la nouvelle variable pour vérifier que le recodage est correct. Une fois le résultat satisfaisant, vous pouvez récupérer le code généré dans l’onglet <em>Code</em> pour l’inclure dans votre script.</p>
</div>
<div class="note">
<p>Les exemples précédents montrent bien qu’il est parfois malaisé d’utiliser des facteurs lorsque l’on recode des variables. Les vecteurs labellisés sont, quant à eux, plus souples. <strong>Attention :</strong> avec des vecteurs labellisés, on utilisera les valeurs sous-jacentes et non les étiquettes pour écrire des conditions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(fecondite)
<span class="kw">library</span>(labelled)
<span class="kw">describe</span>(femmes<span class="op">$</span>educ)</code></pre></div>
<pre><code>Warning in table(labelled::to_factor(x, levels),
exclude = exclude, useNA = "ifany"): 'exclude'
containing NA and 'useNA' != "no"' are a bit
contradicting</code></pre>
<pre><code>[2000 obs.] Niveau d'éducation
labelled double: 0 0 0 0 1 0 0 0 0 0 ...
min: 0 - max: 3 - NAs: 0 (0%) - 4 unique values
4 value labels: [0] aucun [1] primaire [2] secondaire [3] supérieur

                  n     %
[0] aucun      1138  56.9
[1] primaire    460  23.0
[2] secondaire  348  17.4
[3] supérieur    54   2.7
Total          2000 100.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">femmes<span class="op">$</span>educ2 &lt;-<span class="st"> </span><span class="dv">0</span>
femmes<span class="op">$</span>educ2[femmes<span class="op">$</span>educ <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="kw">var_label</span>(femmes<span class="op">$</span>educ2) &lt;-<span class="st"> "A atteint un niveau secondaire ou supérieur ?"</span>
<span class="kw">val_labels</span>(femmes<span class="op">$</span>educ2) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">non =</span> <span class="dv">0</span>, <span class="dt">oui =</span> <span class="dv">1</span>)
<span class="kw">describe</span>(femmes<span class="op">$</span>educ2)</code></pre></div>
<pre><code>Warning in table(labelled::to_factor(x, levels),
exclude = exclude, useNA = "ifany"): 'exclude'
containing NA and 'useNA' != "no"' are a bit
contradicting</code></pre>
<pre><code>[2000 obs.] A atteint un niveau secondaire ou supérieur ?
labelled double: 0 0 0 0 0 0 0 0 0 0 ...
min: 0 - max: 1 - NAs: 0 (0%) - 2 unique values
2 value labels: [0] non [1] oui

           n     %
[0] non 1598  79.9
[1] oui  402  20.1
Total   2000 100.0</code></pre>
</div>
</div>
<div id="recodage_variables-calculees" class="section level2">
<h2>Variables calculées</h2>
<p>La création d’une variable numérique à partir de calculs sur une ou plusieurs autres variables numériques se fait très simplement.</p>
<p>Supposons que l’on souhaite calculer une variable indiquant l’écart entre le nombre d’heures passées à regarder la télévision et la moyenne globale de cette variable. On pourrait alors faire :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">range</span>(d<span class="op">$</span>heures.tv, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>[1]  0 12</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(d<span class="op">$</span>heures.tv, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>[1] 2.246566</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>ecart.heures.tv &lt;-<span class="st"> </span>d<span class="op">$</span>heures.tv <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(d<span class="op">$</span>heures.tv, 
  <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
<span class="kw">range</span>(d<span class="op">$</span>ecart.heures.tv, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>[1] -2.246566  9.753434</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(d<span class="op">$</span>ecart.heures.tv, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>[1] 4.714578e-17</code></pre>
<p>Autre exemple tiré du jeu de données <code>rp99</code> : si on souhaite calculer le pourcentage d’actifs dans chaque commune, on peut diviser la population active <var>pop.act</var> par la population totale <var>pop.tot</var>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"rp99"</span>)
rp99<span class="op">$</span>part.actifs &lt;-<span class="st"> </span>rp99<span class="op">$</span>pop.act<span class="op">/</span>rp99<span class="op">$</span>pop.tot <span class="op">*</span><span class="st"> </span><span class="dv">100</span></code></pre></div>
</div>
<div id="recodage_combiner-plusieurs-variables" class="section level2">
<h2>Combiner plusieurs variables</h2>
<p>La combinaison de plusieurs variables se fait à l’aide des techniques d’indexation déjà décrites précédemment. Le plus compliqué est d’arriver à formuler des conditions parfois complexes de manière rigoureuse.</p>
<p>On peut ainsi vouloir combiner plusieurs variables qualitatives en une seule :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>act.manuelles &lt;-<span class="st"> </span><span class="ot">NA</span>
d<span class="op">$</span>act.manuelles[d<span class="op">$</span>cuisine <span class="op">==</span><span class="st"> "Oui"</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>bricol <span class="op">==</span><span class="st"> "Oui"</span>] &lt;-<span class="st"> "Cuisine et Bricolage"</span>
d<span class="op">$</span>act.manuelles[d<span class="op">$</span>cuisine <span class="op">==</span><span class="st"> "Oui"</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>bricol <span class="op">==</span><span class="st"> "Non"</span>] &lt;-<span class="st"> "Cuisine seulement"</span>
d<span class="op">$</span>act.manuelles[d<span class="op">$</span>cuisine <span class="op">==</span><span class="st"> "Non"</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>bricol <span class="op">==</span><span class="st"> "Oui"</span>] &lt;-<span class="st"> "Bricolage seulement"</span>
d<span class="op">$</span>act.manuelles[d<span class="op">$</span>cuisine <span class="op">==</span><span class="st"> "Non"</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>bricol <span class="op">==</span><span class="st"> "Non"</span>] &lt;-<span class="st"> "Ni cuisine ni bricolage"</span>
<span class="kw">table</span>(d<span class="op">$</span>act.manuelles)</code></pre></div>
<pre><code>
    Bricolage seulement    Cuisine et Bricolage 
                    437                     416 
      Cuisine seulement Ni cuisine ni bricolage 
                    465                     682 </code></pre>
<p>On peut également combiner variables qualitatives et variables quantitatives :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>age.sexe &lt;-<span class="st"> </span><span class="ot">NA</span>
d<span class="op">$</span>age.sexe[d<span class="op">$</span>sexe <span class="op">==</span><span class="st"> "Homme"</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>age <span class="op">&lt;</span><span class="st"> </span><span class="dv">40</span>] &lt;-<span class="st"> "Homme moins de 40 ans"</span>
d<span class="op">$</span>age.sexe[d<span class="op">$</span>sexe <span class="op">==</span><span class="st"> "Homme"</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>age <span class="op">&gt;=</span><span class="st"> </span><span class="dv">40</span>] &lt;-<span class="st"> "Homme plus de 40 ans"</span>
d<span class="op">$</span>age.sexe[d<span class="op">$</span>sexe <span class="op">==</span><span class="st"> "Femme"</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>age <span class="op">&lt;</span><span class="st"> </span><span class="dv">40</span>] &lt;-<span class="st"> "Femme moins de 40 ans"</span>
d<span class="op">$</span>age.sexe[d<span class="op">$</span>sexe <span class="op">==</span><span class="st"> "Femme"</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>age <span class="op">&gt;=</span><span class="st"> </span><span class="dv">40</span>] &lt;-<span class="st"> "Femme plus de 40 ans"</span>
<span class="kw">table</span>(d<span class="op">$</span>age.sexe)</code></pre></div>
<pre><code>
Femme moins de 40 ans  Femme plus de 40 ans 
                  376                   725 
Homme moins de 40 ans  Homme plus de 40 ans 
                  315                   584 </code></pre>
<p>Les combinaisons de variables un peu complexes nécessitent parfois un petit travail de réflexion. En particulier, l’ordre des commandes de recodage a parfois une influence dans le résultat final.</p>
<p>Pour combiner rapidement plusieurs variables entre elles, on peut aussi avoir recours à la fonction <code data-pkg="base">interaction</code> qui créra un facteur avec un niveau pour chaque combinaison de modalités des variables sources.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>age20.sexe &lt;-<span class="st"> </span><span class="kw">interaction</span>(d<span class="op">$</span>sexe, d<span class="op">$</span>age20)
<span class="kw">table</span>(d<span class="op">$</span>age20.sexe)</code></pre></div>
<pre><code>
   Homme.&lt;20ans    Femme.&lt;20ans Homme.21-40 ans 
             34              38             291 
Femme.21-40 ans  Homme.41-60ans  Femme.41-60ans 
            369             352             428 
 Homme.61-80ans  Femme.61-80ans    Homme.&gt;80ans 
            205             231              17 
   Femme.&gt;80ans 
             35 </code></pre>
</div>
<div id="recodage_variables-scores" class="section level2">
<h2>Variables scores</h2>
<p>Une variable score est une variable calculée en additionnant des poids accordés aux modalités d’une série de variables qualitatives.</p>
<p>Pour prendre un exemple tout à fait arbitraire, imaginons que nous souhaitons calculer un score d’activités extérieures. Dans ce score on considère que le fait d’aller au cinéma « pèse » 10, celui de pêcher ou chasser vaut 30 et celui de faire du sport vaut 20. On pourrait alors calculer notre score de la manière suivante :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>score.ext &lt;-<span class="st"> </span><span class="dv">0</span>
d<span class="op">$</span>score.ext[d<span class="op">$</span>cinema <span class="op">==</span><span class="st"> "Oui"</span>] &lt;-<span class="st"> </span>d<span class="op">$</span>score.ext[d<span class="op">$</span>cinema <span class="op">==</span><span class="st"> </span>
<span class="st">  "Oui"</span>] <span class="op">+</span><span class="st"> </span><span class="dv">10</span>
d<span class="op">$</span>score.ext[d<span class="op">$</span>peche.chasse <span class="op">==</span><span class="st"> "Oui"</span>] &lt;-<span class="st"> </span>d<span class="op">$</span>score.ext[d<span class="op">$</span>peche.chasse <span class="op">==</span><span class="st"> </span>
<span class="st">  "Oui"</span>] <span class="op">+</span><span class="st"> </span><span class="dv">30</span>
d<span class="op">$</span>score.ext[d<span class="op">$</span>sport <span class="op">==</span><span class="st"> "Oui"</span>] &lt;-<span class="st"> </span>d<span class="op">$</span>score.ext[d<span class="op">$</span>sport <span class="op">==</span><span class="st"> </span>
<span class="st">  "Oui"</span>] <span class="op">+</span><span class="st"> </span><span class="dv">20</span>
<span class="kw">table</span>(d<span class="op">$</span>score.ext)</code></pre></div>
<pre><code>
  0  10  20  30  40  50  60 
800 342 229 509  31  41  48 </code></pre>
<p>Cette notation étant un peu lourde, on peut l’alléger un peu en utilisant la fonction <code data-pkg="base">ifelse</code>. Celle-ci prend en argument une condition et deux valeurs. Si la condition est vraie elle retourne la première valeur, sinon elle retourne la seconde.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>score.ext &lt;-<span class="st"> </span><span class="dv">0</span>
d<span class="op">$</span>score.ext &lt;-<span class="st"> </span><span class="kw">ifelse</span>(d<span class="op">$</span>cinema <span class="op">==</span><span class="st"> "Oui"</span>, <span class="dv">10</span>, <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ifelse</span>(d<span class="op">$</span>peche.chasse <span class="op">==</span><span class="st"> </span>
<span class="st">  "Oui"</span>, <span class="dv">30</span>, <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ifelse</span>(d<span class="op">$</span>sport <span class="op">==</span><span class="st"> "Oui"</span>, <span class="dv">20</span>, <span class="dv">0</span>)
<span class="kw">table</span>(d<span class="op">$</span>score.ext)</code></pre></div>
<pre><code>
  0  10  20  30  40  50  60 
800 342 229 509  31  41  48 </code></pre>
</div>
<div id="recodage_verification-des-recodages" class="section level2">
<h2>Vérification des recodages</h2>
<p>Il est très important de vérifier, notamment après les recodages les plus complexes, qu’on a bien obtenu le résultat escompté. Les deux points les plus sensibles étant les valeurs manquantes et les erreurs dans les conditions.</p>
<p>Pour vérifier tout cela, le plus simple est sans doute de faire des tableaux croisés entre la variable recodée et celles ayant servi au recodage, à l’aide des fonctions <code data-pkg="base">table</code> ou <code data-pkg="stats">xtabs</code>, et de vérifier le nombre de valeurs manquantes dans la variable recodée avec <code data-pkg="base">summary</code>, <code data-pkg="questionr">freq</code> ou <code data-pkg="base">table</code>.</p>
<p>Par exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>act.manuelles &lt;-<span class="st"> </span><span class="ot">NA</span>
d<span class="op">$</span>act.manuelles[d<span class="op">$</span>cuisine <span class="op">==</span><span class="st"> "Oui"</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>bricol <span class="op">==</span><span class="st"> "Oui"</span>] &lt;-<span class="st"> "Cuisine et Bricolage"</span>
d<span class="op">$</span>act.manuelles[d<span class="op">$</span>cuisine <span class="op">==</span><span class="st"> "Oui"</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>bricol <span class="op">==</span><span class="st"> "Non"</span>] &lt;-<span class="st"> "Cuisine seulement"</span>
d<span class="op">$</span>act.manuelles[d<span class="op">$</span>cuisine <span class="op">==</span><span class="st"> "Non"</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>bricol <span class="op">==</span><span class="st"> "Oui"</span>] &lt;-<span class="st"> "Bricolage seulement"</span>
d<span class="op">$</span>act.manuelles[d<span class="op">$</span>cuisine <span class="op">==</span><span class="st"> "Non"</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>bricol <span class="op">==</span><span class="st"> "Non"</span>] &lt;-<span class="st"> "Ni cuisine ni bricolage"</span>
<span class="kw">table</span>(d<span class="op">$</span>act.manuelles, d<span class="op">$</span>cuisine)</code></pre></div>
<pre><code>                         
                          Non Oui
  Bricolage seulement     437   0
  Cuisine et Bricolage      0 416
  Cuisine seulement         0 465
  Ni cuisine ni bricolage 682   0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(d<span class="op">$</span>act.manuelles, d<span class="op">$</span>bricol)</code></pre></div>
<pre><code>                         
                          Non Oui
  Bricolage seulement       0 437
  Cuisine et Bricolage      0 416
  Cuisine seulement       465   0
  Ni cuisine ni bricolage 682   0</code></pre>
</div>
<div id="recodage_recodage-et-data.table" class="section level2">
<h2>Recodage et data.table</h2>
<p>Nous aborderons dans un <a href="#introduction-a-data-table">prochain chapitre</a> l’extension <code class="pkg">data.table</code> qui étend les tableaux de données et modifie complètement la syntaxe utilisée entre les crochets. Elle nécessite un petit temps d’adaptation mais, une fois maîtrisée, elle facile le quotidien lorsqu’il s’agit de manipuler et recoder les données. Ci-dessous, un petit avant-goût, reprenons quelques exemples précédents. La syntaxe de <code class="pkg">data.table</code> sera explicitée en détail dans le <a href="#introduction-a-data-table">chapitre dédié</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(data.table)
dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(hdv2003)

dt[, score.ext <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">0</span>]
dt[cinema <span class="op">==</span><span class="st"> "Oui"</span>, score.ext <span class="op">:</span><span class="er">=</span><span class="st"> </span>score.ext <span class="op">+</span><span class="st"> </span><span class="dv">10</span>]
dt[peche.chasse <span class="op">==</span><span class="st"> "Oui"</span>, score.ext <span class="op">:</span><span class="er">=</span><span class="st"> </span>score.ext <span class="op">+</span><span class="st"> </span><span class="dv">30</span>]
dt[sport <span class="op">==</span><span class="st"> "Oui"</span>, score.ext <span class="op">:</span><span class="er">=</span><span class="st"> </span>score.ext <span class="op">+</span><span class="st"> </span><span class="dv">20</span>]
<span class="kw">table</span>(dt<span class="op">$</span>score.ext)</code></pre></div>
<pre><code>
  0  10  20  30  40  50  60 
800 342 229 509  31  41  48 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt[cuisine <span class="op">==</span><span class="st"> "Oui"</span> <span class="op">&amp;</span><span class="st"> </span>bricol <span class="op">==</span><span class="st"> "Oui"</span>, act.manuelles <span class="op">:</span><span class="er">=</span><span class="st"> "Cuisine et Bricolage"</span>]
dt[cuisine <span class="op">==</span><span class="st"> "Oui"</span> <span class="op">&amp;</span><span class="st"> </span>bricol <span class="op">==</span><span class="st"> "Non"</span>, act.manuelles <span class="op">:</span><span class="er">=</span><span class="st"> "Cuisine seulement"</span>]
dt[cuisine <span class="op">==</span><span class="st"> "Non"</span> <span class="op">&amp;</span><span class="st"> </span>bricol <span class="op">==</span><span class="st"> "Oui"</span>, act.manuelles <span class="op">:</span><span class="er">=</span><span class="st"> "Bricolage seulement"</span>]
dt[cuisine <span class="op">==</span><span class="st"> "Non"</span> <span class="op">&amp;</span><span class="st"> </span>bricol <span class="op">==</span><span class="st"> "Non"</span>, act.manuelles <span class="op">:</span><span class="er">=</span><span class="st"> "Ni cuisine ni bricolage"</span>]
<span class="kw">table</span>(dt<span class="op">$</span>act.manuelles)</code></pre></div>
<pre><code>
    Bricolage seulement    Cuisine et Bricolage 
                    437                     416 
      Cuisine seulement Ni cuisine ni bricolage 
                    465                     682 </code></pre>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="recodage_fn1"><p>On priviligiera la fonction <code data-pkg="labelled">to_factor</code> à la fonction <code data-pkg="haven" data-rdoc="labelled">as_factor</code> de l’extension <code class="pkg">haven</code>, la première ayant plus de possibilités et un comportement plus consistent.<a href="#recodage_fnref1"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="ou-trouver-de-l-aide"><div class="fluid-row" id="ou-trouver-de-l-aide_header">



<h1 class="title toc-ignore">Où trouver de l’aide ?</h1>

</div>

<div class="TOC">
<ul>
<li>
<a href="#ou-trouver-de-l-aide_aide-en-ligne">Aide en ligne</a><ul>
<li><a href="#ou-trouver-de-l-aide_aide-sur-une-fonction">Aide sur une fonction</a></li>
<li><a href="#ou-trouver-de-l-aide_naviguer-dans-laide">Naviguer dans l’aide</a></li>
</ul>
</li>
<li>
<a href="#ou-trouver-de-l-aide_ressources-sur-le-web">Ressources sur le Web</a><ul>
<li><a href="#ou-trouver-de-l-aide_moteur-de-recherche">Moteur de recherche</a></li>
<li><a href="#ou-trouver-de-l-aide_aide-en-ligne-1">Aide en ligne</a></li>
<li><a href="#ou-trouver-de-l-aide_ressources-officielles">Ressources officielles</a></li>
<li><a href="#ou-trouver-de-l-aide_revue">Revue</a></li>
<li><a href="#ou-trouver-de-l-aide_ressources-francophones">Ressources francophones</a></li>
<li><a href="#ou-trouver-de-l-aide_rstudio">RStudio</a></li>
<li><a href="#ou-trouver-de-l-aide_antiseches-cheatsheet">Antisèches (cheatsheet)</a></li>
</ul>
</li>
<li>
<a href="#ou-trouver-de-l-aide_ou-poser-des-questions">Où poser des questions ?</a><ul>
<li><a href="#ou-trouver-de-l-aide_les-forums-danalyse-r">Les forums d’analyse-R</a></li>
<li><a href="#ou-trouver-de-l-aide_liste-r-soc">Liste R-soc</a></li>
<li><a href="#ou-trouver-de-l-aide_stackoverflow">StackOverflow</a></li>
<li><a href="#ou-trouver-de-l-aide_forum-web-en-francais">Forum Web en français</a></li>
<li><a href="#ou-trouver-de-l-aide_canaux-irc-chat">Canaux IRC (chat)</a></li>
<li><a href="#ou-trouver-de-l-aide_listes-de-discussion-officielles">Listes de discussion officielles</a></li>
</ul>
</li>
</ul>
</div>

<div class="note">
<p>La version originale de ce chapitre a été écrite par Julien Barnier dans le cadre du support de cours <a href="https://github.com/juba/intro-r">Introduction à R</a>.</p>
</div>
<div id="ou-trouver-de-l-aide_aide-en-ligne" class="section level2">
<h2>Aide en ligne</h2>
<p><strong>R</strong> dispose d’une <dfn>aide en ligne</dfn> très complète, mais dont l’usage n’est pas forcément très simple. D’une part car elle est intégralement en anglais, d’autre part car son organisation prend un certain temps à être maîtrisée.</p>
<div id="ou-trouver-de-l-aide_aide-sur-une-fonction" class="section level3">
<h3>Aide sur une fonction</h3>
<p>La fonction la plus utile est sans doute <code data-pkg="utils">help</code> (ou son équivalent <code data-pkg="utils" data-rdoc="Question">?</code>) qui permet d’afficher la page d’aide liée à une ou plusieurs fonctions. Celle-ci permet de lister les arguments de la fonction, d’avoir des informations détaillées sur son fonctionnement, les résultats qu’elle retourne, etc.</p>
<p>Pour accéder à l’aide de la fonction <code data-pkg="base">mean</code>, par exemple, il vous suffit de saisir directement :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?mean</code></pre></div>
<p>ou bien</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">help</span>(<span class="st">"mean"</span>)</code></pre></div>
<p>Sous <strong>RStudio</strong>, la page d’aide correspondante s’affichera sous l’onglet <em>Help</em> dans le quadrant inférieur droit.</p>
<p>Chaque page d’aide comprend plusieurs sections, en particulier :</p>
<table>
<thead><tr class="header">
<th align="left">Section</th>
<th align="left">Contenu</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><em>Description</em></td>
<td align="left">donne un résumé en une phrase de ce que fait la fonction</td>
</tr>
<tr class="even">
<td align="left"><em>Usage</em></td>
<td align="left">indique la ou les manières de l’utiliser</td>
</tr>
<tr class="odd">
<td align="left"><em>Arguments</em></td>
<td align="left">détaille tous les arguments possibles et leur signification</td>
</tr>
<tr class="even">
<td align="left"><em>Value</em></td>
<td align="left">indique la forme du résultat renvoyé par la fonction</td>
</tr>
<tr class="odd">
<td align="left"><em>Details</em></td>
<td align="left">apporte des précisions sur le fonctionnement de la fonction</td>
</tr>
<tr class="even">
<td align="left"><em>Note</em></td>
<td align="left">pour des remarques éventuelles</td>
</tr>
<tr class="odd">
<td align="left"><em>References</em></td>
<td align="left">pour des références bibliographiques ou des URL associées</td>
</tr>
<tr class="even">
<td align="left"><em>See Also</em></td>
<td align="left">très utile, renvoie vers d’autres fonctions semblables ou liées, ce qui peut être très utile pour découvrir ou retrouver une fonction dont on a oublié le nom</td>
</tr>
<tr class="odd">
<td align="left"><em>Examples</em></td>
<td align="left">série d’exemples d’utilisation</td>
</tr>
</tbody>
</table>
<p>Les exemples peuvent être directement exécutés en utilisant la fonction <code data-pkg="utils">example</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">example</span>(mean)</code></pre></div>
<pre><code>
mean&gt; x &lt;- c(0:10, 50)

mean&gt; xm &lt;- mean(x)

mean&gt; c(xm, mean(x, trim = 0.10))
[1] 8.75 5.50</code></pre>
</div>
<div id="ou-trouver-de-l-aide_naviguer-dans-laide" class="section level3">
<h3>Naviguer dans l’aide</h3>
<p>La fonction <code data-pkg="utils">help.start</code> permet d’afficher le sommaire de l’aide en ligne. Saisissez simplement :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">help.start</span>()</code></pre></div>
<p>Si vous souhaitez rechercher quelque chose dans le contenu de l’aide, vous pouvez utiliser la fonction <code data-pkg="utils">help.search</code> (ou <code data-pkg="utils" data-rdoc="help.search">??</code> qui est équivalente) qui renvoie une liste des pages d’aide contenant les termes recherchés.</p>
<p>Par exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">help.search</span>(<span class="st">"logistic"</span>)</code></pre></div>
<p>ou</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">??logistic</code></pre></div>
<p>pour rechercher les pages de l’aide qui contiennent le terme <em>logistic</em>.</p>
</div>
</div>
<div id="ou-trouver-de-l-aide_ressources-sur-le-web" class="section level2">
<h2>Ressources sur le Web</h2>
<p>De nombreuses ressources existent en ligne, mais la plupart sont en anglais.</p>
<div id="ou-trouver-de-l-aide_moteur-de-recherche" class="section level3">
<h3>Moteur de recherche</h3>
<p>Le fait que le logiciel s’appelle <strong>R</strong> ne facilite malheureusement pas les recherches sur le Web… La solution à ce problème a été trouvée grâce à la constitution d’un moteur de recherche <em>ad hoc</em> à partir de <strong>Google</strong>, nommé <strong>Rseek</strong> :<br><a href="http://www.rseek.org/" class="uri">http://www.rseek.org/</a>.</p>
<p>Les requêtes saisies dans <strong>Rseek</strong> sont exécutées dans des corpus prédéfinis liés à <strong>R</strong>, notamment les documents et manuels, les listes de discussion ou le code source du programme.</p>
<p>Les requêtes devront cependant être formulées en anglais.</p>
</div>
<div id="ou-trouver-de-l-aide_aide-en-ligne-1" class="section level3">
<h3>Aide en ligne</h3>
<p>Le site <strong>R documentation</strong> propose un accès clair et rapide à la documentation de <strong>R</strong> et des extensions hébergées sur le <strong>CRAN</strong> (ainsi que certaines extensions hébergées sur <strong>GitHub</strong>). Il permet notamment de rechercher et naviguer facilement entre les pages des différentes fonctions :<br><a href="http://www.rdocumentation.org/" class="uri">http://www.rdocumentation.org/</a>.</p>
</div>
<div id="ou-trouver-de-l-aide_ressources-officielles" class="section level3">
<h3>Ressources officielles</h3>
<p>La documentation officielle de <strong>R</strong> est accessible en ligne depuis le site du projet :<br><a href="http://www.r-project.org/" class="uri">http://www.r-project.org/</a>.</p>
<p>Les liens de l’entrée <em>Documentation</em> du menu de gauche vous permettent d’accéder à différentes ressources.</p>
<div id="ou-trouver-de-l-aide_manuels" class="section level4">
<h4>Manuels</h4>
<p>Les <em>manuels</em> sont des documents complets de présentation de certains aspects de <strong>R</strong>. Ils sont accessibles en ligne, ou téléchargeables au format <strong>PDF</strong> :<br><a href="http://cran.r-project.org/manuals.html" class="uri">http://cran.r-project.org/manuals.html</a>.</p>
<p>On notera plus particulièrement <em>An introduction to R</em>, normalement destiné aux débutants, mais qui nécessite quand même un minimum d’aisance en informatique et en statistiques :<br><a href="http://cran.r-project.org/doc/manuals/R-intro.html" class="uri">http://cran.r-project.org/doc/manuals/R-intro.html</a>.</p>
<p><em>R Data Import/Export</em> explique notamment comment importer des données depuis d’autres logiciels :<br><a href="http://cran.r-project.org/doc/manuals/R-data.html" class="uri">http://cran.r-project.org/doc/manuals/R-data.html</a>.</p>
</div>
<div id="ou-trouver-de-l-aide_faq" class="section level4">
<h4>FAQ</h4>
<p>Les <em>FAQ</em> (<em>frequently asked questions</em>) regroupent des questions fréquemment posées et leurs réponses. À lire donc ou, au moins, à parcourir avant toute chose :<br><a href="http://cran.r-project.org/faqs.html" class="uri">http://cran.r-project.org/faqs.html</a>.</p>
<p>La FAQ la plus utile est la FAQ généraliste sur <strong>R</strong> :<br><a href="http://cran.r-project.org/doc/FAQ/R-FAQ.html" class="uri">http://cran.r-project.org/doc/FAQ/R-FAQ.html</a>.</p>
<p>Mais il existe également une FAQ dédiée aux questions liées à <strong>Windows</strong> et une autre à la plateforme <strong>Mac OS X</strong>.</p>
<div class="note">
<p>Les manuels et les FAQ sont accessibles même si vous n’avez pas d’accès à Internet en utilisant la fonction <code data-pkg="utils">help.start</code> décrite précédemment.</p>
</div>
</div>
<div id="ou-trouver-de-l-aide_r-announce" class="section level4">
<h4>R-announce</h4>
<p><strong>R-announce</strong> est la liste de diffusion électronique officielle du projet. Elle ne comporte qu’un nombre réduit de messages (quelques-uns par mois tout au plus) et diffuse les annonces concernant de nouvelles versions de R ou d’autres informations particulièrement importantes. On peut s’y abonner à l’adresse suivante :<br><a href="https://stat.ethz.ch/mailman/listinfo/r-announce" class="uri">https://stat.ethz.ch/mailman/listinfo/r-announce</a></p>
</div>
<div id="ou-trouver-de-l-aide_r-journal" class="section level4">
<h4>R Journal</h4>
<p><strong>R Journal</strong> est la « revue » officielle du projet <strong>R</strong>, qui a succédé début 2009 à la lettre de nouvelles <strong>R News</strong>. Elle paraît entre deux et cinq fois par an et contient des informations sur les nouvelles versions du logiciel, des articles présentant des extensions, des exemples d’analyse… Les parutions sont annoncées sur la liste de diffusion <strong>R-announce</strong> et les numéros sont téléchargeables à l’adresse suivante :<br><a href="http://journal.r-project.org/" class="uri">http://journal.r-project.org/</a>.</p>
</div>
<div id="ou-trouver-de-l-aide_autres-documents" class="section level4">
<h4>Autres documents</h4>
<p>On trouvera de nombreux documents dans différentes langues, en général au format <strong>PDF</strong>, dans le répertoire suivant :<br><a href="http://cran.r-project.org/doc/contrib/" class="uri">http://cran.r-project.org/doc/contrib/</a>.</p>
<p>Parmi ceux-ci, les cartes de référence peuvent être très utiles, ce sont des aides-mémoire recensant les fonctions les plus courantes :<br><a href="http://cran.r-project.org/doc/contrib/Short-refcard.pdf" class="uri">http://cran.r-project.org/doc/contrib/Short-refcard.pdf</a></p>
<p>On notera également un document d’introduction en anglais progressif et s’appuyant sur des méthodes statistiques relativement simples :<br><a href="http://cran.r-project.org/doc/contrib/Verzani-SimpleR.pdf" class="uri">http://cran.r-project.org/doc/contrib/Verzani-SimpleR.pdf</a></p>
<p>Pour les utilisateurs déjà habitués à <strong>SAS</strong> ou <strong>SPSS</strong>, le livre <em>R for SAS and SPSS Users</em> et le document gratuit qui en est tiré peuvent être de bonnes ressources, tout comme le site web <strong>Quick-R</strong> :<br><a href="http://rforsasandspssusers.com/" class="uri">http://rforsasandspssusers.com/</a> et <a href="http://www.statmethods.net/" class="uri">http://www.statmethods.net/</a>.</p>
</div>
</div>
<div id="ou-trouver-de-l-aide_revue" class="section level3">
<h3>Revue</h3>
<p>La revue <em>Journal of Statistical Software</em> est une revue électronique anglophone, dont les articles sont en accès libre, et qui traite de l’utilisation de logiciels d’analyse de données dans un grand nombre de domaines. De nombreux articles (la majorité) sont consacrés à <strong>R</strong> et à la présentation d’extensions plus ou moins spécialisées.</p>
<p>Les articles qui y sont publiés prennent souvent la forme de tutoriels plus ou moins accessibles mais qui fournissent souvent une bonne introduction et une ressource riche en informations et en liens.</p>
<p>Adresse de la revue :<br><a href="http://www.jstatsoft.org/" class="uri">http://www.jstatsoft.org/</a></p>
</div>
<div id="ou-trouver-de-l-aide_ressources-francophones" class="section level3">
<h3>Ressources francophones</h3>
<p>Il existe des ressources en français sur l’utilisation de <strong>R</strong>, mais peu sont réellement destinées aux débutants, elles nécessitent en général des bases à la fois en informatique et en statistique.</p>
<p>Le document le plus abordable et le plus complet est sans doute <em>R pour les débutants</em>, d’Emmanuel Paradis, accessible au format <strong>PDF</strong> :<br><a href="http://cran.r-project.org/doc/contrib/Paradis-rdebuts_fr.pdf" class="uri">http://cran.r-project.org/doc/contrib/Paradis-rdebuts_fr.pdf</a>.</p>
<p>La somme de documentation en français la plus importante liée à <strong>R</strong> est sans nulle doute celle mise à disposition par le Pôle bioinformatique lyonnais. Leur site propose des cours complets de statistique utilisant <strong>R</strong> :<br><a href="http://pbil.univ-lyon1.fr/R/enseignement.html" class="uri">http://pbil.univ-lyon1.fr/R/enseignement.html</a>.</p>
<p>La plupart des documents sont assez pointus niveau mathématique et plutôt orientés biostatistique, mais on trouvera des documents plus introductifs ici :<br><a href="http://pbil.univ-lyon1.fr/R/html/cours1" class="uri">http://pbil.univ-lyon1.fr/R/html/cours1</a>.</p>
<p>Dans tous les cas la somme de travail et de connaissances mise à disposition librement est impressionnante… Enfin, le site de Vincent Zoonekynd (<a href="http://zoonek2.free.fr/UNIX/48_R_2004/all.html" class="uri">http://zoonek2.free.fr/UNIX/48_R_2004/all.html</a>) comprend de nombreuses notes prises au cours de sa découverte du logiciel. On notera cependant que l’auteur est normalien et docteur en mathématiques…</p>
</div>
<div id="ou-trouver-de-l-aide_rstudio" class="section level3">
<h3>RStudio</h3>
<p>La documentation officielle de <strong>RStudio</strong> est disponible sur <a href="https://support.rstudio.com" class="uri">https://support.rstudio.com</a> (catégorie <em>Documentation</em> disponible en milieu de page).</p>
</div>
<div id="ou-trouver-de-l-aide_antiseches-cheatsheet" class="section level3">
<h3>Antisèches (cheatsheet)</h3>
<p>On peut trouver un peu partout sur internet des antisèches (<em>cheatsheets</em> en anglais) qui sont en général un fichier <strong>PDF</strong> résumant les principales fonctions d’une extension ou d’une problématique donnée. Ces antisèches peuvent être imprimées afin de les avoir facilement à porter de main.</p>
<p>Pour les trouver, il suffit d’effectuer une recherche <strong>Google</strong> avec les mots-clés <code>R cheatsheet</code> ou <code>&lt;pkg&gt; cheatsheet</code> en remplacant <code>&lt;pkg&gt;</code> par le nom du package qui nous intéresse.</p>
</div>
</div>
<div id="ou-trouver-de-l-aide_ou-poser-des-questions" class="section level2">
<h2>Où poser des questions ?</h2>
<p>La communauté des utilisateurs de <strong>R</strong> est très active et en général très contente de pouvoir répondre aux questions (nombreuses) des débutants et à celles (tout aussi nombreuses) des utilisateurs plus expérimentés. Dans tous les cas, les règles de base à respecter avant de poser une question sont toujours les mêmes : avoir cherché soi-même la réponse auparavant, notamment dans les FAQ et dans l’aide en ligne, et poser sa question de la manière la plus claire possible, de préférence avec un exemple de code posant problème.</p>
<div id="ou-trouver-de-l-aide_les-forums-danalyse-r" class="section level3">
<h3>Les forums d’analyse-R</h3>
<p>En premier lieu (autopromotion oblige), chaque chapitre du site d’<strong>analyse-R</strong> (<a href="http://larmarange.github.io/analyse-R/" class="uri">http://larmarange.github.io/analyse-R/</a>) comporte en bas de page une fonctionnalité permettant de laisser des commentaires. On peut donc y poser une question en lien avec le chapitre concerné.</p>
</div>
<div id="ou-trouver-de-l-aide_liste-r-soc" class="section level3">
<h3>Liste R-soc</h3>
<p>Une liste de discussion a été créée spécialement pour permettre aide et échanges autour de l’utilisation de <strong>R</strong> en sciences sociales. Elle est hébergée par le CRU et on peut s’y abonner à l’adresse suivante : <br><a href="https://listes.cru.fr/sympa/subscribe/r-soc" class="uri">https://listes.cru.fr/sympa/subscribe/r-soc</a>.</p>
<p>Grâce aux services offerts par le site <strong>gmane.org</strong>, la liste est également disponible sous d’autres formes (forum Web, blog, <strong>NNTP</strong>, flux <strong>RSS</strong>) permettant de lire et de poster sans avoir à s’inscrire et à recevoir les messages sous forme de courrier électronique. Pour plus d’informations :<br><a href="http://dir.gmane.org/gmane.comp.lang.r.user.french" class="uri">http://dir.gmane.org/gmane.comp.lang.r.user.french</a>.</p>
</div>
<div id="ou-trouver-de-l-aide_stackoverflow" class="section level3">
<h3>StackOverflow</h3>
<p>Le site <strong>StackOverflow</strong> (qui fait partie de la famille des sites <strong>StackExchange</strong>) comprend une section (anglophone) dédiée à <strong>R</strong> qui permet de poser des questions et en général d’obtenir des réponses assez rapidement :<br><a href="http://stackoverflow.com/questions/tagged/r" class="uri">http://stackoverflow.com/questions/tagged/r</a>.</p>
<p>La première chose à faire, évidemment, est de vérifier que sa question n’a pas déjà été posée.</p>
</div>
<div id="ou-trouver-de-l-aide_forum-web-en-francais" class="section level3">
<h3>Forum Web en français</h3>
<p>Le Cirad a mis en ligne un forum dédié aux utilisateurs de <strong>R</strong>, très actif :<br><a href="http://forums.cirad.fr/logiciel-R/index.php" class="uri">http://forums.cirad.fr/logiciel-R/index.php</a>.</p>
<p>Les questions diverses et variées peuvent être posées dans la rubrique <em>Questions en cours</em> :<br><a href="http://forums.cirad.fr/logiciel-R/viewforum.php?f=3" class="uri">http://forums.cirad.fr/logiciel-R/viewforum.php?f=3</a>.</p>
<p>Il est tout de même conseillé de faire une recherche rapide sur le forum avant de poser une question, pour voir si la réponse ne s’y trouverait pas déjà.</p>
</div>
<div id="ou-trouver-de-l-aide_canaux-irc-chat" class="section level3">
<h3>Canaux IRC (chat)</h3>
<p>L’<strong>IRC</strong>, ou <em>Internet Relay Chat</em> est le vénérable ancêtre toujours très actif des messageries instantanées actuelles. Un canal (en anglais) est notamment dédié aux échanges autour de <strong>R</strong> (<code>#R</code>).</p>
<p>Si vous avez déjà l’habitude d’utiliser <strong>IRC</strong>, il vous suffit de pointer votre client préféré sur <strong>Freenode</strong> (<code>irc.freenode.net</code>) puis de rejoindre l’un des canaux en question.</p>
<p>Sinon, le plus simple est certainement d’utiliser l’interface web de <strong>Mibbit</strong>, accessible à l’adresse <a href="http://www.mibbit.com/" class="uri">http://www.mibbit.com/</a>.</p>
<p>Dans le champ <em>Connect to IRC</em>, sélectionnez <em>Freenode.net</em>, puis saisissez un pseudonyme dans le champ <em>Nick</em> et <code>#R</code> dans le champ <em>Channel</em>. Vous pourrez alors discuter directement avec les personnes présentes.</p>
<p>Le canal #R est normalement peuplé de personnes qui seront très heureuses de répondre à toutes les questions, et en général l’ambiance y est très bonne. Une fois votre question posée, n’hésitez pas à être patient et à attendre quelques minutes, voire quelques heures, le temps qu’un des habitués vienne y faire un tour.</p>
</div>
<div id="ou-trouver-de-l-aide_listes-de-discussion-officielles" class="section level3">
<h3>Listes de discussion officielles</h3>
<p>La liste de discussion d’entraide (par courrier électronique) officielle du logiciel <strong>R</strong> s’appelle <strong>R-help</strong>. On peut s’y abonner à l’adresse suivante, mais il s’agit d’une liste avec de nombreux messages :<br><a href="https://stat.ethz.ch/mailman/listinfo/r-help" class="uri">https://stat.ethz.ch/mailman/listinfo/r-help</a>.</p>
<p>Pour une consultation ou un envoi ponctuels, le mieux est sans doute d’utiliser les interfaces Web fournies par <strong>gmane.org</strong> :<br><a href="http://blog.gmane.org/gmane.comp.lang.r.general" class="uri">http://blog.gmane.org/gmane.comp.lang.r.general</a>.</p>
<p><strong>R-help</strong> est une liste avec de nombreux messages, suivie par des spécialistes de <strong>R</strong>, dont certains des développeurs principaux. Elle est cependant à réserver aux questions particulièrement techniques qui n’ont pas trouvé de réponses par d’autres biais.</p>
<p>Dans tous les cas, il est nécessaire avant de poster sur cette liste de bien avoir pris connaissance du <em>posting guide</em> correspondant :<br><a href="http://www.r-project.org/posting-guide.html" class="uri">http://www.r-project.org/posting-guide.html</a>.</p>
<p>Plusieurs autres listes plus spécialisées existent également, elles sont listées à l’adresse suivante : <br><a href="http://www.r-project.org/mail.html" class="uri">http://www.r-project.org/mail.html</a>.</p>
</div>
</div>

</article>
<article id="introduction-a-dplyr"><div class="fluid-row" id="introduction-a-dplyr_header">



<h1 class="title toc-ignore">Introduction à dplyr</h1>

</div>

<div class="TOC">
<ul>
<li>
<a href="#introduction-a-dplyr_les-tibbles">Les tibbles</a><ul>
<li><a href="#introduction-a-dplyr_dplyr-et-data.table">dplyr et data.table</a></li>
</ul>
</li>
<li><a href="#introduction-a-dplyr_principaux-verbes">Principaux verbes</a></li>
<li><a href="#introduction-a-dplyr_enchainer-les-operations">Enchaîner les opérations</a></li>
</ul>
</div>

<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>
<p>Pour une introduction à <code class="pkg">dplyr</code> en anglais, voir la vignette officielle : <a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html" class="uri">https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html</a>. On pourra également se référer à <a href="https://rpubs.com/justmarkham/dplyr-tutorial" class="uri">https://rpubs.com/justmarkham/dplyr-tutorial</a>.</p>
<div id="introduction-a-dplyr_les-tibbles" class="section level1">
<h1>Les tibbles</h1>
<p>L’extension <code class="pkg">tibble</code> permet d’étendre les data.frame en améliorant la manière dont les tableaux sont affichés dans la console et ayant un comportement plus uniforme concernant les noms de colonnes et la manière d’extraire des éléments avec les crochets simples et doubles.</p>
<p>Voir <a href="https://cran.r-project.org/web/packages/tibble/vignettes/tibble.html" class="uri">https://cran.r-project.org/web/packages/tibble/vignettes/tibble.html</a> pour plus de détails.</p>
<p>Cela ne modifie pas radicalement les tableaux de données, mais lorsque l’on travail avec <code class="pkg">dplyr</code>, il est préférable de convertir ses tableaux de données en <em>tibble</em> ce qui se fait aisément avec la fonction <code data_pkg="dplyr">tbl_df</code> fournie avec <code class="pkg">dplyr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)</code></pre></div>
<pre><code>
Attaching package: 'dplyr'</code></pre>
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris2 &lt;-<span class="st"> </span><span class="kw">tbl_df</span>(iris)
<span class="kw">class</span>(iris2)</code></pre></div>
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
<p>Comme on le voit, cela ajoute plusieurs classes additionnelles au tableau de données, celui-ci restant malgré tout toujours un <em>data.frame</em>.</p>
<p><code class="pkg">dplyr</code> et <code class="pkg">tibble</code> propose également une petite fonction bien pratique pour <q>jeter un coup d’oeil</q> à ses données : <code data-pkg="tibble">glimpse</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(iris2)</code></pre></div>
<pre><code>Observations: 150
Variables: 5
$ Sepal.Length &lt;dbl&gt; 5.1, 4.9, 4.7, 4.6, 5.0,...
$ Sepal.Width  &lt;dbl&gt; 3.5, 3.0, 3.2, 3.1, 3.6,...
$ Petal.Length &lt;dbl&gt; 1.4, 1.4, 1.3, 1.5, 1.4,...
$ Petal.Width  &lt;dbl&gt; 0.2, 0.2, 0.2, 0.2, 0.2,...
$ Species      &lt;fctr&gt; setosa, setosa, setosa,...</code></pre>
<p>Il faut également noter que le format <em>tibble</em> est celui dans lequel les données sont importées lorsque l’on utilise les fonctions d’import des extensions <code class="pkg">readr</code>, <code class="pkg">haven</code> et <code class="pkg">readxl</code> (voir le chapitre <a href="#import-de-donnees">Import de données</a>).</p>
<div id="introduction-a-dplyr_dplyr-et-data.table" class="section level2">
<h2>dplyr et data.table</h2>
<p>Pour ceux travaillant également avec l’extension <code class="pkg">data.table</code>, il est possible de concilier <em>tibble</em> et <em>data.table</em> avec l’extension <code class="pkg">dtplyr</code> et sa fonction <code data-pkg="dtplyr">tbl_dt</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dtplyr)
iris_dt &lt;-<span class="st"> </span><span class="kw">tbl_dt</span>(iris)
<span class="kw">class</span>(iris_dt)</code></pre></div>
<pre><code>[1] "tbl_dt"     "tbl"        "data.table"
[4] "data.frame"</code></pre>
<p>Le tableau de données est à la fois compatible avec <code class="pkg">data.table</code> (et notamment sa syntaxe particulière des crochets) et les verbes de <code class="pkg">dplyr</code>.</p>
</div>
</div>
<div id="introduction-a-dplyr_principaux-verbes" class="section level1">
<h1>Principaux verbes</h1>
<p><code class="pkg">dplyr</code> est construit autour de fonctions nommées selon des verbes anglais. Chaque verbe prends comme premier argument un tableau de données, les options étant indiquées à la suite. Chacune de ces fonctions renvoie à son tour un tableau de données.</p>
<ul>
<li>
<code data-pkg="dplyr">filter</code> pour sélectionner des observation selon une condition</li>
<li>
<code data-pkg="dplyr">slice</code> pour sélectionner des observations selon leur position</li>
<li>
<code data-pkg="dplyr">arrange</code> pour trier les observations</li>
<li>
<code data-pkg="dplyr">select</code> pour sélectionner des variables</li>
<li>
<code data-pkg="dplyr" data-rdoc="dplyr">rename</code> pour renommer des variables</li>
<li>
<code data-pkg="dplyr">distinct</code> pour ne retenir que les observations distinctes (et donc éliminer les doublons)</li>
<li>
<code data-pkg="dplyr">mutate</code> pour créer de nouvelles variables</li>
<li>
<code data-pkg="dplyr">summarise</code> pour résumer des des valeurs multiples en une seule (par exemple, avec une moyenne)</li>
<li>
<code data-pkg="dplyr">group_by</code> pour exécuter les opérations par groupe</li>
<li>
<code data-pkg="dplyr" data-rdoc="sample">sample_n</code> et <code data-pkg="dplyr" data-rdoc="sample">sample_frac</code> pour sélectionner un sous-échantillon aléatoire</li>
</ul>
<p>On notera que les verbes de <code class="pkg">dplyr</code> accepte une syntaxe assez libre, puisque que les noms de variables sont interprétés dans leur contexte : il n’est donc pas nécessaire de les entourer de guillemets.</p>
</div>
<div id="introduction-a-dplyr_enchainer-les-operations" class="section level1">
<h1>Enchaîner les opérations</h1>
<p><code class="pkg">dplyr</code> importe automatiquement l’opérateur <code data-pkg="magrittr">%&gt;%</code> fourni par l’extension <code class="pkg">magrittr</code>. Cela permet d’enchaîner facilement les verbes de <code class="pkg">dplyr</code>. Cet opérateur ne fonctionne essentiellement qu’avec des fonctions dont le premier argument est un tableau de données et qui renvoient un tableau de données.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Species) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">mean.sepal.width =</span> <span class="kw">mean</span>(Sepal.Width, 
  <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dt">mean.sepal.length =</span> <span class="kw">mean</span>(Sepal.Length, 
  <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(mean.sepal.width <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>)</code></pre></div>
<pre><code># A tibble: 2 × 3
     Species mean.sepal.width mean.sepal.length
      &lt;fctr&gt;            &lt;dbl&gt;             &lt;dbl&gt;
1 versicolor            2.770             5.936
2  virginica            2.974             6.588</code></pre>
<p><code data-pkg="magrittr">%&lt;&gt;%</code> permet quant à lui de renvoyer le résultat final dans le premier objet appelé. C’est une manière plus courte d’écrire une commande comme la suivante :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris &lt;-<span class="st"> </span>iris <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Sepal.Area =</span> Sepal.Length <span class="op">*</span><span class="st"> </span>
<span class="st">  </span>Sepal.Width)</code></pre></div>
<p>en</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(magrittr)
iris <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Sepal.Area =</span> Sepal.Length <span class="op">*</span><span class="st"> </span>Sepal.Width)</code></pre></div>
<p>De manière plus générique, <code>some_object %&lt;&gt;% foo %&gt;% bar</code> est équivalent à <code>some_object &lt;- some_object %&gt;% foo %&gt;% bar</code>.</p>
<p>Pour plus de détails, voir <a href="https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html" class="uri">https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html</a>.</p>
</div>

</article>
<article id="introduction-a-data-table"><div class="fluid-row" id="introduction-a-data-table_header">



<h1 class="title toc-ignore">Introduction à data.table</h1>

</div>

<div class="TOC">
<ul>
<li>
<a href="#introduction-a-data-table_convertir-un-data.frame-en-data.table">Convertir un data.frame en data.table</a><ul>
<li><a href="#introduction-a-data-table_setdt-et-setdf">setDT et setDF</a></li>
<li><a href="#introduction-a-data-table_dplyr-et-data.table">dplyr et data.table</a></li>
</ul>
</li>
<li>
<a href="#introduction-a-data-table_la-syntaxe-des-crochets">La syntaxe des crochets</a><ul>
<li><a href="#introduction-a-data-table_selectionner-des-observations">Sélectionner des observations</a></li>
<li><a href="#introduction-a-data-table_selectionner-des-variables">Sélectionner des variables</a></li>
<li><a href="#introduction-a-data-table_grouper-les-results">Grouper les résults</a></li>
<li><a href="#introduction-a-data-table_ajoutermodifiersupprimer-une-variable">Ajouter/Modifier/Supprimer une variable</a></li>
</ul>
</li>
<li><a href="#introduction-a-data-table_enchainer-les-operations">Enchaîner les opérations</a></li>
</ul>
</div>

<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>
<p>L’extension <code class="pkg">data.table</code> permets d’étendre les tableaux de données. Elle modifie radicalement la syntaxe des crochets, permettant un code plus court et surtout plus puissant. Par ailleurs, elle est particulièrement rapide pour opérer des opérations sur les données et permets d’effectuer des opérations par assignation directe sans avoir à copier les objets en mémoire. Autrement dit, elle est particulièrement utile lorsque l’on travaille sur des gros fichiers de données.</p>
<p>Certes, l’apprentissage de cette nouvelle syntaxe peut faire peur au début, mais c’est un gain tellement notable une fois qu’on la maîtrise, qu’il est difficile de revenir en arrière.</p>
<p>Pour un tutoriel (en anglais et en ligne) écrit par les développeurs de <code class="pkg">data.table</code>, voir <a href="https://www.datacamp.com/courses/data-table-data-manipulation-r-tutorial" class="uri">https://www.datacamp.com/courses/data-table-data-manipulation-r-tutorial</a>. On pourra aussi se référer à la vignette officielle <a href="https://cran.r-project.org/web/packages/data.table/vignettes/datatable-intro.html" class="uri">https://cran.r-project.org/web/packages/data.table/vignettes/datatable-intro.html</a>.</p>
<div id="introduction-a-data-table_convertir-un-data.frame-en-data.table" class="section level1">
<h1>Convertir un data.frame en data.table</h1>
<p>Il suffit d’avoir recours à la fonction <code data-pkg="data.table">as.data.table</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(data.table)
iris2 &lt;-<span class="st"> </span><span class="kw">as.data.table</span>(iris)
<span class="kw">class</span>(iris2)</code></pre></div>
<pre><code>[1] "data.table" "data.frame"</code></pre>
<p>Comme on le voit, cela ajoute plusieurs classes additionnelles au tableau de données, celui-ci restant malgré tout toujours un <em>data.frame</em>. Cependant, la syntaxe des crochets simples <code>[]</code> change radicalement, tandis que les crochets doubles <code>[[]]</code> restent inchangés. Par contre, comme il s’agit toujours d’un tableau de données classique, on pourra l’utiliser avec les fonctions des autres extensions de R. Si jamais vous rencontriez un problème, il est toujours possible de reconvertir en tableau de données classique avec <code data-pkg="data.table">setDF</code> (voir ci-dessous).</p>
<div id="introduction-a-data-table_setdt-et-setdf" class="section level2">
<h2>setDT et setDF</h2>
<p>Lors de l’utilisation de <code data-pkg="data.table">as.data.table</code>, le tableau de données original a d’abord été copié en mémoire, converti puis il a fallu le sauvegarder dans un objet avec <code>&lt;-</code>. Lorsqu’on l’on manipule de gros tableaux, cela est gourmand en ressources système et prend du temps.</p>
<p>C’est pour cela que <code class="pkg">data.table</code> fournie plusieurs fonctions (commençant parle préfixe <code>set</code>) qui modifient directement l’objet sélectionné en mémoire, ce qu’on appelle <q>modification par assignation</q>. Ce type de fonction est beaucoup plus rapide et efficace en termes de ressources système. On notera également qu’il est inutile de stocker le résultats dans un objet puisque l’objet a été modifié directement en mémoire.</p>
<p><code data-pkg="data.table">setDT</code> converti un tableaux de données en <em>data.table</em> tandis que <code data-pkg="data.table">setDF</code> fait l’opération opposée.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setDT</span>(iris)
<span class="kw">class</span>(iris)</code></pre></div>
<pre><code>[1] "data.table" "data.frame"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setDF</span>(iris)
<span class="kw">class</span>(iris)</code></pre></div>
<pre><code>[1] "data.frame"</code></pre>
</div>
<div id="introduction-a-data-table_dplyr-et-data.table" class="section level2">
<h2>dplyr et data.table</h2>
<p>Pour ceux travaillant également avec les extension <code class="pkg">dplyr</code> et <code class="pkg">tibble</code>, il est possible de concilier <em>tibble</em> et <em>data.table</em> avec l’extension <code class="pkg">dtplyr</code> et sa fonction <code data-pkg="dtplyr">tbl_dt</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dtplyr)
iris_dt &lt;-<span class="st"> </span><span class="kw">tbl_dt</span>(iris)
<span class="kw">class</span>(iris_dt)</code></pre></div>
<pre><code>[1] "tbl_dt"     "tbl"        "data.table"
[4] "data.frame"</code></pre>
<p>Le tableau de données est à la fois compatible avec <code class="pkg">data.table</code> (et notamment sa syntaxe particulière des crochets) et les verbes de <code class="pkg">dplyr</code>.</p>
</div>
</div>
<div id="introduction-a-data-table_la-syntaxe-des-crochets" class="section level1">
<h1>La syntaxe des crochets</h1>
<p>La syntaxe des crochets change radicalement avec <code class="pkg">data.table</code>. Elle est de la forme <code>objet[i, j, by]</code> (dans sa forme la plus simple, pour une présentation exhaustive, voir le fichier d’aide de <code data-pkg="data.table">data.table-package</code>).</p>
<div id="introduction-a-data-table_selectionner-des-observations" class="section level2">
<h2>Sélectionner des observations</h2>
<p>Cela se fait en indiquant une indiquant une condition au premier argument, à savoir <code>i</code>. Si l’on ne procède à une sélection en même temps sur les variables, il n’est pas nécessaire d’indiquer de virgule <code>,</code> dans les crochets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris2[Sepal.Length <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>]</code></pre></div>
<pre><code>    Sepal.Length Sepal.Width Petal.Length
 1:          4.9         3.0          1.4
 2:          4.7         3.2          1.3
 3:          4.6         3.1          1.5
 4:          4.6         3.4          1.4
 5:          4.4         2.9          1.4
 6:          4.9         3.1          1.5
 7:          4.8         3.4          1.6
 8:          4.8         3.0          1.4
 9:          4.3         3.0          1.1
10:          4.6         3.6          1.0
11:          4.8         3.4          1.9
12:          4.7         3.2          1.6
13:          4.8         3.1          1.6
14:          4.9         3.1          1.5
15:          4.9         3.6          1.4
16:          4.4         3.0          1.3
17:          4.5         2.3          1.3
18:          4.4         3.2          1.3
19:          4.8         3.0          1.4
20:          4.6         3.2          1.4
21:          4.9         2.4          3.3
22:          4.9         2.5          4.5
    Sepal.Length Sepal.Width Petal.Length
    Petal.Width    Species
 1:         0.2     setosa
 2:         0.2     setosa
 3:         0.2     setosa
 4:         0.3     setosa
 5:         0.2     setosa
 6:         0.1     setosa
 7:         0.2     setosa
 8:         0.1     setosa
 9:         0.1     setosa
10:         0.2     setosa
11:         0.2     setosa
12:         0.2     setosa
13:         0.2     setosa
14:         0.2     setosa
15:         0.1     setosa
16:         0.2     setosa
17:         0.3     setosa
18:         0.2     setosa
19:         0.3     setosa
20:         0.2     setosa
21:         1.0 versicolor
22:         1.7  virginica
    Petal.Width    Species</code></pre>
<p>On notera que les noms indiquer entre les crochets sont évalués en fonction du contexte, en l’occurence la liste des variables de l’objet considéré. Ainsi, les noms des variables peuvent être indiqués tels quels, sans utilisation du symbole <code>$</code> ni des guillemets.</p>
<div class="important">
<p>Une différence de taille : lorsqu’il y a des observations pour lesquelles la condition indiquée en <code>i</code> renvoie <code>NA</code>, elles ne sont pas sélectionnées par `data.table``{.pkg} tandis que, pour un <em>data.frame</em> classique cela renvoie des lignes manquantes.</p>
</div>
</div>
<div id="introduction-a-data-table_selectionner-des-variables" class="section level2">
<h2>Sélectionner des variables</h2>
<p>Pour sélectionner une variable, il suffit d’indiquer son nom dans la seconde partie, à savoir <code>j</code>. Noter la virgule qui permets d’indiquer que c’est une condition sur <code>j</code> et non sur <code>i</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris2[, Sepal.Length]</code></pre></div>
<pre><code>  [1] 5.1 4.9 4.7 4.6 5.0 5.4 4.6 5.0 4.4 4.9 5.4
 [12] 4.8 4.8 4.3 5.8 5.7 5.4 5.1 5.7 5.1 5.4 5.1
 [23] 4.6 5.1 4.8 5.0 5.0 5.2 5.2 4.7 4.8 5.4 5.2
 [34] 5.5 4.9 5.0 5.5 4.9 4.4 5.1 5.0 4.5 4.4 5.0
 [45] 5.1 4.8 5.1 4.6 5.3 5.0 7.0 6.4 6.9 5.5 6.5
 [56] 5.7 6.3 4.9 6.6 5.2 5.0 5.9 6.0 6.1 5.6 6.7
 [67] 5.6 5.8 6.2 5.6 5.9 6.1 6.3 6.1 6.4 6.6 6.8
 [78] 6.7 6.0 5.7 5.5 5.5 5.8 6.0 5.4 6.0 6.7 6.3
 [89] 5.6 5.5 5.5 6.1 5.8 5.0 5.6 5.7 5.7 6.2 5.1
[100] 5.7 6.3 5.8 7.1 6.3 6.5 7.6 4.9 7.3 6.7 7.2
[111] 6.5 6.4 6.8 5.7 5.8 6.4 6.5 7.7 7.7 6.0 6.9
[122] 5.6 7.7 6.3 6.7 7.2 6.2 6.1 6.4 7.2 7.4 7.9
[133] 6.4 6.3 6.1 7.7 6.3 6.4 6.0 6.9 6.7 6.9 5.8
[144] 6.8 6.7 6.7 6.3 6.5 6.2 5.9</code></pre>
<p>Pour sélectionner plusieurs variables, on fournira une liste définie avec <code data-pkg="base">list</code> (et non un vecteur défini avec <code data-pkg="base">c</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris2[, <span class="kw">list</span>(Sepal.Length, Sepal.Width)]</code></pre></div>
<pre><code>     Sepal.Length Sepal.Width
  1:          5.1         3.5
  2:          4.9         3.0
  3:          4.7         3.2
  4:          4.6         3.1
  5:          5.0         3.6
 ---                         
146:          6.7         3.0
147:          6.3         2.5
148:          6.5         3.0
149:          6.2         3.4
150:          5.9         3.0</code></pre>
<p><code class="pkg">data.table</code> fourni un raccourci pour écrire une liste : <code>.()</code>. A l’intérieur des crochets (mais pas en dehors), <code>.()</code> sera compris comme <code>list()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris2[, .(Sepal.Length, Sepal.Width)]</code></pre></div>
<pre><code>     Sepal.Length Sepal.Width
  1:          5.1         3.5
  2:          4.9         3.0
  3:          4.7         3.2
  4:          4.6         3.1
  5:          5.0         3.6
 ---                         
146:          6.7         3.0
147:          6.3         2.5
148:          6.5         3.0
149:          6.2         3.4
150:          5.9         3.0</code></pre>
<p>Il est possible de renommer une variable à la volée et même d’en calculer d’autres.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris2[, .(<span class="dt">espece =</span> Species, <span class="dt">aire_petal =</span> Petal.Length <span class="op">*</span><span class="st"> </span>
<span class="st">  </span>Petal.Width)]</code></pre></div>
<pre><code>        espece aire_petal
  1:    setosa       0.28
  2:    setosa       0.28
  3:    setosa       0.26
  4:    setosa       0.30
  5:    setosa       0.28
 ---                     
146: virginica      11.96
147: virginica       9.50
148: virginica      10.40
149: virginica      12.42
150: virginica       9.18</code></pre>
<p>Seul le retour est ici affecté. Cela n’impacte pas le tableau d’origine. Nous verrons plus loin comment créer / modifier une variable.</p>
<p>Attention : on ne peut pas directement sélectionner une variable par sa position ou en indiquant une chaîne de caractères. En effet, une valeur numérique ou textuelle est comprise comme une constante.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris2[, .(<span class="st">"Species"</span>, <span class="dv">3</span>)]</code></pre></div>
<pre><code>        V1 V2
1: Species  3</code></pre>
</div>
<div id="introduction-a-data-table_grouper-les-results" class="section level2">
<h2>Grouper les résults</h2>
<p>Si en <code>j</code> on utilise des fonctions qui à partir d’un vecteur renvoient une valeur unique (telles que <code data-pkg="base">mean</code>, <code data-pkg="stats">median</code>, <code data-pkg="base" data-rdoc="Extremes">min</code>, <code data-pkg="base" data-rdoc="Extremes">max</code>, <code data-pkg="data.table">first</code>, <code data-pkg="data.table">last</code>, <code data-pkg="dplyr">nth</code>, etc.), on peut ainsi obtenir un résumé. On pourra également utiliser <code data-pkg="data.table" data-rdoc="special-symbols">.N</code> pour obtenir le nombre d’observations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris2[, .(<span class="dt">min_sepal_width =</span> <span class="kw">min</span>(Sepal.Width), <span class="dt">max_sepal_width =</span> <span class="kw">max</span>(Sepal.Width), 
  <span class="dt">n_observations =</span> .N)]</code></pre></div>
<pre><code>   min_sepal_width max_sepal_width n_observations
1:               2             4.4            150</code></pre>
<p>Cela devient particulièrement intéressant en calculant ces mêmes valeurs par sous-groupe, grace au troisième paramètre : <code>by</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris2[, .(<span class="dt">min_sepal_width =</span> <span class="kw">min</span>(Sepal.Width), <span class="dt">max_sepal_width =</span> <span class="kw">max</span>(Sepal.Width), 
  <span class="dt">n_observations =</span> .N), by =<span class="st"> </span>Species]</code></pre></div>
<pre><code>      Species min_sepal_width max_sepal_width
1:     setosa             2.3             4.4
2: versicolor             2.0             3.4
3:  virginica             2.2             3.8
   n_observations
1:             50
2:             50
3:             50</code></pre>
</div>
<div id="introduction-a-data-table_ajoutermodifiersupprimer-une-variable" class="section level2">
<h2>Ajouter/Modifier/Supprimer une variable</h2>
<p><code class="pkg">data.table</code> introduit un nouvel opérateur <code>:=</code> permettant de modifier une variable par assignation directe. Cela signifie que la modification a lieu directement en mémoire dans le tableau de données, sans qu’il soit besoin réaffecter le résultat avec <code>&lt;-</code>.</p>
<p>On peut également combiner <code>:=</code> avec une sélection sur les observations en <code>i</code> pour ne modifier que certaines observations. De même, le recours à <code>by</code> permets des calculs par groupe.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris2[, group <span class="op">:</span><span class="er">=</span><span class="st"> "A"</span>]
iris2[Species <span class="op">==</span><span class="st"> "virginica"</span>, group <span class="op">:</span><span class="er">=</span><span class="st"> "B"</span>]
iris2[, n_obs_per_species <span class="op">:</span><span class="er">=</span><span class="st"> </span>.N, by =<span class="st"> </span>Species]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris2</code></pre></div>
<pre><code>     Sepal.Length Sepal.Width Petal.Length
  1:          5.1         3.5          1.4
  2:          4.9         3.0          1.4
  3:          4.7         3.2          1.3
  4:          4.6         3.1          1.5
  5:          5.0         3.6          1.4
 ---                                      
146:          6.7         3.0          5.2
147:          6.3         2.5          5.0
148:          6.5         3.0          5.2
149:          6.2         3.4          5.4
150:          5.9         3.0          5.1
     Petal.Width   Species group
  1:         0.2    setosa     A
  2:         0.2    setosa     A
  3:         0.2    setosa     A
  4:         0.2    setosa     A
  5:         0.2    setosa     A
 ---                            
146:         2.3 virginica     B
147:         1.9 virginica     B
148:         2.0 virginica     B
149:         2.3 virginica     B
150:         1.8 virginica     B
     n_obs_per_species
  1:                50
  2:                50
  3:                50
  4:                50
  5:                50
 ---                  
146:                50
147:                50
148:                50
149:                50
150:                50</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris2[, .N, by =<span class="st"> </span>group]</code></pre></div>
<pre><code>   group   N
1:     A 100
2:     B  50</code></pre>
</div>
</div>
<div id="introduction-a-data-table_enchainer-les-operations" class="section level1">
<h1>Enchaîner les opérations</h1>
<p>Il est possible d’enchaîner les opérations avec une succession de crochets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris2[, .(<span class="dt">petal_area =</span> Petal.Width <span class="op">*</span><span class="st"> </span>Petal.Length, 
  Species)][, .(<span class="dt">min_petal_area =</span> <span class="kw">min</span>(petal_area)), 
  by =<span class="st"> </span>Species]</code></pre></div>
<pre><code>      Species min_petal_area
1:     setosa           0.11
2: versicolor           3.30
3:  virginica           7.50</code></pre>
</div>

</article>
<article id="doublons"><div class="fluid-row" id="doublons_header">



<h1 class="title toc-ignore">Doublons</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">A =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">each =</span> <span class="dv">4</span>), <span class="dt">B =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, 
  <span class="dt">each =</span> <span class="dv">3</span>), <span class="dt">C =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">6</span>))
df</code></pre></div>
<pre><code>   A B C
1  1 1 1
2  1 1 2
3  1 1 1
4  1 2 2
5  2 2 1
6  2 2 2
7  2 3 1
8  2 3 2
9  3 3 1
10 3 4 2
11 3 4 1
12 3 4 2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(data.table)
dt &lt;-<span class="st"> </span><span class="kw">as.data.table</span>(df)
<span class="kw">library</span>(dplyr)</code></pre></div>
<pre><code>------------------------------------------------</code></pre>
<pre><code>data.table + dplyr code now lives in dtplyr.
Please library(dtplyr)!</code></pre>
<pre><code>------------------------------------------------</code></pre>
<pre><code>
Attaching package: 'dplyr'</code></pre>
<pre><code>The following objects are masked from 'package:data.table':

    between, first, last</code></pre>
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tbl &lt;-<span class="st"> </span><span class="kw">tbl_df</span>(df)


<span class="co"># data.frame</span>
<span class="kw">unique</span>(df)</code></pre></div>
<pre><code>   A B C
1  1 1 1
2  1 1 2
4  1 2 2
5  2 2 1
6  2 2 2
7  2 3 1
8  2 3 2
9  3 3 1
10 3 4 2
11 3 4 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># data.table</span>
<span class="kw">unique</span>(dt)</code></pre></div>
<pre><code>    A B C
 1: 1 1 1
 2: 1 1 2
 3: 1 2 2
 4: 2 2 1
 5: 2 2 2
 6: 2 3 1
 7: 2 3 2
 8: 3 3 1
 9: 3 4 2
10: 3 4 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># dplyr</span>
<span class="kw">library</span>(dplyr)
<span class="kw">distinct</span>(tbl)</code></pre></div>
<pre><code># A tibble: 10 × 3
       A     B     C
   &lt;int&gt; &lt;int&gt; &lt;int&gt;
1      1     1     1
2      1     1     2
3      1     2     2
4      2     2     1
5      2     2     2
6      2     3     1
7      2     3     2
8      3     3     1
9      3     4     2
10     3     4     1</code></pre>
<p>Voir aussi <code data-pkg="base">duplicated</code>.</p>

</article>
<article id="tris"><div class="fluid-row" id="tris_header">



<h1 class="title toc-ignore">Tris</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#tris_fonctions-r-de-base">Fonctions R de base</a></li>
<li><a href="#tris_extension-dplyr">Extension dplyr</a></li>
<li><a href="#tris_extension-data.table">Extension data.table</a></li>
</ul>
</div>

<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>
<p>Dans ce qui suit on travaillera sur le jeu de données tiré de l’enquête <em>Histoire de vie</em>, fourni avec l’extension <code class="pkg">questionr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">data</span>(hdv2003)
d &lt;-<span class="st"> </span>hdv2003</code></pre></div>
<div id="tris_fonctions-r-de-base" class="section level2">
<h2>Fonctions R de base</h2>
<p>La fonction <code data-pkg="base">sort</code> permet de <dfn data-index="tri de tables">trier</dfn><dfn data-index="tableau de données, tri"></dfn> les éléments d’un vecteur.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sort</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">8</span>))</code></pre></div>
<pre><code>[1] 1 2 5 6 8</code></pre>
<p>On peut appliquer cette fonction à une variable, mais celle-ci ne permet que d’ordonner les valeurs de cette variable, et pas l’ensemble du tableau de données dont elle fait partie. Pour cela nous avons besoin d’une autre fonction, nommée <code data-pkg="base">order</code>. Celle-ci ne renvoie pas les valeurs du vecteur triées, mais les emplacements de ces valeurs.</p>
<p>Un exemple pour comprendre :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">order</span>(<span class="kw">c</span>(<span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">10</span>))</code></pre></div>
<pre><code>[1] 3 1 2</code></pre>
<p>Le résultat renvoyé signifie que la plus petite valeur est la valeur située en 3<sup>e</sup> position, suivie de celle en 1<sup>ère</sup> position et de celle en 2<sup>e</sup> position. Tout cela ne paraît pas passionnant à première vue, mais si on mélange ce résultat avec un peu d’indexation directe, ça devient intéressant…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">order</span>(d<span class="op">$</span>age))</code></pre></div>
<pre><code>[1] 162 215 346 377 511 646</code></pre>
<p>Ce que cette fonction renvoie, c’est l’ordre dans lequel on doit placer les éléments de <em>age</em>, et donc par extension les lignes de <code>d</code>, pour que la variable soit triée par ordre croissant. Par conséquent, si on fait :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d.tri &lt;-<span class="st"> </span>d[<span class="kw">order</span>(d<span class="op">$</span>age), ]</code></pre></div>
<p>Alors on a trié les lignes de d par ordre d’âge croissant ! Et si on fait un petit :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(d.tri, <span class="dv">3</span>)</code></pre></div>
<pre><code>     id age  sexe nivetud    poids
162 162  18 Homme    &lt;NA&gt; 4982.964
215 215  18 Homme    &lt;NA&gt; 4631.188
346 346  18 Femme    &lt;NA&gt; 1725.410
              occup qualif freres.soeurs clso
162 Etudiant, eleve   &lt;NA&gt;             2  Non
215 Etudiant, eleve   &lt;NA&gt;             2  Oui
346 Etudiant, eleve   &lt;NA&gt;             9  Non
                          relig trav.imp
162  Appartenance sans pratique     &lt;NA&gt;
215 Ni croyance ni appartenance     &lt;NA&gt;
346         Pratiquant regulier     &lt;NA&gt;
    trav.satisf hard.rock lecture.bd peche.chasse
162        &lt;NA&gt;       Non        Non          Non
215        &lt;NA&gt;       Non        Non          Non
346        &lt;NA&gt;       Non        Non          Non
    cuisine bricol cinema sport heures.tv
162     Non    Non    Non   Oui         3
215     Oui    Non    Oui   Oui         2
346     Non    Non    Oui   Non         2</code></pre>
<p>On a les caractéristiques des trois enquêtés les plus jeunes.</p>
<p>On peut évidemment trier par ordre décroissant en utilisant l’option <code>decreasing=TRUE</code>. On peut donc afficher les caractéristiques des trois individus les plus âgés avec :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(d[<span class="kw">order</span>(d<span class="op">$</span>age, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>), ], <span class="dv">3</span>)</code></pre></div>
<pre><code>       id age  sexe
1916 1916  97 Femme
270   270  96 Femme
1542 1542  93 Femme
                               nivetud    poids
1916 Derniere annee d'etudes primaires 2162.835
270  Derniere annee d'etudes primaires 9993.020
1542 Derniere annee d'etudes primaires 7107.841
                   occup qualif freres.soeurs
1916       Autre inactif  Autre             5
270             Retraite   &lt;NA&gt;             1
1542 Retire des affaires   &lt;NA&gt;             7
     clso                       relig trav.imp
1916  Non      Pratiquant occasionnel     &lt;NA&gt;
270   Oui Ni croyance ni appartenance     &lt;NA&gt;
1542  Non      Pratiquant occasionnel     &lt;NA&gt;
     trav.satisf hard.rock lecture.bd
1916        &lt;NA&gt;       Non        Non
270         &lt;NA&gt;       Non        Non
1542        &lt;NA&gt;       Non        Non
     peche.chasse cuisine bricol cinema sport
1916          Non     Non    Non    Non   Non
270           Non     Non    Non    Non   Non
1542          Non     Non    Non    Oui   Non
     heures.tv
1916         3
270          6
1542         3</code></pre>
<p>On peut également trier selon plusieurs variables. Ainsi, si l’on souhaite trier le tableau par <em>sexe</em> puis, au sein de chaque sexe, par <em>age</em> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d.tri &lt;-<span class="st"> </span>d[<span class="kw">order</span>(d<span class="op">$</span>sexe, d<span class="op">$</span>age), ]</code></pre></div>
<div class="note">
<p>Si l’on transmets une variable textuelle, le tri sera réalisé de manière alphabétique alors que si l’on transmets un facteur, le tri sera effectué selon l’ordre des facteurs (que l’on peut visualiser avec <code data-pkg="base">levels</code>).</p>
</div>
</div>
<div id="tris_extension-dplyr" class="section level2">
<h2>Extension dplyr</h2>
<p>On aura simplement recours à la fonction <code data-pkg="dplyr">arrange</code>. Un tri par ordre décroissant s’indique avec la fonction <code data-pakg="dplyr">desc</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
tbl &lt;-<span class="st"> </span><span class="kw">tbl_df</span>(hdv2003)
tbl &lt;-<span class="st"> </span>tbl <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(sexe, <span class="kw">desc</span>(age))</code></pre></div>
</div>
<div id="tris_extension-data.table" class="section level2">
<h2>Extension data.table</h2>
<p>On pourra utiliser la fonction <code data-pkg="data.table" data-rdoc="setorder">order</code> dans la condition sur les observations (attention à sauvegarder le résultats si nécessaire) ou bien la fonction <code data-pkg="data.table">setorder</code> pour modifier l’ordre des observations directement par assignation (modification directe en mémoire de l’objet). Un tri décroissant s’indique avec le signe <code>-</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(data.table)
dt &lt;-<span class="st"> </span><span class="kw">as.data.table</span>(hdv2003)

<span class="co"># Option 1</span>
dt &lt;-<span class="st"> </span>dt[<span class="kw">order</span>(sexe, <span class="op">-</span>age)]

<span class="co"># Option 2</span>
<span class="kw">setorder</span>(dt, sexe, <span class="op">-</span>age)</code></pre></div>
</div>

</article>
<article id="sous-ensembles"><div class="fluid-row" id="sous-ensembles_header">



<h1 class="title toc-ignore">Sous-ensembles</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#sous-ensembles_par-indexation">Par indexation</a></li>
<li><a href="#sous-ensembles_subset">Fonction subset</a></li>
<li><a href="#sous-ensembles_tapply">Fonction tapply</a></li>
<li><a href="#sous-ensembles_extension-dplyr">Extension dplyr</a></li>
<li><a href="#sous-ensembles_extension-data.table">Extension data.table</a></li>
</ul>
</div>

<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>
<p>Dans ce qui suit on travaillera sur le jeu de données tiré de l’enquête <em>Histoire de vie</em>, fourni avec l’extension <code class="pkg">questionr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">data</span>(hdv2003)
d &lt;-<span class="st"> </span>hdv2003</code></pre></div>
<div id="sous-ensembles_par-indexation" class="section level2">
<h2>Par indexation</h2>
<p>La première manière de construire des sous-populations est d’utiliser l’indexation par conditions. On peut ainsi facilement sélectionner une partie des observations suivant un ou plusieurs critères et placer le résultat dans un nouveau tableau de données.</p>
<p>Par exemple si l’on souhaite isoler les hommes et les femmes :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dh &lt;-<span class="st"> </span>d[d<span class="op">$</span>sexe <span class="op">==</span><span class="st"> "Homme"</span>, ]
df &lt;-<span class="st"> </span>d[d<span class="op">$</span>sexe <span class="op">==</span><span class="st"> "Femme"</span>, ]
<span class="kw">table</span>(d<span class="op">$</span>sexe)</code></pre></div>
<pre><code>
Homme Femme 
  899  1101 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(dh)</code></pre></div>
<pre><code>[1] 899  20</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(df)</code></pre></div>
<pre><code>[1] 1101   20</code></pre>
<p>On a à partir de là trois tableaux de données, <code>d</code> comportant la population totale, <code>dh</code> seulement les hommes et <code>df</code> seulement les femmes.</p>
<p>On peut évidemment combiner plusieurs critères :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dh.<span class="dv">25</span> &lt;-<span class="st"> </span>d[d<span class="op">$</span>sexe <span class="op">==</span><span class="st"> "Homme"</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>age <span class="op">&lt;=</span><span class="st"> </span><span class="dv">25</span>, ]
<span class="kw">dim</span>(dh.<span class="dv">25</span>)</code></pre></div>
<pre><code>[1] 86 20</code></pre>
<p>Si on utilise directement l’indexation, il convient cependant d’être extrêmement prudent avec les valeurs manquantes. Comme indiqué précédemment, la présence d’une valeur manquante dans une condition fait que celle-ci est évaluée en <code>NA</code> et qu’au final la ligne correspondante est conservée par l’indexation :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(d<span class="op">$</span>trav.satisf)</code></pre></div>
<pre><code>  Satisfaction Insatisfaction      Equilibre 
           480            117            451 
          NA's 
           952 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d.satisf &lt;-<span class="st"> </span>d[d<span class="op">$</span>trav.satisf <span class="op">==</span><span class="st"> "Satisfaction"</span>, ]
<span class="kw">dim</span>(d.satisf)</code></pre></div>
<pre><code>[1] 1432   20</code></pre>
<p>Comme on le voit, ici <code>d.satisf</code> contient les individus ayant la modalité <em>Satisfaction</em> mais aussi ceux ayant une valeur manquante <code>NA</code>. C’est pourquoi il faut toujours soit vérifier au préalable qu’on n’a pas de valeurs manquantes dans les variables de la condition, soit exclure explicitement les <code>NA</code> de la manière suivante :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d.satisf &lt;-<span class="st"> </span>d[d<span class="op">$</span>trav.satisf <span class="op">==</span><span class="st"> "Satisfaction"</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(d<span class="op">$</span>trav.satisf), 
  ]
<span class="kw">dim</span>(d.satisf)</code></pre></div>
<pre><code>[1] 480  20</code></pre>
<p>C’est notamment pour cette raison qu’on préfèrera le plus souvent utiliser la fonction <code data-pkg="base">subset</code>.</p>
</div>
<div id="sous-ensembles_subset" class="section level2">
<h2>Fonction subset</h2>
<p>La fonction <code data-pkg="base">subset</code> permet d’extraire des sous-populations de manière plus simple et un peu plus intuitive que l’indexation directe.</p>
<p>Celle-ci prend trois arguments principaux :</p>
<ul>
<li>le nom de l’objet de départ ;</li>
<li>une condition sur les observations (<code>subset</code>) ;</li>
<li>éventuellement une condition sur les colonnes (<code>select</code>).</li>
</ul>
<p>Reprenons tout de suite un exemple déjà vu :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dh &lt;-<span class="st"> </span><span class="kw">subset</span>(d, sexe <span class="op">==</span><span class="st"> "Homme"</span>)
df &lt;-<span class="st"> </span><span class="kw">subset</span>(d, sexe <span class="op">==</span><span class="st"> "Femme"</span>)</code></pre></div>
<p>L’utilisation de <code data-pkg="base">subset</code> présente plusieurs avantages. Le premier est d’économiser quelques touches. On n’est en effet pas obligé de saisir le nom du tableau de données dans la condition sur les lignes. Ainsi les deux commandes suivantes sont équivalentes :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dh &lt;-<span class="st"> </span><span class="kw">subset</span>(d, d<span class="op">$</span>sexe <span class="op">==</span><span class="st"> "Homme"</span>)
dh &lt;-<span class="st"> </span><span class="kw">subset</span>(d, sexe <span class="op">==</span><span class="st"> "Homme"</span>)</code></pre></div>
<p>Le second avantage est que <code data-pkg="base">subset</code> s’occupe du problème des valeurs manquantes évoquées précédemment et les exclut de lui-même, contrairement au comportement par défaut :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(d<span class="op">$</span>trav.satisf)</code></pre></div>
<pre><code>  Satisfaction Insatisfaction      Equilibre 
           480            117            451 
          NA's 
           952 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d.satisf &lt;-<span class="st"> </span>d[d<span class="op">$</span>trav.satisf <span class="op">==</span><span class="st"> "Satisfaction"</span>, ]
<span class="kw">dim</span>(d.satisf)</code></pre></div>
<pre><code>[1] 1432   20</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d.satisf &lt;-<span class="st"> </span><span class="kw">subset</span>(d, trav.satisf <span class="op">==</span><span class="st"> "Satisfaction"</span>)
<span class="kw">dim</span>(d.satisf)</code></pre></div>
<pre><code>[1] 480  20</code></pre>
<p>Dans le cas présent, l’extraction obtenue avec <code data-pkg="base">subset</code> est équivalente à :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d.satisf &lt;-<span class="st"> </span>d[d<span class="op">$</span>trav.satisf <span class="op">==</span><span class="st"> "Satisfaction"</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(d<span class="op">$</span>trav.satisf), 
  ]
<span class="kw">dim</span>(d.satisf)</code></pre></div>
<pre><code>[1] 480  20</code></pre>
<p>Enfin, l’utilisation de l’argument <code>select</code> est simplifié pour l’expression de condition sur les colonnes. On peut ainsi spécifier les noms de variable sans guillemets et leur appliquer directement l’opérateur d’exclusion <code>-</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d2 &lt;-<span class="st"> </span><span class="kw">subset</span>(d, <span class="dt">select =</span> <span class="kw">c</span>(sexe, sport))
d2 &lt;-<span class="st"> </span><span class="kw">subset</span>(d, age <span class="op">&gt;</span><span class="st"> </span><span class="dv">25</span>, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(id, age, cinema))</code></pre></div>
</div>
<div id="sous-ensembles_tapply" class="section level2">
<h2>Fonction tapply</h2>
<div class="note">
<p>Cette section documente une fonction qui peut être très utile, mais pas forcément indispensable au départ.</p>
</div>
<p>La fonction <code data-pkg="base">tapply</code> n’est qu’indirectement liée à la notion de sous-population, mais peut permettre d’éviter d’avoir à créer ces sous-populations dans certains cas.</p>
<p>Son fonctionnement est assez simple, mais pas forcément intuitif. La fonction prend trois arguments : un vecteur, un facteur et une fonction. Elle applique ensuite la fonction aux éléments du vecteur correspondant à un même niveau du facteur. Vite, un exemple !</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(d<span class="op">$</span>age, d<span class="op">$</span>sexe, mean)</code></pre></div>
<pre><code>   Homme    Femme 
48.16129 48.15350 </code></pre>
<p>Qu’est-ce que ça signifie ? Ici <code data-pkg="base">tapply</code> a sélectionné toutes les observations correspondant à « Homme », puis appliqué la fonction <code data-pkg="base">mean</code> aux valeurs de <em>age</em> correspondantes. Puis elle a fait de même pour les observations correspondant à « Femme ». On a donc ici la moyenne d’âge chez les hommes et chez les femmes.</p>
<p>On peut fournir à peu près n’importe quelle fonction à <code data-pkg="base">tapply</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(d<span class="op">$</span>bricol, d<span class="op">$</span>sexe, freq)</code></pre></div>
<pre><code>$Homme
      n    % val%
Non 384 42.7 42.7
Oui 515 57.3 57.3

$Femme
      n    % val%
Non 763 69.3 69.3
Oui 338 30.7 30.7</code></pre>
<p>Les arguments supplémentaires fournis à <code data-pkg="base">tapply</code> sont en fait fournis directement à la fonction appelée.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(d<span class="op">$</span>bricol, d<span class="op">$</span>sexe, freq, <span class="dt">total =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>$Homme
        n     %  val%
Non   384  42.7  42.7
Oui   515  57.3  57.3
Total 899 100.0 100.0

$Femme
         n     %  val%
Non    763  69.3  69.3
Oui    338  30.7  30.7
Total 1101 100.0 100.0</code></pre>
<div class="note">
<p>La fonction <code data-pkg="base">by</code> est un équivalent (pour les tableaux de données) de <code data-pkg="base">tapply</code>. La présentation des résultats diffère légèrement.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(d<span class="op">$</span>age, d<span class="op">$</span>sexe, mean)</code></pre></div>
<pre><code>   Homme    Femme 
48.16129 48.15350 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">by</span>(d<span class="op">$</span>age, d<span class="op">$</span>sexe, mean)</code></pre></div>
<pre><code>d$sexe: Homme
[1] 48.16129
------------------------------------- 
d$sexe: Femme
[1] 48.1535</code></pre>
</div>
</div>
<div id="sous-ensembles_extension-dplyr" class="section level2">
<h2>Extension dplyr</h2>
<p>On utilisera tout simplement la fonction <code data-pkg="dplyr">filter</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
tbl &lt;-<span class="st"> </span><span class="kw">tbl_df</span>(hdv2003)
hommes_jeunes &lt;-<span class="st"> </span>tbl <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(sexe <span class="op">==</span><span class="st"> "Homme"</span>, age <span class="op">&lt;</span><span class="st"> </span>
<span class="st">  </span><span class="dv">30</span>)</code></pre></div>
<p>Voir le chapitre <a href="#introduction-a-dplyr">Introduction à dplyr</a> pour plus de détails.</p>
</div>
<div id="sous-ensembles_extension-data.table" class="section level2">
<h2>Extension data.table</h2>
<p>Il suffit d’indiquer la condition entre crochets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(data.table)
dt &lt;-<span class="st"> </span><span class="kw">as.data.table</span>(hdv2003)
hommes_jeunes &lt;-<span class="st"> </span>dt[sexe <span class="op">==</span><span class="st"> "Hommes"</span> <span class="op">&amp;</span><span class="st"> </span>age <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>]</code></pre></div>
<p>Voir le chapitre <a href="#introduction-a-data-table">Introduction à data.table</a> pour plus de détails.</p>
</div>

</article>
<article id="fusion-de-tables"><div class="fluid-row" id="fusion-de-tables_header">



<h1 class="title toc-ignore">Fusion de tables</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#fusion-de-tables_la-fonction-merge">La fonction merge</a></li>
<li><a href="#fusion-de-tables_extension-dplyr">Extension dplyr</a></li>
<li><a href="#fusion-de-tables_extension-data.table">Extension data.table</a></li>
</ul>
</div>

<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>
<p>Lorsqu’on traite de grosses enquêtes, notamment les enquêtes de l’INSEE, on a souvent à gérer des données réparties dans plusieurs tables, soit du fait de la construction du questionnaire, soit du fait de contraintes techniques (fichiers <strong>dbf</strong> ou <strong>Excel</strong> limités à 256 colonnes, par exemple).</p>
<p>Cela arrive également lorsque l’on traitre de données d’une enquêtes réalisée à différents niveaux (par exemple, un questionnaire ménage et un questionnaire individu).</p>
<div id="fusion-de-tables_la-fonction-merge" class="section level1">
<h1>La fonction merge</h1>
<p>Une opération relativement courante consiste à <dfn data-index="fusion de tables">fusionner</dfn><dfn data-index="tableau de données, fusion"></dfn> plusieurs tables pour regrouper tout ou partie des données dans un unique tableau.</p>
<p>Nous allons simuler artificiellement une telle situation en créant deux tables à partir de l’extrait de l’enquête <em>Histoire de vie</em> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">data</span>(hdv2003)
d &lt;-<span class="st"> </span>hdv2003
<span class="kw">dim</span>(d)</code></pre></div>
<pre><code>[1] 2000   20</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d1 &lt;-<span class="st"> </span><span class="kw">subset</span>(d, <span class="dt">select =</span> <span class="kw">c</span>(<span class="st">"id"</span>, <span class="st">"age"</span>, <span class="st">"sexe"</span>))
<span class="kw">dim</span>(d1)</code></pre></div>
<pre><code>[1] 2000    3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d2 &lt;-<span class="st"> </span><span class="kw">subset</span>(d, <span class="dt">select =</span> <span class="kw">c</span>(<span class="st">"id"</span>, <span class="st">"clso"</span>))
<span class="kw">dim</span>(d2)</code></pre></div>
<pre><code>[1] 2000    2</code></pre>
<p>On a donc deux tableaux de données, <code>d1</code> et <code>d2</code>, comportant chacun 2000 lignes et respectivement 3 et 2 colonnes. Comment les rassembler pour n’en former qu’un ?</p>
<p>Intuitivement, cela paraît simple. Il suffit de « coller » <code>d2</code> à la droite de <code>d1</code>, comme dans l’exemple suivant.</p>
<style type="text/css">
table.exemple_df td, 
table.exemple_df th {
  text-align: center;
  padding: 3px 10px;
}
table.exemple_df th {
  border-bottom: solid 1px #999;
}

table.exemple_df td + td,
table.exemple_df th + th {
  border-left: solid 1px #999;
}

table.exemple_operateur td {
  font-size: 3em;
  padding: 20px;
}
</style>
<table style="margin: 11px auto;"><tr>
<td>
<table class="exemple_df">
<tr>
<th>
id
</th>
<th>
v1
</th>
<th>
v2
</th>
</tr>
<tr>
<td>
1
</td>
<td>
H
</td>
<td>
12
</td>
</tr>
<tr>
<td>
2
</td>
<td>
H
</td>
<td>
17
</td>
</tr>
<tr>
<td>
3
</td>
<td>
F
</td>
<td>
41
</td>
</tr>
<tr>
<td>
4
</td>
<td>
F
</td>
<td>
9
</td>
</tr>
<tr>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
</table>
</td>
<td>
<table class="exemple_operateur"><tr>
<td>
+
</td>
</tr></table>
</td>
<td>
<table class="exemple_df">
<tr>
<th>
id
</th>
<th>
v3
</th>
</tr>
<tr>
<td>
1
</td>
<td>
rouge
</td>
</tr>
<tr>
<td>
2
</td>
<td>
bleu
</td>
</tr>
<tr>
<td>
3
</td>
<td>
bleu
</td>
</tr>
<tr>
<td>
4
</td>
<td>
rouge
</td>
</tr>
<tr>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
</table>
</td>
<td>
<table class="exemple_operateur"><tr>
<td>
=
</td>
</tr></table>
</td>
<td>
<table class="exemple_df">
<tr>
<th>
id
</th>
<th>
v1
</th>
<th>
v2
</th>
<th>
v3
</th>
</tr>
<tr>
<td>
1
</td>
<td>
H
</td>
<td>
12
</td>
<td>
rouge
</td>
</tr>
<tr>
<td>
2
</td>
<td>
H
</td>
<td>
17
</td>
<td>
bleu
</td>
</tr>
<tr>
<td>
3
</td>
<td>
F
</td>
<td>
41
</td>
<td>
bleu
</td>
</tr>
<tr>
<td>
4
</td>
<td>
F
</td>
<td>
9
</td>
<td>
rouge
</td>
</tr>
<tr>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
</table>
</td>
</tr></table>
<p>Cela semble fonctionner. La fonction qui permet d’effectuer cette opération sous <strong>R</strong> s’appelle <code data-pkg="base">cbind</code>, elle « colle » des tableaux côte à côte en regroupant leurs colonnes<a href="#fusion-de-tables_fn1" class="footnoteRef" id="fusion-de-tables_fnref1"><sup>1</sup></a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">cbind</span>(d1, d2))</code></pre></div>
<pre><code>  id age  sexe id clso
1  1  28 Femme  1  Oui
2  2  23 Femme  2  Oui
3  3  59 Homme  3  Non
4  4  34 Homme  4  Non
5  5  71 Femme  5  Oui
6  6  35 Femme  6  Non</code></pre>
<p>À part le fait qu’on a une colonne <em>id</em> en double, le résultat semble satisfaisant. À première vue seulement. Imaginons maintenant que nous avons travaillé sur <code>d1</code> et <code>d2</code>, et que nous avons ordonné les lignes de <code>d1</code> selon l’âge des enquêtés :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d1 &lt;-<span class="st"> </span>d1[<span class="kw">order</span>(d1<span class="op">$</span>age), ]</code></pre></div>
<p>Répétons l’opération de collage :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">cbind</span>(d1, d2))</code></pre></div>
<pre><code>     id age  sexe id clso
162 162  18 Homme  1  Oui
215 215  18 Homme  2  Oui
346 346  18 Femme  3  Non
377 377  18 Homme  4  Non
511 511  18 Homme  5  Oui
646 646  18 Homme  6  Non</code></pre>
<p>Que constate-t-on ? La présence de la variable <em>id</em> en double nous permet de voir que les identifiants ne coïncident plus ! En regroupant nos colonnes nous avons donc attribué à des individus les réponses d’autres individus.</p>
<p>La commande <code data-pkg="base">cbind</code> ne peut en effet fonctionner que si les deux tableaux ont exactement le même nombre de lignes, et dans le même ordre, ce qui n’est pas le cas ici.</p>
<p>On va donc être obligé de pocéder à une <dfn>fusion</dfn> des deux tableaux, qui va permettre de rendre à chaque ligne ce qui lui appartient. Pour cela nous avons besoin d’un identifiant qui permet d’identifier chaque ligne de manière unique et qui doit être présent dans tous les tableaux. Dans notre cas, c’est plutôt rapide, il s’agit de la variable <em>id</em>.</p>
<p>Une fois l’identifiant identifié<a href="#fusion-de-tables_fn2" class="footnoteRef" id="fusion-de-tables_fnref2"><sup>2</sup></a>, on peut utiliser la commande <code data-pkg="base">merge</code>. Celle-ci va fusionner les deux tableaux en supprimant les colonnes en double et en regroupant les lignes selon leurs identifiants :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d.complet &lt;-<span class="st"> </span><span class="kw">merge</span>(d1, d2, <span class="dt">by =</span> <span class="st">"id"</span>)
<span class="kw">head</span>(d.complet)</code></pre></div>
<pre><code>  id age  sexe clso
1  1  28 Femme  Oui
2  2  23 Femme  Oui
3  3  59 Homme  Non
4  4  34 Homme  Non
5  5  71 Femme  Oui
6  6  35 Femme  Non</code></pre>
<p>Ici l’utilisation de la fonction <code data-pkg="base">merge</code> est plutôt simple car nous sommes dans le cas de figure idéal : les lignes correspondent parfaitement et l’identifiant est clairement identifié. Parfois les choses peuvent être un peu plus compliquées :</p>
<ul>
<li>parfois les identifiants n’ont pas le même nom dans les deux tableaux. On peut alors les spécifier par les options <code>by.x</code> et <code>by.y</code> ;</li>
<li>parfois les deux tableaux comportent des colonnes (hors identifiants) ayant le même nom. <code data-pkg="base">merge</code> conserve dans ce cas ces deux colonnes mais les renomme en les suffixant par <em>.x</em> pour celles provenant du premier tableau et <em>.y</em> pour celles du second ;</li>
<li>parfois on n’a pas d’identifiant unique préétabli, mais on en construit un à partir de plusieurs variables. On peut alors donner un vecteur en paramètres de l’option <code>by</code>, par exemple <code>by=c("nom","prenom","date.naissance")</code>.</li>
</ul>
<p>Une subtilité supplémentaire intervient lorsque les deux tableaux fusionnés n’ont pas exactement les mêmes lignes. Par défaut, <code data-pkg="base">merge</code> ne conserve que les lignes présentes dans les deux tableaux :</p>
<table style="margin: 11px auto;"><tr>
<td>
<table class="exemple_df">
<tr>
<th>
id
</th>
<th>
v1
</th>
</tr>
<tr>
<td>
1
</td>
<td>
H
</td>
</tr>
<tr>
<td>
2
</td>
<td>
H
</td>
</tr>
<tr>
<td>
3
</td>
<td>
F
</td>
</tr>
</table>
</td>
<td>
<table class="exemple_operateur"><tr>
<td>
+
</td>
</tr></table>
</td>
<td>
<table class="exemple_df">
<tr>
<th>
id
</th>
<th>
v2
</th>
</tr>
<tr>
<td>
1
</td>
<td>
10
</td>
</tr>
<tr>
<td>
2
</td>
<td>
15
</td>
</tr>
<tr>
<td>
5
</td>
<td>
31
</td>
</tr>
</table>
</td>
<td>
<table class="exemple_operateur"><tr>
<td>
=
</td>
</tr></table>
</td>
<td>
<table class="exemple_df">
<tr>
<th>
id
</th>
<th>
v1
</th>
<th>
v2
</th>
</tr>
<tr>
<td>
1
</td>
<td>
H
</td>
<td>
10
</td>
</tr>
<tr>
<td>
2
</td>
<td>
H
</td>
<td>
15
</td>
</tr>
</table>
</td>
</tr></table>
<p>On peut cependant modifier ce comportement avec les options <code>all.x</code> et <code>all.y</code>.</p>
<p>Ainsi, <code>all.x=TRUE</code> indique de conserver toutes les lignes du premier tableau. Dans ce cas <code data-pkg="base">merge</code> donne une valeur <code>NA</code> pour ces lignes aux colonnes provenant du second tableau. Ce qui donnerait :</p>
<table style="margin: 11px auto;"><tr>
<td>
<table class="exemple_df">
<tr>
<th>
id
</th>
<th>
v1
</th>
</tr>
<tr>
<td>
1
</td>
<td>
H
</td>
</tr>
<tr>
<td>
2
</td>
<td>
H
</td>
</tr>
<tr>
<td>
3
</td>
<td>
F
</td>
</tr>
</table>
</td>
<td>
<table class="exemple_operateur"><tr>
<td>
+
</td>
</tr></table>
</td>
<td>
<table class="exemple_df">
<tr>
<th>
id
</th>
<th>
v2
</th>
</tr>
<tr>
<td>
1
</td>
<td>
10
</td>
</tr>
<tr>
<td>
2
</td>
<td>
15
</td>
</tr>
<tr>
<td>
5
</td>
<td>
31
</td>
</tr>
</table>
</td>
<td>
<table class="exemple_operateur"><tr>
<td>
=
</td>
</tr></table>
</td>
<td>
<table class="exemple_df">
<tr>
<th>
id
</th>
<th>
v1
</th>
<th>
v2
</th>
</tr>
<tr>
<td>
1
</td>
<td>
H
</td>
<td>
10
</td>
</tr>
<tr>
<td>
2
</td>
<td>
H
</td>
<td>
15
</td>
</tr>
<tr>
<td>
3
</td>
<td>
F
</td>
<td>
<code>NA</code>
</td>
</tr>
</table>
</td>
</tr></table>
<p>L’option <code>all.y=TRUE</code> fait la même chose en conservant toutes les lignes du second tableau.</p>
<table style="margin: 11px auto;"><tr>
<td>
<table class="exemple_df">
<tr>
<th>
id
</th>
<th>
v1
</th>
</tr>
<tr>
<td>
1
</td>
<td>
H
</td>
</tr>
<tr>
<td>
2
</td>
<td>
H
</td>
</tr>
<tr>
<td>
3
</td>
<td>
F
</td>
</tr>
</table>
</td>
<td>
<table class="exemple_operateur"><tr>
<td>
+
</td>
</tr></table>
</td>
<td>
<table class="exemple_df">
<tr>
<th>
id
</th>
<th>
v2
</th>
</tr>
<tr>
<td>
1
</td>
<td>
10
</td>
</tr>
<tr>
<td>
2
</td>
<td>
15
</td>
</tr>
<tr>
<td>
5
</td>
<td>
31
</td>
</tr>
</table>
</td>
<td>
<table class="exemple_operateur"><tr>
<td>
=
</td>
</tr></table>
</td>
<td>
<table class="exemple_df">
<tr>
<th>
id
</th>
<th>
v1
</th>
<th>
v2
</th>
</tr>
<tr>
<td>
1
</td>
<td>
H
</td>
<td>
10
</td>
</tr>
<tr>
<td>
2
</td>
<td>
H
</td>
<td>
15
</td>
</tr>
<tr>
<td>
5
</td>
<td>
<code>NA</code>
</td>
<td>
31
</td>
</tr>
</table>
</td>
</tr></table>
<p>Enfin, on peut décider de conserver toutes les lignes des deux tableaux en utilisant à la fois <code>all.x=TRUE</code> et <code>all.y=TRUE</code>, ce qui donne :</p>
<table style="margin: 11px auto;"><tr>
<td>
<table class="exemple_df">
<tr>
<th>
id
</th>
<th>
v1
</th>
</tr>
<tr>
<td>
1
</td>
<td>
H
</td>
</tr>
<tr>
<td>
2
</td>
<td>
H
</td>
</tr>
<tr>
<td>
3
</td>
<td>
F
</td>
</tr>
</table>
</td>
<td>
<table class="exemple_operateur"><tr>
<td>
+
</td>
</tr></table>
</td>
<td>
<table class="exemple_df">
<tr>
<th>
id
</th>
<th>
v2
</th>
</tr>
<tr>
<td>
1
</td>
<td>
10
</td>
</tr>
<tr>
<td>
2
</td>
<td>
15
</td>
</tr>
<tr>
<td>
5
</td>
<td>
31
</td>
</tr>
</table>
</td>
<td>
<table class="exemple_operateur"><tr>
<td>
=
</td>
</tr></table>
</td>
<td>
<table class="exemple_df">
<tr>
<th>
id
</th>
<th>
v1
</th>
<th>
v2
</th>
</tr>
<tr>
<td>
1
</td>
<td>
H
</td>
<td>
10
</td>
</tr>
<tr>
<td>
2
</td>
<td>
H
</td>
<td>
15
</td>
</tr>
<tr>
<td>
3
</td>
<td>
F
</td>
<td>
<code>NA</code>
</td>
</tr>
<tr>
<td>
5
</td>
<td>
<code>NA</code>
</td>
<td>
31
</td>
</tr>
</table>
</td>
</tr></table>
<p>Parfois, l’un des identifiants est présent à plusieurs reprises dans l’un des tableaux (par exemple lorsque l’une des tables est un ensemble de ménages et que l’autre décrit l’ensemble des individus de ces ménages). Dans ce cas les lignes de l’autre table sont dupliquées autant de fois que nécessaires :</p>
<table style="margin: 11px auto;"><tr>
<td>
<table class="exemple_df">
<tr>
<th>
id
</th>
<th>
v1
</th>
</tr>
<tr>
<td>
1
</td>
<td>
H
</td>
</tr>
<tr>
<td>
2
</td>
<td>
H
</td>
</tr>
<tr>
<td>
3
</td>
<td>
F
</td>
</tr>
</table>
</td>
<td>
<table class="exemple_operateur"><tr>
<td>
+
</td>
</tr></table>
</td>
<td>
<table class="exemple_df">
<tr>
<th>
id
</th>
<th>
v2
</th>
</tr>
<tr>
<td>
1
</td>
<td>
10
</td>
</tr>
<tr>
<td>
1
</td>
<td>
18
</td>
</tr>
<tr>
<td>
1
</td>
<td>
21
</td>
</tr>
<tr>
<td>
2
</td>
<td>
15
</td>
</tr>
<tr>
<td>
3
</td>
<td>
42
</td>
</tr>
</table>
</td>
<td>
<table class="exemple_operateur"><tr>
<td>
=
</td>
</tr></table>
</td>
<td>
<table class="exemple_df">
<tr>
<th>
id
</th>
<th>
v1
</th>
<th>
v2
</th>
</tr>
<tr>
<td>
1
</td>
<td>
H
</td>
<td>
10
</td>
</tr>
<tr>
<td>
1
</td>
<td>
H
</td>
<td>
18
</td>
</tr>
<tr>
<td>
1
</td>
<td>
H
</td>
<td>
21
</td>
</tr>
<tr>
<td>
2
</td>
<td>
H
</td>
<td>
15
</td>
</tr>
<tr>
<td>
3
</td>
<td>
F
</td>
<td>
42
</td>
</tr>
</table>
</td>
</tr></table>
</div>
<div id="fusion-de-tables_extension-dplyr" class="section level1">
<h1>Extension dplyr</h1>
<p>Voir la vignette dédiée (en anglais) : <a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/two-table.html" class="uri">https://cran.rstudio.com/web/packages/dplyr/vignettes/two-table.html</a>.</p>
<p>Les principales fonctions de <code class="pkg">dplyr</code> pour la fusion de tables sont <code data-pkg="dplyr" data-rdoc="join">inner_join</code> et <code data-pkg="dplyr" data-rdoc="join">left_join</code>.</p>
</div>
<div id="fusion-de-tables_extension-data.table" class="section level1">
<h1>Extension data.table</h1>
<p><code class="pkg">data.table</code> fourni une fonction <code data-pkg="data.table">merge</code> beaucoup plus rapide que celle standard de R mais fonctionnant de manière identique.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fusion-de-tables_fn1"><p>L’équivalent de <code data-pkg="base">cbind</code> pour les lignes s’appelle <code data-pkg="base" data-rdoc="cbind">rbind</code>.<a href="#fusion-de-tables_fnref1"><U+21A9></a></p></li>
<li id="fusion-de-tables_fn2"><p>Si vous me passez l’expression…<a href="#fusion-de-tables_fnref2"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="gestion-des-dates"><div class="fluid-row" id="gestion-des-dates_header">



<h1 class="title toc-ignore">Gestion des dates</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>
<p>Si R fournit quelques fonctions natives pour la gestion des dates, l’extension <code class="pkg">lubridate</code> est recommandée pour tout travail un peu plus fin sur des dates. On pourra se référer à la vignette officielle (<a href="https://cran.r-project.org/web/packages/lubridate/vignettes/lubridate.html" class="uri">https://cran.r-project.org/web/packages/lubridate/vignettes/lubridate.html</a>, en anglais) ou encore à ce tutoriel (<a href="https://rpubs.com/davoodastaraky/lubridate" class="uri">https://rpubs.com/davoodastaraky/lubridate</a>).</p>

</article>
<article id="agregation"><div class="fluid-row" id="agregation_header">



<h1 class="title toc-ignore">Agrégation</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="fonctions-a-fenetre"><div class="fluid-row" id="fonctions-a-fenetre_header">



<h1 class="title toc-ignore">Fonctions à fenêtre</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="restructuration-de-donnees"><div class="fluid-row" id="restructuration-de-donnees_header">



<h1 class="title toc-ignore">Restructuration de données</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="manipuler-du-texte"><div class="fluid-row" id="manipuler-du-texte_header">



<h1 class="title toc-ignore">Manipuler du texte</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="scraping"><div class="fluid-row" id="scraping_header">



<h1 class="title toc-ignore">Scraping</h1>

</div>

<div class="TOC">
<ul>
<li>
<a href="#scraping_les-sources-de-lexemple">Les sources de l’exemple</a><ul>
<li><a href="#scraping_les-blogs">Les blogs</a></li>
<li><a href="#scraping_les-mots-cles">Les mots-clés</a></li>
</ul>
</li>
<li>
<a href="#scraping_recuperation-des-donnees">Récupération des données</a><ul>
<li><a href="#scraping_recuperation-delements-html">Récupération d’éléments HTML</a></li>
<li><a href="#scraping_recuperation-de-plusieurs-pages">Récupération de plusieurs pages</a></li>
<li><a href="#scraping_utilisation-de-la-syntaxe-xpath">Utilisation de la syntaxe XPath</a></li>
</ul>
</li>
<li><a href="#scraping_combinaison-des-resultats">Combinaison des résultats</a></li>
</ul>
</div>

<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>
<p>Une grande partie des données que l’on trouve sur Internet n’y sont pas présentées sous la forme d’un jeu de données : dans de très nombreux cas de figure, ces données peuvent être présentées, par exemple, sous la forme d’un tableau, ou d’une série de pages Web. Ce chapitre explique comment récupérer ces données, de manière à en permettre la manipulation dans <strong>R</strong>.</p>
<p>La récupération de données numériques, que l’on va illustrer à partir de trois sites Internet consacrés aux théories du complot circulant en France, est plus connue sous le nom de <em>scraping</em> ou de <em><a href="https://en.wikipedia.org/wiki/Web_scraping">Web scraping</a></em>. Il s’agit d’un ensemble de techniques, dont on présentera ici que les principaux aspects, appliqués à un cas d’étude précis.</p>
<div id="scraping_les-sources-de-lexemple" class="section level2">
<h2>Les sources de l’exemple</h2>
<p>Ce chapitre s’intéresse à trois sites Internet consacrés aux théories du complot et à leurs diffuseurs, les « conspirationnistes ». Le site de Rudy Reichstadt, <a href="http://www.conspiracywatch.info/">Conspiracy Watch</a>, qui va devenir notre principale source de données, propose une <a href="http://www.conspiracywatch.info/F-A-Q_r11.html">définition de ce terme</a>. La seconde source utilisée, le site <a href="http://confusionnisme.info/">Confusionnisme</a> d’Ornella Guyet, utilise une <a href="http://confusionnisme.info/vous-avez-dit-confusionnisme/">définition différente</a>, qui recoupe largement la première du point de vue des individus et des groupes qu’elle identifie. Notre troisième source, le site anonyme <a href="http://conspishorsdenosvies.noblogs.org/">Conspis hors de nos vi[ll]es</a>, ne propose pas de définition précise pour sa part, mais fournit <a href="http://conspishorsdenosvies.noblogs.org/qui-sommes-nous/">quelques éléments supplémentaires de description</a>.</p>
<p>Les termes de « théorie du complot » et de « conspirationnisme » étant difficiles à saisir en seulement quelques phrases, on renverra le lecteur à la <a href="http://www.jean-jaures.org/Publications/Notes/Conspirationnisme-un-etat-des-lieux">note publiée par Rudy Reichstadt</a> pour l’Observatoire des radicalités politiques de la Fondation Jean Jaurès. Cette note donne un bon aperçu des différents groupes impliqués dans la diffusion de ces « théories » en France, que l’on retrouve dans une <a href="http://www.joelgombin.fr/mapping-the-french-conspiracist-web-key-findings/">cartographie en réseau</a> de leurs sites Internet, réalisée par Joël Gombin en juillet 2014. Les données récupérées dans ce chapitre recoupent les informations fournies dans ces deux sources.</p>
<div id="scraping_les-blogs" class="section level3">
<h3>Les blogs</h3>
<p>Les sites Internet auxquels on s’intéresse sont tous les trois publiés sous la forme de blogs. Ce détail est important, car pour en récupérer les informations publiées par ces sites, il va falloir comprendre la structure sous-jacente de ces blogs, c’est-à-dire la syntaxe HTML de leurs pages. Les sites <a href="http://confusionnisme.info/">Confusionnisme</a> et <a href="http://conspishorsdenosvies.noblogs.org/">Conspis hors de nos vi[ll]es</a> sont les plus simples à comprendre. En effet, ils sont tous les deux publiés grâce au moteur de blog <a href="http://wordpress.org/">WordPress</a>, qui permet de parcourir les différentes pages d’un blog en rajoutant le suffixe <code>/page/n</code> à l’adresse-racine du site, de la manière suivante :</p>
<pre><code>http://confusionnisme.info/page/1
http://confusionnisme.info/page/2
http://confusionnisme.info/page/3
...
http://conspishorsdenosvies.noblogs.org/page/1
http://conspishorsdenosvies.noblogs.org/page/2
http://conspishorsdenosvies.noblogs.org/page/3
...</code></pre>
<p>En navigant ces liens, on s’aperçoit que les deux sites en question n’ont publié qu’un nombre limité de billets : il n’y a que 4 pages de billets sur le premier, et 5 pages sur le second. Le site <a href="http://www.conspiracywatch.info/">Conspiracy Watch</a> est, en comparaison, beaucoup plus riche : en effet, comme l’indique le compteur visible en bas de chaque page, le site compte 60 pages de billets, auxquelles le lecteur peut accéder en utilisant un suffixe différent, lié à l’utilisation d’un moteur de blog différent de WordPress. Dans ce cas de figure, le suffixe ne renvoie pas à une « page », mais à un « compteur » de billets, où le dernier billet publié est numéroté <code>0</code> :</p>
<pre><code>http://www.conspiracywatch.info/?start=0
http://www.conspiracywatch.info/?start=20
http://www.conspiracywatch.info/?start=40
...</code></pre>
<p>Suivant ce schéma de pagination, qui commence à <code>0</code> puis augmente de 20 billets par page, la page <code>60</code> va correspondre au suffixe <code>?start=1180</code>. On connaît donc désormais le nombres de pages à récupérer sur chacun des blogs étudiés, en notant bien que c’est le site <a href="http://www.conspiracywatch.info/">Conspiracy Watch</a> qui va fournir la très grande majorité des pages. On aurait pu « découvrir » ces informations de manière programmatique, en écrivant un peu de code pour ce faire, mais un repérage manuel du nombre de pages sur chacun des blogs est ici tout aussi rapide, même s’il faudra le mettre à jour lorsque les blogs auront publié de nouvelles pages de billets.</p>
</div>
<div id="scraping_les-mots-cles" class="section level3">
<h3>Les mots-clés</h3>
<p>Sur chacun des blogs auxquels on s’intéresse, on trouve des billets très détaillés sur tel ou tel groupe diffusant une ou plusieurs « théories du complot ». Sur les blogs <a href="http://confusionnisme.info/">Confusionnisme</a> et <a href="http://www.conspiracywatch.info/">Conspiracy Watch</a>, on trouve par exemple <a href="http://www.conspiracywatch.info/Mouvement-du-14-Juillet-le-pu-putsch-qui-fait-flop_a1427.html">deux</a> <a href="http://confusionnisme.info/2015/07/15/le-petard-mouille-du-14-juillet/">articles</a> sur un groupuscule ayant appelé à un « Mouvement du 14 juillet » 2015. Sur le blog <a href="http://conspishorsdenosvies.noblogs.org/">Conspis hors de nos vi[ll]es</a>, qui a cessé de publier en mars 2012, le <a href="http://conspishorsdenosvies.noblogs.org/post/2012/03/30/les-ideologues-de-la-contre-revolution-sinvitent-a-lageca-et-on-devrait-laisser-faire-ca/">dernier billet</a> évoque un autre exemple de ces groupes. Ces différents billets sont tous soigneusement catégorisés par de très nombreux mots-clés, qui incluent notamment les noms propres des individus cités ; <a href="http://www.conspiracywatch.info/Laurent-Louis-a-propos-du-premier-pas-de-l-homme-sur-la-Lune_a1419.html">ce billet</a>, par exemple, se termine par les mots-clés suivants :</p>
<pre><code>11 septembre, antiaméricanisme, apollo 11, etat islamique, etats-unis, laurent louis, lune</code></pre>
<p>Ces mots-clés sont destinés à permettre aux lecteurs de naviguer plus facilement à travers les différents billets du site, ainsi qu’à faciliter l’indexation du blog par les moteurs de recherche. Ce que l’on se propose de faire ici consiste à récupérer, pour chacun des billets publiés par chacun des trois blogs, l’ensemble de ces mots-clés, ainsi que les titres, les dates de publication et les adresses Internet – les <a href="https://fr.wikipedia.org/wiki/Uniform_Resource_Locator">URL</a> – des billets auxquels ils correspondent. Ces données permettront par la suite de construire un <a href="https://en.wikipedia.org/wiki/Co-occurrence_networks">réseau de co-occcurrences</a> de ces mots-clés, c’est-à-dire une représentation graphique des associations entre ces mots-clés sur la base des trois sources utilisées.</p>
</div>
</div>
<div id="scraping_recuperation-des-donnees" class="section level2">
<h2>Récupération des données</h2>
<p>Pour récupérer les données des trois blogs, on va commencer par charger quelques extensions utilisées dans plusieurs autres chapitres : l’extension <code class="pkg">dplyr</code> va servir à manipuler les données au fur et à mesure de leur récupération ; l’extension <code class="pkg">readr</code> va servir à sauvegarder le résultat final au format CSV ; l’extension <code class="pkg">lubridate</code> va servir à convertir les dates de publication des billets vers un même format générique ; et l’extension <code class="pkg">stringr</code> va servir à nettoyer le texte récupéré.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(readr)
<span class="kw">library</span>(lubridate)
<span class="kw">library</span>(stringr)</code></pre></div>
<p>Chargeons à présent l’extension <code class="pkg">rvest</code>, qui va fournir les fonctions essentielles à la récupération des données de chacun des blogs. Comme <a href="https://cran.r-project.org/web/packages/rvest/README.html">l’explique</a> l’auteur de l’extension, celle-ci est inspirée d’extensions équivalentes disponibles pour le langage Python. Sa fonctionnalité principale est de permettre à l’utilisateur, à l’aide d’une syntaxe simplifiée ou à l’aide de la syntaxe <a href="https://fr.wikipedia.org/wiki/XPath">XPath</a>, de sélectionner les différents éléments d’une page Web, à partir des balises <a href="https://fr.wikipedia.org/wiki/Hypertext_Markup_Language">HTML</a> et <a href="https://fr.wikipedia.org/wiki/Feuilles_de_style_en_cascade">CSS</a> de cette page.<a href="#scraping_fn1" class="footnoteRef" id="scraping_fnref1"><sup>1</sup></a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rvest)</code></pre></div>
<div id="scraping_recuperation-delements-html" class="section level3">
<h3>Récupération d’éléments HTML</h3>
<p>Commençons par le blog <a href="http://confusionnisme.info/">Confusionnisme</a>. Un rapide coup d’oeil au <a href="view-source:http://confusionnisme.info/">code source de sa page d’accueil</a> montre que les billets publiés sur ce blog se trouvent dans une suite de structures : l’une d’entre elles, <code>&lt;div id="scraping_content"&gt;</code>, qui se lit « diviseur à identifiant <code>content</code> », contient tous les billets, et à l’intérieur de cette structure, tous les titres de billets se trouvent dans un hyperlien <code>&lt;a&gt;</code> à l’intérieur d’une balise <code>&lt;h1 class="entry-title"&gt;</code>, qui se lit « titre de niveau 1 de classe « entry-title ».</p>
<p>Récupérons désormais le code source de la page d’accueil du blog grâce à la fonction <code data-pkg="rvest">html</code>. Une fois exécuté le code ci-dessous, affichez le contenu de l’objet <code>h</code> pour réaliser que vous venez de récupérer le code source HTML de la page d’accueil du blog :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">h =<span class="st"> </span><span class="kw">html</span>(<span class="st">"http://confusionnisme.info/"</span>)</code></pre></div>
<p>Sélectionnons, à présent, toutes les balises correspondant aux identifiants notés ci-dessus, grâce à la fonction <code data-pkg="rvest">html_nodes</code>. Pour gagner de la place, on n’affichera ici que les deux premiers titres de billets que renvoie cette dernière fonction :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">html_nodes</span>(h, <span class="st">"#content .entry-title a"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">head</span>(<span class="dv">2</span>)</code></pre></div>
<p>Le code ci-dessus signifie : « sélectionner tous les hyperliens <code>&lt;a&gt;</code>, à l’intérieur des éléments identifiés par la classe <code>entry-title</code>, à l’intérieur de l’élément portant l’identifiant <code>content</code> ». Comme l’on peut le voir, les identifiants des éléments HTML (<code>id</code>), qui sont censés être uniques, sont codés par un dièse (<code>#</code>), et les classes de ces mêmes éléments (<code>class</code>), qui peuvent se répéter, sont codées par un point (<code>.</code>). Ces codes sont identiques à ceux que l’on utilise pour attribuer des styles particuliers à ces éléments en langage CSS.</p>
<p>Les éléments HTML que l’on a sélectionnés contiennent aussi bien des balises HTML (telles que <code>&lt;a&gt;</code> et <code>&lt;i&gt;</code>) que du texte. Pour ne sélectionner que le texte, on rajoute la fonction <code data-pkg="rvest">html_text</code> au code montré ci-dessus. Toujours par économie de place, on ne montre que les deux premiers résultats de ce nouvel enchaînement de fonctions :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">html_nodes</span>(h, <span class="st">"#content .entry-title a"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>html_text <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">head</span>(<span class="dv">2</span>)</code></pre></div>
<p>Voilà qui permet donc de récupérer les titres des billets ! Pour récupérer les hyperliens vers ces billets, rien de plus simple : au lieu de récupérer le texte des titres, il suffit de demander à récupérer l’attribut <code>href</code> de chaque lien, en utilisant la fonction <code data-pkg="rvest">html_attr</code>. On obtient cette fois-ci les hyperliens complets vers chaque billet :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">html_nodes</span>(h, <span class="st">"#content .entry-title a"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">html_attr</span>(<span class="st">"href"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">head</span>(<span class="dv">2</span>)</code></pre></div>
<p>Présentons encore un exemple de sélection d’éléments sur la page d’accueil de ce blog, cette fois-ci en montrant l’intégralité des éléments récupérés, car ils prennent peu de place à l’écran. Ici, on récupère les dates de publications des billets, qui se trouvent, toujours selon le <a href="view-source:http://confusionnisme.info/">code source de la page</a>, dans une balise <code>&lt;time&gt;</code> qui se trouve dans une balise <code>&lt;header class="entry-meta"&gt;</code>. Le code que l’on donne à la fonction <code data-pkg="rvest">html_nodes</code> est donc :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">html_nodes</span>(h, <span class="st">"#content header.entry-header time"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>html_text</code></pre></div>
<p>On voit bien ici que les deux premières dates sont identiques aux dates qui figurent dans les hyperliens des deux premiers billets, tels que vus plus haut.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">html_nodes</span>(h, <span class="st">"#content header.entry-header time"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>html_text</code></pre></div>
<p>Terminons, enfin, par un exemple plus compliqué. Comme on l’a déjà écrit, chacun des billets du blog est accompagné de plusieurs mots-clés. Après inspection du code source, on voit que ces mots-clés se trouvent regroupés dans un élément appelé <code>&lt;span class="tag-links"&gt;</code>. Visionnons les deux premiers éléments en question, toujours à l’aide de la même syntaxe de sélection :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">html_nodes</span>(h, <span class="st">".tag-links"</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">head</span>(<span class="dv">2</span>)</code></pre></div>
<p>Pour pouvoir stocker tous les mots-clés d’un billet sur la même ligne d’un fichier CSV, qui contiendra aussi le titre du billet, son hyperlien et sa date de publication, il va falloir regroupr ces mots-clés. On va donc, <em>à l’intérieur de chacun des éléments</em> de la liste d’éléments <code>&lt;span&gt;</code>, extraire le texte des mots-clés, contenus dans les éléments <code>&lt;a&gt;</code>, et les “coller” ensemble grâce à la fonction <code data-pkg="base">paste0</code> et à son argument <code>collapse</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">html_nodes</span>(h, <span class="st">".tag-links"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">sapply</span>(<span class="cf">function</span>(x) <span class="kw">html_nodes</span>(x, <span class="st">"a"</span>) <span class="op">%&gt;%</span>
<span class="st">           </span>html_text <span class="op">%&gt;%</span>
<span class="st">           </span><span class="kw">paste0</span>(<span class="dt">collapse =</span> <span class="st">";"</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">head</span>(<span class="dv">2</span>)</code></pre></div>
<p>L’astuce se trouve ici dans l’utilisation de la fonction <code data-pkg="base">sapply</code>, qui permet de travailler sur chacun des éléments <code>&lt;span class="tag-links"&gt;</code> de manière séparée. L’utilisation de la fonction <em>pipe</em> <code>%&gt;%</code> a par ailleurs permis de travailler de manière cumulative, par essai-erreur, tout en produisant un code final plutôt lisible.</p>
</div>
<div id="scraping_recuperation-de-plusieurs-pages" class="section level3">
<h3>Récupération de plusieurs pages</h3>
<p>On sait désormais comment récupérer les informations que l’on veut collecter. Le blog <a href="http://confusionnisme.info/">Confusionnisme</a> n’ayant que 4 pages, il va être très simple de les récupérer à l’aide d’une petite boucle qui récupère chaque page, en extrait les données inspectées ci-dessus, et les rajoute à un jeu de données initialement vide, nommé <code>d1</code>, grâce à la fonction <code data-pkg="base">rbind</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d1 =<span class="st"> </span><span class="kw">data_frame</span>()

<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {
  
  h =<span class="st"> </span><span class="kw">html</span>(<span class="kw">paste0</span>(<span class="st">"http://confusionnisme.info/page/"</span>, i))
  
  d1 =<span class="st"> </span><span class="kw">rbind</span>(d1, <span class="kw">data_frame</span>(
    <span class="dt">url =</span> <span class="kw">html_nodes</span>(h, <span class="st">"#content .entry-title a"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_attr</span>(<span class="st">"href"</span>),
    <span class="dt">title =</span> <span class="kw">html_nodes</span>(h, <span class="st">"#content .entry-title a"</span>) <span class="op">%&gt;%</span><span class="st"> </span>html_text,
    <span class="dt">date =</span> <span class="kw">html_nodes</span>(h, <span class="st">"#content header.entry-header time"</span>) <span class="op">%&gt;%</span><span class="st"> </span>html_text,
    <span class="dt">tags =</span> <span class="kw">html_nodes</span>(h, <span class="st">".tag-links"</span>) <span class="op">%&gt;%</span>
<span class="st">      </span><span class="kw">sapply</span>(<span class="cf">function</span>(x) <span class="kw">html_nodes</span>(x, <span class="st">"a"</span>) <span class="op">%&gt;%</span>
<span class="st">               </span>html_text <span class="op">%&gt;%</span>
<span class="st">               </span><span class="kw">paste0</span>(<span class="dt">collapse =</span> <span class="st">";"</span>))
  ))
  
}</code></pre></div>
<p>À la date de publication de ce blog, ce petit bout de code récupère les 36 billets étalés sur les 4 pages du site <a href="http://confusionnisme.info/">Confusionnisme</a>. Comme le montre l’inspection du résultat, le jeu de données que l’on vient de constituer contient l’adresse, le titre, la date de publication et les mots-clés de ces billets :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">View</span>(d1)</code></pre></div>
<p>Il ne reste plus qu’à convertir la variable <var>date</var> vers le format générique <code>yyyy-mm-dd</code> que propose <strong>R</strong> à travers la fonction <code data-pkg="base">as.Date</code>. Pour convertir la variable, on utilise l’extension <code class="pkg">lubridate</code>, qui peut facilement interpréter les mois écrits en langue française grâce à l’argument <code>locale</code> spécifié ci-dessous :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d1<span class="op">$</span>date =<span class="st"> </span><span class="kw">parse_date_time</span>(d1<span class="op">$</span>date, <span class="st">"%d %m %Y"</span>, <span class="dt">locale =</span> <span class="st">"fr_FR"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>as.Date</code></pre></div>
</div>
<div id="scraping_utilisation-de-la-syntaxe-xpath" class="section level3">
<h3>Utilisation de la syntaxe XPath</h3>
<p>L’exemple que l’on vient de voir permet de récupérer les données du blog <a href="http://confusionnisme.info/">Confusionnisme</a>. Il se trouve que ce code fonctionne presque aussi bien pour le blog <a href="http://conspishorsdenosvies.noblogs.org/">Conspis hors de nos vi[ll]es</a> : en effet, celui-ci utilisant aussi le moteur de blog WordPress, la structure de ses pages est quasiment identique à celle que l’on vient de voir. Voici le code complet pour récupérer les 5 pages de ce blog :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d2 =<span class="st"> </span><span class="kw">data_frame</span>()

<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {
  
  h =<span class="st"> </span><span class="kw">html</span>(<span class="kw">paste0</span>(<span class="st">"http://conspishorsdenosvies.noblogs.org/page/"</span>, i))
  
  d2 =<span class="st"> </span><span class="kw">rbind</span>(d2, <span class="kw">data_frame</span>(
    <span class="dt">url =</span> <span class="kw">html_nodes</span>(h, <span class="st">"#content .entry-title a"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_attr</span>(<span class="st">"href"</span>),
    <span class="dt">title =</span> <span class="kw">html_nodes</span>(h, <span class="st">"#content .entry-title a"</span>) <span class="op">%&gt;%</span><span class="st"> </span>html_text,
    <span class="dt">date =</span> <span class="kw">html_nodes</span>(h, <span class="st">"#content .entry-date"</span>) <span class="op">%&gt;%</span><span class="st"> </span>html_text,
    <span class="dt">tags =</span> <span class="kw">html_nodes</span>(h, <span class="st">".tag-links"</span>) <span class="op">%&gt;%</span>
<span class="st">      </span><span class="kw">sapply</span>(<span class="cf">function</span>(x) <span class="kw">html_nodes</span>(x, <span class="dt">xpath =</span> <span class="st">"a[@rel='tag']"</span>) <span class="op">%&gt;%</span>
<span class="st">               </span>html_text <span class="op">%&gt;%</span>
<span class="st">               </span><span class="kw">paste0</span>(<span class="dt">collapse =</span> <span class="st">";"</span>))
  ))
  
}

d2<span class="op">$</span>date =<span class="st"> </span><span class="kw">parse_date_time</span>(d2<span class="op">$</span>date, <span class="st">"%d/%m/%Y"</span>) <span class="op">%&gt;%</span><span class="st"> </span>as.Date</code></pre></div>
<p>On remarquera que plusieurs petites choses ont changé : par exemple, sur le blog <a href="http://conspishorsdenosvies.noblogs.org/">Conspis hors de nos vi[ll]es</a>, les dates sont affichées dans un format <code>dd/mm/yyyy</code> qui ne nécessite pas de conversion, car chaque élément de la date est donné sous la forme d’un chiffre. On remarquera aussi que l’emplacement de la date a changé, car le gabarit graphique du blog diffère de celui de <a href="http://confusionnisme.info/">Confusionnisme</a> et place cette information dans un élément différent du <a href="view-source:http://conspishorsdenosvies.noblogs.org/">code source de la page</a>.</p>
<p>Le changement le plus important ici concerne l’utilisation de la syntaxe <a href="https://fr.wikipedia.org/wiki/XPath">XPath</a> : en effet, pour récupérer les mots-clés, il nous a fallu limiter ceux-ci à ceux se trouvant dans des hyperliens (<code>&lt;a&gt;</code>) dont la propriété <code>rel</code> est égale à <code>tag</code>, pour ne pas également récupérer les mots-clés correspondant à des catégories du blog. La syntaxe XPath est un peu plus alambiquée : ici, c’est l’expression <code>a[@rel='tag']</code> qui accomplit l’opération souhaitée, à condition d’être bien passée à l’argument <code>xpath</code> de la fonction <code data-pkg="rvest">html_nodes</code>.</p>
</div>
</div>
<div id="scraping_combinaison-des-resultats" class="section level2">
<h2>Combinaison des résultats</h2>
<p>Il nous reste un blog à couvrir : <a href="http://www.conspiracywatch.info/">Conspiracy Watch</a>. Le code pour celui-ci diffère assez fondamentalement des blogs précédents du point de vue de la syntaxe de ses pages, qui utilisent un moteur de blog complètement différent de WordPress. Après lecture de la source, on arrive au code suivant, qui récupère les mêmes variables que récupérées pour les deux autres blogs :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d3 =<span class="st"> </span><span class="kw">data_frame</span>()

<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1180</span>, <span class="dv">20</span>)) {
  
  h =<span class="st"> </span><span class="kw">html</span>(<span class="kw">paste0</span>(<span class="st">"http://www.conspiracywatch.info/?start="</span>, i))
  
  d3 =<span class="st"> </span><span class="kw">rbind</span>(d3, <span class="kw">data_frame</span>(
    <span class="dt">url =</span> <span class="kw">html_nodes</span>(h, <span class="st">"#mod_1260437 .titre a"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_attr</span>(<span class="st">"href"</span>),
    <span class="dt">title =</span> <span class="kw">html_nodes</span>(h, <span class="st">"#mod_1260437 .titre"</span>) <span class="op">%&gt;%</span><span class="st"> </span>html_text <span class="op">%&gt;%</span><span class="st"> </span>str_trim,
    <span class="dt">date =</span> <span class="kw">html_nodes</span>(h, <span class="st">"#mod_1260437 .cel_pied .date"</span>) <span class="op">%&gt;%</span><span class="st"> </span>html_text,
    <span class="dt">tags =</span> <span class="kw">html_nodes</span>(h, <span class="st">"#mod_1260437 .cel_pied"</span>) <span class="op">%&gt;%</span>
<span class="st">      </span><span class="kw">sapply</span>(<span class="cf">function</span>(x) <span class="kw">html_nodes</span>(x, <span class="st">".objet-tag a"</span>) <span class="op">%&gt;%</span>
<span class="st">               </span>html_text <span class="op">%&gt;%</span>
<span class="st">               </span><span class="kw">paste0</span>(<span class="dt">collapse =</span> <span class="st">";"</span>))
  ))
  
}

d3<span class="op">$</span>url =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">"http://www.conspiracywatch.info"</span>, d3<span class="op">$</span>url)
d3<span class="op">$</span>date =<span class="st"> </span><span class="kw">parse_date_time</span>(d3<span class="op">$</span>date, <span class="st">"%d %m %Y"</span>, <span class="dt">locale =</span> <span class="st">"fr_FR"</span>) <span class="op">%&gt;%</span><span class="st"> </span>as.Date</code></pre></div>
<p>Il ne reste plus qu’à combiner les différents résultats de nos récupérations, de les ordonner par date de publication, puis d’harmoniser les mots-clés a minima, en supprimant les traits d’union et en s’assurant qu’ils ne contiennent pas de lettres majuscules :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d =<span class="st"> </span><span class="kw">rbind</span>(d1, d2, d3) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(date)
d<span class="op">$</span>tags =<span class="st"> </span><span class="kw">gsub</span>(<span class="st">"-"</span>, <span class="st">" "</span>, d<span class="op">$</span>tags) <span class="op">%&gt;%</span><span class="st"> </span>tolower</code></pre></div>
<p>L’inspection du résultat montre que l’on dispose à présent d’un jeu de données contenant les métadonnées de 1,268 billets de blogs, dont l’immense majorité proviennent de <a href="http://www.conspiracywatch.info/">Conspiracy Watch</a> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># nombre de billets récupérés</span>
<span class="kw">nrow</span>(d)
<span class="co"># sources des billets</span>
<span class="kw">table</span>(<span class="kw">substr</span>(d<span class="op">$</span>url, <span class="dv">1</span>, <span class="dv">25</span>))</code></pre></div>
<p>Il ne reste plus qu’à sauvegarder ce résultat, pour réutilisation future :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write_csv</span>(d, <span class="st">"data/conspi.csv"</span>)</code></pre></div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="scraping_fn1"><p>Si vous ne connaissez rien aux langages HTML et CSS, c’est le moment ou jamais d’en apprendre les bases ! Un excellent site de référence pour ce faire est <a href="http://www.w3schools.com/">W3 Schools</a>.<a href="#scraping_fnref1"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="export-de-donnees"><div class="fluid-row" id="export-de-donnees_header">



<h1 class="title toc-ignore">Export de données</h1>

</div>


<p><dfn data-index="données, exporter"></dfn><dfn data-index="exporter des données"></dfn></p>
<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>
<p><strong>R</strong> propose différentes fonctions permettant d’exporter des données vers des formats variés.</p>
<table>
<thead><tr class="header">
<th align="left">Type de fichier souhaité</th>
<th align="left">Fonction</th>
<th align="left">Extension</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">texte</td>
<td align="left"><code data-pkg="utils">write.table</code></td>
<td align="left"><code class="pkg">utils</code></td>
</tr>
<tr class="even">
<td align="left">CSV</td>
<td align="left"><code data-pkg="utils" data-rdoc="write.table">write.csv</code></td>
<td align="left"><code class="pkg">utils</code></td>
</tr>
<tr class="odd">
<td align="left">CSV</td>
<td align="left"><code data-pkg="readr">write_csv</code></td>
<td align="left"><code class="pkg">readr</code></td>
</tr>
<tr class="even">
<td align="left">Excel</td>
<td align="left"><code data-pkg="xlsx">write.xlsx</code></td>
<td align="left"><code class="pkg">xlsx</code></td>
</tr>
<tr class="odd">
<td align="left">dBase</td>
<td align="left"><code data-pkg="foreign">write.dbf</code></td>
<td align="left"><code class="pkg">foreign</code></td>
</tr>
<tr class="even">
<td align="left">SPSS</td>
<td align="left"><code data-pkg="haven">write_sav</code></td>
<td align="left"><code class="pkg">haven</code></td>
</tr>
<tr class="odd">
<td align="left">SPSS</td>
<td align="left"><code data-pkg="foreign">write.foreign</code></td>
<td align="left"><code class="pkg">foreign</code></td>
</tr>
<tr class="even">
<td align="left">Stata</td>
<td align="left"><code data-pkg="foreign">write.dta</code></td>
<td align="left"><code class="pkg">foreign</code></td>
</tr>
<tr class="odd">
<td align="left">Stata</td>
<td align="left"><code data-pkg="haven">write_dta</code></td>
<td align="left"><code class="pkg">haven</code></td>
</tr>
<tr class="even">
<td align="left">SAS</td>
<td align="left"><code data-pkg="foreign">write.foreign</code></td>
<td align="left"><code class="pkg">foreign</code></td>
</tr>
<tr class="odd">
<td align="left">SPSS</td>
<td align="left"><code data-pkg="foreign">write.foreign</code></td>
<td align="left"><code class="pkg">foreign</code></td>
</tr>
<tr class="even">
<td align="left">Shapefile</td>
<td align="left"><code data-pkg="maptools" data-rdoc="readShapePoints">writePointsShape</code></td>
<td align="left"><code class="pkg">maptools</code></td>
</tr>
<tr class="odd">
<td align="left">Shapefile</td>
<td align="left"><code data-pkg="maptools" data-rdoc="readShapeLines">writeLinesShape</code></td>
<td align="left"><code class="pkg">maptools</code></td>
</tr>
<tr class="even">
<td align="left">Shapefile</td>
<td align="left"><code data-pkg="maptools" data-rdoc="readShapePoly">writePolyShape</code></td>
<td align="left"><code class="pkg">maptools</code></td>
</tr>
<tr class="odd">
<td align="left">ASCII Grid</td>
<td align="left"><code data-pkg="maptools" data-rdoc="readAsciiGrid">writeAsciiGrid</code></td>
<td align="left"><code class="pkg">maptools</code></td>
</tr>
</tbody>
</table>
<p>À nouveau, pour plus de détails on se référera aux pages d’aide de ces fonctions et au manuel <cite>R Data Import/Export</cite> accessible à l’adresse suivante : <a href="http://cran.r-project.org/manuals.html" class="uri">http://cran.r-project.org/manuals.html</a>.</p>

</article>
<article id="export-de-graphiques"><div class="fluid-row" id="export-de-graphiques_header">



<h1 class="title toc-ignore">Export de graphiques</h1>

</div>

<div class="TOC">
<ul>
<li>
<a href="#export-de-graphiques_via-linterface-de-rstudio">Via l’interface de RStudio</a><ul>
<li><a href="#export-de-graphiques_sauvegarder-le-fichier-en-tant-quimage">Sauvegarder le fichier en tant qu’image</a></li>
<li><a href="#export-de-graphiques_sauvegarder-le-graphique-en-pdf">Sauvegarder le graphique en PDF</a></li>
<li><a href="#export-de-graphiques_copier-le-graphique-dans-le-presse-papier">Copier le graphique dans le presse-papier</a></li>
</ul>
</li>
<li><a href="#export-de-graphiques_export-avec-les-commandes-de-r">Export avec les commandes de R</a></li>
<li><a href="#export-de-graphiques_export-avec-ggplot2">Export avec ggplot2</a></li>
</ul>
</div>

<div id="export-de-graphiques_via-linterface-de-rstudio" class="section level2">
<h2>Via l’interface de RStudio</h2>
<p>L’<dfn>export de graphiques</dfn><dfn data-index="graphique, export"></dfn> est très facile avec <strong>RStudio</strong>. Lorsque l’on créé un graphique, ce dernier est affiché sous l’onglet <em>Plots</em> dans le quadrant inférieur droit. Il suffit de cliquer sur <em>Export</em> pour avoir accès à trois options différentes :</p>
<ul>
<li>
<em>Save as image</em> pour sauvegarder le graphique en tant que fichier image ;</li>
<li>
<em>Save as PDF</em> pour sauvegarder le graphique dans un fichier <strong>PDF</strong> ;</li>
<li>
<em>Copy to Clipboard</em> pour copier le graphique dans le presse-papier (et pouvoir ainsi le coller ensuite dans un document <strong>Word</strong> par exemple).</li>
</ul>
<div id="export-de-graphiques_sauvegarder-le-fichier-en-tant-quimage" class="section level3">
<h3>Sauvegarder le fichier en tant qu’image</h3>
<figure><img src="images/capture_RStudio_save_plot_as_image.png" alt="Sauvegarder un graphique en tant qu’image avec RStudio"><figcaption>
Sauvegarder un graphique en tant qu’image avec RStudio
</figcaption></figure><p>La boîte de dialogue qui s’ouvre propose différentes options d’export :</p>
<ul>
<li>le type de fichier désiré ;</li>
<li>le nom du fichier ;</li>
<li>le répertoire où le fichier doit être créé (par défaut, il s’agit du répertoire de travail) ;</li>
<li>la taille de l’image.</li>
</ul>
<p><strong>R</strong> peut exporter un graphique dans une grande variété de formats. Nous n’aborderons ici que les principaux. Les formats <strong>PNG</strong>, <strong>JPEG</strong> et <strong>TIFF</strong> sont des formats de type <dfn langue="en">bitmap</dfn><dfn data-index="image bitmap"></dfn> (on parle aussi d’<dfn data-index="image matricielle">images matricielles</dfn><a href="#export-de-graphiques_fn1" class="footnoteRef" id="export-de-graphiques_fnref1"><sup>1</sup></a>). L’image est stockée sous forme de points, sa qualité dépendant de sa <dfn>résolution</dfn>, c’est-à-dire du nombre total de points qui la composent. L’intérêt des images matricielles est d’être toujours interprétées de manière identique quelque soit l’outil utilisé. Par contre, elles ne sont pas adaptées lorsque l’on souhaite effectuer des retouches avec un logiciel de dessin.</p>
<p>Pour une utilisation sur un site web, on privilégiera une résolution d’image modérée (entre 400 et 800 pixels de largeur) et les formats <strong>PNG</strong> ou <strong>JPEG</strong>. Pour un document destiné à être imprimé, on priviligiera une résolution plus élevée, pour éviter un phénomène dit de pixellisation.</p>
<p>Les <dfn data-index="image vectorielle">images vectorielles</dfn><a href="#export-de-graphiques_fn2" class="footnoteRef" id="export-de-graphiques_fnref2"><sup>2</sup></a> ont l’avantage de pouvoir être redimensionnées à volonté sans perte de qualité et produisent des fichiers en général de plus petite taille<a href="#export-de-graphiques_fn3" class="footnoteRef" id="export-de-graphiques_fnref3"><sup>3</sup></a>. Elles sont donc tout à fait adaptées pour l’impression. Si l’on souhaite importer l’image dans <strong>Word</strong>, on choisira le format <strong>Metafile</strong> (le seul compris par ce logiciel). Pour <strong>Libre Office</strong> ou <strong>Open Office</strong>, on choisira le format <strong>SVG</strong>.</p>
<p><strong>SVG</strong> (<em>scalable vector graphic</em><a href="#export-de-graphiques_fn4" class="footnoteRef" id="export-de-graphiques_fnref4"><sup>4</sup></a>) est un format libre permettant de décrire une image vectorielle. Les fichiers <strong>SVG</strong> peuvent être directement lus par la majorité des navigateurs récents (<strong>Firefox</strong>, <strong>Chrome</strong>, …). De plus, le logiciel libre de dessins <strong>Inkscape</strong><a href="#export-de-graphiques_fn5" class="footnoteRef" id="export-de-graphiques_fnref5"><sup>5</sup></a> permet d’éditer et de modifier des fichiers <strong>SVG</strong>. Ce format est donc tout à fait adapté pour les graphiques que l’on souhaite retoucher avant publication. Depuis <strong>Inkscape</strong>, il sera possible de faire un export <strong>PNG</strong> en haute résolution pour intégration dans un fichier <strong>Word</strong>.</p>
<p>On pourra modifier la taille de l’image avec les paramètres <em>Height</em> (hauteur) et <em>Width</em> (largeur). En cliquant sur <em>Update Preview</em> la prévisulation du rendu final sera mise à jour.</p>
</div>
<div id="export-de-graphiques_sauvegarder-le-graphique-en-pdf" class="section level3">
<h3>Sauvegarder le graphique en PDF</h3>
<figure><img src="images/capture_RStudio_save_plot_as_pdf.png" alt="Sauvegarder un graphique en PDF avec RStudio"><figcaption>
Sauvegarder un graphique en PDF avec RStudio
</figcaption></figure><p>Les options de la boîte de dialogue permettent de modifier la taille du fichier <strong>PDF</strong> et, bien entendu, d’indiquer le nom et le répertoire du fichier à créer.</p>
<p>En cliquant sur <em>Preview</em>, <strong>RStudio</strong> générera un fichier temporaire afin de visualiser le rendu final.</p>
</div>
<div id="export-de-graphiques_copier-le-graphique-dans-le-presse-papier" class="section level3">
<h3>Copier le graphique dans le presse-papier</h3>
<figure><img src="images/capture_RStudio_copy_plot_to_clipboard.png" alt="Copier un graphique dans le presse-papier avec RStudio"><figcaption>
Copier un graphique dans le presse-papier avec RStudio
</figcaption></figure><p>Il est possible de redimensionner le graphique. De plus, on précisera si l’on souhaite copier une version matricielle (<em>bitmap</em>) ou vectorielle (<em>metafile</em>) du graphique.</p>
</div>
</div>
<div id="export-de-graphiques_export-avec-les-commandes-de-r" class="section level2">
<h2>Export avec les commandes de R</h2>
<p>On peut également exporter les graphiques dans des fichiers de différents formats directement avec des commandes <strong>R</strong>. Ceci a l’avantage de fonctionner sur toutes les plateformes et de faciliter la mise à jour du graphique exporté (on n’a qu’à relancer les commandes concernées pour que le fichier externe soit mis à jour).</p>
<p>La première possibilité est d’exporter le contenu d’une fenêtre déjà existante à l’aide de la fonction <code data-pkg="grDevices" data-rdoc="dev2">dev.print</code>. On doit fournir à celle-ci le format de l’export (option <code>device</code>) et le nom du fichier (option <code>file</code>).</p>
<p>Par exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>))
<span class="kw">dev.print</span>(<span class="dt">device =</span> png, <span class="dt">file =</span> <span class="st">"export.png"</span>, <span class="dt">width =</span> <span class="dv">600</span>)</code></pre></div>
<p>Les formats de sortie possibles varient selon les plateformes, mais on retrouve partout les formats <em>bitmap</em> <code>png</code>, <code>jpeg</code>, <code>tiff</code> et les formats vectoriels <code>svg</code>, <code>postscript</code> ou <code>pdf</code>.</p>
<p>L’autre possibilité est de rediriger directement la sortie graphique dans un fichier, avant d’exécuter la commande générant la figure. On doit pour cela faire appel à l’une des commandes permettant cette redirection. Les plus courantes sont <code data-pkg="grDevices">png</code>, <code data-pkg="grDevices" data-rdoc="png">jpeg</code> et <code data-pkg="grDevices" data-rdoc="png">tiff</code> pour les formats <em>bitmap</em>, <code data-pkg="grDevices" data-rdoc="cairo">svg</code>, <code data-pkg="grDevices">pdf</code>, <code data-pkg="grDevices">postscript</code> et <code data-pkg="grDevices" data-rdoc="windows">win.metafile</code> pour les formats vectoriels.</p>
<p>Ces fonctions prennent différentes options permettant de personnaliser la sortie graphique. Les plus courantes sont <code>width</code> et <code>height</code> qui donnent la largeur et la hauteur de l’image générée (en pixels pour les images bitmap, en pouces pour les images vectorielles) et <code>pointsize</code> qui donne la taille de base des polices de caractère utilisées.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">png</span>(<span class="dt">file =</span> <span class="st">"out.png"</span>, <span class="dt">width =</span> <span class="dv">800</span>, <span class="dt">height =</span> <span class="dv">700</span>)
<span class="kw">plot</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>))
<span class="kw">dev.off</span>()
<span class="kw">pdf</span>(<span class="dt">file =</span> <span class="st">"out.pdf"</span>, <span class="dt">width =</span> <span class="dv">9</span>, <span class="dt">height =</span> <span class="dv">9</span>, <span class="dt">pointsize =</span> <span class="dv">10</span>)
<span class="kw">plot</span>(<span class="kw">rnorm</span>(<span class="dv">150</span>))
<span class="kw">dev.off</span>()</code></pre></div>
<p>Il est nécessaire de faire un appel à la fonction <code data-pkg="grDevices" data-rdoc="dev">dev.off</code> après génération du graphique pour que le résultat soit bien écrit dans le fichier de sortie (dans le cas contraire on se retrouve avec un fichier vide).</p>
</div>
<div id="export-de-graphiques_export-avec-ggplot2" class="section level2">
<h2>Export avec ggplot2</h2>
<p>Les graphiques produits par <code class="pkg">ggplot2</code> peuvent être sauvegardés manuellement, comme vu précédemment, ou programmatiquement. Pour sauvegarder le dernier graphique affiché par <code class="pkg">ggplot2</code> au format PNG, il suffit d’utiliser la fonction <code data-pkg="ggplot2" data-rdoc="ggsave">ggsave</code>, qui permet d’en régler la taille (en pouces) et la résolution (en pixels par pouce ; 72 par défaut) :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsave</span>(<span class="st">"mon_graphique.png"</span>, <span class="dt">width =</span> <span class="dv">11</span>, <span class="dt">height =</span> <span class="dv">8</span>)</code></pre></div>
<p>De la même manière, pour sauvegarder n’importe quel graphique construit avec <code class="pkg">ggplot2</code> et stocké dans un objet, il suffit de préciser le nom de cet objet, comme ci-dessous, où l’on sauvegarde le graphique contenu dans l’objet <code>p</code> au format vectoriel PDF, qui préserve la netteté du texte et des autres éléments du graphique à n’importe quelle résolution d’affichage :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsave</span>(<span class="st">"mon_graphique.pdf"</span>, <span class="dt">plot =</span> p, <span class="dt">width =</span> <span class="dv">11</span>, <span class="dt">height =</span> <span class="dv">8</span>)</code></pre></div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="export-de-graphiques_fn1"><p>Voir <a href="http://fr.wikipedia.org/wiki/Image_matricielle" class="uri">http://fr.wikipedia.org/wiki/Image_matricielle</a>.<a href="#export-de-graphiques_fnref1"><U+21A9></a></p></li>
<li id="export-de-graphiques_fn2"><p>Voir <a href="http://fr.wikipedia.org/wiki/Image_vectorielle" class="uri">http://fr.wikipedia.org/wiki/Image_vectorielle</a>.<a href="#export-de-graphiques_fnref2"><U+21A9></a></p></li>
<li id="export-de-graphiques_fn3"><p>Sauf dans le cas des graphiques complexes reposant sur des dégradés de couleurs, comme les cartes produites à partir de rasters. Auquel cas, il sera parfois préférable de privilégier un export dans un format <em>bitmap</em>.<a href="#export-de-graphiques_fnref3"><U+21A9></a></p></li>
<li id="export-de-graphiques_fn4"><p>Voir <a href="https://www.wikiwand.com/fr/Scalable_Vector_Graphics" class="uri">https://www.wikiwand.com/fr/Scalable_Vector_Graphics</a>.<a href="#export-de-graphiques_fnref4"><U+21A9></a></p></li>
<li id="export-de-graphiques_fn5"><p>téléchargeable gratuitement sur <a href="https://inkscape.org/fr/" class="uri">https://inkscape.org/fr/</a>.<a href="#export-de-graphiques_fnref5"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="export-de-tableaux"><div class="fluid-row" id="export-de-tableaux_header">



<h1 class="title toc-ignore">Export de tableaux</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="statistique-univariee"><div class="fluid-row" id="statistique-univariee_header">



<h1 class="title toc-ignore">Statistique univariée</h1>

</div>

<div class="TOC">
<ul>
<li>
<a href="#statistique-univariee_variable-quantitative">Variable quantitative</a><ul>
<li><a href="#statistique-univariee_principaux-indicateurs">Principaux indicateurs</a></li>
<li><a href="#statistique-univariee_histogramme">Histogramme</a></li>
<li><a href="#statistique-univariee_densite-et-repartition-cumulee">Densité et répartition cumulée</a></li>
<li><a href="#statistique-univariee_boites-a-moustaches">Boîtes à moustaches</a></li>
</ul>
</li>
<li>
<a href="#statistique-univariee_variable-qualitative">Variable qualitative</a><ul>
<li><a href="#statistique-univariee_tris-a-plat">Tris à plat</a></li>
<li><a href="#statistique-univariee_representation-graphique">Représentation graphique</a></li>
</ul>
</li>
<li><a href="#statistique-univariee_exporter-les-graphiques-obtenus">Exporter les graphiques obtenus</a></li>
</ul>
</div>

<div class="note">
<p>Ce chapitre est inspiré de la section <em>Premier travail avec les données</em> du support de cours <a href="https://github.com/juba/intro-r">Introduction à R</a> réalisé par Julien Barnier.</p>
</div>
<p>On entend par <dfn>statistique univariée</dfn><dfn data-index="univariée, statistique"></dfn> l’étude d’une seule variable, que celle-ci soit quantitative ou qualitative. La statistique univariée fait partie de la <dfn>statistique descriptive</dfn><dfn data-index="descriptive, statistique"></dfn>.</p>
<p>Nous utiliserons dans ce chapitre les données de l’enquête <em>Histoire de vie 2003</em> fournies avec l’extension <code class="pkg">questionr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">data</span>(<span class="st">"hdv2003"</span>)
d &lt;-<span class="st"> </span>hdv2003</code></pre></div>
<div id="statistique-univariee_variable-quantitative" class="section level2">
<h2>Variable quantitative</h2>
<div id="statistique-univariee_principaux-indicateurs" class="section level3">
<h3>Principaux indicateurs</h3>
<p>Comme la fonction <code data-pkg="utils">str</code> nous l’a indiqué, notre tableau <code>d</code> contient plusieurs <dfn data-index="variable numérique">variables numériques</dfn><dfn data-index="numérique, variable"></dfn> ou <dfn data-index="variable quantitative">variables quantitatives</dfn><dfn data-index="quantitative, variable"></dfn>, dont la variable <em>heures.tv</em> qui représente le nombre moyen passé par les enquêtés à regarder la télévision quotidiennement. On peut essayer de déterminer quelques caractéristiques de cette variable, en utilisant les fonctions <code data-pkg="base">mean</code> (<dfn>moyenne</dfn>), <code data-pkg="stats">sd</code> (<dfn>écart-type</dfn>), <code data-pkg="base" data-rdoc="Extremes">min</code> (<dfn>minimum</dfn>), <code data-pkg="base" data-rdoc="Extremes">max</code> (<dfn>maximum</dfn>) et <code data-pkg="base">range</code> (<dfn>étendue</dfn>) :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(d<span class="op">$</span>heures.tv)</code></pre></div>
<pre><code>[1] NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(d<span class="op">$</span>heures.tv, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>[1] 2.246566</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(d<span class="op">$</span>heures.tv, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>[1] 1.775853</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">min</span>(d<span class="op">$</span>heures.tv, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>[1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">max</span>(d<span class="op">$</span>heures.tv, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>[1] 12</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">range</span>(d<span class="op">$</span>heures.tv, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>[1]  0 12</code></pre>
<p>On peut lui ajouter la fonction <code data-pkg="stats">median</code> qui donne la valeur <dfn>médiane</dfn>, <code data-pkg="stats">quantile</code> qui calcule plus généralement tout type de <dfn data-index="quantile">quantiles</dfn>, et le très utile <code data-pkg="base">summary</code> qui donne toutes ces informations ou presque en une seule fois, avec en prime le nombre de <dfn data-index="valeur manquante">valeurs manquantes</dfn> (<code>NA</code>) :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">median</span>(d<span class="op">$</span>heures.tv, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>[1] 2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quantile</span>(d<span class="op">$</span>heures.tv, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>  0%  25%  50%  75% 100% 
   0    1    2    3   12 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(d<span class="op">$</span>heures.tv)</code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.000   1.000   2.000   2.247   3.000  12.000 
   NA's 
      5 </code></pre>
<p>La fonction <code data-pkg="base">summary</code> est une fonction générique qui peut être utilisée sur tout type d’objet, y compris un tableau de données. Essayez donc <code>summary(d)</code>.</p>
</div>
<div id="statistique-univariee_histogramme" class="section level3">
<h3>Histogramme</h3>
<p>Tout cela est bien pratique, mais pour pouvoir observer la <dfn>distribution</dfn> des valeurs d’une variable quantitative, il n’y a quand même rien de mieux qu’un bon graphique.</p>
<p>On peut commencer par un <dfn>histogramme</dfn> de la répartition des valeurs. Celui-ci peut être généré très facilement avec la fonction <code data-pkg="graphics">hist</code> :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(d<span class="op">$</span>heures.tv, <span class="dt">main =</span> <span class="st">"Nombre d'heures passées devant la télé par jour"</span>, 
  <span class="dt">xlab =</span> <span class="st">"Heures"</span>, <span class="dt">ylab =</span> <span class="st">"Effectif"</span>)</code></pre></div>
<img src="graphs/statistique-univariee/unnamed-chunk-4-1.png" width="1050"><figcaption>
Exemple d’histogramme
</figcaption></figure><p>Sous <strong>RStudio</strong>, les graphiques s’affichent dans l’onglet <em>Plots</em> du quadrant inférieur droit. Il est possible d’afficher une version plus grande de votre graphique en cliquant sur <em>Zoom</em>.</p>
<p>Ici, les options <code>main</code>, <code>xlab</code> et <code>ylab</code> permettent de personnaliser le titre du graphique, ainsi que les étiquettes des axes. De nombreuses autres options existent pour personnaliser l’histogramme, parmi celles-ci on notera :</p>
<ul>
<li>
<code>probability</code> si elle vaut <code>TRUE</code>, l’histogramme indique la proportion des <dfn data-index="classe de valeurs">classes de valeurs</dfn> au lieu des effectifs.</li>
<li>
<code>breaks</code> permet de contrôler les classes de valeurs. On peut lui passer un chiffre, qui indiquera alors le nombre de classes, un vecteur, qui indique alors les limites des différentes classes, ou encore une chaîne de caractère ou une fonction indiquant comment les classes doivent être calculées.</li>
<li>
<code>col</code> la couleur de l’histogramme<a href="#statistique-univariee_fn1" class="footnoteRef" id="statistique-univariee_fnref1"><sup>1</sup></a>.</li>
</ul>
<p>Voir la page d’aide de la fonction <code data-pkg="graphics">hist</code> pour plus de détails sur les différentes options. Les deux figures ci-après sont deux autres exemples d’histogramme.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(d<span class="op">$</span>heures.tv, <span class="dt">main =</span> <span class="st">"Heures de télé en 7 classes"</span>, 
  <span class="dt">breaks =</span> <span class="dv">7</span>, <span class="dt">xlab =</span> <span class="st">"Heures"</span>, <span class="dt">ylab =</span> <span class="st">"Proportion"</span>, 
  <span class="dt">probability =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">"orange"</span>)</code></pre></div>
<img src="graphs/statistique-univariee/unnamed-chunk-5-1.png" width="1050"><figcaption>
Un autre exemple d’histogramme
</figcaption></figure><figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(d<span class="op">$</span>heures.tv, <span class="dt">main =</span> <span class="st">"Heures de télé avec classes spécifiées"</span>, 
  <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">12</span>), <span class="dt">xlab =</span> <span class="st">"Heures"</span>, <span class="dt">ylab =</span> <span class="st">"Proportion"</span>, 
  <span class="dt">col =</span> <span class="st">"red"</span>)</code></pre></div>
<img src="graphs/statistique-univariee/unnamed-chunk-6-1.png" width="1050"><figcaption>
Encore un autre exemple d’histogramme
</figcaption></figure>
</div>
<div id="statistique-univariee_densite-et-repartition-cumulee" class="section level3">
<h3>Densité et répartition cumulée</h3>
<p>La fonction <code data-pkg="stats">density</code> permet d’obtenir une <dfn>estimation par noyau</dfn><dfn data-index="noyau, estimation"></dfn><a href="#statistique-univariee_fn2" class="footnoteRef" id="statistique-univariee_fnref2"><sup>2</sup></a> de la distribution du nombre d’heures consacrées à regarder la télévision. Le paramètre <code>na.rm = TRUE</code> indique que l’on souhaite retirer les valeurs manquantes avant de calculer cette courbe de densité.</p>
<p>Le résultat de cette estimation est ensuite représenté graphiquement à l’aide de <code data-pkg="stats" data-rdoc="plot.density">plot</code>. L’argument <code>main</code> permet de spécifier le titre du graphique.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">density</span>(d<span class="op">$</span>heures.tv, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dt">main =</span> <span class="st">"Heures consacrées à la télévision"</span>)</code></pre></div>
<img src="graphs/statistique-univariee/unnamed-chunk-7-1.png" width="1050"><figcaption>
Courbe de densité
</figcaption></figure><p>De manière similaire, on peut calculer la <dfn>fonction de répartition empirique</dfn><dfn data-index="répartition empirique, fonction"></dfn> ou <dfn lang="en">empirical cumulative distribution function</dfn> en anglais avec la fonction <code class="pkg">ecdf</code>. Le résultat obtenu peut, une fois encore, être représenté sur un graphique à l’aide de la fonction <code data-pkg="stats" data-rdoc="ecdf">plot</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">ecdf</span>(d<span class="op">$</span>heures.tv))</code></pre></div>
<img src="graphs/statistique-univariee/unnamed-chunk-8-1.png" width="1050"><figcaption>
Fonction de répartition empirique cumulée
</figcaption></figure>
</div>
<div id="statistique-univariee_boites-a-moustaches" class="section level3">
<h3>Boîtes à moustaches</h3>
<p>Les <dfn data-index="boîte à moustaches">boîtes à moustaches</dfn><dfn data-index="moustaches, boîte"></dfn>, ou <dfn data-index="boxplot" lang="en">boxplots</dfn> en anglais, sont une autre représentation graphique de la répartition des valeurs d’une variable quantitative. Elles sont particulièrement utiles pour comparer les distributions de plusieurs variables ou d’une même variable entre différents groupes, mais peuvent aussi être utilisées pour représenter la dispersion d’une unique variable. La fonction qui produit ces graphiques est la fonction <code data-pkg="graphics">boxplot</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(d<span class="op">$</span>heures.tv, <span class="dt">main =</span> <span class="st">"Nombre d'heures passées devant la télé par jour"</span>, 
  <span class="dt">ylab =</span> <span class="st">"Heures"</span>)</code></pre></div>
<img src="graphs/statistique-univariee/unnamed-chunk-9-1.png" width="1050"><figcaption>
Exemple de boîte à moustaches
</figcaption></figure><p>Comment interpréter ce graphique ? On le comprendra mieux à partir de la figure ci-après<a href="#statistique-univariee_fn3" class="footnoteRef" id="statistique-univariee_fnref3"><sup>3</sup></a>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(d<span class="op">$</span>heures.tv, <span class="dt">col =</span> <span class="kw">grey</span>(<span class="fl">0.8</span>), <span class="dt">main =</span> <span class="st">"Nombre d'heures passées devant la télé par jour"</span>, 
  <span class="dt">ylab =</span> <span class="st">"Heures"</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">median</span>(d<span class="op">$</span>heures.tv, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dt">col =</span> <span class="st">"navy"</span>, 
  <span class="dt">lty =</span> <span class="dv">2</span>)
<span class="kw">text</span>(<span class="fl">1.35</span>, <span class="kw">median</span>(d<span class="op">$</span>heures.tv, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.15</span>, 
  <span class="st">"Médiane"</span>, <span class="dt">col =</span> <span class="st">"navy"</span>)
Q1 &lt;-<span class="st"> </span><span class="kw">quantile</span>(d<span class="op">$</span>heures.tv, <span class="dt">probs =</span> <span class="fl">0.25</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> Q1, <span class="dt">col =</span> <span class="st">"darkred"</span>)
<span class="kw">text</span>(<span class="fl">1.35</span>, Q1 <span class="op">+</span><span class="st"> </span><span class="fl">0.15</span>, <span class="st">"Q1 : premier quartile"</span>, <span class="dt">col =</span> <span class="st">"darkred"</span>, 
  <span class="dt">lty =</span> <span class="dv">2</span>)
Q3 &lt;-<span class="st"> </span><span class="kw">quantile</span>(d<span class="op">$</span>heures.tv, <span class="dt">probs =</span> <span class="fl">0.75</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> Q3, <span class="dt">col =</span> <span class="st">"darkred"</span>)
<span class="kw">text</span>(<span class="fl">1.35</span>, Q3 <span class="op">+</span><span class="st"> </span><span class="fl">0.15</span>, <span class="st">"Q3 : troisième quartile"</span>, <span class="dt">col =</span> <span class="st">"darkred"</span>, 
  <span class="dt">lty =</span> <span class="dv">2</span>)
<span class="kw">arrows</span>(<span class="dt">x0 =</span> <span class="fl">0.7</span>, <span class="dt">y0 =</span> <span class="kw">quantile</span>(d<span class="op">$</span>heures.tv, <span class="dt">probs =</span> <span class="fl">0.75</span>, 
  <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dt">x1 =</span> <span class="fl">0.7</span>, <span class="dt">y1 =</span> <span class="kw">quantile</span>(d<span class="op">$</span>heures.tv, 
  <span class="dt">probs =</span> <span class="fl">0.25</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dt">length =</span> <span class="fl">0.1</span>, <span class="dt">code =</span> <span class="dv">3</span>)
<span class="kw">text</span>(<span class="fl">0.7</span>, Q1 <span class="op">+</span><span class="st"> </span>(Q3 <span class="op">-</span><span class="st"> </span>Q1)<span class="op">/</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.15</span>, <span class="st">"h"</span>, <span class="dt">pos =</span> <span class="dv">2</span>)
<span class="kw">mtext</span>(<span class="st">"L'écart inter-quartile h contient 50 % des individus"</span>, 
  <span class="dt">side =</span> <span class="dv">1</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> Q1 <span class="op">-</span><span class="st"> </span><span class="fl">1.5</span> <span class="op">*</span><span class="st"> </span>(Q3 <span class="op">-</span><span class="st"> </span>Q1), <span class="dt">col =</span> <span class="st">"darkgreen"</span>)
<span class="kw">text</span>(<span class="fl">1.35</span>, Q1 <span class="op">-</span><span class="st"> </span><span class="fl">1.5</span> <span class="op">*</span><span class="st"> </span>(Q3 <span class="op">-</span><span class="st"> </span>Q1) <span class="op">+</span><span class="st"> </span><span class="fl">0.15</span>, <span class="st">"Q1 -1.5 h"</span>, 
  <span class="dt">col =</span> <span class="st">"darkgreen"</span>, <span class="dt">lty =</span> <span class="dv">2</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> Q3 <span class="op">+</span><span class="st"> </span><span class="fl">1.5</span> <span class="op">*</span><span class="st"> </span>(Q3 <span class="op">-</span><span class="st"> </span>Q1), <span class="dt">col =</span> <span class="st">"darkgreen"</span>)
<span class="kw">text</span>(<span class="fl">1.35</span>, Q3 <span class="op">+</span><span class="st"> </span><span class="fl">1.5</span> <span class="op">*</span><span class="st"> </span>(Q3 <span class="op">-</span><span class="st"> </span>Q1) <span class="op">+</span><span class="st"> </span><span class="fl">0.15</span>, <span class="st">"Q3 +1.5 h"</span>, 
  <span class="dt">col =</span> <span class="st">"darkgreen"</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</code></pre></div>
<img src="graphs/statistique-univariee/unnamed-chunk-10-1.png" width="1050"><figcaption>
Interprétation d’une boîte à moustaches
</figcaption></figure><p>Le carré au centre du graphique est délimité par les premiers et troisième <dfn data-index="quartile">quartiles</dfn>, avec la <dfn>médiane</dfn> représentée par une ligne plus sombre au milieu. Les « fourchettes » s’étendant de part et d’autres vont soit jusqu’à la valeur minimale ou maximale, soit jusqu’à une valeur approximativement égale au quartile le plus proche plus 1,5 fois l’<dfn>écart interquartile</dfn><dfn data-index="interquartilen écart"></dfn>. Les points se situant en-dehors de cette fourchette sont représentés par des petits ronds et sont généralement considérés comme des valeurs extrêmes, potentiellement aberrantes.</p>
<p>On peut ajouter la représentation des valeurs sur le graphique pour en faciliter la lecture avec des petits traits dessinés sur l’axe vertical (fonction <code data-pkg="graphics">rug</code>) :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(d<span class="op">$</span>heures.tv, <span class="dt">main =</span> <span class="st">"Nombre d'heures passées devant la télé par</span><span class="ch">\n</span><span class="st">jour"</span>, 
  <span class="dt">ylab =</span> <span class="st">"Heures"</span>)
<span class="kw">rug</span>(d<span class="op">$</span>heures.tv, <span class="dt">side =</span> <span class="dv">2</span>)</code></pre></div>
<img src="graphs/statistique-univariee/unnamed-chunk-11-1.png" width="1050"><figcaption>
Boîte à moustaches avec représentation des valeurs
</figcaption></figure>
</div>
</div>
<div id="statistique-univariee_variable-qualitative" class="section level2">
<h2>Variable qualitative</h2>
<div id="statistique-univariee_tris-a-plat" class="section level3">
<h3>Tris à plat</h3>
<p>La fonction la plus utilisée pour le traitement et l’analyse des <dfn data-index="variable qualitative">variables qualitatives</dfn><dfn data-index="qualitative, variable"></dfn> (variable prenant ses valeurs dans un ensemble de <dfn data-index="modalité">modalités</dfn>) est sans aucun doute la fonction <code data-pkg="base">table</code>, qui donne les effectifs de chaque modalité de la variable, ce qu’on appelle un <dfn>tri à plat</dfn> ou <dfn>tableau de fréquences</dfn><dfn data-index="fréquence, tableau"></dfn>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(d<span class="op">$</span>sexe)</code></pre></div>
<pre><code>
Homme Femme 
  899  1101 </code></pre>
<p>La tableau précédent nous indique que parmi nos enquêtés on trouve 899 hommes et 1101 femmes.</p>
<p>Quand le nombre de modalités est élevé, on peut ordonner le tri à plat selon les effectifs à l’aide de la fonction <code data-pkg="base">sort</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(d<span class="op">$</span>occup)</code></pre></div>
<pre><code>
Exerce une profession               Chomeur 
                 1049                   134 
      Etudiant, eleve              Retraite 
                   94                   392 
  Retire des affaires              Au foyer 
                   77                   171 
        Autre inactif 
                   83 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sort</span>(<span class="kw">table</span>(d<span class="op">$</span>occup))</code></pre></div>
<pre><code>
  Retire des affaires         Autre inactif 
                   77                    83 
      Etudiant, eleve               Chomeur 
                   94                   134 
             Au foyer              Retraite 
                  171                   392 
Exerce une profession 
                 1049 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sort</span>(<span class="kw">table</span>(d<span class="op">$</span>occup), <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>
Exerce une profession              Retraite 
                 1049                   392 
             Au foyer               Chomeur 
                  171                   134 
      Etudiant, eleve         Autre inactif 
                   94                    83 
  Retire des affaires 
                   77 </code></pre>
<p>À noter que la fonction <code data-pkg="base">table</code> exclut par défaut les non-réponses du tableau résultat. L’argument <code>useNA</code> de cette fonction permet de modifier ce comportement :</p>
<ul>
<li>avec <code>useNA="no"</code> (valeur par défaut), les valeurs manquantes ne sont jamais incluses dans le tri à plat ;</li>
<li>avec <code>useNA="ifany"</code>, une colonne <code>NA</code> est ajoutée si des valeurs manquantes sont présentes dans les données ;</li>
<li>avec <code>useNA="always"</code>, une colonne <code>NA</code> est toujours ajoutée, même s’il n’y a pas de valeurs manquantes dans les données.</li>
</ul>
<p>On peut donc utiliser :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(d<span class="op">$</span>trav.satisf, <span class="dt">useNA =</span> <span class="st">"ifany"</span>)</code></pre></div>
<pre><code>
  Satisfaction Insatisfaction      Equilibre 
           480            117            451 
          &lt;NA&gt; 
           952 </code></pre>
<p>L’utilisation de <code data-pkg="base">summary</code> permet également l’affichage du tri à plat et du nombre de non-réponses :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(d<span class="op">$</span>trav.satisf)</code></pre></div>
<pre><code>  Satisfaction Insatisfaction      Equilibre 
           480            117            451 
          NA's 
           952 </code></pre>
<p>Pour obtenir un tableau avec la répartition en pourcentages, on peut utiliser la fonction <code data-pkg="questionr">freq</code> de l’extension <code class="pkg">questionr</code><a href="#statistique-univariee_fn4" class="footnoteRef" id="statistique-univariee_fnref4"><sup>4</sup></a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">freq</span>(d<span class="op">$</span>qualif)</code></pre></div>
<pre><code>                           n    % val%
Ouvrier specialise       203 10.2 12.3
Ouvrier qualifie         292 14.6 17.7
Technicien                86  4.3  5.2
Profession intermediaire 160  8.0  9.7
Cadre                    260 13.0 15.7
Employe                  594 29.7 35.9
Autre                     58  2.9  3.5
NA                       347 17.3   NA</code></pre>
<p>La colonne <code>n</code> donne les effectifs bruts, la colonne <code>%</code> la répartition en pourcentages et <code>val%</code> la répartition en pourcentages, données manquantes exclues. La fonction accepte plusieurs paramètres permettant d’afficher les totaux, les pourcentages cumulés, de trier selon les effectifs ou de contrôler l’affichage. Par exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">freq</span>(d<span class="op">$</span>qualif, <span class="dt">cum =</span> <span class="ot">TRUE</span>, <span class="dt">total =</span> <span class="ot">TRUE</span>, <span class="dt">sort =</span> <span class="st">"inc"</span>, 
  <span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">exclude =</span> <span class="ot">NA</span>)</code></pre></div>
<pre><code>Warning in table(labelled::to_factor(x, levels),
exclude = exclude, useNA = "ifany"): 'exclude'
containing NA and 'useNA' != "no"' are a bit
contradicting</code></pre>
<pre><code>                            n      %   %cum
Autre                      58   3.51   3.51
Technicien                 86   5.20   8.71
Profession intermediaire  160   9.68  18.39
Ouvrier specialise        203  12.28  30.67
Cadre                     260  15.73  46.40
Ouvrier qualifie          292  17.66  64.07
Employe                   594  35.93 100.00
Total                    1653 100.00 100.00</code></pre>
<p>La colonne <code>%cum</code> indique ici le pourcentage cumulé, ce qui est ici une très mauvaise idée puisque pour ce type de variable cela n’a aucun sens. Les lignes du tableau résultat ont été triés par effectifs croissants, les totaux ont été ajoutés, les non-réponses exclues et les pourcentages arrondis à deux décimales.</p>
<p>La fonction <code data-pkg="questionr">freq</code> est également en mesure de tenir compte des étiquettes de valeurs lorsqu’on utilise des <a href="#facteurs-et-vecteurs-labellises">données labellisées</a>. Ainsi :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(fecondite)
<span class="kw">describe</span>(femmes<span class="op">$</span>region)</code></pre></div>
<pre><code>Warning in table(labelled::to_factor(x, levels),
exclude = exclude, useNA = "ifany"): 'exclude'
containing NA and 'useNA' != "no"' are a bit
contradicting</code></pre>
<pre><code>[2000 obs.] Région de résidence
labelled double: 4 4 4 4 4 3 3 3 3 3 ...
min: 1 - max: 4 - NAs: 0 (0%) - 4 unique values
4 value labels: [1] Nord [2] Est [3] Sud [4] Ouest

             n     %
[1] Nord   707  35.4
[2] Est    324  16.2
[3] Sud    407  20.3
[4] Ouest  562  28.1
Total     2000 100.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">freq</span>(femmes<span class="op">$</span>region)</code></pre></div>
<pre><code>            n    % val%
[1] Nord  707 35.4 35.4
[2] Est   324 16.2 16.2
[3] Sud   407 20.3 20.3
[4] Ouest 562 28.1 28.1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">freq</span>(femmes<span class="op">$</span>region, <span class="dt">levels =</span> <span class="st">"labels"</span>)</code></pre></div>
<pre><code>        n    % val%
Nord  707 35.4 35.4
Est   324 16.2 16.2
Sud   407 20.3 20.3
Ouest 562 28.1 28.1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">freq</span>(femmes<span class="op">$</span>region, <span class="dt">levels =</span> <span class="st">"values"</span>)</code></pre></div>
<pre><code>    n    % val%
1 707 35.4 35.4
2 324 16.2 16.2
3 407 20.3 20.3
4 562 28.1 28.1</code></pre>
<p>Pour plus d’informations sur la fonction <code data-pkg="questionr">freq</code>, consultez sa page d’aide en ligne avec <code>?freq</code> ou <code>help("freq")</code>.</p>
</div>
<div id="statistique-univariee_representation-graphique" class="section level3">
<h3>Représentation graphique</h3>
<p>Pour représenter la répartition des effectifs parmi les modalités d’une variable qualitative, on a souvent tendance à utiliser des <dfn data-index="diagramme en secteur">diagrammes en secteurs</dfn><dfn data-index="secteur, diagramme"></dfn> (<dfn data-index="camembert, graphique">camemberts</dfn>). Ceci est possible sous <strong>R</strong> avec la fonction <code data-pkg="graphics">pie</code>, mais la page d’aide de la dite fonction nous le déconseille assez vivement : les diagrammes en secteur sont en effet une mauvaise manière de présenter ce type d’information, car l’oeil humain préfère comparer des longueurs plutôt que des surfaces<a href="#statistique-univariee_fn5" class="footnoteRef" id="statistique-univariee_fnref5"><sup>5</sup></a>.</p>
<p>On privilégiera donc d’autres formes de représentations, à savoir les <dfn data-index="diagramme en bâtons">diagrammes en bâtons</dfn><dfn data-index="bâton, diagramme"></dfn> et les <dfn data-index="diagramme de Cleveland">diagrammes de Cleveland</dfn><dfn data-index="Cleveland, diagramme"></dfn>.</p>
<p>Les diagrammes en bâtons sont utilisés automatiquement par <strong>R</strong> lorsqu’on applique la fonction générique <code data-pkg="graphics" data-rdoc="plot.table">plot</code> à un tri à plat obtenu avec <code data-pkg="base">table</code>. On privilégiera cependant ce type de représentations pour les variables de type numérique comportant un nombre fini de valeurs. Le nombre de frères, soeurs, demi-frères et demi-soeurs est un bon exemple :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">table</span>(d<span class="op">$</span>freres.soeurs), <span class="dt">main =</span> <span class="st">"Nombre de frères, soeurs, demi-frères et demi-soeurs"</span>, 
  <span class="dt">ylab =</span> <span class="st">"Effectif"</span>)</code></pre></div>
<img src="graphs/statistique-univariee/unnamed-chunk-19-1.png" width="1050"><figcaption>
Exemple de diagramme en bâtons
</figcaption></figure><p>Pour les autres types de variables qualitatives, on privilégiera les diagrammes de Cleveland, obtenus avec la fonction <code data-pkg="graphics">dotchart</code>. On doit appliquer cette fonction au tri à plat de la variable, obtenu avec <code data-pkg="base">table</code><a href="#statistique-univariee_fn6" class="footnoteRef" id="statistique-univariee_fnref6"><sup>6</sup></a> :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dotchart</span>(<span class="kw">as.matrix</span>(<span class="kw">table</span>(d<span class="op">$</span>clso))[, <span class="dv">1</span>], <span class="dt">main =</span> <span class="st">"Sentiment d'appartenance à une classe sociale"</span>, 
  <span class="dt">pch =</span> <span class="dv">19</span>)</code></pre></div>
<img src="graphs/statistique-univariee/unnamed-chunk-20-1.png" width="1050"><figcaption>
Exemple de diagramme de Cleveland
</figcaption></figure><div class="note">
<p>Il est possible d’entrer directement la commande suivante dans la console :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dotchart</span>(<span class="kw">table</span>(d<span class="op">$</span>clso))</code></pre></div>
<p><strong>R</strong> produira bien le diagramme de Cleveland désiré mais affichera un message d’avertissement (<em>Warning</em>) car pour des raisons liées au fonctionnement interne de la fonction <code data-pkg="graphics">dotchart</code>, il est attendu une matrice ou un vecteur, non un objet de type table. Pour éviter cet avertissement, il est nécessaire de faire appel à la fonction <code data-pkg="base" data-rdoc="matrix">as.matrix</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dotchart</span>(<span class="kw">as.matrix</span>(<span class="kw">table</span>(d<span class="op">$</span>clso)))</code></pre></div>
<p><img src="graphs/statistique-univariee/unnamed-chunk-22-1.png" width="1050"></p>
<p>Dans le cas présent, on voit apparaître un chiffre 1 au-dessus des modalités. En fait, <code data-pkg="graphics">dotchart</code> peut être appliqué au résultat d’un tableau croisé à deux entrées, auquel cas il présentera les résultats pour chaque colonne. Comme dans l’exemple ci-après.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dotchart</span>(<span class="kw">as.matrix</span>(<span class="kw">table</span>(d<span class="op">$</span>clso, d<span class="op">$</span>sexe)))</code></pre></div>
<p><img src="graphs/statistique-univariee/unnamed-chunk-23-1.png" width="1050"></p>
<p>Cela ne résoud pas le problème pour notre diagramme de Cleveland issu d’un tri à plat simple. Pour bien comprendre, la fonction <code data-pkg="base" data-rdoc="matrix">as.matrix</code> a produit un objet à deux dimensions ayant une colonne et plusieurs lignes. On indiquera à <strong>R</strong> que l’on ne souhaite extraire la première colonne avec <code>[, 1]</code> (juste après l’appel à <code data-pkg="base" data-rdoc="matrix">as.matrix</code>). C’est ce qu’on appelle l’<em>indexation</em>, abordée plus en détail dans le chapitre <a href="#listes-et-tableaux-de-donnes">Listes et tableaux de données</a>.</p>
</div>
<p>Quand la variable comprend un grand nombre de modalités, il est préférable d’<dfn>ordonner le tri à plat</dfn><dfn data-index="tri à plat, ordonner"></dfn> obtenu à l’aide de la fonction <code data-pkg="base">sort</code> :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dotchart</span>(<span class="kw">as.matrix</span>(<span class="kw">sort</span>(<span class="kw">table</span>(d<span class="op">$</span>qualif)))[, <span class="dv">1</span>], <span class="dt">main =</span> <span class="st">"Niveau de qualification"</span>)</code></pre></div>
<img src="graphs/statistique-univariee/unnamed-chunk-24-1.png" width="1050"><figcaption>
Exemple de diagramme de Cleveland ordonné
</figcaption></figure><div class="note">
<p>L’agument <code>pch</code>, qui est utilisé par la plupart des graphiques de type points, permet de spécifier le symbole à utiliser. Il peut prendre soit un nombre entier compris entre 0 et 25, soit un charactère textuel (voir ci-dessous).</p>
<p><img src="graphs/statistique-univariee/unnamed-chunk-25-1.png" width="1050"></p>
</div>
</div>
</div>
<div id="statistique-univariee_exporter-les-graphiques-obtenus" class="section level2">
<h2>Exporter les graphiques obtenus</h2>
<p>L’<dfn>export de graphiques</dfn><dfn data-index="graphique, export"></dfn> est très facile avec <strong>RStudio</strong>. Lorsque l’on créé un graphique, ce dernier est affiché sous l’onglet <em>Plots</em> dans le quadrant inférieur droit. Il suffit de cliquer sur <em>Export</em> pour avoir accès à trois options différentes :</p>
<ul>
<li>
<em>Save as image</em> pour sauvegarder le graphique en tant que fichier image ;</li>
<li>
<em>Save as PDF</em> pour sauvegarder le graphique dans un fichier <strong>PDF</strong> ;</li>
<li>
<em>Copy to Clipboard</em> pour copier le graphique dans le presse-papier (et pouvoir ainsi le coller ensuite dans un document <strong>Word</strong> par exemple).</li>
</ul>
<p>Pour une présentation détaillée de l’export de graphiques avec <strong>RStudio</strong>, ainsi que pour connaître les commandes <strong>R</strong> permettant d’exporter des graphiques via un script, on pourra se référer au <a href="#export-de-graphiques">chapitre dédié</a>.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="statistique-univariee_fn1"><p>Il existe un grand nombre de couleurs prédéfinies dans <strong>R</strong>. On peut récupérer leur liste en utilisant la fonction <code data-pkg="grDevices">colors</code> en tapant simplement <code>colors()</code> dans la console, ou en consultant le document suivant : <a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf" class="uri">http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf</a>.<a href="#statistique-univariee_fnref1"><U+21A9></a></p></li>
<li id="statistique-univariee_fn2"><p>Voir <a href="https://fr.wikipedia.org/wiki/Estimation_par_noyau" class="uri">https://fr.wikipedia.org/wiki/Estimation_par_noyau</a><a href="#statistique-univariee_fnref2"><U+21A9></a></p></li>
<li id="statistique-univariee_fn3"><p>Le code ayant servi à générer cette figure est une copie quasi conforme de celui présenté dans l’excellent document de Jean Lobry sur les graphiques de base avec <strong>R</strong>, téléchargeable sur le site du Pôle bioinformatique lyonnais : <a href="http://pbil.univ-lyon1.fr/R/pdf/lang04.pdf" class="uri">http://pbil.univ-lyon1.fr/R/pdf/lang04.pdf</a>.<a href="#statistique-univariee_fnref3"><U+21A9></a></p></li>
<li id="statistique-univariee_fn4"><p>En l’absence de l’extension <code class="pkg">questionr</code>, on pourra se rabattre sur la fonction <code data-pkg="base">prop.table</code> avec la commande suivante : <code>prop.table(table(d$qualif))</code>.<a href="#statistique-univariee_fnref4"><U+21A9></a></p></li>
<li id="statistique-univariee_fn5"><p>On trouvera des exemples illustrant cette idée dans le document de Jean Lobry cité précédemment.<a href="#statistique-univariee_fnref5"><U+21A9></a></p></li>
<li id="statistique-univariee_fn6"><p>Pour des raisons liées au fonctionnement interne de la fonction <code data-pkg="graphics">dotchart</code>, on doit transformer le tri à plat en matrice, d’où l’appel à la fonction <code data-pkg="base" data-rdoc="matrix">as.matrix</code>.<a href="#statistique-univariee_fnref6"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="statistique-bivariee"><div class="fluid-row" id="statistique-bivariee_header">



<h1 class="title toc-ignore">Statistique bivariée</h1>

</div>

<div class="TOC">
<ul>
<li>
<a href="#statistique-bivariee_deux-variables-quantitatives">Deux variables quantitatives</a><ul>
<li><a href="#statistique-bivariee_trois-variables-ou-plus">Trois variables ou plus</a></li>
</ul>
</li>
<li>
<a href="#statistique-bivariee_une-variable-quantitative-et-une-variable-qualitative">Une variable quantitative et une variable qualitative</a><ul>
<li><a href="#statistique-bivariee_representations-graphiques">Représentations graphiques</a></li>
</ul>
</li>
<li>
<a href="#statistique-bivariee_deux-variables-qualitatives">Deux variables qualitatives</a><ul>
<li><a href="#statistique-bivariee_tableau-croise">Tableau croisé</a></li>
<li><a href="#statistique-bivariee_pourcentages-en-ligne-et-en-colonne">Pourcentages en ligne et en colonne</a></li>
<li><a href="#statistique-bivariee_representation-graphique">Représentation graphique</a></li>
</ul>
</li>
</ul>
</div>

<div class="note">
<p>La version originale de ce chapitre a été écrite par Julien Barnier dans le cadre du support de cours <a href="https://github.com/juba/intro-r">Introduction à R</a>.</p>
</div>
<p>On entend par <dfn>statistique bivariée</dfn> l’étude des relations entre deux variables, celles-ci pouvant être <dfn data-index="variable quantitative">quantitatives</dfn><dfn data-index="quantitative, variable"></dfn> ou <dfn data-index="variable qualitative">qualitatives</dfn><dfn data-index="qualitative, variable"></dfn>. La statistique bivariée fait partie de la <dfn>statistique descriptive</dfn><dfn data-index="descriptive, statistique"></dfn>.</p>
<p>La statistique univariée a quant à elle déjà été abordée dans un <a href="#statistique-univariee">chapitre dédié</a>.</p>
<p>Comme dans la partie précédente, on travaillera sur les jeux de données fournis avec l’extension <code class="pkg">questionr</code> et tiré de l’enquête <em>Histoire de vie</em> et du recensement 1999 :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">data</span>(hdv2003)
d &lt;-<span class="st"> </span>hdv2003
<span class="kw">data</span>(rp99)</code></pre></div>
<div id="statistique-bivariee_deux-variables-quantitatives" class="section level2">
<h2>Deux variables quantitatives</h2>
<p>La comparaison de deux variables quantitatives se fait en premier lieu graphiquement, en représentant l’ensemble des couples de valeurs. On peut ainsi représenter les valeurs du nombre d’heures passées devant la télévision selon l’âge.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(d<span class="op">$</span>age, d<span class="op">$</span>heures.tv)</code></pre></div>
<img src="graphs/statistique-bivariee/unnamed-chunk-2-1.png" width="1050"><figcaption>
Nombre d’heures de télévision selon l’âge
</figcaption></figure><p>Le fait que des points sont superposés ne facilite pas la lecture du graphique. On peut utiliser une représentation avec des points semi-transparents.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(d<span class="op">$</span>age, d<span class="op">$</span>heures.tv, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, 
  <span class="dv">0</span>, <span class="fl">0.1</span>))</code></pre></div>
<img src="graphs/statistique-bivariee/unnamed-chunk-3-1.png" width="1050"><figcaption>
Nombre d’heures de télévision selon l’âge avec semi-transparence
</figcaption></figure><p>Plus sophistiqué, on peut faire une <dfn>estimation locale de densité</dfn><dfn data-index="densité, estimation locale"></dfn> et représenter le résultat sous forme de « carte ». Pour cela on commence par isoler les deux variables, supprimer les observations ayant au moins une <dfn>valeur manquante</dfn><dfn data-index="manquante, valeur"></dfn> à l’aide de la fonction <code data-pkg="stats">complete.cases</code>, estimer la densité locale à l’aide de la fonction <code data-pkg="MASS">kde2d</code> de l’extension <code class="pkg">MASS</code><a href="#statistique-bivariee_fn1" class="footnoteRef" id="statistique-bivariee_fnref1"><sup>1</sup></a> et représenter le tout à l’aide d’une des fonctions <code data-pkg="graphics">image</code>, <code data-pkg="graphics">contour</code> ou <code data-pkg="graphics">filled.contour</code>…</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)
tmp &lt;-<span class="st"> </span>d[, <span class="kw">c</span>(<span class="st">"age"</span>, <span class="st">"heures.tv"</span>)]
tmp &lt;-<span class="st"> </span>tmp[<span class="kw">complete.cases</span>(tmp), ]
<span class="kw">filled.contour</span>(<span class="kw">kde2d</span>(tmp<span class="op">$</span>age, tmp<span class="op">$</span>heures.tv), <span class="dt">color =</span> terrain.colors)</code></pre></div>
<img src="graphs/statistique-bivariee/unnamed-chunk-4-1.png" width="1050"><figcaption>
Représentation de l’estimation de densité locale
</figcaption></figure><p>Une représentation alternative de la densité locale peut être obtenue avec la fonction <code data-pkg="graphics">smoothScatter</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">smoothScatter</span>(d[, <span class="kw">c</span>(<span class="st">"age"</span>, <span class="st">"heures.tv"</span>)])</code></pre></div>
<img src="graphs/statistique-bivariee/unnamed-chunk-5-1.png" width="1050"><figcaption>
Représentation alternative de l’estimation de densité locale
</figcaption></figure><p>Dans tous les cas, il n’y a pas de structure très nette qui semble se dégager. On peut tester ceci mathématiquement en calculant le <dfn>coefficient de corrélation</dfn><dfn data-index="corrélation, coefficient"></dfn> entre les deux variables à l’aide de la fonction <code data-pkg="stats">cor</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(d<span class="op">$</span>age, d<span class="op">$</span>heures.tv, <span class="dt">use =</span> <span class="st">"complete.obs"</span>)</code></pre></div>
<pre><code>[1] 0.1776249</code></pre>
<p>L’option <code>use</code> permet d’éliminer les observations pour lesquelles l’une des deux valeurs est manquante. Le coefficient de corrélation est très faible.</p>
<p>On va donc s’intéresser plutôt à deux variables présentes dans le jeu de données <code>rp99</code>, la part de diplômés du supérieur et la proportion de cadres dans les communes du Rhône en 1999.</p>
<p>À nouveau, commençons par représenter les deux variables.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(rp99<span class="op">$</span>dipl.sup, rp99<span class="op">$</span>cadres, <span class="dt">ylab =</span> <span class="st">"Part des cadres"</span>, 
  <span class="dt">xlab =</span> <span class="st">"Part des diplomês du supérieur"</span>)</code></pre></div>
<img src="graphs/statistique-bivariee/unnamed-chunk-7-1.png" width="1050"><figcaption>
Proportion de cadres et proportion de diplômés du supérieur
</figcaption></figure><p>Ça ressemble déjà beaucoup plus à une relation de type linéaire.</p>
<p>Calculons le coefficient de corrélation :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(rp99<span class="op">$</span>dipl.sup, rp99<span class="op">$</span>cadres)</code></pre></div>
<pre><code>[1] 0.8975282</code></pre>
<p>C’est beaucoup plus proche de 1. On peut alors effectuer une <dfn>régression linéaire</dfn><dfn data-index="linéaire, régression"></dfn> complète en utilisant la fonction <code data-pkg="stats">lm</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reg &lt;-<span class="st"> </span><span class="kw">lm</span>(cadres <span class="op">~</span><span class="st"> </span>dipl.sup, <span class="dt">data =</span> rp99)
<span class="kw">summary</span>(reg)</code></pre></div>
<pre><code>
Call:
lm(formula = cadres ~ dipl.sup, data = rp99)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.6905 -1.9010 -0.1823  1.4913 17.0866 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  1.24088    0.32988   3.762 0.000203
dipl.sup     1.38352    0.03931  35.196  &lt; 2e-16
               
(Intercept) ***
dipl.sup    ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.281 on 299 degrees of freedom
Multiple R-squared:  0.8056,    Adjusted R-squared:  0.8049 
F-statistic:  1239 on 1 and 299 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Le résultat montre que les coefficients sont significativement différents de 0. La part de cadres augmente donc avec celle de diplômés du supérieur (ô surprise). On peut très facilement représenter la <dfn>droite de régression</dfn><dfn data-index="régression, droite"></dfn> à l’aide de la fonction <code data-pkg="graphics">abline</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(rp99<span class="op">$</span>dipl.sup, rp99<span class="op">$</span>cadres, <span class="dt">ylab =</span> <span class="st">"Part des cadres"</span>, 
  <span class="dt">xlab =</span> <span class="st">"Part des diplômés du supérieur"</span>)
<span class="kw">abline</span>(reg, <span class="dt">col =</span> <span class="st">"red"</span>)</code></pre></div>
<img src="graphs/statistique-bivariee/unnamed-chunk-10-1.png" width="1050"><figcaption>
Régression de la proportion de cadres par celle de diplômés du supérieur
</figcaption></figure><div class="note">
<p>On remarquera que le premier argument passé à la fonction <code data-pkg="stats">lm</code> a une syntaxe un peu particulière. Il s’agit d’une <dfn>formule</dfn>, utilisée de manière générale dans les modèles statistiques. On indique la variable d’intérêt à gauche et la variable explicative à droite, les deux étant séparées par un tilde <code>~</code> (obtenu sous <strong>Windows</strong> en appuyant simultanément sur les touches <kbd>Alt Gr</kbd> et <kbd>2</kbd>). On remarquera que les noms des colonnes de notre tableau de données ont été écrites sans guillemets.</p>
<p>Dans le cas présent, nous avons calculé une régression linéaire simple entre deux variables, d’où l’écriture <code>cadres ~ dipl.sup</code>. Si nous avions voulu expliquer une variable <em>z</em> par deux variables <em>x</em> et <em>y</em>, nous aurions écrit <code>z ~ x + y</code>. Il est possible de spécifier des modèles encore plus complexes.</p>
<p>Pour un aperçu de la syntaxe des formules sous <strong>R</strong>, voir <a href="http://ww2.coastal.edu/kingw/statistics/R-tutorials/formulae.html" class="uri">http://ww2.coastal.edu/kingw/statistics/R-tutorials/formulae.html</a>.</p>
</div>
<div id="statistique-bivariee_trois-variables-ou-plus" class="section level3">
<h3>Trois variables ou plus</h3>
<p>Lorsque l’on souhaite représenter trois variables quantitatives simultanément, il est possible de réaliser un nuage de points représentant les deux premières variables sur l’axe horizontal et l’axe vertical et en faisant varier la taille des points selon la troisième variable, en utilisant l’argument <code>cex</code> de la fonction <code data-pkg="graphics" data-rdoc="plot.default">plot</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(rp99<span class="op">$</span>dipl.aucun, rp99<span class="op">$</span>tx.chom, <span class="dt">cex =</span> rp99<span class="op">$</span>pop.tot<span class="op">/</span><span class="dv">10</span><span class="op">^</span><span class="dv">4</span>)</code></pre></div>
<img src="graphs/statistique-bivariee/unnamed-chunk-11-1.png" width="1050"><figcaption>
Nuage de points avec taille des points proportionnels à une troisième variable
</figcaption></figure><p>Lorsque l’on étudie un plus grand nombres de variables quantitatives, il est peut être utile de réaliser une matrice de nuages de points, qui compare chaque variable deux à deux et qui s’obtient facilement avec la fonction <code data-pkg="graphics">pairs</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairs</span>(rp99[, <span class="kw">c</span>(<span class="st">"proprio"</span>, <span class="st">"hlm"</span>, <span class="st">"locataire"</span>, <span class="st">"maison"</span>)])</code></pre></div>
<img src="graphs/statistique-bivariee/unnamed-chunk-12-1.png" width="1050"><figcaption>
Matrice de nuages de points
</figcaption></figure>
</div>
</div>
<div id="statistique-bivariee_une-variable-quantitative-et-une-variable-qualitative" class="section level2">
<h2>Une variable quantitative et une variable qualitative</h2>
<div id="statistique-bivariee_representations-graphiques" class="section level3">
<h3>Représentations graphiques</h3>
<p>Quand on parle de comparaison entre une variable quantitative et une variable qualitative, on veut en général savoir si la <dfn>distribution</dfn> des valeurs de la variable quantitative est la même selon les modalités de la variable qualitative. En clair : est ce que l’âge de ceux qui écoutent du hard rock est différent de l’âge de ceux qui n’en écoutent pas ?</p>
<p>Là encore, l’idéal est de commencer par une représentation graphique. Les <dfn data-index="boîte à moustache">boîtes à moustaches</dfn><dfn data-index="moustaches, boîte"></dfn> (<dfn lang="en">boxplot</dfn> en anglais) sont parfaitement adaptées pour cela.</p>
<p>Si on a construit des sous-populations d’individus écoutant ou non du hard rock, on peut utiliser la fonction <code data-pkg="graphics">boxplot</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d.hard &lt;-<span class="st"> </span><span class="kw">subset</span>(d, hard.rock <span class="op">==</span><span class="st"> "Oui"</span>)
d.non.hard &lt;-<span class="st"> </span><span class="kw">subset</span>(d, hard.rock <span class="op">==</span><span class="st"> "Non"</span>)
<span class="kw">boxplot</span>(d.hard<span class="op">$</span>age, d.non.hard<span class="op">$</span>age)</code></pre></div>
<img src="graphs/statistique-bivariee/unnamed-chunk-13-1.png" width="1050"><figcaption>
Boxplot de la répartition des âges (sous-populations)
</figcaption></figure><p>Mais construire les sous-populations n’est pas nécessaire. On peut utiliser directement la version de <code data-pkg="graphics">boxplot</code> prenant une formule en argument.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(age <span class="op">~</span><span class="st"> </span>hard.rock, <span class="dt">data =</span> d)</code></pre></div>
<img src="graphs/statistique-bivariee/unnamed-chunk-14-1.png" width="1050"><figcaption>
Boxplot de la répartition des âges (formule)
</figcaption></figure><p>À première vue, ô surprise, la population écoutant du hard rock a l’air sensiblement plus jeune. Peut-on le tester mathématiquement ?</p>
</div>
</div>
<div id="statistique-bivariee_deux-variables-qualitatives" class="section level2">
<h2>Deux variables qualitatives</h2>
<p>La comparaison de deux variables qualitatives s’appelle en général un <dfn>tableau croisé</dfn><dfn data-index="croisé, tableau"></dfn>. C’est sans doute l’une des analyses les plus fréquentes lors du traitement d’enquêtes en sciences sociales.</p>
<div id="statistique-bivariee_tableau-croise" class="section level3">
<h3>Tableau croisé</h3>
<p>La manière la plus simple d’obtenir un tableau croisé est d’utiliser la fonction <code data-pkg="base">table</code> en lui donnant en paramètres les deux variables à croiser. En l’occurrence nous allons croiser un recodage du niveau de qualification regroupé avec le fait de pratiquer un sport.</p>
<p>On commence par calculer la variable recodée et par afficher le tri à plat des deux variables :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>qualreg &lt;-<span class="st"> </span><span class="kw">as.character</span>(d<span class="op">$</span>qualif)
d<span class="op">$</span>qualreg[d<span class="op">$</span>qualif <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"Ouvrier specialise"</span>, <span class="st">"Ouvrier qualifie"</span>)] &lt;-<span class="st"> "Ouvrier"</span>
d<span class="op">$</span>qualreg[d<span class="op">$</span>qualif <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"Profession intermediaire"</span>, 
  <span class="st">"Technicien"</span>)] &lt;-<span class="st"> "Intermediaire"</span>
<span class="kw">table</span>(d<span class="op">$</span>qualreg)</code></pre></div>
<pre><code>
        Autre         Cadre       Employe 
           58           260           594 
Intermediaire       Ouvrier 
          246           495 </code></pre>
<p>Le tableau croisé des deux variables s’obtient de la manière suivante :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(d<span class="op">$</span>sport, d<span class="op">$</span>qualreg)</code></pre></div>
<pre><code>     
      Autre Cadre Employe Intermediaire Ouvrier
  Non    38   117     401           127     381
  Oui    20   143     193           119     114</code></pre>
<div class="note">
<p>Il est tout à fait possible de croiser trois variables ou plus. Par exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(d<span class="op">$</span>sport, d<span class="op">$</span>cuisine, d<span class="op">$</span>sexe)</code></pre></div>
<pre><code>, ,  = Homme

     
      Non Oui
  Non 401 129
  Oui 228 141

, ,  = Femme

     
      Non Oui
  Non 358 389
  Oui 132 222</code></pre>
</div>
<p>Une alternative à la fonction <code data-pkg="base">table</code> est la fonction <code data-pkg="stats">xtabs</code>. On indiquera à cette dernière le croisement à effectuer à l’aide d’une formule puis l’objet contenant nos données. Comme il ne s’agit pas d’un modèle avec une variable à expliquer, toutes les variables seront indiquées à la droite du symbole <code>~</code> et séparées par <code>+</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xtabs</span>(<span class="op">~</span>sport, d)</code></pre></div>
<pre><code>sport
 Non  Oui 
1277  723 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xtabs</span>(<span class="op">~</span>sport <span class="op">+</span><span class="st"> </span>cuisine, d)</code></pre></div>
<pre><code>     cuisine
sport Non Oui
  Non 759 518
  Oui 360 363</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xtabs</span>(<span class="op">~</span>sport <span class="op">+</span><span class="st"> </span>cuisine <span class="op">+</span><span class="st"> </span>sexe, d)</code></pre></div>
<pre><code>, , sexe = Homme

     cuisine
sport Non Oui
  Non 401 129
  Oui 228 141

, , sexe = Femme

     cuisine
sport Non Oui
  Non 358 389
  Oui 132 222</code></pre>
<p>On remarquera que le rendu par défaut est en général plus lisible car le nom des variables est indiqué, permettant de savoir quelle variable est affichée en colonnes et laquelle en lignes.</p>
<p>Si l’on utilise des <a href="#facteurs-et-vecteurs-labellises">données labellisées</a>, la fonction <code data-pkg="stats">xtabs</code> ne prendra pas en compte les étiquettes de valeur.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(fecondite)
<span class="kw">xtabs</span>(<span class="op">~</span>educ <span class="op">+</span><span class="st"> </span>region, femmes)</code></pre></div>
<pre><code>    region
educ   1   2   3   4
   0 387 213 282 256
   1 179  53  86 142
   2 123  57  37 131
   3  18   1   2  33</code></pre>
<p>On pourra alors utiliser la fonction <code data-pkg="questionr">ltabs</code> de l’extension <code class="pkg">question</code>, qui fonctionne exactement comme <code data-pkg="stats">xtabs</code>, à ceci près qu’elle prendra en compte les étiquettes de variable et de valeur quand elles existent.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ltabs</span>(<span class="op">~</span>educ <span class="op">+</span><span class="st"> </span>region, femmes)</code></pre></div>
<pre><code>                        region: Région de résidence
educ: Niveau d'éducation [1] Nord [2] Est [3] Sud
          [0] aucun           387     213     282
          [1] primaire        179      53      86
          [2] secondaire      123      57      37
          [3] supérieur        18       1       2
                        region: Région de résidence
educ: Niveau d'éducation [4] Ouest
          [0] aucun            256
          [1] primaire         142
          [2] secondaire       131
          [3] supérieur         33</code></pre>
</div>
<div id="statistique-bivariee_pourcentages-en-ligne-et-en-colonne" class="section level3">
<h3>Pourcentages en ligne et en colonne</h3>
<p>On n’a cependant que les effectifs, ce qui rend difficile les comparaisons. L’extension <code class="pkg">questionr</code> fournit des fonctions permettant de calculer facilement les pourcentages lignes, colonnes et totaux d’un tableau croisé.</p>
<p>Les pourcentages lignes s’obtiennent avec la fonction <code data-pkg="questionr" data-rdoc="rprop">lprop</code><a href="#statistique-bivariee_fn2" class="footnoteRef" id="statistique-bivariee_fnref2"><sup>2</sup></a>. Celle-ci s’applique au tableau croisé généré par <code data-pkg="base">table</code> ou <code data-pkg="stats">xtabs</code>  :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tab &lt;-<span class="st"> </span><span class="kw">table</span>(d<span class="op">$</span>sport, d<span class="op">$</span>qualreg)
<span class="kw">lprop</span>(tab)</code></pre></div>
<pre><code>          
           Autre Cadre Employe Intermediaire
  Non        3.6  11.0  37.7    11.9        
  Oui        3.4  24.3  32.8    20.2        
  Ensemble   3.5  15.7  35.9    14.9        
          
           Ouvrier Total
  Non       35.8   100.0
  Oui       19.4   100.0
  Ensemble  29.9   100.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tab &lt;-<span class="st"> </span><span class="kw">xtabs</span>(<span class="op">~</span>sport <span class="op">+</span><span class="st"> </span>qualreg, d)
<span class="kw">lprop</span>(tab)</code></pre></div>
<pre><code>          qualreg
sport      Autre Cadre Employe Intermediaire
  Non        3.6  11.0  37.7    11.9        
  Oui        3.4  24.3  32.8    20.2        
  Ensemble   3.5  15.7  35.9    14.9        
          qualreg
sport      Ouvrier Total
  Non       35.8   100.0
  Oui       19.4   100.0
  Ensemble  29.9   100.0</code></pre>
<p>Les pourcentages ligne ne nous intéressent guère ici. On ne cherche pas à voir quelle est la proportion de cadres parmi ceux qui pratiquent un sport, mais plutôt quelle est la proportion de sportifs chez les cadres. Il nous faut donc des pourcentages colonnes, que l’on obtient avec la fonction <code data-pkg="questionr">cprop</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cprop</span>(tab)</code></pre></div>
<pre><code>       qualreg
sport   Autre Cadre Employe Intermediaire Ouvrier
  Non    65.5  45.0  67.5    51.6          77.0  
  Oui    34.5  55.0  32.5    48.4          23.0  
  Total 100.0 100.0 100.0   100.0         100.0  
       qualreg
sport   Ensemble
  Non    64.4   
  Oui    35.6   
  Total 100.0   </code></pre>
<p>Dans l’ensemble, le pourcentage de personnes ayant pratiqué un sport est de 35,6 %. Mais cette proportion varie fortement d’une catégorie professionnelle à l’autre : 55,0 % chez les cadres contre 23,0 % chez les ouvriers.</p>
<p>Enfin, les pourcentage totaux s’obtiennent avec la fonction <code data-pkg="questionr">prop</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop</span>(tab)</code></pre></div>
<pre><code>       qualreg
sport   Autre Cadre Employe Intermediaire Ouvrier
  Non     2.3   7.1  24.3     7.7          23.0  
  Oui     1.2   8.7  11.7     7.2           6.9  
  Total   3.5  15.7  35.9    14.9          29.9  
       qualreg
sport   Total
  Non    64.4
  Oui    35.6
  Total 100.0</code></pre>
<p>À noter qu’on peut personnaliser l’affichage de ces tableaux de pourcentages à l’aide de différentes options, dont <code>digits</code> qui règle le nombre de décimales à afficher et <code>percent</code> qui indique si on souhaite ou non rajouter un symbole <code>%</code> dans chaque case du tableau. Cette personnalisation peut se faire directement au moment de la génération du tableau et dans ce cas elle sera utilisée par défaut :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ctab &lt;-<span class="st"> </span><span class="kw">cprop</span>(tab, <span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">percent =</span> <span class="ot">TRUE</span>)
ctab</code></pre></div>
<pre><code>       qualreg
sport   Autre   Cadre   Employe Intermediaire
  Non    65.52%  45.00%  67.51%  51.63%      
  Oui    34.48%  55.00%  32.49%  48.37%      
  Total 100.00% 100.00% 100.00% 100.00%      
       qualreg
sport   Ouvrier Ensemble
  Non    76.97%  64.37% 
  Oui    23.03%  35.63% 
  Total 100.00% 100.00% </code></pre>
<p>ou bien ponctuellement en passant les mêmes arguments à la fonction <code data-pkg="questionr" data-rdoc="print.proptab">print</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ctab &lt;-<span class="st"> </span><span class="kw">cprop</span>(tab)
<span class="kw">print</span>(ctab, <span class="dt">percent =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>       qualreg
sport   Autre  Cadre  Employe Intermediaire
  Non    65.5%  45.0%  67.5%   51.6%       
  Oui    34.5%  55.0%  32.5%   48.4%       
  Total 100.0% 100.0% 100.0%  100.0%       
       qualreg
sport   Ouvrier Ensemble
  Non    77.0%   64.4%  
  Oui    23.0%   35.6%  
  Total 100.0%  100.0%  </code></pre>
</div>
<div id="statistique-bivariee_representation-graphique" class="section level3">
<h3>Représentation graphique</h3>
<p>On peut obtenir une représentation graphique synthétisant l’ensemble des résultats obtenus sous la forme d’un <dfn>graphique en mosaïque</dfn><dfn data-index="mosaïque, graphique"></dfn><dfn data-index="tableau croisé, graphique en mosaïque"></dfn> grâce à la fonction <code data-pkg="graphics">mosaicplot</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mosaicplot</span>(qualreg <span class="op">~</span><span class="st"> </span>sport, <span class="dt">data =</span> d, <span class="dt">shade =</span> <span class="ot">TRUE</span>, 
  <span class="dt">main =</span> <span class="st">"Graphe en mosaïque"</span>)</code></pre></div>
<img src="graphs/statistique-bivariee/unnamed-chunk-26-1.png" width="1050"><figcaption>
Exemple de graphe en mosaïque
</figcaption></figure><p>Comment interpréter ce graphique haut en couleurs<a href="#statistique-bivariee_fn3" class="footnoteRef" id="statistique-bivariee_fnref3"><sup>3</sup></a> ? Chaque rectangle représente une case de tableau. Sa largeur correspond aux pourcentages en colonnes (il y a beaucoup d’employés et d’ouvriers et très peu d’« Autre »). Sa hauteur correspond aux pourcentages en lignes : la proportion de sportifs chez les cadres est plus élevée que chez les employés. Enfin, la couleur de la case correspond au résidu du test du <U+03C7>² correspondant : les cases en rouge sont sous-représentées, les cases en bleu sur-représentées, et les cases blanches sont statistiquement proches de l’hypothèse d’<dfn>indépendance</dfn>.</p>
<div class="note">
<p>Les graphiques en mosaïque permettent notamment de représenter des tableaux croisés à 3 ou 4 dimensions, voire plus.</p>
<p>L’extension <code class="pkg">vcd</code> fournie une fonction <code data-pkg="vcd">mosaic</code> fournissant plus d’options pour la création d’un graphique en mosaïque, permettant par exemple d’indiquer quelles variables doivent être affichées horizontalement ou verticalement, ou encore de colorier le contenu des rectangles en fonction d’une variable donnée, …</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(vcd)</code></pre></div>
<pre><code>Loading required package: grid</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mosaic</span>(<span class="op">~</span>sport <span class="op">+</span><span class="st"> </span>cuisine <span class="op">+</span><span class="st"> </span>sexe, d, <span class="dt">highlighting =</span> <span class="st">"sexe"</span>, 
  <span class="dt">main =</span> <span class="st">"Exemple de graphique en mosaïque à 3 dimensions"</span>)</code></pre></div>
<p><img src="graphs/statistique-bivariee/unnamed-chunk-27-1.png" width="1050"></p>
</div>
<p>Lorsque l’on s’intéresse principalement aux variations d’une variable selon une autre, par exemple ici à la pratique du sport selon le niveau de qualification, il peut être intéressant de présenter les pourcentages en colonne sous la forme de <dfn data-index="barres cumulées, graphique">barres cumulées</dfn>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(<span class="kw">cprop</span>(tab, <span class="dt">total =</span> <span class="ot">FALSE</span>), <span class="dt">main =</span> <span class="st">"Pratique du sport selon le niveau de qualification"</span>)</code></pre></div>
<img src="graphs/statistique-bivariee/unnamed-chunk-28-1.png" width="1050"><figcaption>
Exemple de barres cumulées
</figcaption></figure>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="statistique-bivariee_fn1"><p><code class="pkg">MASS</code> est installée par défaut avec la version de base de <strong>R</strong>.<a href="#statistique-bivariee_fnref1"><U+21A9></a></p></li>
<li id="statistique-bivariee_fn2"><p>Il s’agit en fait d’un alias pour les francophones de la fonction <code data-pkg="questionr">rprop</code>.<a href="#statistique-bivariee_fnref2"><U+21A9></a></p></li>
<li id="statistique-bivariee_fn3"><p>Sauf s’il est imprimé en noir et blanc…<a href="#statistique-bivariee_fnref3"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="intro-ggplot2"><div class="fluid-row" id="intro-ggplot2_header">



<h1 class="title toc-ignore">Introduction à ggplot2</h1>

</div>

<div class="TOC">
<ul>
<li>
<a href="#intro-ggplot2_les-donnees-de-lexemple">Les données de l’exemple</a><ul>
<li><a href="#intro-ggplot2_nettoyage-des-donnees">Nettoyage des données</a></li>
<li><a href="#intro-ggplot2_recodage-dune-variable">Recodage d’une variable</a></li>
</ul>
</li>
<li>
<a href="#intro-ggplot2_visualisation-des-donnees">Visualisation des données</a><ul>
<li><a href="#intro-ggplot2_visualisation-par-petits-multiples">Visualisation par <q>petits multiples</q></a></li>
<li><a href="#intro-ggplot2_visualisation-en-series-temporelles">Visualisation en séries temporelles</a></li>
<li><a href="#intro-ggplot2_combinaisons-delements-graphiques">Combinaisons d’éléments graphiques</a></li>
</ul>
</li>
<li>
<a href="#intro-ggplot2_composition-graphique-avec-ggplot2">Composition graphique avec ggplot2</a><ul>
<li><a href="#intro-ggplot2_couleurs-et-echelles">Couleurs et échelles</a></li>
<li><a href="#intro-ggplot2_utilisation-des-themes">Utilisation des thèmes</a></li>
<li><a href="#intro-ggplot2_export-des-graphiques">Export des graphiques</a></li>
</ul>
</li>
<li>
<a href="#intro-ggplot2_pour-aller-plus-loin">Pour aller plus loin</a><ul>
<li><a href="#intro-ggplot2_ressources-essentielles">Ressources essentielles</a></li>
<li><a href="#intro-ggplot2_extensions-de-ggplot2">Extensions de ggplot2</a></li>
</ul>
</li>
</ul>
</div>

<div class="note">
<p>Ce chapitre est tiré d’une <a href="https://github.com/briatte/aad/tree/master/reinhart-rogoff">séance de cours</a> de François Briatte et destinée à des étudiants de L2 sans aucune connaissance de <strong>R</strong>. Cette séance de cours est elle-même inspirée d’un <a href="http://www.stat.cmu.edu/~cshalizi/uADA/13/hw/11/">exercice</a> tiré d’un cours de <a href="http://www.stat.cmu.edu/~cshalizi/">Cosma Shalizi</a>.</p>
</div>
<p><strong>R</strong> possède un puissant moteur graphique interne, qui permet de <q>dessiner</q> dans un graphique en y rajoutant des segments, des points, du texte, ou toutes sortes d’autres symboles. Toutefois, pour produire un graphique complet avec les fonctions basiques de <strong>R</strong>, il faut un peu bricoler : d’abord, ouvrir une fenêtre ; puis rajouter des points ; puis rajouter des lignes ; tout en configurant les couleurs au fur-et-à-mesure ; puis finir par fermer la fenêtre graphique.</p>
<p>L’extension <code class="pkg">ggplot2</code><a href="#intro-ggplot2_fn1" class="footnoteRef" id="intro-ggplot2_fnref1"><sup>1</sup></a>, développée par Hadley Wickham et mettant en œuvre la <q>grammaire graphique</q> <a href="https://books.google.fr/books/about/The_Grammar_of_Graphics.html">théorisée par Leland Wilkinson</a>, devient vite indispensable lorsque l’on souhaite réaliser des graphiques plus complexes<a href="#intro-ggplot2_fn2" class="footnoteRef" id="intro-ggplot2_fnref2"><sup>2</sup></a>.</p>
<p>Ce chapitre, articulé autour d’une étude de cas, présente <code class="pkg">ggplot2</code> à partir d’un exemple simple de visualisation de séries temporelles, puis rentre dans le détail de sa syntaxe. Pour une présentation plus formelle, on pourra se référer au <a href="#ggplot2-la-grammaire-des-graphiques">chapitre dédié</a> de la section <em>Approfondir</em>.</p>
<div id="intro-ggplot2_les-donnees-de-lexemple" class="section level2">
<h2>Les données de l’exemple</h2>
<p>Il y a quelques années, les chercheurs Carmen M. Reinhart et Kenneth S. Rogoff publiaient un article intitulé <cite><a href="http://scholar.harvard.edu/files/rogoff/files/growth_in_time_debt_aer.pdf">Growth in a Time of Debt</a></cite>, dans lequel ils faisaient la démonstration qu’un niveau élevé de dette publique nuisait à la croissance économique. Plus exactement, les deux chercheurs y défendaient l’idée que, lorsque la dette publique dépasse 90 % du produit intérieur brut, ce produit cesse de croître.</p>
<p>Cette conclusion, proche du discours porté par des institutions comme le Fonds Monétaire International, a <a href="http://www.economist.com/news/finance-and-economics/21576362-seminal-analysis-relationship-between-debt-and-growth-comes-under">alimenté plusieurs argumentaires politiques</a>. Des parlementaires américains s’en ainsi sont servi pour exiger une diminution du budget fédéral, et surtout, la Commission européenne s’est appuyée sur cet argumentaire pour exiger que des pays comme la Grèce, durement frappés par la crise financière globale de 2008, adoptent des plans d’austérité drastiques.</p>
<p>Or, en tentant de reproduire les résultats de Reinhart et Rogoff, les chercheurs Thomas Herndon, Michael Ash et Robert Pollin y ont trouvé <a href="http://www.peri.umass.edu/236/hash/31e2ff374b6377b2ddec04deaa6388b1/publication/566/">de nombreuses erreurs</a>, ainsi qu’une <a href="http://www.nextnewdeal.net/rortybomb/researchers-finally-replicated-reinhart-rogoff-and-there-are-serious-problems">bête erreur de calcul</a> due à une utilisation peu attentive du logiciel <strong>Microsoft Excel</strong>. La révélation de ces erreurs donna lieu à un débat très vif entre adversaires et partisans des politiques économiques d’austérité, débat toujours autant d’actualité aujourd’hui.</p>
<p>Dans ce chapitre, on va se servir des données (corrigées) de Reinhart et Rogoff pour évaluer, de manière indépendante, la cohérence de leur argument sur le rapport entre endettement et croissance économique. Commençons par récupérer ces données au format CSV sur le site du chercheur américain <a href="http://www.stat.cmu.edu/~cshalizi/">Cosma Shalizi</a>, qui utilise ces données dans <a href="http://www.stat.cmu.edu/~cshalizi/uADA/">l’un de ses exercices de cours</a> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># charger l'extension lisant le format CSV</span>
<span class="kw">library</span>(readr)

<span class="co"># emplacement souhaité pour le jeu de données</span>
file &lt;-<span class="st"> "data/debt.csv"</span>

<span class="co"># télécharger le jeu de données s'il n'existe pas</span>
<span class="cf">if</span>(<span class="op">!</span><span class="kw">file.exists</span>(file))
  <span class="kw">download.file</span>(<span class="st">"http://www.stat.cmu.edu/~cshalizi/uADA/13/hw/11/debt.csv"</span>,
                file, <span class="dt">mode =</span> <span class="st">"wb"</span>)

<span class="co"># charger les données dans l'objet 'debt'</span>
debt &lt;-<span class="st"> </span><span class="kw">read_csv</span>(file)</code></pre></div>
<pre><code>Warning: Missing column names filled in: 'X1' [1]</code></pre>
<pre><code>Parsed with column specification:
cols(
  X1 = col_integer(),
  Country = col_character(),
  Year = col_integer(),
  growth = col_double(),
  ratio = col_double()
)</code></pre>
<div class="note">
<p>Le code ci-dessus utilise la fonction <code data-pkg="readr" data-rdoc="read_csv">read_csv</code> de l’extension <code class="pkg">readr</code>, dont on a recommandé l’utilisation dans un <a href="#import-de-donnees">précédent chapitre</a>. En l’absence de cette extension, on aurait pu utiliser la fonction de base <code data-pkg="utils" data-rdoc="read.csv">read.csv</code>.</p>
</div>
<div id="intro-ggplot2_nettoyage-des-donnees" class="section level3">
<h3>Nettoyage des données</h3>
<p>Les données de Reinhart et Rogoff contiennent, pour un échantillon de 20 pays occidentaux membres de la zone <a href="https://fr.wikipedia.org/wiki/Organisation_de_coop%C3%A9ration_et_de_d%C3%A9veloppement_%C3%A9conomiques">OCDE</a>, la croissance de leur <a href="https://fr.wikipedia.org/wiki/Produit_int%C3%A9rieur_brut">produit intérieur brut</a> (PIB)<a href="#intro-ggplot2_fn3" class="footnoteRef" id="intro-ggplot2_fnref3"><sup>3</sup></a>, et le ratio entre leur <a href="https://fr.wikipedia.org/wiki/Dette_publique">dette publique</a> et ce produit, exprimé sous la forme d’un pourcentage <q>Dette / PIB</q>. Les données vont du milieu des années 1940 à la fin des années 2000. La première colonne du jeu de données ne contenant que les numéros des lignes, on va la supprimer d’entrée de jeu :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># inspection du jeu de données</span>
<span class="kw">str</span>(debt)</code></pre></div>
<pre><code>Classes 'tbl_df', 'tbl' and 'data.frame':   1171 obs. of  5 variables:
 $ X1     : int  147 148 149 150 151 152 153 154 155 156 ...
 $ Country: chr  "Australia" "Australia" "Australia" "Australia" ...
 $ Year   : int  1946 1947 1948 1949 1950 1951 1952 1953 1954 1955 ...
 $ growth : num  -3.56 2.46 6.44 6.61 6.92 ...
 $ ratio  : num  190 177 149 126 110 ...
 - attr(*, "spec")=List of 2
  ..$ cols   :List of 5
  .. ..$ X1     : list()
  .. .. ..- attr(*, "class")= chr  "collector_integer" "collector"
  .. ..$ Country: list()
  .. .. ..- attr(*, "class")= chr  "collector_character" "collector"
  .. ..$ Year   : list()
  .. .. ..- attr(*, "class")= chr  "collector_integer" "collector"
  .. ..$ growth : list()
  .. .. ..- attr(*, "class")= chr  "collector_double" "collector"
  .. ..$ ratio  : list()
  .. .. ..- attr(*, "class")= chr  "collector_double" "collector"
  ..$ default: list()
  .. ..- attr(*, "class")= chr  "collector_guess" "collector"
  ..- attr(*, "class")= chr "col_spec"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># suppression de la première colonne</span>
debt &lt;-<span class="st"> </span>debt[, <span class="op">-</span><span class="dv">1</span>]</code></pre></div>
<p>Il faut aussi noter d’emblée que certaines mesures sont manquantes : pour certains pays, on ne dispose pas d’une mesure fiable du PIB et/ou de la dette publique. En conséquence, le nombre d’observations par pays est différent, et va de 40 observations <q>pays-année</q> pour la Grèce à 64 observations <q>pays-année</q> pour plusieurs pays comme l’Australie ou les États-Unis :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(debt<span class="op">$</span>Country)</code></pre></div>
<pre><code>
  Australia     Austria     Belgium      Canada 
         64          59          63          64 
    Denmark     Finland      France     Germany 
         56          64          54          59 
     Greece     Ireland       Italy       Japan 
         40          63          59          54 
Netherlands New Zealand      Norway    Portugal 
         53          64          64          58 
      Spain      Sweden          UK          US 
         42          64          63          64 </code></pre>
</div>
<div id="intro-ggplot2_recodage-dune-variable" class="section level3">
<h3>Recodage d’une variable</h3>
<p>Dernière manipulation préalable avant l’analyse : on va calculer la décennie de chaque observation, en divisant l’année de mesure par 10, et en multipliant la partie entière de ce résultat par 10. Cette manipulation très simple donne <q>1940</q> pour les mesures des années 1940 à 1949, <q>1950</q> pour les années 1950-1959, et ainsi de suite.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">debt<span class="op">$</span>Decade &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="dv">10</span> <span class="op">*</span><span class="st"> </span>debt<span class="op">$</span>Year<span class="op">%/%</span><span class="dv">10</span>)</code></pre></div>
<p>Voici, pour terminer, les premières lignes du jeu de données sur lequel on travaille :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(debt)</code></pre></div>
<pre><code># A tibble: 6 × 5
    Country  Year    growth     ratio Decade
      &lt;chr&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;fctr&gt;
1 Australia  1946 -3.557951 190.41908   1940
2 Australia  1947  2.459475 177.32137   1940
3 Australia  1948  6.437534 148.92981   1940
4 Australia  1949  6.611994 125.82870   1940
5 Australia  1950  6.920201 109.80940   1950
6 Australia  1951  4.272612  87.09448   1950</code></pre>
</div>
</div>
<div id="intro-ggplot2_visualisation-des-donnees" class="section level2">
<h2>Visualisation des données</h2>
<p>Chargeons à présent l’extension graphique <code class="pkg">ggplot2</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)</code></pre></div>
<p>Procédons désormais à quelques visualisations très simples de ces données. On dispose de trois variables continues : l’année, le taux de croissance du PIB, et le ratio <q>Dette publique / PIB</q>. Si l’on souhaite visualiser la croissance du PIB au cours du temps, la solution basique dans <strong>R</strong> s’écrit de la manière suivante :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(debt, <span class="kw">plot</span>(Year, growth))</code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-7-1.png" width="1050"></figure><p>Le code de la visualisation est très simple et se lit : <q>avec l’objet <code>debt</code>, construire le graphique montrant l’année d’observation <var>Year</var> en abcisse et le taux de croissance du PIB <var>growth</var> en ordonnée</q>. Le code est compris de cette manière par <strong>R</strong> car la fonction <code data-pkg="graphics">plot</code> comprend le premier argument comme étant la variable à représenter sur l’axe horizontal <code>x</code>, et le second comme la variable à représenter sur l’axe vertical <code>y</code>.</p>
<p>Le même graphique s’écrit de la manière suivante avec l’extension <code class="pkg">ggplot2</code> :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(debt, <span class="kw">qplot</span>(Year, growth))</code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-8-1.png" width="1050"></figure><p>Comme on peut le voir, le code est très proche du code utilisé dans <q><strong>R</strong> base</q>, la syntaxe signifiant toujours : <q>avec le jeu de données <code>debt</code>, visualiser les variables <var>Year</var> sur l’axe <code>x</code> et <var>growth</var> sur l’axe <code>y</code></q>. Le résultat est similaire, bien que plusieurs paramètres graphiques aient changé : le fond gris clair, en particulier, est caractéristique du thème graphique par défaut de <code class="pkg">ggplot2</code>, que l’on apprendra à modifier plus loin.</p>
<p>Par ailleurs, dans les deux exemples précédents, on a écrit <code>with(debt, ...)</code> pour indiquer que l’on travaillait avec l’objet <code>debt</code>. Lorsque l’on travaille avec l’extension <code class="pkg">ggplot2</code>, il est toutefois plus commun d’utiliser l’argument <code>data</code> dans l’appel de <code data-pkg="ggplot2">qplot</code> pour indiquer ce choix :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(Year, growth, <span class="dt">data =</span> debt)</code></pre></div>
<div id="intro-ggplot2_visualisation-par-petits-multiples" class="section level3">
<h3>Visualisation par <q>petits multiples</q>
</h3>
<p>Cherchons désormais à mieux comprendre les variations du taux de croissance du PIB au fil des années.</p>
<p>Dans les graphiques précédents, on voit clairement que ce taux est très variable dans l’immédiat après-guerre, puis qu’il oscille entre environ -5 % et +15 %, puis qu’il semble chuter dramatiquement à la fin des années 2000, marquées par la crise financière globale. Mais comment visualiser ces variations pour chacun des vingt pays de l’échantillon ?</p>
<p>On va ici utiliser le principe de la visualisation par <q><a href="http://www.juiceanalytics.com/writing/better-know-visualization-small-multiples/">petits multiples</a></q>, c’est-à-dire que l’on va reproduire le même graphique pour chacun des pays, et visualiser l’ensemble de ces graphiques dans une même fenêtre. Concrètement, il va donc s’agir de montrer la croissance annuelle du PIB en faisant apparaître chaque pays dans une facette différente du graphique.</p>
<p><code class="pkg">ggplot2</code> permet d’effectuer cette opération en rajoutant au graphique précédent, au moyen de l’opérateur <code>+</code>, l’élément <code>facet_wrap(~ Country)</code> au graphique et qui signifie <q>construire le graphique pour chaque valeur différente de la variable <var>Country</var></q>. On notera que la fonction <code data-pkg="ggplot2">facet_wrap</code> utilise la syntaxe <a href="#formules">équation</a> de <strong>R</strong>. Par défaut, ces <q>facettes</q> sont classées par ordre alphabétique :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(Year, growth, <span class="dt">data =</span> debt) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Country)</code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-10-1.png" width="1050"></figure><p>Voilà qui est beaucoup plus clair ! On aperçoit bien, dans ce graphique, les variations très importantes de croissance du PIB dans un pays comme l’Autriche, ruinée après la Seconde guerre mondiale, ou l’Irlande, très durement frappée par la crise financière globale en 2008 et 2009. On aperçoit aussi où se trouvent les données manquantes : voir le graphique de l’Espagne, par exemple.</p>
<p>Il faut noter ici un élément essentiel de la grammaire graphique de <code class="pkg">ggplot2</code>, qui utilise une syntaxe additive, où différents éléments et paramètres graphiques peuvent être combinés en les additionnant, ce qui permet de construire et de modifier des graphiques de manière cumulative, pas à pas. Cette caractéristique permet de tâtonner, et de construire progressivement des graphiques très complets.</p>
</div>
<div id="intro-ggplot2_visualisation-en-series-temporelles" class="section level3">
<h3>Visualisation en séries temporelles</h3>
<p>Enfin, pour produire le même graphique que ci-dessus en utilisant des lignes plutôt que des points, il suffit d’utiliser l’argument <code>geom = "line"</code>, ce qui peut être considéré comme une meilleure manière de visualiser des séries temporelles, mais qui tend aussi à rendre plus difficile la détection des périodes pour lesquelles il manque des données (voir, à nouveau, le graphique pour l’Espagne) :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="dt">data =</span> debt, <span class="dt">y =</span> growth, <span class="dt">x =</span> Year, <span class="dt">geom =</span> <span class="st">"line"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Country)</code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-11-1.png" width="1050"></figure><p>Dans ce dernier exemple, on a défini l’axe <code>y</code> avant de définir l’axe <code>x</code>, en écrivant ces arguments de manière explicite ; de même, on a commencé par spécifier l’argument <code>data</code>, et l’on a terminé par l’argument <code>geom</code>. Cet ordre d’écriture permet de conserver une forme de cohérence dans l’écriture des fonctions graphiques.</p>
</div>
<div id="intro-ggplot2_combinaisons-delements-graphiques" class="section level3">
<h3>Combinaisons d’éléments graphiques</h3>
<p>On n’a pas encore visualisé le ratio <q>Dette publique / PIB</q>, l’autre variable du raisonnement de Reinhart et Rogoff. C’est l’occasion de voir comment rajouter des titres aux axes des graphiques, et d’utiliser les lignes en même temps que des points, toujours grâce à l’argument <code>geom</code>, qui peut prendre plusieurs valeurs (ici, <code>"point"</code> produit les points et <code>"line"</code> produit les lignes) :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="dt">data =</span> debt, <span class="dt">y =</span> ratio, <span class="dt">x =</span> Year, <span class="dt">geom =</span> <span class="kw">c</span>(<span class="st">"line"</span>, <span class="st">"point"</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Country) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="st">"Ratio dette publique / produit intérieur brut (%)</span><span class="ch">\n</span><span class="st">"</span>)</code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-12-1.png" width="1050"></figure><p>Dans ce graphique, on a combiné deux <q>objets géométriques</q> (<code>geom</code>) pour afficher à la fois des points et des lignes. On a ensuite défini les titres des axes, en supprimant celui de l’axe <code>x</code>, et en rajoutant un peu d’espace entre le titre de l’axe <code>y</code> et l’axe lui-même grâce à la chaîne de caractères finale <code>\n</code>, qui rajoute une ligne vide entre ces deux éléments<a href="#intro-ggplot2_fn4" class="footnoteRef" id="intro-ggplot2_fnref4"><sup>4</sup></a>.</p>
<p>Les différents exemples vus dans cette section montrent qu’il va falloir apprendre un minimum de syntaxe graphique pour parvenir à produire des graphiques avec <code class="pkg">ggplot2</code>. Ce petit investissement permet de savoir très vite produire de très nombreux types de graphiques, assez élégants de surcroît, et très facilement modifiables à l’aide de toutes sortes de paramètres optionnels.</p>
<div class="important">
<p>Aussi élégants que soient vos graphiques, il ne vous dispense évidemment pas de réfléchir à ce que vous êtes en train de visualiser, un graphique très élégant pouvant naturellement être complètement erroné, en particulier si les données de base du graphique ont été mal mesurées… ou endommagées.</p>
</div>
</div>
</div>
<div id="intro-ggplot2_composition-graphique-avec-ggplot2" class="section level2">
<h2>Composition graphique avec ggplot2</h2>
<p>La section précédente a montré comment utiliser la fonction <code data-pkg="ggplot2">qplot</code> (<em>quick plot</em>). La syntaxe complète de l’extension <code class="pkg">ggplot2</code> passe par une autre fonction, <code data-pkg="ggplot2">ggplot</code>, qui permet de mieux comprendre les différents éléments de sa grammaire graphique. Dans cette section, on va détailler cette syntaxe pour en tirer un graphique plus complexe que les précédents.</p>
<p>Commençons par créer un <q>treillis de base</q> au graphique :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> debt, <span class="kw">aes</span>(<span class="dt">y =</span> growth, <span class="dt">x =</span> ratio))</code></pre></div>
<p>Aucun graphique ne s’affiche ici : en effet, ce que l’on a stocké, dans l’objet <code>p</code>, n’est pas un graphique complet, mais une base de travail. Cette base définit les coordonnées <code>x</code> et <code>y</code> du graphique dans l’argument <code data-pkg="ggplot2">aes</code> (<em>aesthetics</em>). Ici, on a choisi de mettre la variable dépendante de Reinhart et Rogoff, <var>growth</var> (le taux de croissance du PIB), sur l’axe <code>y</code>, et la variable indépendante <var>ratio</var> (le ratio <q>Dette publique / PIB</q>) sur l’axe <code>x</code>.</p>
<p>Rajoutons désormais un objet géométrique, <code data-pkg="ggplot2">geom_point</code>, qui va projeter, sur le graphique, des points aux coordonnées précédemment définies, et divisons le graphique par un <q>petit multiple</q>, en projetant les points de chaque décennie dans une facette différente du graphique. Ce graphique propose une décomposition temporelle de la relation étudiée par Reinhart et Rogoff :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Decade)</code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-14-1.png" width="1050"></figure><div class="note">
<p>Le paramètre <code data-pkg="ggplot2">facet_grid</code>, qui utilise aussi la syntaxe <q><a href="#formules">équation</a></q>, permet de créer des facettes plus compliquées que celles créées par le paramètre <code data-pkg="ggplot2">facet_wrap</code>, même si, dans nos exemples, on aurait pu utiliser aussi bien l’un que l’autre.</p>
</div>
<p>Le graphique ci-dessus présente un problème fréquent : l’axe horizontal du graphique, très important puisque Reinhart et Rogoff évoquent un seuil <q>fatidique</q>, pour la croissance, de 90% du PIB, est illisible. Grâce à l’argument <code data-pkg="ggplot2" data-rdoc="continuous_scale">scale_x_continuous</code>, on va pouvoir clarifier cet axe en n’y faisant figurer que certaines valeurs :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Decade) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">200</span>, <span class="dt">by =</span> <span class="dv">100</span>))</code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-15-1.png" width="1050"></figure><p>Ces réglages nous conviennent : on va donc les sauvegarder dans l’objet <code>p</code>, de manière à continuer de construire notre graphique en incluant ces différents éléments.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Decade) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">200</span>, <span class="dt">by =</span> <span class="dv">100</span>))</code></pre></div>
<div id="intro-ggplot2_couleurs-et-echelles" class="section level3">
<h3>Couleurs et échelles</h3>
<p>Abordons désormais un élément-clé de <code class="pkg">ggplot2</code> : la manipulation des paramètres esthétiques. Précédemment, on n’a montré que deux de ces paramètres : <code>x</code> et <code>y</code>, les coordonnées du graphique. Mais ces paramètres peuvent aussi influencer la couleur des points de notre graphique comme le montre l’exemple suivant :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">color =</span> ratio <span class="op">&lt;</span><span class="st"> </span><span class="dv">90</span>)</code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-17-1.png" width="1050"></figure><p>Qu’a-t-on fait ici ? On a rajouté, au graphique stocké dans <code>p</code>, un paramètre esthétique qui détermine la couleur de ses points en fonction d’une inégalité, <code>ratio &lt; 90</code>, qui est vraie quand le ratio <q>Dette publique / PIB</q> est inférieur au seuil <q>fatidique</q> de Reinhart et Rogoff, et fausse quand ce ratio dépasse ce seuil. Les couleurs des points correspondent aux couleurs par défaut de <code class="pkg">ggplot2</code>, que l’on peut très facilement modifier avec <code data-pkg="ggplot2">scale_colour_brewer</code> :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">color =</span> ratio <span class="op">&lt;</span><span class="st"> </span><span class="dv">90</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">"Set1"</span>)</code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-18-1.png" width="1050"></figure><p>Ici, on a fait appel à la palette de couleur <code>Set1</code> de l’éventail de couleurs <a href="http://colorbrewer2.org/">ColorBrewer</a>, qui est automatiquement disponible dans <code class="pkg">ggplot2</code>, et qui est contenu dans l’extension <code class="pkg">RColorBrewer</code>. La palette de couleurs que l’on a choisie affiche les points situés au-dessus du seuil <q>fatidique</q> de Reinhart et Rogoff en rouge, les autres en bleu.</p>
<p>Que peut-on dire, à ce stade, du seuil <q>fatidique</q> de Reinhart et Rogoff ? On peut observer qu’après la Seconde guerre mondiale, de nombreux pays sont <em>déjà</em> endettés au-delà de ce seuil, et dégagent <em>déjà</em> moins de croissance que les autres. Sur la base de cette trajectoire, de nombreux critiques de Reinhart et Rogoff ont fait remarquer que le raisonnement de Reinhart et Rogoff pose en réalité un sérieux problème d’<a href="http://www.nextnewdeal.net/rortybomb/guest-post-reinhartrogoff-and-growth-time-debt">inversion du rapport causal</a> entre endettement et croissance au cours du temps.</p>
<p>Envisageons une nouvelle modification des paramètres graphiques. La légende du graphique, qui affiche <code>FALSE</code> et <code>TRUE</code> en fonction de l’inégalité <code>ratio &lt; 90</code>, peut être déroutante. Clarifions un peu cette légende en supprimant son titre et en remplaçant les libellés (<em>labels</em>) <code>FALSE</code> et <code>TRUE</code> par leur signification :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">color =</span> ratio <span class="op">&lt;</span><span class="st"> </span><span class="dv">90</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="st">""</span>, <span class="dt">palette =</span> <span class="st">"Set1"</span>,
                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"ratio &gt; 90"</span>, <span class="st">"ratio &lt; 90"</span>))</code></pre></div>
<p>Dans le bloc de code ci-dessus, on a stocké l’ensemble de nos modifications dans l’objet <code>p</code>, sans l’afficher ; en effet, on souhaite encore procéder à une dernière modification, en rajoutant une <a href="https://fr.wikipedia.org/wiki/R%C3%A9gression_locale">régression locale</a> à travers les points de chaque facette<a href="#intro-ggplot2_fn5" class="footnoteRef" id="intro-ggplot2_fnref5"><sup>5</sup></a>. Après consultation de la documentation de <code class="pkg">ggplot2</code> <a href="http://docs.ggplot2.org/current/geom_smooth.html">ici</a> et <a href="http://docs.ggplot2.org/current/stat_smooth.html">là</a>, on en arrive au code ci-dessous, où <code>p</code> produit le graphique précédent et <code data-pkg="ggplot2" data-rdoc="geom_smooth">geom_smooth</code> produit la régression locale :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">"loess"</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>,
                <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">"black"</span>)</code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-20-1.png" width="1050"></figure><p>Le graphique permet d’évaluer de manière encore un peu plus précise l’argument de Reinhart et Rogoff, et en particulier la nature pas si <q>fatidique</q> du seuil de 90% du ratio “Dette publique / PIB”, qui sans être une bonne nouvelle pour l’économie, ne détermine pas <q>fatidiquement</q> la direction du taux de croissance : si c’était le cas, toutes les courbes du graphique ressembleraient à celles des années 2000. Autrement dit, l’argumentaire de Reinhart et Rogoff laisse clairement à désirer.</p>
</div>
<div id="intro-ggplot2_utilisation-des-themes" class="section level3">
<h3>Utilisation des thèmes</h3>
<p>Reprenons notre graphique de départ. On va, pour terminer cette démonstration, en construire une version imprimable en noir et blanc, ce qui signifie qu’au lieu d’utiliser des couleurs pour distinguer les points en-deçà et au-delà du seuil <q>fatidique</q> de Reinhart et Rogoff, on va utiliser une ligne verticale, produite par <code data-pkg="ggplot2" data-rdoc="geom_vline">geom_vline</code> et affichée en pointillés par le paramètre <code>lty</code> (<em>linetype</em>) :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> debt, <span class="kw">aes</span>(<span class="dt">y =</span> growth, <span class="dt">x =</span> ratio)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">"grey50"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">90</span>, <span class="dt">lty =</span> <span class="st">"dotted"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">"loess"</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">"black"</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">200</span>, <span class="dt">by =</span> <span class="dv">100</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Decade) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">"Taux de croissance du produit intérieur brut</span><span class="ch">\n</span><span class="st">"</span>,
       <span class="dt">x =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">Ratio dette publique / produit intérieur brut (%)"</span>,
       <span class="dt">title =</span> <span class="st">"Données Reinhart et Rogoff corrigées, 1946-2009</span><span class="ch">\n</span><span class="st">"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"grey90"</span>, <span class="dt">color =</span> <span class="st">"grey50"</span>),
        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="kw">rel</span>(<span class="dv">1</span>)),
        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-21-1.png" width="1050"></figure><p>Ce graphique utilise tous les éléments présentés dans ce chapitre, ainsi qu’une dernière nouveauté : l’utilisation d’un thème graphique différent du thème par défaut de <code class="pkg">ggplot2</code>. Le thème par défaut, qui s’appelle <code>theme_grey</code>, est ici remplacé par un thème moins chargé, <code>theme_bw</code> (“<em>black and white</em>”), que l’on a modifié en y rajoutant <a href="http://docs.ggplot2.org/current/theme.html">quelques paramètres supplémentaires</a> :</p>
<ul>
<li>le paramètre <code>strip.background</code> détermine la couleur du rectangle contenant les titres des facettes, c’est-à-dire les décennies observées ;</li>
<li>le paramètre <code>strip.text</code> détermine la taille des titres des facettes, qui sont ici affichés dans la même taille de texte que le reste du texte ;</li>
<li>et le paramètre <code>panel.grid</code> supprime ici les guides du graphique grâce à l’élément vide <code>element_blank</code>, de manière à en alléger la lecture.</li>
</ul>
<p>Ces différents réglages peuvent être sauvegardés de manière à créer des thèmes réutilisables, comme <a href="https://github.com/jrnold/ggthemes/blob/master/README.md#examples">ceux de l’extension <code class="pkg">ggthemes</code></a>, ce qui permet par exemple de créer un thème entièrement blanc dans lequel on peut ensuite projeter une carte, ou de produire une série de graphiques homogènes d’un point de vue esthétique.</p>
</div>
<div id="intro-ggplot2_export-des-graphiques" class="section level3">
<h3>Export des graphiques</h3>
<p>Les graphiques produits par <code class="pkg">ggplot2</code> peuvent être sauvegardés manuellement, comme expliqué dans le chapitre <q><a href="#export-de-graphiques">Export des graphiques</a></q>, ou programmatiquement. Pour sauvegarder le dernier graphique affiché par <code class="pkg">ggplot2</code> au format PNG, il suffit d’utiliser la fonction <code data-pkg="ggplot2" data-rdoc="ggsave">ggsave</code>, qui permet d’en régler la taille (en pouces) et la résolution (en pixels par pouce ; 72 par défaut) :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsave</span>(<span class="st">"reinhart-rogoff.png"</span>, <span class="dt">width =</span> <span class="dv">11</span>, <span class="dt">height =</span> <span class="dv">8</span>)</code></pre></div>
<p>De la même manière, pour sauvegarder n’importe quel graphique construit avec <code class="pkg">ggplot2</code> et stocké dans un objet, il suffit de préciser le nom de cet objet, comme ci-dessous, où l’on sauvegarde le graphique contenu dans l’objet <code>p</code> au format vectoriel PDF, qui préserve la netteté du texte et des autres éléments du graphique à n’importe quelle résolution d’affichage :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsave</span>(<span class="st">"reinhart-rogoff.pdf"</span>, <span class="dt">plot =</span> p,
       <span class="dt">width =</span> <span class="dv">11</span>, <span class="dt">height =</span> <span class="dv">8</span>)</code></pre></div>
</div>
</div>
<div id="intro-ggplot2_pour-aller-plus-loin" class="section level2">
<h2>Pour aller plus loin</h2>
<p>Ce chapitre n’a pu faire la démonstration que d’une infime partie des manières d’utiliser <code class="pkg">ggplot2</code>. En voici une dernière illustration, qui donne une idée des différents types de graphiques que l’extension permet de produire dès que l’on connaît les principaux éléments de sa syntaxe :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> debt, <span class="kw">aes</span>(<span class="dt">x =</span> ratio <span class="op">&gt;</span><span class="st"> </span><span class="dv">90</span>, <span class="dt">y =</span> growth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"&lt; 90"</span>, <span class="st">"90+"</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Decade) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">"Taux de croissance du produit intérieur brut</span><span class="ch">\n</span><span class="st">"</span>,
       <span class="dt">x =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">Ratio dette publique / produit intérieur brut (%)"</span>,
       <span class="dt">title =</span> <span class="st">"Données Reinhart et Rogoff corrigées, 1946-2009</span><span class="ch">\n</span><span class="st">"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="kw">rel</span>(<span class="dv">1</span>)),
        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-24-1.png" width="1050"></figure><p>Le code ci-dessus est somme toute très proche du code présenté dans le reste du texte, et en même temps, on a basculé de la visualisation sous forme de série temporelles à une visualisation par <em>boxplots</em>. Ces basculements sont très faciles à envisager dès que l’on maîtrise les principaux éléments de <code class="pkg">ggplot2</code>, <code>geom</code>, <code>scale</code> et <code>facet</code>, et les paramètres <code>labs</code> et <code>theme</code> pour effectuer les finitions.</p>
<div id="intro-ggplot2_ressources-essentielles" class="section level3">
<h3>Ressources essentielles</h3>
<p>Pour tout ce qui concerne l’utilisation de <code class="pkg">ggplot2</code>, <a href="http://ggplot2.org/book/">l’ouvrage de Wickham</a>, <a href="https://github.com/hadley/ggplot2-book">en cours d’actualisation</a>, est la ressource essentielle à consulter. <a href="https://books.google.fr/books?id=ob0VAAAAQBAJ">L’ouvrage de Winston Chang</a>, qui contient des <a href="http://www.cookbook-r.com/Graphs/">dizaines d’exemples</a>, le complète utilement, de même que la <a href="http://docs.ggplot2.org/current/">documentation en ligne</a> de l’extension. Enfin, le site <a href="https://stackoverflow.com/questions/tagged/ggplot2">StackOverflow</a> contient de très nombreuses questions/réponses sur les subtilités de sa syntaxe.</p>
<p>On trouve aussi très facilement, ailleurs sur Internet, des dizaines de <em>tutorials</em> et autres <em>cheatsheets</em> pour <code class="pkg">ggplot2</code>, <a href="http://zevross.com/blog/2014/08/04/beautiful-plotting-in-r-a-ggplot2-cheatsheet-3/">ici</a> ou <a href="http://www.rstudio.com/wp-content/uploads/2015/04/ggplot2-cheatsheet.pdf">là</a> par exemple.</p>
<p>On pourra aussi se référer au chapitre <a href="#ggplot2-la-grammaire-des-graphiques">ggplot2 : la grammaire des graphiques</a>.</p>
</div>
<div id="intro-ggplot2_extensions-de-ggplot2" class="section level3">
<h3>Extensions de ggplot2</h3>
<p>Il faut signaler, pour terminer, quelques-unes des différentes extensions inspirées de <code class="pkg">ggplot2</code>, dont la plupart sont encore en cours de développement, mais qui permettent d’ores et déjà de produire des centaines de types de graphiques différents, à partir d’une syntaxe graphique proche de celle présentée dans ce chapitre :</p>
<ul>
<li>l’extension <code class="pkg">ggfortify</code> permet de <a href="https://github.com/sinhrks/ggfortify/blob/master/README.rst#examples">visualiser les résultats de différentes fonctions de modélisation</a> avec <code class="pkg">ggplot2</code> ;</li>
<li>l’extension <code class="pkg">ggmap</code> permet de visualiser des fonds de carte et d’y superposer des éléments graphiques rédigés avec <code class="pkg">ggplot2</code> ;</li>
<li>l’extension <code class="pkg">GGally</code> rajoute quelques types de graphiques à ceux que <code class="pkg">ggplot2</code> peut produire par défaut ;</li>
<li>et des extensions comme <code class="pkg">ggvis</code> permettent de <a href="http://ggvis.rstudio.com/">produire des graphiques interactifs</a> en utilisant la syntaxe de base de <code class="pkg">ggplot2</code>.</li>
</ul>
<p>On reviendra sur ces extensions dans un <a href="#etendre-ggplot2">chapitre plus avancé</a>. Pour l’instant, on se contentera des éléments de syntaxe présentés dans ce chapitre, qui seront très souvent mobilisés dans les chapitres suivants, de manière à pleinement illustrer la richesse et la flexibilité de <code class="pkg">ggplot2</code>.</p>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="intro-ggplot2_fn1"><p>Voir l’excellente <a href="http://ggplot2.org/">documentation de l’extension</a> et les autres ressources citées en fin de chapitre.<a href="#intro-ggplot2_fnref1"><U+21A9></a></p></li>
<li id="intro-ggplot2_fn2"><p>Bien que l’on ait fait le choix de présenter l’extension <code class="pkg">ggplot2</code> plutôt que l’extension <code class="pkg">lattice</code>, celle-ci reste un excellent choix pour la visualisation, notamment, de <a href="http://www.magesblog.com/2013/09/using-planelgroups-in-lattice.html">panels</a> et de <a href="http://www.fromthebottomoftheheap.net/2013/10/23/time-series-plots-with-lattice-and-ggplot/">séries temporelles</a>. On trouve de <a href="https://procomun.wordpress.com/2015/04/14/mapping-flows-in-r-with-data-table-and-lattice/">très beaux exemples</a> d’utilisation de <code class="pkg">lattice</code> en ligne, mais un peu moins de documentation, et beaucoup moins d’extensions, que pour <code class="pkg">ggplot2</code>.<a href="#intro-ggplot2_fnref2"><U+21A9></a></p></li>
<li id="intro-ggplot2_fn3"><p>Ce produit est mesuré en <a href="https://fr.wikipedia.org/wiki/Produit_int%C3%A9rieur_brut_r%C3%A9el">termes réels</a>, de manière à ce que le calcul de sa croissance ne soit pas affecté par l’inflation.<a href="#intro-ggplot2_fnref3"><U+21A9></a></p></li>
<li id="intro-ggplot2_fn4"><p>Plus précisément, cela introduit un retour à la ligne dans le titre de l’axe.<a href="#intro-ggplot2_fnref4"><U+21A9></a></p></li>
<li id="intro-ggplot2_fn5"><p>La régression locale est une variante du calcul de la <a href="https://fr.wikipedia.org/wiki/Moyenne_glissante">moyenne glissante</a> (ou <q>moyenne mobile</q>) d’une courbe.<a href="#intro-ggplot2_fnref5"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="graphiques-bivaries-ggplot2"><div class="fluid-row" id="graphiques-bivaries-ggplot2_header">



<h1 class="title toc-ignore">Graphiques univariés et bivariés avec ggplot2</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#graphiques-bivaries-ggplot2_retour-sur-les-bases-de-ggplot2">Retour sur les bases de ggplot2</a></li>
<li><a href="#graphiques-bivaries-ggplot2_histogramme">Histogramme</a></li>
<li><a href="#graphiques-bivaries-ggplot2_densite-et-repartition-cumulee">Densité et répartition cumulée</a></li>
<li><a href="#graphiques-bivaries-ggplot2_boites-a-moustaches-et-representations-associees">Boîtes à moustaches (et représentations associées)</a></li>
<li><a href="#graphiques-bivaries-ggplot2_diagramme-en-batons">Diagramme en bâtons</a></li>
<li><a href="#graphiques-bivaries-ggplot2_nuage-de-points">Nuage de points</a></li>
<li><a href="#graphiques-bivaries-ggplot2_matrice-de-nuages-de-points-et-matrice-de-correlation">Matrice de nuages de points et matrice de corrélation</a></li>
<li><a href="#graphiques-bivaries-ggplot2_estimation-locale-de-densite-et-representations-associees">Estimation locale de densité (et représentations associées)</a></li>
<li><a href="#graphiques-bivaries-ggplot2_diagramme-de-cleveland">Diagramme de Cleveland</a></li>
<li><a href="#graphiques-bivaries-ggplot2_diagrammes-en-barres">Diagrammes en barres</a></li>
<li><a href="#graphiques-bivaries-ggplot2_graphe-en-mosaique">Graphe en mosaïque</a></li>
<li><a href="#graphiques-bivaries-ggplot2_donnees-labellisees-et-ggplot2">Données labellisées et ggplot2</a></li>
<li><a href="#graphiques-bivaries-ggplot2_exporter-les-graphiques-obtenus">Exporter les graphiques obtenus</a></li>
</ul>
</div>

<p>Après avoir introduit l’extension <code class="pkg">ggplot2</code> au travers d’une <a href="#intro-ggplot2">étude de cas</a>, nous reprenons ici les graphiques produits dans les chapitres <a href="#statistique-univariee">statistique univariée</a> et <a href="#statistique-bivariee">statistique bivariée</a> et montrons comment les réaliser avec <code class="pkg">ggplot2</code>.</p>
<div id="graphiques-bivaries-ggplot2_retour-sur-les-bases-de-ggplot2" class="section level2">
<h2>Retour sur les bases de ggplot2</h2>
<p>L’extension <code class="pkg">ggplot2</code> nécessite que les données du graphique soient sous la forme d’un tableau de données (<em>data.frame</em>) avec une ligne par observation et les différentes valeurs à représenter sous forme de variables du tableau.</p>
<p>Tous les graphiques avec <code class="pkg">ggplot2</code> suivent une même logique. En <strong>premier</strong> lieu, on appelera la fonction <code data-pkg="ggplot2">ggplot</code> en lui passant en paramètre le fichier de données.</p>
<p><code class="pkg">ggplot2</code> nomme <em>esthétiques</em> les différentes propriétés visuelles d’un graphique, à savoir l’axe des x (<code>x</code>), celui des y (<code>y</code>), la couleur des lignes (<code>colour</code>), celle de remplissage des polygones (<code>fill</code>), le type de lignes (<code>linetype</code>), etc. Une représentation graphique consiste donc à représenter chacune de nos variables d’intérêt selon une esthétique donnée. En <strong>second</strong> lieu, on appelera donc la fonction <code data-pkg="ggplot2">aes</code> pour indiquer la correspondance entre les variables de notre fichier de données et les esthétiques du graphique.</p>
<p>A minima, il est nécessaire d’indiquer en <strong>troisième</strong> lieu une <em>géométrie</em>, autrement dit la manière dont les éléments seront représentés visuellement. À chaque géométrie corresponds une fonction commençant par <code>geom_</code>, par exemple <code data-pkg="ggplot2">geom_point</code> pour dessiner des points, <code data-pkg="ggplot2" data-rdoc="geom_path">geom_line</code> pour des lignes, <code data-pkg="ggplot2">geom_bar</code> pour des barres ou encore <code data-pkg="ggplot2" data-rdoc="geom_ribbon">geom_area</code> pour des aires. Il existe de nombreuses géométries différentes, chacune prenant en compte certaines esthétiques, certaines étant requises pour cette géométrie et d’autres optionnelles. La liste des esthétiques prises en compte par chaque géométrie en indiquée dans l’aide en ligne de cette dernière.</p>
<p>Pour un document récapitulant les principales géométries et options de <code class="pkg">ggplot2</code>, on pourra se référer à la <em>Cheat Sheet</em> officielle disponible à <a href="https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf" class="uri">https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf</a>. Une version en français est disponible à l’adresse <a href="http://thinkr.fr/pdf/ggplot2-french-cheatsheet.pdf" class="uri">http://thinkr.fr/pdf/ggplot2-french-cheatsheet.pdf</a>.</p>
<p><code class="pkg">ggplot2</code> reposant sur une syntaxe additive, la syntaxe de base d’un graphique sera donc de la forme :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(data) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> Var1, <span class="dt">fill =</span> Var2) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>()</code></pre></div>
<p>De manière alternative, on peut également indiquer la correspondance entre variables et esthétiques comme deuxième argument de la fonction <code data-pkg="ggplot2">ggplot</code>. Les deux syntaxes sont équivalentes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> Var1, <span class="dt">fill =</span> Var2)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>()</code></pre></div>
<p>Il est ensuite possible de personnaliser de nombreux éléments d’un graphique et notamment :</p>
<ul>
<li>les <em>étiquettes</em> ou <em>labs</em> (titre, axes, légendes) avec <code data-pkg="ggplot2" data-rdoc="labs">ggtitle</code>, <code data-pkg="ggplot2" data-rdoc="labs">xlab</code>, <code data-pkg="ggplot2" data-rdoc="labs">ylab</code> ou encore la fonction plus générique <code data-pkg="ggplot2">labs</code> ;</li>
<li>les <em>échelles</em> (<em>scales</em>) des différentes esthétiques avec les fonctions commençant par <code>scale_</code> ;</li>
<li>les <em>facettes</em> (<em>facets</em>) avec les fonctions commençant par <code>facet_</code> ;</li>
<li>le système de <em>coordonnées</em> avec les fonctions commençant par <code>coord_</code> ;</li>
<li>la <em>légende</em> (<em>guides</em>) avec les fonctions commençant par <code>guide_</code> ;</li>
<li>le <em>thème</em> du graphiques (mise en forme des différents éléments) avec <code data-pkg="ggplot2">theme</code>.</li>
</ul>
<p>Ces différents éléments seront abordés plus en détails dans le <a href="#ggplot2-la-grammaire-des-graphiques">chapitre avancé sur ggplot2</a>. Dans la suite de ce chapitre, nous nous focaliserons sur les graphiques et options de base.</p>
<p>Préparons les données des exemples et chargeons <code class="pkg">ggplot2</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">library</span>(ggplot2)
<span class="kw">data</span>(<span class="st">"hdv2003"</span>)
d &lt;-<span class="st"> </span>hdv2003</code></pre></div>
</div>
<div id="graphiques-bivaries-ggplot2_histogramme" class="section level2">
<h2>Histogramme</h2>
<p>Pour un <dfn>histogramme</dfn>, on aura recours à la géométrie <code data-pkg="ggplot2" data-rdoc="geom_freqpoly">geom_histogram</code>. Si l’on a une observation par ligne dans le fichier de données, l’histogramme s’obtient simplement en associant la variable d’intérêt à l’esthétique <code>x</code>. Notez la syntaxe de <code data-pkg="ggplot2">aes</code> : le nom des variables est indiqué directement, sans guillemets.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> heures.tv) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">"Nombres d'heures passées devant la télévision"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Heures"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Effectifs"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-4-1.png" width="1050"><figcaption>
Un histogramme
</figcaption></figure><p>On peut personnaliser la couleur de remplissage des rectangles en indiduant une valeur fixe pour l’esthétique <code>fill</code> dans l’appel de <code data-pkg="ggplot2" data-rdoc="geom_freqpoly">geom_histogram</code> (et non via la fonction <code data-pkg="ggplot2">aes</code> puisqu’il ne s’agit pas d’une variable du tableau de données). L’esthétique <code>colour</code> permet de spécifier la couleur du trait des rectangles. Enfin, le paramètre <code>binwidth</code> permet de spécifier la largeur des barres.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> heures.tv) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">fill =</span> <span class="st">"orange"</span>, 
  <span class="dt">colour =</span> <span class="st">"black"</span>, <span class="dt">binwidth =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">"Nombres d'heures passées devant la télévision"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Heures"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Effectifs"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-5-1.png" width="1050"><figcaption>
Un histogramme en couleur
</figcaption></figure><p>Comme avec la fonction <code data-pkg="graphics">hist</code>, on peut personnaliser les classes avec l’argument <code>breaks</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> heures.tv) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">fill =</span> <span class="st">"orange"</span>, 
  <span class="dt">colour =</span> <span class="st">"black"</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">12</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">"Nombres d'heures passées devant la télévision"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Heures"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Effectifs"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-6-1.png" width="1050"><figcaption>
Un histogramme avec classes personnalisées
</figcaption></figure><p>On peut ajouter à l’axe des x des tirets représentant la position des observations à l’aide de <code data-pkg="ggplot2">geom_rug</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> heures.tv) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">fill =</span> <span class="st">"orange"</span>, 
  <span class="dt">colour =</span> <span class="st">"black"</span>, <span class="dt">binwidth =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_rug</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">"Nombres d'heures passées devant la télévision"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Heures"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Effectifs"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-7-1.png" width="1050"><figcaption>
Un histogramme avec geom_rug()
</figcaption></figure>
</div>
<div id="graphiques-bivaries-ggplot2_densite-et-repartition-cumulee" class="section level2">
<h2>Densité et répartition cumulée</h2>
<p>Une <dfn>courbe de densité</dfn><dfn data-index="densité, courbe de"></dfn> s’obtient aisément avec la géométrie <code data-pkg="ggplot2">geom_density</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> heures.tv) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">"Nombres d'heures passées devant la télévision"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Heures"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Densité"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-8-1.png" width="1050"><figcaption>
Courbe de densité
</figcaption></figure><p>On peut personnaliser la fenêtre d’ajustement avec l’argument <code>adjust</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> heures.tv) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">adjust =</span> <span class="fl">1.5</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">"Nombres d'heures passées devant la télévision"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Heures"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Densité"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-9-1.png" width="1050"><figcaption>
Courbe de densité avec fenêtre d’ajustement personnalisée
</figcaption></figure><p>Pour la <dfn>fonction de répartition empirique</dfn><dfn data-index="répartition empirique, fonction"></dfn> ou <dfn lang="en">empirical cumulative distribution function</dfn> en anglais, on utilisera la statistique <code data-pkg="ggplot2">stat_ecdf</code>. Au passage, on notera qu’il est possible d’ajouter une <em>couche</em> à un graphique en appelant soit une <em>géométrie</em>, soit une <em>statistique</em>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> heures.tv) <span class="op">+</span><span class="st"> </span><span class="kw">stat_ecdf</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">"Heures"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">"Fonction de répartition cumulée"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-10-1.png" width="1050"><figcaption>
Fonction de répartition empirique cumulée
</figcaption></figure>
</div>
<div id="graphiques-bivaries-ggplot2_boites-a-moustaches-et-representations-associees" class="section level2">
<h2>Boîtes à moustaches (et représentations associées)</h2>
<p>La géométrie <code data-pkg="ggplot2">geom_boxplot</code> nécessite <em>a minima</em> deux esthétiques : <code>x</code> et <code>y</code>. Pour représenter une variable quantitative selon une variable catégorielle, on fera donc :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> hard.rock, <span class="dt">y =</span> age) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Ecoute du hard rock"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Âge"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">"Répartition par âge selon que l'on écoute du hard rock ou non"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-11-1.png" width="1050"><figcaption>
Boîtes à moustache
</figcaption></figure><p>Lorsque l’on souhaite représenter une seule variable quantitative (statistique univariée), on passera alors une constante à l’esthétique <code>x</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">"Nombre d'heures passées devant la télévision"</span>, 
  <span class="dt">y =</span> heures.tv) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">""</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Heures quotidiennes"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-12-1.png" width="1050"><figcaption>
Boîte à moustache (une seule variable)
</figcaption></figure><p>Une représentation alternative aux <dfn data-index="boîte à moustaches">boîtes à moustaches</dfn><dfn data-index="moustaches, boîte"></dfn> ou <dfn data-index="boxplot" lang="en">boxplots</dfn> sont les <dfn data-index="graphique en violon">graphiques en violon</dfn><dfn data-index="violon, graphique en"> ou <dfn data-index="violin plot" lang="en">violin plots</dfn>, qui représentent la densité de distribution. Ils s’obtiennent avec la géométrie <code data-pkg="ggplot2">geom_violin</code>.</dfn></p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> hard.rock, <span class="dt">y =</span> age) <span class="op">+</span><span class="st"> </span><span class="kw">geom_violin</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Ecoute du hard rock"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Âge"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">"Répartition par âge selon que l'on écoute du hard rock ou non"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-13-1.png" width="1050"><figcaption>
Graphiques en violon ou “violin plot”
</figcaption></figure>
</div>
<div id="graphiques-bivaries-ggplot2_diagramme-en-batons" class="section level2">
<h2>Diagramme en bâtons</h2>
<p>Un <dfn>diagramme en bâtons</dfn><dfn data-index="bâtons, diagramme en"></dfn> s’obtient avec la géométrie <code data-pkg="ggplot2">geom_bar</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> freres.soeurs) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">"Nombre de frères et soeurs"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">"Effectifs"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-14-1.png" width="1050"><figcaption>
Diagramme en bâtons
</figcaption></figure><p>La largeur des barres par défaut est de 0,9. Dès lors, le graphique ressemble plus à un histogramme qu’à un diagramme en bâtons. On peut personnaliser ce paramètre avec l’argument <code>width</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> freres.soeurs) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Nombre de frères et soeurs"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Effectifs"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-15-1.png" width="1050"><figcaption>
Diagramme en bâtons avec ajustement de la largeur des barres
</figcaption></figure>
</div>
<div id="graphiques-bivaries-ggplot2_nuage-de-points" class="section level2">
<h2>Nuage de points</h2>
<p>Un <dfn>nuage de points</dfn><dfn data-index="points, nuage de"></dfn> se représente facilement avec la géométrie <code data-pkg="ggplot2">geom_point</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> heures.tv) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Âge"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Heures quotidiennes de télévision"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-16-1.png" width="1050"><figcaption>
Nuage de points
</figcaption></figure><p>On pourra personnaliser la couleur des points avec <code>colour</code> et le niveau de transparence avec <code>alpha</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> heures.tv) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">colour =</span> <span class="st">"red"</span>, 
  <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">"Âge"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Heures quotidiennes de télévision"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-17-1.png" width="1050"><figcaption>
Nuage de points semi-transparents
</figcaption></figure><p>Pour représenter une troisième variable quantitative, on pourra faire varier la taille des points avec l’esthétique <code>size</code>. Pour une variable qualitative, on pourra faire varier la couleur avec <code>colour</code>. Pour faciliter la lecture, on positionnera la légende en bas du graphique, en modifiant l’argument <code>legend.position</code> via la fonction <code data-pkg="ggplot2">theme</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"rp99"</span>)
rp99<span class="op">$</span>prop.proprio &lt;-<span class="st"> </span><span class="dv">0</span>
rp99[rp99<span class="op">$</span>proprio <span class="op">&gt;=</span><span class="st"> </span><span class="kw">mean</span>(rp99<span class="op">$</span>proprio), ]<span class="op">$</span>prop.proprio &lt;-<span class="st"> </span><span class="dv">1</span>
rp99<span class="op">$</span>prop.proprio &lt;-<span class="st"> </span><span class="kw">factor</span>(rp99<span class="op">$</span>prop.proprio, <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, 
  <span class="kw">c</span>(<span class="st">"non"</span>, <span class="st">"oui"</span>))
<span class="kw">ggplot</span>(rp99) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> dipl.aucun, <span class="dt">y =</span> tx.chom, <span class="dt">size =</span> pop.tot, 
  <span class="dt">colour =</span> prop.proprio) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"% sans diplôme"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Taux de chômage"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">size =</span> <span class="st">"Population totale"</span>, <span class="dt">colour =</span> <span class="st">"Proportion de propriétaires supérieure à la moyenne"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-18-1.png" width="1050"><figcaption>
Nuage de points proportionnels
</figcaption></figure><p><code data-pkg="ggplot2">geom_smooth</code> permets d’ajouter au graphique une moyenne mobile du nuage de points avec son intervalle de confiance. Notez que l’on ajoute <code data-pkg="ggplot2">geom_smooth</code> au graphique avant <code data-pkg="ggplot2">geom_point</code> puisque l’ordre dans lequel sont affichées les différentes couches du graphique dépend de l’ordre dans lequel elles ont été ajoutées. Dans cet exemple, nous souhaitons afficher les points <q>au-dessus</q> de la moyenne mobile.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(rp99) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> dipl.sup, <span class="dt">y =</span> cadres) <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">"% de diplômés du supérieur"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">"% de cadres"</span>)</code></pre></div>
<pre><code>`geom_smooth()` using method = 'loess' and formula 'y ~ x'</code></pre>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-19-1.png" width="1050"><figcaption>
Nuage de points avec moyenne mobile
</figcaption></figure><p>Si l’on préfère afficher plutôt la <dfn>droite de régression</dfn><dfn data-index="régression, droite">, on indiquera à <code data-pkg="ggplot2">geom_smooth</code> l’agument <code>method = "lm"</code>.</dfn></p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(rp99) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> dipl.sup, <span class="dt">y =</span> cadres) <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">"lm"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">"% de diplômés du supérieur"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">"% de cadres"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-20-1.png" width="1050"><figcaption>
Nuage de points avec droite de régression linéaire
</figcaption></figure>
</div>
<div id="graphiques-bivaries-ggplot2_matrice-de-nuages-de-points-et-matrice-de-correlation" class="section level2">
<h2>Matrice de nuages de points et matrice de corrélation</h2>
<p><code class="pkg">ggplot2</code> ne fournit pas de fonction native pour la réalisation d’une matrice de nuages de points. Cependant, il existe plusieurs extensions permettant d’étendre <code class="pkg">ggplot2</code>. Parmi celles-ci, l’extension <code class="pkg">GGally</code> propose une fonction <code data-pkg="GGally">ggpairs</code> correspondant exactement à notre besoin.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(GGally)
<span class="kw">ggpairs</span>(rp99[, <span class="kw">c</span>(<span class="st">"proprio"</span>, <span class="st">"hlm"</span>, <span class="st">"locataire"</span>, <span class="st">"maison"</span>)])</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-21-1.png" width="1050"><figcaption>
Matrice de nuages de points
</figcaption></figure><p><code data-pkg="GGally">ggpairs</code> accepte même des variables catégorielles ainsi que des esthétiques supplémentaires, offrant ainsi plus de possibilités que la fonction <code data-pkg="graphics">pairs</code><a href="#graphiques-bivaries-ggplot2_fn1" class="footnoteRef" id="graphiques-bivaries-ggplot2_fnref1"><sup>1</sup></a>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggpairs</span>(rp99[, <span class="kw">c</span>(<span class="st">"hlm"</span>, <span class="st">"locataire"</span>, <span class="st">"maison"</span>, <span class="st">"prop.proprio"</span>)], 
  <span class="kw">aes</span>(<span class="dt">colour =</span> prop.proprio))</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-22-1.png" width="1050"><figcaption>
Matrice de nuages de points avec variables catégorielles
</figcaption></figure><p><code class="pkg">GGally</code> propose également une fonction <code data-pkg="GGally">ggcorr</code> permettant d’afficher une <dfn>matrice de corrélation</dfn><dfn data-index="corrélation, matrice de"></dfn> entre variables quantitatives<a href="#graphiques-bivaries-ggplot2_fn2" class="footnoteRef" id="graphiques-bivaries-ggplot2_fnref2"><sup>2</sup></a>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggcorr</span>(rp99)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-23-1.png" width="1050"><figcaption>
Matrice de corrélarion
</figcaption></figure>
</div>
<div id="graphiques-bivaries-ggplot2_estimation-locale-de-densite-et-representations-associees" class="section level2">
<h2>Estimation locale de densité (et représentations associées)</h2>
<p>On peut aisément représenter une <dfn>estimation locale de densité</dfn><dfn data-index="densité, estimation locale"></dfn> avec la géométrie <code data-pkg="ggplot2">geom_density_2d</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> heures.tv) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density_2d</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Âge"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Heures quotidiennes de télévision"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-24-1.png" width="1050"><figcaption>
Estimation locale de densité (contours)
</figcaption></figure><p>Par défaut, le résultat est représenté sous forme de contours. Pour obtenir une représentation avec des polygones, on appelera la statistique <code data-pkg="ggplot2" data-rdoc="geom_density_2d">stat_density_2d</code> en forçant la géométrie.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> heures.tv, <span class="dt">fill =</span> ..level..) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_density_2d</span>(<span class="dt">geom =</span> <span class="st">"polygon"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">"Âge"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">"Heures quotidiennes de télévision"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">"Densité"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-25-1.png" width="1050"><figcaption>
Estimation locale de densité (contours)
</figcaption></figure><p><code class="pkg">ggplot2</code> propose également deux géométries, <code data-pkg="ggplot2">geom_bin2d</code> et <code data-pkg="ggplot2">geom_hex</code>, permettant d’effectuer à un comptage des effectifs en deux dimensions.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> heures.tv) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bin2d</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Âge"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Heures quotidiennes de télévision"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">"Effectifs"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-26-1.png" width="1050"><figcaption>
Effectifs en deux dimensions
</figcaption></figure><figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> heures.tv) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hex</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Âge"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Heures quotidiennes de télévision"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">"Effectifs"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-27-1.png" width="1050"><figcaption>
Effectifs en deux dimensions (hexagones)
</figcaption></figure><div class="note">
<p>Pour reproduire à l’identique l’exemple donné dans le chapitre <a href="#statistique-bivariee_deux-variables-quantitatives">statistique bivariée</a>, on aura besoin de la méthode <code data-pkg="broom" data-rdoc="xyz_tidiers">tidy</code> de l’extension <code class="pkg">broom</code> afin de transformer le résultat de <code data-pkg="MASS">kde2d</code> en un tableau de données exploitables par <code class="pkg">ggplot2</code>. <code data-pkg="broom">tidy</code> est une méthode générique permettant de transformer un grand nombre d’objets (et en particulier les résultats d’un modèle) en un tableau de données exploitable by <code class="pkg">ggplot2</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)
tmp &lt;-<span class="st"> </span>d[, <span class="kw">c</span>(<span class="st">"age"</span>, <span class="st">"heures.tv"</span>)]
tmp &lt;-<span class="st"> </span>tmp[<span class="kw">complete.cases</span>(tmp), ]
<span class="kw">library</span>(broom)
tmp &lt;-<span class="st"> </span><span class="kw">tidy</span>(<span class="kw">kde2d</span>(tmp<span class="op">$</span>age, tmp<span class="op">$</span>heures.tv))
<span class="kw">str</span>(tmp)</code></pre></div>
<pre><code>'data.frame':   625 obs. of  3 variables:
 $ x: num  18 21.3 24.6 27.9 31.2 ...
 $ y: num  0 0 0 0 0 0 0 0 0 0 ...
 $ z: num  0.00147 0.00227 0.0027 0.00291 0.00308 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(tmp) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> z) <span class="op">+</span><span class="st"> </span><span class="kw">geom_raster</span>(<span class="dt">interpolate =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> <span class="kw">terrain.colors</span>(<span class="dv">14</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Âge"</span>, <span class="dt">y =</span> <span class="st">"Heures de TV"</span>, <span class="dt">fill =</span> <span class="st">"Densité"</span>)</code></pre></div>
<p><img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-28-1.png" width="1050"></p>
</div>
</div>
<div id="graphiques-bivaries-ggplot2_diagramme-de-cleveland" class="section level2">
<h2>Diagramme de Cleveland</h2>
<p>Pour un <dfn>diagramme de Cleveland</dfn><dfn data-index="Cleveland, diagramme"></dfn>, on aura recours à la géométrie <code data-pkg="ggplot2">geom_point</code>. Cependant, il faudra lui préciser que l’on souhaite utiliser la statistique <code data-pkg="ggplot2" data-rdoc="geom_bar">stat_count</code> afin que les effectifs soient calculés pour chaque valeur de <code>x</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> clso) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">stat =</span> <span class="st">"count"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Sentiment d'appartenance à une classe sociale"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">"Effectifs"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-29-1.png" width="1050"><figcaption>
Diagramme de Cleveland
</figcaption></figure><p>Une alternative, notamment si l’on souhaite un diagramme de Cleveland ordonné, consiste à calculer les effectifs de chaque modalité en amont. <code class="pkg">ggplot2</code> ayant besoin d’un tableau de données en entrée, nous calculerons notre tableau de fréquences avec <code data-pkg="stats">xtabs</code> et le transformerons en tableau de données avec <code data-pkg="base" data-rdoc="table">as.data.frame</code>. Pour que les niveaux de qualifaction soient représentés selon leur effectif, il est nécessaire d’ordonner les étiquettes du facteur de manière adéquate. Enfin, nous utiliserons <code data-pkg="ggplot2">coord_flip</code> pour intervertir l’axe des <code>x</code> et celui des <code>y</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tab &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">xtabs</span>(<span class="op">~</span>qualif, d))
tab<span class="op">$</span>qualif &lt;-<span class="st"> </span><span class="kw">factor</span>(tab<span class="op">$</span>qualif, <span class="dt">levels =</span> tab<span class="op">$</span>qualif[<span class="kw">order</span>(tab<span class="op">$</span>Freq)])
<span class="kw">str</span>(tab)</code></pre></div>
<pre><code>'data.frame':   7 obs. of  2 variables:
 $ qualif: Factor w/ 7 levels "Autre","Technicien",..: 4 6 2 3 5 7 1
 $ Freq  : int  203 292 86 160 260 594 58</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(tab) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> qualif, <span class="dt">y =</span> Freq) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Niveau de qualification"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Effectifs"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">coord_flip</span>()</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-30-1.png" width="1050"><figcaption>
Diagramme de Cleveland ordonné
</figcaption><div class="note">
<p>L’extension <code class="pkg">ggalt</code> propose quelques géométries supplémentaires pour <code class="pkg">ggplot2</code>. L’une d’elles dite <q>en sucettes</q> (<em>lollipop</em>) propose une représentation graphique au croisement entre un diagramme en bâtons et un diagramme de Cleveland.</p>
<p>Pour cela, il est d’abord nécessaire d’installer la version de développement de <code class="pkg">gglat</code> à l’aide de la commande suivante :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">"hrbrmstr/ggalt"</span>)</code></pre></div>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggalt)
<span class="kw">ggplot</span>(tab) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> qualif, <span class="dt">y =</span> Freq) <span class="op">+</span><span class="st"> </span><span class="kw">geom_lollipop</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Niveau de qualification"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Effectifs"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">coord_flip</span>()</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-32-1.png" width="1050"><figcaption>
Diagramme en “sucettes” (lollipop)
</figcaption></figure>
</div>
</div>
<div id="graphiques-bivaries-ggplot2_diagrammes-en-barres" class="section level2">
<h2>Diagrammes en barres</h2>
<p>Un <dfn>diagramme en barres</dfn><dfn data-index="barres, diagramme en"></dfn> se construit avec la géométrie <code data-pkg="ggplot2">geom_bar</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>qualreg &lt;-<span class="st"> </span><span class="kw">as.character</span>(d<span class="op">$</span>qualif)
d<span class="op">$</span>qualreg[d<span class="op">$</span>qualif <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"Ouvrier specialise"</span>, <span class="st">"Ouvrier qualifie"</span>)] &lt;-<span class="st"> "Ouvrier"</span>
d<span class="op">$</span>qualreg[d<span class="op">$</span>qualif <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"Profession intermediaire"</span>, 
  <span class="st">"Technicien"</span>)] &lt;-<span class="st"> "Intermediaire"</span>
<span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> qualreg, <span class="dt">fill =</span> sport) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"CSP"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Effectifs"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">"Pratique du sport"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-33-1.png" width="1050"><figcaption>
Diagramme en barres
</figcaption></figure><p>On peut modifier la position des barres avec le paramètre <code>position</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> qualreg, <span class="dt">fill =</span> sport) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">"dodge"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"CSP"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Effectifs"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">"Pratique du sport"</span>)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-34-1.png" width="1050"><figcaption>
Diagramme en barres côte à côte
</figcaption></figure><p>Pour des barres cumulées, on aura recours à <code>position = "fill"</code>. Pour que les étiquettes de l’axe des <code>y</code> soient représentées sous forme de pourcentages (i.e. <code>25%</code> au lieu de <code>0.25</code>), on aura recours à la fonction <code data-pkg="scales" data-rdoc="percent_format">percent</code> de l’extension <code class="pkg">scales</code>, qui sera transmise à <code class="pkg">ggplot2</code> via <code data-pkg="ggplot2" data-rdoc="scale_continuous">scale_y_continuous</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(scales)
<span class="kw">ggplot</span>(d) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> qualreg, <span class="dt">fill =</span> sport) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">"fill"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"CSP"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Proportion"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">"Pratique du sport"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> percent)</code></pre></div>
<img src="graphs/graphiques-bivaries-ggplot2/unnamed-chunk-35-1.png" width="1050"><figcaption>
Diagramme en barres cumulées
</figcaption></figure>
</div>
<div id="graphiques-bivaries-ggplot2_graphe-en-mosaique" class="section level2">
<h2>Graphe en mosaïque</h2>
<p>Il n’y a pas, à ce jour, d’implémentation officielle des <dfn data-index="graphique en mosaïque">graphiques en mosaïque</dfn><dfn data-index="mosaïque, graphique"></dfn> sous <code class="pkg">ggplot2</code>. On pourra néanmoins se référer à l’extension expérimentale <code class="pkg">productplots</code><a href="#graphiques-bivaries-ggplot2_fn3" class="footnoteRef" id="graphiques-bivaries-ggplot2_fnref3"><sup>3</sup></a> développée par Hadley Wickham.</p>
</div>
<div id="graphiques-bivaries-ggplot2_donnees-labellisees-et-ggplot2" class="section level2">
<h2>Données labellisées et ggplot2</h2>
<p><code class="pkg">ggplot2</code> tient compte du type des variables, attendant à ce que les variables catégorielles soient présentées sous forme de facteurs. Si l’on utilise des données labellisées (voir le <a href="#facteurs-et-vecteurs-labellises_labelled">chapitre dédié</a>), nos variables catégorielles seront stockées sous la forme d’un vecteur numérique avec des étiquettes. Il sera donc nécessaire de convertir ces variables en facteurs, tout simplement avec la fonction <code data-pkg="labelled">to_factor</code> de l’extension <code class="pkg">labelled</code> qui pourra utiliser les étiquettes de valeurs comme modalités du facteur.</p>
</div>
<div id="graphiques-bivaries-ggplot2_exporter-les-graphiques-obtenus" class="section level2">
<h2>Exporter les graphiques obtenus</h2>
<p>Les graphiques produits par <code class="pkg">ggplot2</code> peuvent être sauvegardés manuellement, comme expliqué dans le chapitre <q><a href="#export-de-graphiques">Export des graphiques</a></q>, ou programmatiquement. Pour sauvegarder le dernier graphique affiché par <code class="pkg">ggplot2</code> au format PNG, il suffit d’utiliser la fonction <code data-pkg="ggplot2" data-rdoc="ggsave">ggsave</code>, qui permet d’en régler la taille (en pouces) et la résolution (en pixels par pouce ; 72 par défaut) :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsave</span>(<span class="st">"mon_graphique.png"</span>, <span class="dt">width =</span> <span class="dv">11</span>, <span class="dt">height =</span> <span class="dv">8</span>)</code></pre></div>
<p>De la même manière, pour sauvegarder n’importe quel graphique construit avec <code class="pkg">ggplot2</code> et stocké dans un objet, il suffit de préciser le nom de cet objet, comme ci-dessous, où l’on sauvegarde le graphique contenu dans l’objet <code>p</code> au format vectoriel PDF, qui préserve la netteté du texte et des autres éléments du graphique à n’importe quelle résolution d’affichage :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsave</span>(<span class="st">"mon_graphique.pdf"</span>, <span class="dt">plot =</span> p,
       <span class="dt">width =</span> <span class="dv">11</span>, <span class="dt">height =</span> <span class="dv">8</span>)</code></pre></div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="graphiques-bivaries-ggplot2_fn1"><p>Pour plus de détails, on pourra lire <a href="https://tgmstat.wordpress.com/2013/11/13/plot-matrix-with-the-r-package-ggally/" class="uri">https://tgmstat.wordpress.com/2013/11/13/plot-matrix-with-the-r-package-ggally/</a>.<a href="#graphiques-bivaries-ggplot2_fnref1"><U+21A9></a></p></li>
<li id="graphiques-bivaries-ggplot2_fn2"><p>Pour une présentation détaillée de cette fonction et de ses options, voir <a href="https://briatte.github.io/ggcorr/" class="uri">https://briatte.github.io/ggcorr/</a>.<a href="#graphiques-bivaries-ggplot2_fnref2"><U+21A9></a></p></li>
<li id="graphiques-bivaries-ggplot2_fn3"><p>Voir <a href="https://github.com/hadley/productplots" class="uri">https://github.com/hadley/productplots</a> et <a href="http://vita.had.co.nz/papers/prodplots.html" class="uri">http://vita.had.co.nz/papers/prodplots.html</a>.<a href="#graphiques-bivaries-ggplot2_fnref3"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="donnees-ponderees"><div class="fluid-row" id="donnees-ponderees_header">



<h1 class="title toc-ignore">Données pondérées</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#donnees-ponderees_options-de-certaines-fonctions">Options de certaines fonctions</a></li>
<li><a href="#donnees-ponderees_fonctions-de-lextension-questionr">Fonctions de l’extension questionr</a></li>
<li>
<a href="#donnees-ponderees_survey">Données pondérées avec l’extension survey</a><ul>
<li><a href="#donnees-ponderees_extraire-un-sous-echantillon">Extraire un sous-échantillon</a></li>
</ul>
</li>
<li><a href="#donnees-ponderees_conclusion">Conclusion</a></li>
</ul>
</div>

<div class="note">
<p>La version originale de ce chapitre a été écrite par Julien Barnier dans le cadre du support de cours <a href="https://github.com/juba/intro-r">Introduction à R</a>, complétée par Joseph Larmarange dans <a href="https://github.com/larmarange/intro-r/tree/CoursM2">Introduction à l’analyse d’enquêtes avec R</a>.</p>
</div>
<p>S’il est tout à fait possible de travailler avec des <dfn>données pondérées</dfn> sous R, cette fonctionnalité n’est pas aussi bien intégrée que dans la plupart des autres logiciels de traitement statistique. En particulier, il y a plusieurs manières possibles de gérer la <dfn>pondération</dfn>. Cependant, lorsque l’on doit également prendre un compte un <dfn>plan d’échantillonnage</dfn><dfn data-index="échantillonnage, plan"></dfn> complexe (voir section dédiée ci-après), <strong>R</strong> fournit tous les outils nécessaires, alors que dans la plupart des logiciels propriétaires, il faut disposer d’une extension adéquate, pas toujours vendue de base avec le logiciel.</p>
<p>Dans ce qui suit, on utilisera le jeu de données tiré de l’enquête <em>Histoire de vie</em> et notamment sa variable de pondération <em>poids</em><a href="#donnees-ponderees_fn1" class="footnoteRef" id="donnees-ponderees_fnref1"><sup>1</sup></a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">data</span>(hdv2003)
d &lt;-<span class="st"> </span>hdv2003
<span class="kw">range</span>(d<span class="op">$</span>poids)</code></pre></div>
<pre><code>[1]    78.07834 31092.14132</code></pre>
<div id="donnees-ponderees_options-de-certaines-fonctions" class="section level2">
<h2>Options de certaines fonctions</h2>
<p>Tout d’abord, certaines fonctions de <strong>R</strong> acceptent en argument un vecteur permettant de pondérer les observations (l’option est en général nommée <code>weights</code> ou <code>row.w</code>). C’est le cas par exemple des méthodes d’estimation de modèles linéaires<a href="#donnees-ponderees_fn2" class="footnoteRef" id="donnees-ponderees_fnref2"><sup>2</sup></a> (<code data-pkg="stats">lm</code>) ou de modèles linéaires généralisés <a href="#donnees-ponderees_fn3" class="footnoteRef" id="donnees-ponderees_fnref3"><sup>3</sup></a> (<code data-pkg="stats">glm</code>) ou dans les analyses de correspondances<a href="#donnees-ponderees_fn4" class="footnoteRef" id="donnees-ponderees_fnref4"><sup>4</sup></a> des extensions <code class="pkg">ade4</code> ou <code class="pkg">FactoMineR</code>.</p>
<p>Par contre cette option n’est pas présente dans les fonctions de base comme <code data-pkg="base">mean</code>, <code data-pkg="base" data-rdoc="cor">var</code>, <code data-pkg="base">table</code> ou <code data-pkg="stats">chisq.test</code>.</p>
</div>
<div id="donnees-ponderees_fonctions-de-lextension-questionr" class="section level2">
<h2>Fonctions de l’extension questionr</h2>
<p>L’extension <code class="pkg">questionr</code> propose quelques fonctions permettant de calculer des statistiques simples pondérées<a href="#donnees-ponderees_fn5" class="footnoteRef" id="donnees-ponderees_fnref5"><sup>5</sup></a> :</p>
<ul>
<li>
<code data-pkg="questionr">wtd.mean</code> : moyenne pondérée</li>
<li>
<code data-pkg="questionr" data-rdoc="wtd.mean">wtd.var</code> : variance pondérée</li>
<li>
<code data-pkg="questionr">wtd.table</code> : tris à plat et tris croisés pondérés</li>
</ul>
<p>On les utilise de la manière suivante :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">mean</span>(d<span class="op">$</span>age)</code></pre></div>
<pre><code>[1] 48.157</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wtd.mean</span>(d<span class="op">$</span>age, <span class="dt">weights =</span> d<span class="op">$</span>poids)</code></pre></div>
<pre><code>[1] 46.34726</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wtd.var</span>(d<span class="op">$</span>age, <span class="dt">weights =</span> d<span class="op">$</span>poids)</code></pre></div>
<pre><code>[1] 325.2658</code></pre>
<p>Pour les tris à plat, on utilise la fonction wtd.table à laquelle on passe la variable en paramètre :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wtd.table</span>(d<span class="op">$</span>sexe, <span class="dt">weights =</span> d<span class="op">$</span>poids)</code></pre></div>
<pre><code>  Homme   Femme 
5149382 5921844 </code></pre>
<p>Pour un tri croisé, il suffit de passer deux variables en paramètres :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wtd.table</span>(d<span class="op">$</span>sexe, d<span class="op">$</span>hard.rock, <span class="dt">weights =</span> d<span class="op">$</span>poids)</code></pre></div>
<pre><code>             Non        Oui
Homme 5109366.41   40016.02
Femme 5872596.42   49247.49</code></pre>
<p>Ces fonctions admettent notamment les deux options suivantes :</p>
<ul>
<li>
<code>na.rm</code> : si <code>TRUE</code>, on ne conserve que les observations sans valeur manquante.</li>
<li>
<code>normwt</code> : si <code>TRUE</code>, on normalise les poids pour que les effectifs totaux pondérés soient les mêmes que les effectifs initiaux. Il faut utiliser cette option, notamment si on souhaite appliquer un test sensible aux effectifs comme le <U+03C7>².</li>
</ul>
<p>Ces fonctions rendent possibles l’utilisation des statistiques descriptives les plus simples et le traitement des tableaux croisés (les fonctions <code data-pkg="questionr" data-rdoc="rprop">lprop</code>, <code data-pkg="questionr">cprop</code> ou <code data-pkg="stats">chisq.test</code> peuvent être appliquées au résultat d’un <code data-pkg="questionr">wtd.table</code>) mais restent limitées en termes de tests statistiques ou de graphiques…</p>
</div>
<div id="donnees-ponderees_survey" class="section level2">
<h2>Données pondérées avec l’extension survey</h2>
<p>L’extension <code class="pkg">survey</code> est spécialement dédiée au traitement d’enquêtes ayant des techniques d’échantillonnage et de pondération potentiellement très complexes.</p>
<p>L’extension s’installe comme la plupart des autres :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"survey"</span>)</code></pre></div>
<p>Le site officiel (en anglais) comporte beaucoup d’informations, mais pas forcément très accessibles : <br><a href="http://r-survey.r-forge.r-project.org/" class="uri">http://r-survey.r-forge.r-project.org/</a>.</p>
<p>Pour utiliser les fonctionnalités de l’extension, on doit d’abord définir le <dfn>plan d’échantillonnage</dfn> ou <dfn lang="en">design</dfn> de notre enquête, c’est-à-dire indiquer quel type de pondération nous souhaitons lui appliquer.</p>
<p>Dans un premier temps, nous utiliserons le plan d’échantillonnage le plus simple, avec une variable de pondération déjà calculée<a href="#donnees-ponderees_fn6" class="footnoteRef" id="donnees-ponderees_fnref6"><sup>6</sup></a>. Ceci se fait à l’aide de la fonction <code data-pkg="survey">svydesign</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(survey)
dw &lt;-<span class="st"> </span><span class="kw">svydesign</span>(<span class="dt">ids =</span> <span class="op">~</span><span class="dv">1</span>, <span class="dt">data =</span> d, <span class="dt">weights =</span> <span class="op">~</span>d<span class="op">$</span>poids)</code></pre></div>
<p>Cette fonction crée un nouvel objet, que nous avons nommé <code>dw</code>. Cet objet n’est pas à proprement parler un tableau de données, mais plutôt un tableau de données plus une méthode de pondération. <code>dw</code> et <code>d</code> sont des objets distincts, les opérations effectuées sur l’un n’ont pas d’influence sur l’autre. On peut cependant retrouver le contenu de <code>d</code> depuis <code>dw</code> en utilisant <code>dw$variables</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(d<span class="op">$</span>age)</code></pre></div>
<pre><code> int [1:2000] 28 23 59 34 71 35 60 47 20 28 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(dw<span class="op">$</span>variables<span class="op">$</span>age)</code></pre></div>
<pre><code> int [1:2000] 28 23 59 34 71 35 60 47 20 28 ...</code></pre>
<p>Lorsque notre plan d’échantillonnage est déclaré, on peut lui appliquer une série de fonctions permettant d’effectuer diverses opérations statistiques en tenant compte de la pondération. On citera notamment :</p>
<ul>
<li>
<code data-pkg="survey" data-rdoc="surveysummary">svymean</code>, <code data-pkg="survey" data-rdoc="surveysummary">svyvar</code>, <code data-pkg="survey" data-rdoc="surveysummary">svytotal</code>, <code data-pkg="survey">svyquantile</code> : <dfn data-index="statistique univariée">statistiques univariées</dfn> <dfn data-index="univariée, statistique"></dfn>(<dfn>moyenne</dfn>, <dfn>variance</dfn>, <dfn>total</dfn>, <dfn data-index="quantile">quantiles</dfn>)</li>
<li>
<code data-pkg="survey">svytable</code> : <dfn>tri à plat</dfn> et <dfn>tableau croisé</dfn>
</li>
<li>
<code data-pkg="survey" data-rdoc="svytable">svychisq</code> : <dfn data-index="test du Chi²">test du <U+03C7>²</dfn> <dfn data-index="Chi², test"></dfn>
</li>
<li>
<code data-pkg="survey">svyby</code> : statistiques selon un facteur</li>
<li>
<code data-pkg="survey">svyttest</code> : <dfn>test t de Student</dfn><dfn data-index="Student, test-t"></dfn> de <dfn>comparaison de moyennes</dfn><dfn data-index="moyenne, comparaison"></dfn>
</li>
<li>
<code data-pkg="survey">svyciprop</code> : <dfn>intervalle de confiance d’une proportion</dfn><dfn data-index="proportion, intervalle de confiance"></dfn>
</li>
<li>
<code data-pkg="survey">svyglm</code> : <dfn data-index="modèle linéaire généralisé">modèles linéaires généralisés</dfn> (dont <dfn>régression logistique</dfn><dfn data-index="logistique, régression"></dfn>)</li>
<li>
<code data-pkg="survey">svyplot</code>, <code data-pkg="survey">svyhist</code>, <code data-pkg="survey" data-rdoc="svyhist">svyboxplot</code> : fonctions graphiques</li>
</ul>
<p>D’autres fonctions sont disponibles, comme <code data-pkg="survey">svyratio</code>, mais elles ne seront pas abordées ici.</p>
<p>Pour ne rien arranger, ces fonctions prennent leurs arguments sous forme de formules<a href="#donnees-ponderees_fn7" class="footnoteRef" id="donnees-ponderees_fnref7"><sup>7</sup></a>, c’est-à-dire pas de la manière habituelle. En général l’appel de fonction se fait en spécifiant d’abord les variables d’intérêt sous forme de formule, puis l’objet <em>survey.design</em>.</p>
<p>Voyons tout de suite quelques exemples<a href="#donnees-ponderees_fn8" class="footnoteRef" id="donnees-ponderees_fnref8"><sup>8</sup></a> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svymean</span>(<span class="op">~</span>age, dw)</code></pre></div>
<pre><code>      mean     SE
age 46.347 0.5284</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svyquantile</span>(<span class="op">~</span>age, dw, <span class="dt">quantile =</span> <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), 
  <span class="dt">ci =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>$quantiles
    0.25 0.5 0.75
age   31  45   60

$CIs
, , age

       0.25 0.5 0.75
(lower   30  43   58
upper)   32  47   62</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svyvar</span>(<span class="op">~</span>heures.tv, dw, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>          variance     SE
heures.tv   2.9886 0.1836</code></pre>
<p>Les tris à plat se déclarent en passant comme argument le nom de la variable précédé d’un tilde (<code>~</code>), tandis que les tableaux croisés utilisent les noms des deux variables séparés par un signe plus (<code>+</code>) et précédés par un tilde (<code>~</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svytable</span>(<span class="op">~</span>sexe, dw)</code></pre></div>
<pre><code>sexe
  Homme   Femme 
5149382 5921844 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svytable</span>(<span class="op">~</span>sexe <span class="op">+</span><span class="st"> </span>clso, dw)</code></pre></div>
<pre><code>       clso
sexe           Oui        Non Ne sait pas
  Homme 2658744.04 2418187.64    72450.75
  Femme 2602031.76 3242389.36    77422.79</code></pre>
<p>La fonction <code data-pkg="questionr">freq</code> peut être utilisée si on lui passe en argument non pas la variable elle-même, mais son tri à plat obtenu avec <code data-pkg="survey">svytable</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tab &lt;-<span class="st"> </span><span class="kw">svytable</span>(<span class="op">~</span>peche.chasse, dw)
<span class="kw">freq</span>(tab, <span class="dt">total =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>             n     %  val%
Non    9716683  87.8  87.8
Oui    1354544  12.2  12.2
Total 11071226 100.0 100.0</code></pre>
<p>On peut également récupérer le tableau issu de <code data-pkg="survey">svytable</code> dans un objet et le réutiliser ensuite comme n’importe quel tableau croisé :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tab &lt;-<span class="st"> </span><span class="kw">svytable</span>(<span class="op">~</span>sexe <span class="op">+</span><span class="st"> </span>clso, dw)
tab</code></pre></div>
<pre><code>       clso
sexe           Oui        Non Ne sait pas
  Homme 2658744.04 2418187.64    72450.75
  Femme 2602031.76 3242389.36    77422.79</code></pre>
<p>Les fonctions <code data-pkg="questionr" data-rdoc="rprop">lprop</code> et <code data-pkg="questionr">cprop</code> de <code class="pkg">questionr</code> sont donc tout à fait compatibles avec l’utilisation de <code class="pkg">survey</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lprop</span>(tab)</code></pre></div>
<pre><code>          clso
sexe       Oui   Non   Ne sait pas Total
  Homme     51.6  47.0   1.4       100.0
  Femme     43.9  54.8   1.3       100.0
  Ensemble  47.5  51.1   1.4       100.0</code></pre>
<p>Le principe de la fonction <code data-pkg="survey">svyby</code> est similaire à celui de <code data-pkg="base">tapply</code><a href="#donnees-ponderees_fn9" class="footnoteRef" id="donnees-ponderees_fnref9"><sup>9</sup></a>. Elle permet de calculer des statistiques selon plusieurs sous-groupes définis par un facteur. Par exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svyby</span>(<span class="op">~</span>age, <span class="op">~</span>sexe, dw, svymean)</code></pre></div>
<pre><code>       sexe      age        se
Homme Homme 45.20200 0.7419450
Femme Femme 47.34313 0.7420836</code></pre>
<p><code class="pkg">survey</code> est également capable de produire des graphiques à partir des données pondérées. Quelques exemples :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
<span class="kw">svyplot</span>(<span class="op">~</span>age <span class="op">+</span><span class="st"> </span>heures.tv, dw, <span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">main =</span> <span class="st">"Bubble plot"</span>)
<span class="kw">svyhist</span>(<span class="op">~</span>heures.tv, dw, <span class="dt">col =</span> <span class="st">"peachpuff"</span>, <span class="dt">main =</span> <span class="st">"Histogramme"</span>)
<span class="kw">svyboxplot</span>(age <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, dw, <span class="dt">main =</span> <span class="st">"Boxplot simple"</span>, <span class="dt">ylab =</span> <span class="st">"Âge"</span>)
<span class="kw">svyboxplot</span>(age <span class="op">~</span><span class="st"> </span>sexe, dw, <span class="dt">main =</span> <span class="st">"Boxplot double"</span>, 
  <span class="dt">ylab =</span> <span class="st">"Âge"</span>, <span class="dt">xlab =</span> <span class="st">"Sexe"</span>)</code></pre></div>
<img src="graphs/donnees-ponderees/unnamed-chunk-14-1.png" width="1050"><figcaption>
Fonctions graphiques de l’extension survey
</figcaption></figure><div id="donnees-ponderees_extraire-un-sous-echantillon" class="section level3">
<h3>Extraire un sous-échantillon</h3>
<p>Si l’on souhaite travailler sur un <dfn>sous-échantillon</dfn> tout en gardant les informations d’échantillonnage, on utilisera la fonction <code data-pkg="survey" data-rdoc="subset.survey.design">subset</code> présentée en détail dans le chapitre <a href="#sous-ensembles">Sous-ensembles</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sous &lt;-<span class="st"> </span><span class="kw">subset</span>(dw, sexe <span class="op">==</span><span class="st"> "Femme"</span> <span class="op">&amp;</span><span class="st"> </span>age <span class="op">&gt;=</span><span class="st"> </span><span class="dv">40</span>)</code></pre></div>
</div>
</div>
<div id="donnees-ponderees_conclusion" class="section level2">
<h2>Conclusion</h2>
<p>Si, la gestion de la pondération sous <strong>R</strong> n’est sans doute pas ce qui se fait de plus pratique et de plus simple, on pourra quand même donner les conseils suivants :</p>
<ul>
<li>utiliser les options de pondération des fonctions usuelles ou les fonctions d’extensions comme <code class="pkg">questionr</code> pour les cas les plus simples ;</li>
<li>si on utilise <code class="pkg">survey</code>, effectuer autant que possible tous les recodages et manipulations sur les données non pondérées ;</li>
<li>une fois les recodages effectués, on déclare le design et on fait les analyses en tenant compte de la pondération ;</li>
<li>surtout ne jamais modifier les variables du design. Toujours effectuer recodages et manipulations sur les données non pondérées, puis redéclarer le design pour que les mises à jour effectuées soient disponibles pour l’analyse.</li>
</ul>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="donnees-ponderees_fn1"><p>On notera que cette variable est utilisée à titre purement illustratif. Le jeu de données étant un extrait d’enquête et la variable de pondération n’ayant pas été recalculée, elle n’a ici à proprement parler aucun sens.<a href="#donnees-ponderees_fnref1"><U+21A9></a></p></li>
<li id="donnees-ponderees_fn2"><p>Voir le chapitre <a href="#regression-lineaire">régression linéaire</a>.<a href="#donnees-ponderees_fnref2"><U+21A9></a></p></li>
<li id="donnees-ponderees_fn3"><p>Voir le chapitre sur la <a href="#regression-logistique">régression logistique</a>.<a href="#donnees-ponderees_fnref3"><U+21A9></a></p></li>
<li id="donnees-ponderees_fn4"><p>Voir le chapitre dédié à l’<a href="#analyse-des-correspondances-multiples">analyse des correspondances</a>.<a href="#donnees-ponderees_fnref4"><U+21A9></a></p></li>
<li id="donnees-ponderees_fn5"><p>Les fonctions <code data-pkg="questionr">wtd.mean</code> et <code data-pkg="questionr" data-rdoc="wtd.mean">wtd.var</code> sont des copies conformes des fonctions du même nom de l’extension <code class="pkg">Hmisc</code> de Frank Harrel. <code class="pkg">Hmisc</code> étant une extension « de taille », on a préféré recopié les fonctions pour limiter le poids des dépendances.<a href="#donnees-ponderees_fnref5"><U+21A9></a></p></li>
<li id="donnees-ponderees_fn6"><p>Pour d’autres types de plan d’échantillonnage, voir la chapitre sur les <a href="#definir-un-plan-d-echantillonnage-complexe">plans d’échantillonnage complexes</a>.<a href="#donnees-ponderees_fnref6"><U+21A9></a></p></li>
<li id="donnees-ponderees_fn7"><p>Pour plus de détails sur les formules, voir le <a href="#formules">chapitre dédié</a>.<a href="#donnees-ponderees_fnref7"><U+21A9></a></p></li>
<li id="donnees-ponderees_fn8"><p>Pour d’autres exemples, voir <a href="http://www.ats.ucla.edu/stat/r/faq/svy_r_oscluster.htm" class="uri">http://www.ats.ucla.edu/stat/r/faq/svy_r_oscluster.htm</a> (en anglais).<a href="#donnees-ponderees_fnref8"><U+21A9></a></p></li>
<li id="donnees-ponderees_fn9"><p>La fonction <code data-pkg="base">tapply</code> est présentée plus en détails dans le chapitre <a href="pem_manipulation.html#tapply">Manipulation de données</a>.<a href="#donnees-ponderees_fnref9"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="graphiques-de-donnees-ponderees"><div class="fluid-row" id="graphiques-de-donnees-ponderees_header">



<h1 class="title toc-ignore">Graphiques de données pondéres</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="intervalles-de-confiance"><div class="fluid-row" id="intervalles-de-confiance_header">



<h1 class="title toc-ignore">Intervalles de confiance</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#intervalles-de-confiance_ic_moyenne">Intervalle de confiance d’une moyenne</a></li>
<li><a href="#intervalles-de-confiance_ic_proportion">Intervalle de confiance d’une proportion</a></li>
<li><a href="#intervalles-de-confiance_survey">Données pondérées et l’extension survey</a></li>
</ul>
</div>

<p>Nous utiliserons dans ce chapitre les données de l’enquête <em>Histoire de vie 2003</em> fournies avec l’extension <code class="pkg">questionr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">data</span>(<span class="st">"hdv2003"</span>)
d &lt;-<span class="st"> </span>hdv2003</code></pre></div>
<div id="intervalles-de-confiance_ic_moyenne" class="section level2">
<h2>Intervalle de confiance d’une moyenne</h2>
<p>L’<dfn>intervalle de confiance d’une moyenne</dfn><dfn data-index="moyenne, intervalle de confiance"></dfn><dfn data-index="intervalle de confiance"></dfn> peut être calculé avec la fonction <code data-pkg="stats">t.test</code> (fonction qui permet également de réaliser un test <em>t</em> de Student comme nous le verrons dans le chapitre dédié aux <a href="#comparaisons-moyennes-et-proportions">comparaisons de moyennes</a>) :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(d<span class="op">$</span>heures.tv)</code></pre></div>
<pre><code>
    One Sample t-test

data:  d$heures.tv
t = 56.505, df = 1994, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 2.168593 2.324540
sample estimates:
mean of x 
 2.246566 </code></pre>
<p>Le niveau de confiance peut être précisé via l’argument <code>conf.level</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(d<span class="op">$</span>heures.tv, <span class="dt">conf.level =</span> <span class="fl">0.9</span>)</code></pre></div>
<pre><code>
    One Sample t-test

data:  d$heures.tv
t = 56.505, df = 1994, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 0
90 percent confidence interval:
 2.181138 2.311995
sample estimates:
mean of x 
 2.246566 </code></pre>
<p>Le nombre d’heures moyennes à regarder la télévision parmi les enquêtés s’avère être de 2,2 heures, avec un intervalle de confiance à 95 % de [2,17 - 2,33] et un intervalle de confiance à 90 % de [2,18 - 2,31].</p>
</div>
<div id="intervalles-de-confiance_ic_proportion" class="section level2">
<h2>Intervalle de confiance d’une proportion</h2>
<p>La fonction <code data-pkg="stats">prop.test</code> permet de calculer l’<dfn>intervalle de confiance d’une proportion</dfn><dfn data-index="proportion, intervalle de confiance"></dfn><dfn data-index="intervalle de confiance"></dfn>. Une première possibilité consiste à lui transmettre une table à une dimension et deux entrées. Par exemple, si l’on s’intéresse à la proportion de personnes ayant pratiqué une activité physique au cours des douze derniers mois :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">freq</span>(d<span class="op">$</span>sport)</code></pre></div>
<pre><code>       n    % val%
Non 1277 63.8 63.8
Oui  723 36.1 36.1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.test</span>(<span class="kw">table</span>(d<span class="op">$</span>sport))</code></pre></div>
<pre><code>
    1-sample proportions test with continuity
    correction

data:  table(d$sport), null probability 0.5
X-squared = 152.9, df = 1, p-value &lt; 2.2e-16
alternative hypothesis: true p is not equal to 0.5
95 percent confidence interval:
 0.6169447 0.6595179
sample estimates:
     p 
0.6385 </code></pre>
<p>On remarquera que la fonction a calculé l’intervalle de confiance correspondant à la première entrée du tableau, autrement dit celui de la proportion d’enquêtés n’ayant pas pratiqué une activité sportive. Or, nous sommes intéressé par la proportion complémentaire, à savoir celle d’enquêtés ayant pratiqué une activité sportive. On peut dès lors modifier l’ordre de la table en indiquant notre modalité d’intérêt avec la fonction <code data-pkg="stats">relevel</code> ou bien indiquer à <code data-pkg="stats">prop.test</code> d’abord le nombre de succès puis l’effectif total :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.test</span>(<span class="kw">table</span>(<span class="kw">relevel</span>(d<span class="op">$</span>sport, <span class="st">"Oui"</span>)))</code></pre></div>
<pre><code>
    1-sample proportions test with continuity
    correction

data:  table(relevel(d$sport, "Oui")), null probability 0.5
X-squared = 152.9, df = 1, p-value &lt; 2.2e-16
alternative hypothesis: true p is not equal to 0.5
95 percent confidence interval:
 0.3404821 0.3830553
sample estimates:
     p 
0.3615 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.test</span>(<span class="kw">sum</span>(d<span class="op">$</span>sport <span class="op">==</span><span class="st"> "Oui"</span>), <span class="kw">length</span>(d<span class="op">$</span>sport))</code></pre></div>
<pre><code>
    1-sample proportions test with continuity
    correction

data:  sum(d$sport == "Oui") out of length(d$sport), null probability 0.5
X-squared = 152.9, df = 1, p-value &lt; 2.2e-16
alternative hypothesis: true p is not equal to 0.5
95 percent confidence interval:
 0.3404821 0.3830553
sample estimates:
     p 
0.3615 </code></pre>
<p>Enfin, le niveau de confiance peut être modifié via l’argument <code>conf.level</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.test</span>(<span class="kw">table</span>(<span class="kw">relevel</span>(d<span class="op">$</span>sport, <span class="st">"Oui"</span>)), <span class="dt">conf.level =</span> <span class="fl">0.9</span>)</code></pre></div>
<pre><code>
    1-sample proportions test with continuity
    correction

data:  table(relevel(d$sport, "Oui")), null probability 0.5
X-squared = 152.9, df = 1, p-value &lt; 2.2e-16
alternative hypothesis: true p is not equal to 0.5
90 percent confidence interval:
 0.3437806 0.3795989
sample estimates:
     p 
0.3615 </code></pre>
<div class="note">
<p>Il existe de nombreuses manières de calculer un intervalle de confiance pour une proportion. En l’occurence, l’intervalle calculé par <code data-pkg="stats">prop.test</code> correspond dans le cas présent à un intervalle bilatéral selon la méthode des scores de Wilson avec correction de continuité. Pour plus d’information, on pourra lire <a href="http://joseph.larmarange.net/?Intervalle-de-confiance-bilateral" class="uri">http://joseph.larmarange.net/?Intervalle-de-confiance-bilateral</a>.</p>
</div>
<div class="note">
<p>Pour se simplifier un peu la vie, le package <code class="pkg">JLutils</code> propose une fonction <code data-pkg="JLutils">prop.ci</code> (et ses deux variantes <code data-pkg="JLutils">prop.ci.lower</code> et <code data-pkg="JLutils">prop.ci.upper</code>) permettant d’appeler plus facilement <code data-pkg="stats">prop.test</code> et renvoyant directement l’intervalle de confiance.</p>
<p><code class="pkg">JLutils</code> n’étant disponible que sur <a href="https://github.com/larmarange/JLutils">GitHub</a>, on aura recours au package <code class="pkg">devtools</code> et à sa fonction <code data-pkg="devtools">install_github</code> pour l’installer :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools)
<span class="kw">install_github</span>(<span class="st">"larmarange/JLutils"</span>)</code></pre></div>
<p><code data-pkg="JLutils">prop.ci</code> fonction accepte directement un tri à plat obtenu avec <code data-pkg="base">table</code>, un vecteur de données, un vecteur logique (issu d’une condition), ou bien le nombre de succès et le nombre total d’essais. Voir les exemples ci-après :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(JLutils)</code></pre></div>
<pre><code>Loading required package: ggplot2</code></pre>
<pre><code>Loading required package: plyr</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">freq</span>(d<span class="op">$</span>sport)</code></pre></div>
<pre><code>       n    % val%
Non 1277 63.8 63.8
Oui  723 36.1 36.1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.ci</span>(d<span class="op">$</span>sport)</code></pre></div>
<pre><code>[1] 0.6169447 0.6595179</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.ci.lower</span>(d<span class="op">$</span>sport)</code></pre></div>
<pre><code>[1] 0.6169447</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.ci.upper</span>(d<span class="op">$</span>sport)</code></pre></div>
<pre><code>[1] 0.6595179</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.ci</span>(d<span class="op">$</span>sport, <span class="dt">conf.level =</span> <span class="fl">0.9</span>)</code></pre></div>
<pre><code>[1] 0.6204011 0.6562194</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.ci</span>(<span class="kw">table</span>(d<span class="op">$</span>sport))</code></pre></div>
<pre><code>[1] 0.6169447 0.6595179</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.ci</span>(d<span class="op">$</span>sport <span class="op">==</span><span class="st"> "Non"</span>)</code></pre></div>
<pre><code>[1] 0.6169447 0.6595179</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.ci</span>(d<span class="op">$</span>sport <span class="op">==</span><span class="st"> "Oui"</span>)</code></pre></div>
<pre><code>[1] 0.3404821 0.3830553</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.ci.lower</span>(<span class="kw">c</span>(<span class="dv">1277</span>, <span class="dv">723</span>), <span class="dt">n =</span> <span class="dv">2000</span>)</code></pre></div>
<pre><code>[1] 0.6169447 0.3404821</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.ci.upper</span>(<span class="kw">c</span>(<span class="dv">1277</span>, <span class="dv">723</span>), <span class="dt">n =</span> <span class="dv">2000</span>)</code></pre></div>
<pre><code>[1] 0.6595179 0.3830553</code></pre>
</div>
</div>
<div id="intervalles-de-confiance_survey" class="section level2">
<h2>Données pondérées et l’extension survey</h2>
<p>Lorsque l’on utilise des données pondérées définies à l’aide de l’extension <code class="pkg">survey</code><a href="#intervalles-de-confiance_fn1" class="footnoteRef" id="intervalles-de-confiance_fnref1"><sup>1</sup></a>, l’<dfn>intervalle de confiance d’une moyenne</dfn><dfn data-index="moyenne, intervalle de confiance"></dfn> s’obtient avec <code data-pkg="survey" data-rdoc="surveysummary">confint</code> et celui d’une <dfn data-index="intervalle de confiance d'une proportion">proportion</dfn><dfn data-index="proportion, intervalle de confiance"></dfn> avec <code data-pkg="survey">svyciprop</code>.</p>
<p>Quelques exemples :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(survey)
dw &lt;-<span class="st"> </span><span class="kw">svydesign</span>(<span class="dt">ids =</span> <span class="op">~</span><span class="dv">1</span>, <span class="dt">data =</span> d, <span class="dt">weights =</span> <span class="op">~</span>poids)
<span class="kw">svymean</span>(<span class="op">~</span>age, dw)</code></pre></div>
<pre><code>      mean     SE
age 46.347 0.5284</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">confint</span>(<span class="kw">svymean</span>(<span class="op">~</span>age, dw))  <span class="co"># Intervalle de confiance d'une moyenne</span></code></pre></div>
<pre><code>      2.5 %   97.5 %
age 45.3117 47.38282</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">confint</span>(<span class="kw">svyby</span>(<span class="op">~</span>age, <span class="op">~</span>sexe, dw, svymean))  <span class="co"># Intervalles de confiance pour chaque sexe</span></code></pre></div>
<pre><code>         2.5 %   97.5 %
Homme 43.74781 46.65618
Femme 45.88867 48.79758</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">freq</span>(<span class="kw">svytable</span>(<span class="op">~</span>sexe, dw))</code></pre></div>
<pre><code>            n    % val%
Homme 5149382 46.5 46.5
Femme 5921844 53.5 53.5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svyciprop</span>(<span class="op">~</span>sexe, dw)  <span class="co"># Intervalle de confiance d'une proportion</span></code></pre></div>
<pre><code>            2.5% 97.5%
sexe 0.535 0.507  0.56</code></pre>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="intervalles-de-confiance_fn1"><p>Voir le chapitre dédié aux <a href="#donnees-ponderees_survey">données pondérées</a>.<a href="#intervalles-de-confiance_fnref1"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="comparaisons-moyennes-et-proportions"><div class="fluid-row" id="comparaisons-moyennes-et-proportions_header">



<h1 class="title toc-ignore">Comparaisons (moyennes et proportions)</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#comparaisons-moyennes-et-proportions_comp_moyennes">Comparaison de moyennes</a></li>
<li><a href="#comparaisons-moyennes-et-proportions_comp_prop">Comparaison de proportions</a></li>
<li><a href="#comparaisons-moyennes-et-proportions_-et-derives"><U+03C7>² et dérivés</a></li>
<li><a href="#comparaisons-moyennes-et-proportions_survey">Données pondérées et l’extension survey</a></li>
</ul>
</div>

<p>Nous utiliserons dans ce chapitre les données de l’enquête <em>Histoire de vie 2003</em> fournies avec l’extension <code class="pkg">questionr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">data</span>(<span class="st">"hdv2003"</span>)
d &lt;-<span class="st"> </span>hdv2003</code></pre></div>
<div id="comparaisons-moyennes-et-proportions_comp_moyennes" class="section level2">
<h2>Comparaison de moyennes</h2>
<p>On peut calculer la <dfn>moyenne</dfn> d’âge des deux groupes en utilisant la fonction <code data-pkg="base">tapply</code><a href="#comparaisons-moyennes-et-proportions_fn1" class="footnoteRef" id="comparaisons-moyennes-et-proportions_fnref1"><sup>1</sup></a> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(d<span class="op">$</span>age, d<span class="op">$</span>hard.rock, mean)</code></pre></div>
<pre><code>     Non      Oui 
48.30211 27.57143 </code></pre>
<p>L’écart est important. Est-il statistiquement significatif ? Pour cela on peut faire un <dfn>test t de Student</dfn><dfn data-index="Student, test t"></dfn> <dfn>comparaison de moyennes</dfn><dfn data-index="moyenne, comparaison"></dfn> à l’aide de la fonction <code data-pkg="stats">t.test</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(d<span class="op">$</span>age <span class="op">~</span><span class="st"> </span>d<span class="op">$</span>hard.rock)</code></pre></div>
<pre><code>
    Welch Two Sample t-test

data:  d$age by d$hard.rock
t = 9.6404, df = 13.848, p-value = 1.611e-07
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 16.11379 25.34758
sample estimates:
mean in group Non mean in group Oui 
         48.30211          27.57143 </code></pre>
<p>Le test est extrêmement significatif. L’<dfn>intervalle de confiance</dfn> à 95 % de la différence entre les deux moyennes va de 14,5 ans à 21,8 ans.</p>
<div class="note">
<p>La valeur affichée pour <em>p</em> est de <code>1.611e-07</code>. Cette valeur peut paraître étrange pour les non avertis. Cela signifie tout simplement 1,611 multiplié par 10 à la puissance -7, autrement dit 0,0000001611. Cette manière de représenter un nombre est couramment appelée <dfn>notation scientifique</dfn><dfn data-index="scientifique, notation"></dfn>.</p>
<p>Pour plus de détails, voir <a href="http://fr.wikipedia.org/wiki/Notation_scientifique" class="uri">http://fr.wikipedia.org/wiki/Notation_scientifique</a>.</p>
</div>
<p>Nous sommes cependant allés un peu vite en besogne, car nous avons négligé une hypothèse fondamentale du test <em>t</em> : les ensembles de valeur comparés doivent suivre approximativement une <dfn>loi normale</dfn><dfn data-index="normale, loi"></dfn> et être de même <dfn>variance</dfn><a href="#comparaisons-moyennes-et-proportions_fn2" class="footnoteRef" id="comparaisons-moyennes-et-proportions_fnref2"><sup>2</sup></a>. Comment le vérifier ?</p>
<p>D’abord avec un petit graphique composés de deux <dfn data-index="histogramme">histogrammes</dfn> :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">hist</span>(d<span class="op">$</span>age[d<span class="op">$</span>hard.rock <span class="op">==</span><span class="st"> "Oui"</span>], <span class="dt">main =</span> <span class="st">"Hard rock"</span>, 
  <span class="dt">col =</span> <span class="st">"red"</span>)
<span class="kw">hist</span>(d<span class="op">$</span>age[d<span class="op">$</span>hard.rock <span class="op">==</span><span class="st"> "Non"</span>], <span class="dt">main =</span> <span class="st">"Sans hard rock"</span>, 
  <span class="dt">col =</span> <span class="st">"red"</span>)</code></pre></div>
<img src="graphs/comparaisons-moyennes-et-proportions/unnamed-chunk-4-1.png" width="1050"><figcaption>
Distribution des âges pour appréciation de la normalité
</figcaption></figure><div class="note">
<p>La fonction <code data-pkg="graphics">par</code> permet de modifier de nombreux paramètres graphiques. <code>par(mfrow = c(1, 2))</code> sert à indiquer que l’on souhaite afficher deux graphiques sur une même fenêtre, plus précisément que la fenêtre doit comporter une ligne et deux colonnes.</p>
</div>
<p>Ça a l’air à peu près bon pour les « Sans hard rock », mais un peu plus limite pour les fans de <em>Metallica</em>, dont les effectifs sont d’ailleurs assez faibles. Si on veut en avoir le coeur net on peut utiliser le <dfn>test de normalité de Shapiro-Wilk</dfn><dfn data-index="normalité, test de Shapiro-Wilk"></dfn><dfn data-index="Shapiro-Wilk, test de normalité"></dfn> avec la fonction <code data-pkg="stats">shapiro.test</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">shapiro.test</span>(d<span class="op">$</span>age[d<span class="op">$</span>hard.rock <span class="op">==</span><span class="st"> "Oui"</span>])</code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  d$age[d$hard.rock == "Oui"]
W = 0.86931, p-value = 0.04104</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">shapiro.test</span>(d<span class="op">$</span>age[d<span class="op">$</span>hard.rock <span class="op">==</span><span class="st"> "Non"</span>])</code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  d$age[d$hard.rock == "Non"]
W = 0.98141, p-value = 2.079e-15</code></pre>
<p>Visiblement, le test estime que les distributions ne sont pas suffisamment proches de la normalité dans les deux cas.</p>
<p>Et concernant l’égalité des variances ?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(d<span class="op">$</span>age, d<span class="op">$</span>hard.rock, var)</code></pre></div>
<pre><code>      Non       Oui 
285.62858  62.72527 </code></pre>
<p>L’écart n’a pas l’air négligeable. On peut le vérifier avec le <dfn>test d’égalité des variances</dfn><dfn data-index="variance, test d'égalité"></dfn> fourni par la fonction <code data-pkg="stats">var.test</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var.test</span>(d<span class="op">$</span>age <span class="op">~</span><span class="st"> </span>d<span class="op">$</span>hard.rock)</code></pre></div>
<pre><code>
    F test to compare two variances

data:  d$age by d$hard.rock
F = 4.5536, num df = 1985, denom df = 13,
p-value = 0.003217
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 1.751826 8.694405
sample estimates:
ratio of variances 
          4.553644 </code></pre>
<p>La différence est très significative. En toute rigueur le test <em>t</em> n’aurait donc pas pu être utilisé.</p>
<p><em>Damned</em> ! Ces maudits tests statistiques vont-ils nous empêcher de faire connaître au monde entier notre fabuleuse découverte sur l’âge des fans de <em>Sepultura</em> ? Non ! Car voici qu’approche à l’horizon un nouveau test, connu sous le nom de <dfn data-index="test de Wilcoxon/Mann-Whitney">Wilcoxon/Mann-Whitney</dfn><dfn data-index="Wilcoxon, test"></dfn><dfn data-index="Mann-Whitney, test"></dfn><dfn data-index="médiane, test de comparaison"></dfn><dfn data-index="comparaison de médianes, test"></dfn>. Celui-ci a l’avantage d’être non-paramétrique, c’est à dire de ne faire aucune hypothèse sur la distribution des échantillons comparés. Par contre il ne compare pas des différences de moyennes mais des différences de <dfn data-index="médiane">médianes</dfn> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wilcox.test</span>(d<span class="op">$</span>age <span class="op">~</span><span class="st"> </span>d<span class="op">$</span>hard.rock)</code></pre></div>
<pre><code>
    Wilcoxon rank sum test with continuity
    correction

data:  d$age by d$hard.rock
W = 23980, p-value = 2.856e-06
alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>Ouf ! La différence est hautement significative<a href="#comparaisons-moyennes-et-proportions_fn3" class="footnoteRef" id="comparaisons-moyennes-et-proportions_fnref3"><sup>3</sup></a>. Nous allons donc pouvoir entamer la rédaction de notre article pour la <em>Revue française de sociologie</em>.</p>
</div>
<div id="comparaisons-moyennes-et-proportions_comp_prop" class="section level2">
<h2>Comparaison de proportions</h2>
<p>La fonction <code data-pkg="stats">prop.test</code>, que nous avons déjà rencontrer pour calculer l’intervalle de confiance d’une proportion (voir le chapitre dédié aux <a href="#intervalles-de-confiance">intervalles de confiance</a>) permets également d’effectuer un <dfn>test de comparaison de deux proportions</dfn><dfn data-index="comparaison de proportions, test"></dfn><dfn data-index="proportion, test de comparaison"></dfn>.</p>
<p>Supposons que l’on souhaite comparer la proportion de personnes faisant du sport entre ceux qui lisent des bandes dessinées et les autres :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tab &lt;-<span class="st"> </span><span class="kw">xtabs</span>(<span class="op">~</span>lecture.bd <span class="op">+</span><span class="st"> </span>sport, d)
<span class="kw">lprop</span>(tab)</code></pre></div>
<pre><code>          sport
lecture.bd Non   Oui   Total
  Non       64.2  35.8 100.0
  Oui       48.9  51.1 100.0
  Ensemble  63.8  36.1 100.0</code></pre>
<p>Il suffit de transmettre notre tableau croisé (à 2×2 dimensions) à <code data-pkg="stats">prop.test</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.test</span>(tab)</code></pre></div>
<pre><code>
    2-sample test for equality of proportions
    with continuity correction

data:  tab
X-squared = 4, df = 1, p-value = 0.0455
alternative hypothesis: two.sided
95 percent confidence interval:
 -0.002652453  0.308107236
sample estimates:
   prop 1    prop 2 
0.6420891 0.4893617 </code></pre>
<p>On pourra également avoir recours à la fonction <code data-pkg="stats">fisher.test</code> qui renverra notamment l’<dfn>odds ratio</dfn> et son intervalle de confiance correspondant :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fisher.test</span>(<span class="kw">table</span>(d<span class="op">$</span>lecture.bd, d<span class="op">$</span>sport))</code></pre></div>
<pre><code>
    Fisher's Exact Test for Count Data

data:  table(d$lecture.bd, d$sport)
p-value = 0.0445
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 1.003372 3.497759
sample estimates:
odds ratio 
  1.871433 </code></pre>
<p>On pourra aussi avoir recours à la fonction <code data-pkg="questionr">odds.ratio</code> de l’extension <code class="pkg">questionr</code> qui réalise le même calcul mais présente le résultat légèrement différemment :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">odds.ratio</span>(tab)</code></pre></div>
<pre><code>                  OR  2.5 % 97.5 %      p  
Fisher's test 1.8714 1.0034 3.4978 0.0445 *
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>Note : pour le calcul du <dfn>risque relatif</dfn>, on pourra regarder du côté de la fonction <code data-pkg="mosaic">relrisk</code> de l’extension <code class="pkg">mosaic</code>.</p>
</div>
<div id="comparaisons-moyennes-et-proportions_-et-derives" class="section level2">
<h2><U+03C7>² et dérivés</h2>
<p>Dans le cadre d’un tableau croisée, on peut tester l’existence d’un lien entre les modalités de deux variables, avec le très classique <dfn data-index="test du Chi²">test du <U+03C7>²</dfn><dfn data-index="Chi², test"></dfn><a href="#comparaisons-moyennes-et-proportions_fn4" class="footnoteRef" id="comparaisons-moyennes-et-proportions_fnref4"><sup>4</sup></a>. Celui-ci s’obtient grâce à la fonction <code data-pkg="stats">chisq.test</code>, appliquée au tableau croisé obtenu avec <code data-pkg="base">table</code> ou <code data-pacakge="stats">xtabs</code><a href="#comparaisons-moyennes-et-proportions_fn5" class="footnoteRef" id="comparaisons-moyennes-et-proportions_fnref5"><sup>5</sup></a> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>qualreg &lt;-<span class="st"> </span><span class="kw">as.character</span>(d<span class="op">$</span>qualif)
d<span class="op">$</span>qualreg[d<span class="op">$</span>qualif <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"Ouvrier specialise"</span>, <span class="st">"Ouvrier qualifie"</span>)] &lt;-<span class="st"> "Ouvrier"</span>
d<span class="op">$</span>qualreg[d<span class="op">$</span>qualif <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"Profession intermediaire"</span>, 
  <span class="st">"Technicien"</span>)] &lt;-<span class="st"> "Intermediaire"</span>

tab &lt;-<span class="st"> </span><span class="kw">table</span>(d<span class="op">$</span>sport, d<span class="op">$</span>qualreg)
tab</code></pre></div>
<pre><code>     
      Autre Cadre Employe Intermediaire Ouvrier
  Non    38   117     401           127     381
  Oui    20   143     193           119     114</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(tab)</code></pre></div>
<pre><code>
    Pearson's Chi-squared test

data:  tab
X-squared = 96.798, df = 4, p-value &lt;
2.2e-16</code></pre>
<p>Le test est hautement significatif, on ne peut pas considérer qu’il y a indépendance entre les lignes et les colonnes du tableau.</p>
<p>On peut affiner l’interprétation du test en déterminant dans quelle case l’écart à l’indépendance est le plus significatif en utilisant les <dfn data-index="résidus, test du Chi²">résidus</dfn><dfn data-index="test du Chi², résidus"></dfn><dfn data-index="Chi², résidus"></dfn> du test. Ceux-ci sont notamment affichables avec la fonction <code data-pkg="questionr">chisq.residuals</code> de <code class="pkg">questionr</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.residuals</span>(tab)</code></pre></div>
<pre><code>     
      Autre Cadre Employe Intermediaire Ouvrier
  Non  0.11 -3.89    0.95         -2.49    3.49
  Oui -0.15  5.23   -1.28          3.35   -4.70</code></pre>
<p>Les cases pour lesquelles l’écart à l’indépendance est significatif ont un résidu dont la valeur est supérieure à 2 ou inférieure à -2. Ici on constate que la pratique d’un sport est sur-représentée parmi les cadres et, à un niveau un peu moindre, parmi les professions intermédiaires, tandis qu’elle est sousreprésentée chez les ouvriers.</p>
<p>Enfin, on peut calculer le <dfn>coefficient de contingence de Cramer</dfn><dfn data-index="Cramer, coefficient de contingence"></dfn><dfn data-index="tableau croisé, coefficient de contingence de Cramer"></dfn> du tableau, qui peut nous permettre de le comparer par la suite à d’autres tableaux croisés. On peut pour cela utiliser la fonction <code data-pkg="questionr">cramer.v</code> de <code class="pkg">questionr</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cramer.v</span>(tab)</code></pre></div>
<pre><code>[1] 0.24199</code></pre>
<div class="note">
<p>Pour un tableau à 2×2 entrées, il est possible de calculer le <dfn>test exact de Fisher</dfn><dfn data-index="Fisher, test exact"></dfn><dfn data-index="tableau croisé, test exact de Fisher"></dfn> avec la fonction <code data-pkg="stats">fisher.test</code>. On peut soit lui passer le résultat de <code data-pkg="base">table</code> ou <code data-pkg="stats">xtabs</code>, soit directement les deux variables à croiser.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lprop</span>(<span class="kw">table</span>(d<span class="op">$</span>sexe, d<span class="op">$</span>cuisine))</code></pre></div>
<pre><code>          
           Non   Oui   Total
  Homme     70.0  30.0 100.0
  Femme     44.5  55.5 100.0
  Ensemble  56.0  44.0 100.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fisher.test</span>(<span class="kw">table</span>(d<span class="op">$</span>sexe, d<span class="op">$</span>cuisine))</code></pre></div>
<pre><code>
    Fisher's Exact Test for Count Data

data:  table(d$sexe, d$cuisine)
p-value &lt; 2.2e-16
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 2.402598 3.513723
sample estimates:
odds ratio 
  2.903253 </code></pre>
</div>
</div>
<div id="comparaisons-moyennes-et-proportions_survey" class="section level2">
<h2>Données pondérées et l’extension survey</h2>
<p>Lorsque l’on utilise des données pondérées, on aura recours à l’extension <code class="pkg">survey</code><a href="#comparaisons-moyennes-et-proportions_fn6" class="footnoteRef" id="comparaisons-moyennes-et-proportions_fnref6"><sup>6</sup></a>.</p>
<p>Préparons des données d’exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(survey)
dw &lt;-<span class="st"> </span><span class="kw">svydesign</span>(<span class="dt">ids =</span> <span class="op">~</span><span class="dv">1</span>, <span class="dt">data =</span> d, <span class="dt">weights =</span> <span class="op">~</span>poids)</code></pre></div>
<p>Pour comparer deux moyennes à l’aide d’un test <em>t</em> on aura recours à <code data-pkg="survey">svyttest</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svyttest</span>(age <span class="op">~</span><span class="st"> </span>sexe, dw)</code></pre></div>
<pre><code>
    Design-based t-test

data:  age ~ sexe
t = 2.0404, df = 1998, p-value = 0.04144
alternative hypothesis: true difference in mean is not equal to 0
sample estimates:
difference in mean 
          2.141129 </code></pre>
<p>On ne peut pas utiliser <code data-pkg="stats">chisq.test</code> directement sur un tableau généré par <code data-pkg="survey">svytable</code>. Les effectifs étant extrapolés à partir de la pondération, les résultats du test seraient complètement faussés. Si on veut faire un test du <U+03C7>² sur un tableau croisé pondéré, il faut utiliser <code data-pkg="survey" data-rdoc="svytable">svychisq</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rprop</span>(<span class="kw">svytable</span>(<span class="op">~</span>sexe <span class="op">+</span><span class="st"> </span>clso, dw))</code></pre></div>
<pre><code>          clso
sexe       Oui   Non   Ne sait pas Total
  Homme     51.6  47.0   1.4       100.0
  Femme     43.9  54.8   1.3       100.0
  Ensemble  47.5  51.1   1.4       100.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svychisq</span>(<span class="op">~</span>sexe <span class="op">+</span><span class="st"> </span>clso, dw)</code></pre></div>
<pre><code>
    Pearson's X^2: Rao &amp; Scott adjustment

data:  svychisq(~sexe + clso, dw)
F = 3.3331, ndf = 1.9734, ddf = 3944.9000,
p-value = 0.03641</code></pre>
<p>L’extension <code class="pkg">survey</code> ne propose pas de version adaptée du test exact de Fisher. Pour comparer deux proportions, on aura donc recours au test du <U+03C7>² :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rprop</span>(<span class="kw">svytable</span>(<span class="op">~</span>lecture.bd <span class="op">+</span><span class="st"> </span>sport, dw))</code></pre></div>
<pre><code>          sport
lecture.bd Non   Oui   Total
  Non       61.0  39.0 100.0
  Oui       46.8  53.2 100.0
  Ensemble  60.7  39.3 100.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svychisq</span>(<span class="op">~</span>lecture.bd <span class="op">+</span><span class="st"> </span>sport, dw)</code></pre></div>
<pre><code>
    Pearson's X^2: Rao &amp; Scott adjustment

data:  svychisq(~lecture.bd + sport, dw)
F = 2.6213, ndf = 1, ddf = 1999, p-value =
0.1056</code></pre>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="comparaisons-moyennes-et-proportions_fn1"><p>La fonction <code data-pkg="base">tapply</code> est présentée plus en détails dans le chapitre <a href="pem_manipulation.html#tapply">Manipulation de données</a>.<a href="#comparaisons-moyennes-et-proportions_fnref1"><U+21A9></a></p></li>
<li id="comparaisons-moyennes-et-proportions_fn2"><p>Concernant cette seconde condition, <code data-pkg="stats">t.test</code> propose une option nommée <code>var.equal</code> qui permet d’utiliser une approximation dans le cas où les variances ne sont pas égales.<a href="#comparaisons-moyennes-et-proportions_fnref2"><U+21A9></a></p></li>
<li id="comparaisons-moyennes-et-proportions_fn3"><p>Ce test peut également fournir un intervalle de confiance avec l’option <code>conf.int=TRUE</code>.<a href="#comparaisons-moyennes-et-proportions_fnref3"><U+21A9></a></p></li>
<li id="comparaisons-moyennes-et-proportions_fn4"><p>On ne donnera pas plus d’indications sur le test du <U+03C7>² ici. Les personnes désirant une présentation plus détaillée pourront se reporter (attention, séance d’autopromotion !) à la page suivante : <a href="http://alea.fr.eu.org/pages/khi2" class="uri">http://alea.fr.eu.org/pages/khi2</a>.<a href="#comparaisons-moyennes-et-proportions_fnref4"><U+21A9></a></p></li>
<li id="comparaisons-moyennes-et-proportions_fn5"><p>On peut aussi appliquer directement le test en spécifiant les deux variables à croiser via <code>chisq.test(d$qualreg, d$sport)</code>.<a href="#comparaisons-moyennes-et-proportions_fnref5"><U+21A9></a></p></li>
<li id="comparaisons-moyennes-et-proportions_fn6"><p>Voir le chapitre dédié aux <a href="#donnees-ponderees_survey">données pondérées</a>.<a href="#comparaisons-moyennes-et-proportions_fnref6"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="definir-un-plan-d-echantillonnage-complexe"><div class="fluid-row" id="definir-un-plan-d-echantillonnage-complexe_header">



<h1 class="title toc-ignore">Définir un plan d’échantillonnage complexe</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#definir-un-plan-d-echantillonnage-complexe_differents-types-dechantillonnage">Différents types d’échantillonnage</a></li>
<li><a href="#definir-un-plan-d-echantillonnage-complexe_les-options-de-svydesign">Les options de svydesign</a></li>
<li><a href="#definir-un-plan-d-echantillonnage-complexe_quelques-exemples">Quelques exemples</a></li>
<li><a href="#definir-un-plan-d-echantillonnage-complexe_extraire-un-sous-echantillon">Extraire un sous-échantillon</a></li>
</ul>
</div>

<p>L’extension <code class="pkg">survey</code> ne permet pas seulement d’indiquer une variable de pondération mais également de prendre les spécificités du plan d’échantillonnage (strates, grappes, …). Le plan d’échantillonnage ne joue pas seulement sur la pondération des données, mais influence le calcul des variances et par ricochet tous les tests statistiques. Deux échantillons identiques avec la même variable de pondération mais des designs différents produiront les mêmes moyennes et proportions mais des intervalles de confiance différents.</p>
<p>Le site officiel (en anglais) comporte beaucoup d’informations, mais pas forcément très accessibles : <br><a href="http://r-survey.r-forge.r-project.org/" class="uri">http://r-survey.r-forge.r-project.org/</a>.</p>
<div id="definir-un-plan-d-echantillonnage-complexe_differents-types-dechantillonnage" class="section level2">
<h2>Différents types d’échantillonnage</h2>
<p>L’<dfn>échantillonnage aléatoire simple</dfn><dfn data-index="aléatoire, échantillonnage"></dfn> ou <dfn>échantillonnage équiprobable</dfn><dfn data-index="équiprobable, échantillonnage"></dfn> est une méthode pour laquelle tous les échantillons possibles (de même taille) ont la même probabilité d’être choisis et tous les éléments de la population ont une chance égale de faire partie de l’échantillon. C’est l’échantillonnage le plus simple : chaque individu à la même probabilité d’être sélectionné.</p>
<p>L’<dfn>échantillonnage stratifié</dfn><dfn data-index="stratifié, échantillonnage"></dfn> est une méthode qui consiste d’abord à subdiviser la population en groupes homogènes (<dfn data-index="strate">strates</dfn>) pour ensuite extraire un échantillon aléatoire de chaque strate. Cette méthode suppose la connaissance de la structure de la population. Pour estimer les paramètres, les résultats doivent être pondérés par l’importance relative de chaque strate dans la population.</p>
<p>L’<dfn>échantillonnage par grappes</dfn> est une méthode qui consiste à choisir un échantillon aléatoire d’unités qui sont elles-mêmes des sous-ensembles de la population (<dfn data-index="grappe, échantillonnage">grappes</dfn> ou <dfn data-index="cluster" lang="en">clusters</dfn> en anglais). Cette méthode suppose que les unités de chaque grappe sont représentatives. Elle possède l’avantage d’être souvent plus économique.</p>
<p>Il est possible de combiner plusieurs de ces approches. Par exemple, les <em>Enquêtes Démographiques et de Santé</em><a href="#definir-un-plan-d-echantillonnage-complexe_fn1" class="footnoteRef" id="definir-un-plan-d-echantillonnage-complexe_fnref1"><sup>1</sup></a> (EDS) sont des enquêtes stratifiées en grappes à deux degrés. Dans un premier temps, la population est divisée en strates par région et milieu de résidence. Dans chaque strate, des zones d’enquêtes, correspondant à des unités de recensement, sont tirées au sort avec une probabilité proportionnelle au nombre de ménages de chaque zone au dernier recensement de population. Enfin, au sein de chaque zone d’enquête sélectionnée, un recensement de l’ensemble des ménages est effectué puis un nombre identique de ménages par zone d’enquête est tiré au sort de manière alétoire simple.</p>
</div>
<div id="definir-un-plan-d-echantillonnage-complexe_les-options-de-svydesign" class="section level2">
<h2>Les options de svydesign</h2>
<p>La fonction <code data-pkg="survey">svydesign</code> accepte plusieurs arguments décrits sur sa page d’aide (obtenue avec la commande <code>?svydesign</code>).</p>
<p>L’agument <code>data</code> permet de spécifier le tableau de données contenant les observations.</p>
<p>L’argument <code>ids</code> est obligatoire et spécifie sous la forme d’une formule les identifiants des différents niveaux d’un tirage en grappe. S’il s’agit d’un échantillon aléatoire simple, on entrera <code>ids=˜1</code>. Autre situation : supposons une étude portant sur la population française. Dans un premier temps, on a tiré au sort un certain nombre de départements français. Dans un second temps, on tire au sort dans chaque département des communes. Dans chaque commune sélectionnée, on tire au sort des quartiers. Enfin, on interroge de manière exhaustive toutes les personnes habitant les quartiers enquêtés. Notre fichier de données devra donc comporter pour chaque observation les variables <em>id_departement</em>, <em>id_commune</em> et <em>id_quartier</em>. On écrira alors pour l’argument <code>ids</code> la valeur suivante :<br><code>ids=˜id_departement+id_commune+id_quartier</code>.</p>
<p>Si l’échantillon est stratifié, on spécifiera les strates à l’aide de l’argument <code>strata</code> en spécifiant la variable contenant l’identifiant des strates. Par exemple : <code>strata=˜id_strate</code>.</p>
<p>Il faut encore spécifier les probabilités de tirage de chaque cluster ou bien la pondération des individus. Si l’on dispose de la probabilité de chaque observation d’être sélectionnée, on utilisera l’argument <code>probs</code>. Si, par contre, on connaît la pondération de chaque observation (qui doit être proportionnelle à l’inverse de cette probabilité), on utilisera l’argument <code>weights</code>.</p>
<p>Si l’échantillon est stratifié, qu’au sein de chaque strate les individus ont été tirés au sort de manière aléatoire et que l’on connaît la taille de chaque strate, il est possible de ne pas avoir à spécifier la probabilité de tirage ou la pondération de chaque observation. Il est préférable de fournir une variable contenant la taille de chaque strate à l’argument <code>fpc</code>. De plus, dans ce cas-là, une petite correction sera appliquée au modèle pour prendre en compte la taille finie de chaque strate.</p>
</div>
<div id="definir-un-plan-d-echantillonnage-complexe_quelques-exemples" class="section level2">
<h2>Quelques exemples</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Échantillonnage aléatoire simple</span>
plan &lt;-<span class="st"> </span><span class="kw">svydesign</span>(<span class="dt">ids =</span> <span class="op">~</span><span class="dv">1</span>, <span class="dt">data =</span> donnees)

<span class="co"># Échantillonnage stratifié à un seul niveau (la</span>
<span class="co"># taille de chaque strate est connue)</span>
plan &lt;-<span class="st"> </span><span class="kw">svydesign</span>(<span class="dt">ids =</span> <span class="op">~</span><span class="dv">1</span>, <span class="dt">data =</span> donnees, <span class="dt">fpc =</span> <span class="op">~</span>taille)

<span class="co"># Échantillonnage en grappes avec tirages à quatre</span>
<span class="co"># degrés (departement, commune, quartier,</span>
<span class="co"># individus). La probabilité de tirage de chaque</span>
<span class="co"># niveau de cluster est connue.</span>
plan &lt;-<span class="st"> </span><span class="kw">svydesign</span>(<span class="dt">ids =</span> <span class="op">~</span>id_departement <span class="op">+</span><span class="st"> </span>id_commune <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>id_quartier, <span class="dt">data =</span> donnees, <span class="dt">probs =</span> <span class="op">~</span>proba_departement <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>proba_commune <span class="op">+</span><span class="st"> </span>proba_quartier)

<span class="co"># Échantillonnage stratifié avec tirage à deux</span>
<span class="co"># degrés (clusters et individus). Le poids</span>
<span class="co"># statistiques de chaque observation est connu.</span>
plan &lt;-<span class="st"> </span><span class="kw">svydesign</span>(<span class="dt">ids =</span> <span class="op">~</span>id_cluster, <span class="dt">data =</span> donnees, 
  <span class="dt">strata =</span> <span class="op">~</span>id_strate, <span class="dt">weights =</span> <span class="op">~</span>poids)</code></pre></div>
<p>Prenons l’exemple d’une <em>Enquête Démographique et de Santé</em>. Le nom des différentes variables est standardisé et commun quelle que soit l’enquête. Nous supposerons que vous avez importé le fichier <em>individus</em> dans un tableau de données nommés <code>eds</code>. Le poids statistique de chaque individu est fourni par la variable <em>V005</em> qui doit au préalable être divisée par un million. Les grappes d’échantillonnage au premier degré sont fournies par la variable <em>V021 (primary sample unit)</em>. Si elle n’est pas renseignée, on pourra utilisier le numéro de grappe <em>V001</em>. Enfin, le milieu de résidence (urbain / rural) est fourni par <em>V025</em> et la région par <em>V024</em>. Pour rappel, l’échantillon a été stratifié à la fois par région et par mileu de résidence. Certaines enquêtes fournissent directement un numéro de strate via <em>V022</em>. Si tel est le cas, on pourra préciser le plan d’échantillonnage ainsi :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eds<span class="op">$</span>poids &lt;-<span class="st"> </span>eds<span class="op">$</span>V005<span class="op">/</span><span class="fl">1e+06</span>
design.eds &lt;-<span class="st"> </span><span class="kw">svydesign</span>(<span class="dt">ids =</span> <span class="op">~</span>V021, <span class="dt">data =</span> eds, <span class="dt">strata =</span> <span class="op">~</span>V022, 
  <span class="dt">weights =</span> <span class="op">~</span>poids)</code></pre></div>
<p>Si <em>V022</em> n’est pas fourni mais que l’enquête a bien été stratifiée par région et milieu de résidence (vérifiez toujours le premier chapitre du rapport d’enquête), on pourra créer une variable strate ainsi<a href="#definir-un-plan-d-echantillonnage-complexe_fn2" class="footnoteRef" id="definir-un-plan-d-echantillonnage-complexe_fnref2"><sup>2</sup></a> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eds<span class="op">$</span>strate &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="kw">as.integer</span>(eds<span class="op">$</span>V024) <span class="op">*</span><span class="st"> </span><span class="dv">10</span> <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">as.integer</span>(eds<span class="op">$</span>V025))
<span class="kw">levels</span>(eds<span class="op">$</span>strate) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">paste</span>(<span class="kw">levels</span>(eds<span class="op">$</span>V024), <span class="st">"Urbain"</span>), 
  <span class="kw">paste</span>(<span class="kw">levels</span>(eds<span class="op">$</span>V024), <span class="st">"Rural"</span>))
design.eds &lt;-<span class="st"> </span><span class="kw">svydesign</span>(<span class="dt">ids =</span> <span class="op">~</span>V021, <span class="dt">data =</span> eds, <span class="dt">strata =</span> <span class="op">~</span>strate, 
  <span class="dt">weights =</span> <span class="op">~</span>poids)</code></pre></div>
</div>
<div id="definir-un-plan-d-echantillonnage-complexe_extraire-un-sous-echantillon" class="section level2">
<h2>Extraire un sous-échantillon</h2>
<p>Si l’on souhaite travailler sur un <dfn>sous-échantillon</dfn> tout en gardant les informations d’échantillonnage, on utilisera la fonction <code data-pkg="survey" data-rdoc="subset.survey.design">subset</code> présentée en détail dans le chapitre <a href="pem_manipulation.html#subset">Manipulation de données</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sous &lt;-<span class="st"> </span><span class="kw">subset</span>(plan, sexe <span class="op">==</span><span class="st"> "Femme"</span> <span class="op">&amp;</span><span class="st"> </span>age <span class="op">&gt;=</span><span class="st"> </span><span class="dv">40</span>)</code></pre></div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="definir-un-plan-d-echantillonnage-complexe_fn1"><p>Vaste programme d’enquêtes réalisées à intervalles réguliers dans les pays du Sud, disponibles sur <a href="http://www.dhsprogram.com/" class="uri">http://www.dhsprogram.com/</a>.<a href="#definir-un-plan-d-echantillonnage-complexe_fnref1"><U+21A9></a></p></li>
<li id="definir-un-plan-d-echantillonnage-complexe_fn2"><p>L’astuce consiste à utiliser <code data-pkg="base">as.integer</code> pour obtenir le code des facteurs et non leur valeur textuelle. L’addition des deux valeurs après multiplication du code de la région par 10 permet d’obtenir une valeur unique pour chaque combinaison des deux variables. On retransforme le résultat en facteurs puis on modifie les étiquettes des modalités.<a href="#definir-un-plan-d-echantillonnage-complexe_fnref2"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="regression-lineaire"><div class="fluid-row" id="regression-lineaire_header">



<h1 class="title toc-ignore">Régression linéaire</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="regression-logistique"><div class="fluid-row" id="regression-logistique_header">



<h1 class="title toc-ignore">Régression logistique</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#regression-logistique_preparation-des-donnees">Préparation des données</a></li>
<li><a href="#regression-logistique_regression-logistique-binaire">Régression logistique binaire</a></li>
<li><a href="#regression-logistique_selection-de-modeles">Sélection de modèles</a></li>
<li><a href="#regression-logistique_regression-logistique-multinomiale">Régression logistique multinomiale</a></li>
<li><a href="#regression-logistique_survey">Données pondérées et l’extension survey</a></li>
</ul>
</div>

<div class="note">
<p>La version originale de ce chapitre a été écrite par Joseph Larmarange dans le cadre du support de cours <a href="https://github.com/larmarange/intro-r/tree/CoursM2">Introduction à l’analyse d’enquêtes avec R</a>.</p>
</div>
<p>La <dfn>régression logistique</dfn><dfn data-index="logistique, régression"></dfn> est fréquemment utilisée en sciences sociales car elle permet d’effectuer un raisonnement dit <em>toutes choses étant égales par ailleurs</em>. Plus précisément, la régression logistique a pour but d’isoler les effets de chaque variable, c’est-à-dire d’identifier les effets résiduels d’une <dfn>variable explicative</dfn><dfn data-index="explicative, variable"></dfn> sur une <dfn>variable d’intérêt</dfn>, une fois pris en compte les autres variables explicatives introduites dans le modèle. La régression logistique est ainsi prisée en épidémiologie pour identifier les facteurs associés à telle ou telle pathologie.</p>
<p>La <dfn>régression logistique ordinaire</dfn><dfn data-index="ordinaire, régression logistique"></dfn> ou <dfn>régression logistique binaire</dfn><dfn data-index="binaire, régression logistique"></dfn> vise à expliquer une variable d’intérêt binaire (c’est-à-dire de type « oui / non » ou « vrai / faux »). Les variables explicatives qui seront introduites dans le modèle peuvent être <dfn data-index="variable quantitative">quantitatives</dfn><dfn data-index="quantitative, variable"></dfn> ou <dfn data-index="variable qualitative">qualitatives</dfn><dfn data-index="qualitative, variable"></dfn>.</p>
<p>La <dfn>régression logistique multinomiale</dfn><dfn data-index="multinomiale, régression logistique"></dfn> est une extension de la régression logistique aux variables qualitatives à trois modalités ou plus.</p>
<div id="regression-logistique_preparation-des-donnees" class="section level2">
<h2>Préparation des données</h2>
<p>Dans ce chapite, nous allons encore une fois utiliser les données de l’enquête <em>Histoire de vie</em>, fournies avec l’extension <code class="pkg">questionr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">data</span>(hdv2003)
d &lt;-<span class="st"> </span>hdv2003</code></pre></div>
<p>À titre d’exemple, nous allons étudier l’effet de l’âge, du sexe, du niveau d’étude, de la pratique religieuse et du nombre moyen d’heures passées à regarder la télévision par jour.</p>
<p>En premier lieu, il importe de vérifier que notre variable d’intérêt (ici <em>sport</em>) est correctement codée. Une possibilité consiste à créer une <dfn>variable booléenne</dfn><dfn data-index="booléenne, variable"></dfn> (vrai / faux) selon que l’individu a pratiqué du sport ou non :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>sport2 &lt;-<span class="st"> </span><span class="ot">FALSE</span>
d<span class="op">$</span>sport2[d<span class="op">$</span>sport <span class="op">==</span><span class="st"> "Oui"</span>] &lt;-<span class="st"> </span><span class="ot">TRUE</span></code></pre></div>
<p>Dans le cas présent, cette variable n’a pas de <dfn>valeur manquante</dfn><dfn data-index="manquante, valeur"></dfn>. Mais, le cas échéant, il importe de bien coder les valeurs manquantes en <code>NA</code>, les individus en question étant alors exclu de l’analyse.</p>
<p>Il n’est pas forcément nécessaire de transformer notre variable d’intérêt en variable booléenne. En effet, <strong>R</strong> accepte sans problème une variable de type <dfn>facteur</dfn>. Cependant, l’ordre des valeurs d’un facteur a de l’importance. En effet, <strong>R</strong> considère toujours la première modalité comme étant la <dfn>modalité de référence</dfn><dfn data-index="référence, modalité"></dfn>. Dans le cas de la variable d’intérêt, la modalité de référence correspond au fait de ne pas remplir le critère étudié, dans notre exemple au fait de ne pas avoir eu d’activité sportive au cours des douze derniers mois.</p>
<p>Pour connaître l’ordre des modalités d’une variable de type facteur, on peut utiliser la fonction <code data-pkg="base">levels</code> ou bien encore tout simplement la fonction <code data-pkg="questionr">freq</code> de l’extension <code class="pkg">questionr</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(d<span class="op">$</span>sport)</code></pre></div>
<pre><code>[1] "Non" "Oui"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">freq</span>(d<span class="op">$</span>sport)</code></pre></div>
<pre><code>       n    % val%
Non 1277 63.8 63.8
Oui  723 36.1 36.1</code></pre>
<p>Dans notre exemple, la modalité « Non » est déjà la première modalité. Il n’y a donc pas besoin de modifier notre variable. Si ce n’est pas le cas, il faudra modifier la modalité de référence avec la fonction <code data-pkg="stats">relevel</code> comme nous allons le voir un peu plus loin.</p>
<div class="important">
<p>Il est possible d’indiquer un facteur à plus de deux modalités. Dans une telle situation, <strong>R</strong> considérera que tous les modalités, sauf la modalité de référence, est une réalisation de la variable d’intérêt. Cela serait correct, par exemple, si notre variable <em>sport</em> était codée ainsi : « Non », « Oui, toutes les semaines », « Oui, au moins une fois par mois », « Oui, moins d’une fois par mois ». Cependant, afin d’éviter tout risque d’erreur ou de mauvaise interprétation, il est vivement conseillé de recoder au préalable sa variable d’intérêt en un facteur à deux modalités.</p>
</div>
<p>La notion de modalité de référence s’applique également aux variables explicatives qualitatives. En effet, dans un modèle, tous les coefficients sont calculés par rapport à la modalité de référence. Il importe de choisir une modalité de référence qui fasse sens afin de faciliter l’interprétation. Par ailleurs, ce choix peut également dépendre de la manière dont on souhaite présenter les résultats. De manière générale on évitera de choisir comme référence une modalité peu représentée dans l’échantillon ou bien une modalité correspondant à une situation atypique.</p>
<p>Prenons l’exemple de la variable <em>sexe</em>. Souhaite-t-on connaitre l’effet d’être une femme par rapport au fait d’être un homme ou bien l’effet d’être un homme par rapport au fait d’être une femme ? Si l’on opte pour le second, alors notre modalité de référence sera le sexe féminin. Comme est codée cette variable ?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">freq</span>(d<span class="op">$</span>sexe)</code></pre></div>
<pre><code>         n  % val%
Homme  899 45   45
Femme 1101 55   55</code></pre>
<p>La modalité « Femme » s’avère ne pas être la première modalité. Nous devons appliquer la fonction <code data-pkg="stats">relevel</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>sexe &lt;-<span class="st"> </span><span class="kw">relevel</span>(d<span class="op">$</span>sexe, <span class="st">"Femme"</span>)
<span class="kw">freq</span>(d<span class="op">$</span>sexe)</code></pre></div>
<pre><code>         n  % val%
Femme 1101 55   55
Homme  899 45   45</code></pre>
<div class="important">
<p><strong>Données labellisées</strong></p>
<p>Si l’on utilise des données labellisées (voir le <a href="#facteurs-et-vecteurs-labellises_labelled">chapitre dédié</a>), nos variables catégorielles seront stockées sous la forme d’un vecteur numérique avec des étiquettes. Il sera donc nécessaire de convertir ces variables en facteurs, tout simplement avec la fonction <code data-pkg="labelled">to_factor</code> de l’extension <code class="pkg">labelled</code> qui pourra utiliser les étiquettes de valeurs comme modalités du facteur.</p>
</div>
<p>Les variables <em>age</em> et <em>heures.tv</em> sont des variables quantitatives. Il importe de vérifier qu’elles sont bien enregistrées en tant que variables numériques. En effet, il arrive parfois que dans le fichier source les variables quantitatives soient renseignées sous forme de valeur textuelle et non sous forme numérique.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(d<span class="op">$</span>age)</code></pre></div>
<pre><code> int [1:2000] 28 23 59 34 71 35 60 47 20 28 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(d<span class="op">$</span>heures.tv)</code></pre></div>
<pre><code> num [1:2000] 0 1 0 2 3 2 2.9 1 2 2 ...</code></pre>
<p>Nos deux variables sont bien renseignées sous forme numérique.</p>
<p>Cependant, l’effet de l’âge est rarement linéaire. Un exemple trivial est par exemple le fait d’occuper un emploi qui sera moins fréquent aux jeunes âges et aux âges élevés. Dès lors, on pourra transformer la variable <em>age</em> en groupe d’âges avec la fonction <code data-pkg="base">cut</code> (voir le chapitre <a href="pem_manipulation.html#decouper_en_classes">Manipulation de données</a>) :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>grpage &lt;-<span class="st"> </span><span class="kw">cut</span>(d<span class="op">$</span>age, <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">25</span>, <span class="dv">45</span>, <span class="dv">65</span>, <span class="dv">93</span>), <span class="dt">right =</span> <span class="ot">FALSE</span>, 
  <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>)
<span class="kw">freq</span>(d<span class="op">$</span>grpage)</code></pre></div>
<pre><code>          n    % val%
[16,25) 169  8.5  8.5
[25,45) 706 35.3 35.3
[45,65) 745 37.2 37.3
[65,93] 378 18.9 18.9
NA        2  0.1   NA</code></pre>
<p>Jetons maintenant un oeil à la variable <em>nivetud</em> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">freq</span>(d<span class="op">$</span>nivetud)</code></pre></div>
<pre><code>                                                                  n
N'a jamais fait d'etudes                                         39
A arrete ses etudes, avant la derniere annee d'etudes primaires  86
Derniere annee d'etudes primaires                               341
1er cycle                                                       204
2eme cycle                                                      183
Enseignement technique ou professionnel court                   463
Enseignement technique ou professionnel long                    131
Enseignement superieur y compris technique superieur            441
NA                                                              112
                                                                   %
N'a jamais fait d'etudes                                         2.0
A arrete ses etudes, avant la derniere annee d'etudes primaires  4.3
Derniere annee d'etudes primaires                               17.1
1er cycle                                                       10.2
2eme cycle                                                       9.2
Enseignement technique ou professionnel court                   23.2
Enseignement technique ou professionnel long                     6.6
Enseignement superieur y compris technique superieur            22.1
NA                                                               5.6
                                                                val%
N'a jamais fait d'etudes                                         2.1
A arrete ses etudes, avant la derniere annee d'etudes primaires  4.6
Derniere annee d'etudes primaires                               18.1
1er cycle                                                       10.8
2eme cycle                                                       9.7
Enseignement technique ou professionnel court                   24.5
Enseignement technique ou professionnel long                     6.9
Enseignement superieur y compris technique superieur            23.4
NA                                                                NA</code></pre>
<p>En premier lieu, cette variable est détaillée en pas moins de huit modalités dont certaines sont peu représentées (seulement 39 individus soit 2 % n’ont jamais fait d’études par exemple). Afin d’améliorier notre modèle logistique, il peut être pertinent de regrouper certaines modalités (voir le chapitre <a href="pem_manipulation.html#regrouper_modalites">Manipulation de données</a>) :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>etud &lt;-<span class="st"> </span>d<span class="op">$</span>nivetud
<span class="kw">levels</span>(d<span class="op">$</span>etud) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Primaire"</span>, <span class="st">"Primaire"</span>, <span class="st">"Primaire"</span>, 
  <span class="st">"Secondaire"</span>, <span class="st">"Secondaire"</span>, <span class="st">"Technique/Professionnel"</span>, 
  <span class="st">"Technique/Professionnel"</span>, <span class="st">"Supérieur"</span>)
<span class="kw">freq</span>(d<span class="op">$</span>etud)</code></pre></div>
<pre><code>                          n    % val%
Primaire                466 23.3 24.7
Secondaire              387 19.4 20.5
Technique/Professionnel 594 29.7 31.5
Supérieur               441 22.1 23.4
NA                      112  5.6   NA</code></pre>
<p>Notre variable comporte également 112 individus avec une valeur manquante. Si nous conservons cette valeur manquante, ces 112 individus seront, par défaut, exclus de l’analyse. Ces valeurs manquantes n’étant pas négligeable (5,6 %), nous pouvons également faire le choix de considérer ces valeurs manquantes comme une modalité supplémentaire. Auquel cas, nous utiliserons la fonction <code data-pkg="base">add.NA</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(d<span class="op">$</span>etud)</code></pre></div>
<pre><code>[1] "Primaire"               
[2] "Secondaire"             
[3] "Technique/Professionnel"
[4] "Supérieur"              </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>etud &lt;-<span class="st"> </span><span class="kw">addNA</span>(d<span class="op">$</span>etud)
<span class="kw">levels</span>(d<span class="op">$</span>etud)</code></pre></div>
<pre><code>[1] "Primaire"               
[2] "Secondaire"             
[3] "Technique/Professionnel"
[4] "Supérieur"              
[5] NA                       </code></pre>
</div>
<div id="regression-logistique_regression-logistique-binaire" class="section level2">
<h2>Régression logistique binaire</h2>
<p>La fonction <code data-pkg="stats">glm</code> (pour <dfn lang="en">generalized linear models</dfn> soit <dfn>modèle linéaire généralisé</dfn> en français) permet de calculer une grande variété de modèles statistiques. La régression logistique ordinaire correspond au modèle <em>logit</em> de la famille des modèles binomiaux, ce que l’on indique à <code data-pkg="stats">glm</code> avec l’argument <code>family=binomial(logit)</code>.</p>
<p>Le modèle proprement dit sera renseigné sous la forme d’une <dfn>formule</dfn> (que nous avons déjà rencontrée dans le chapitre sur la <a href="#statistique-bivariee">statistique bivariée</a> et présentée plus en détails dans un <a href="#formules">chapitre dédié</a>). On indiquera d’abord la variable d’intérêt, suivie du signe <code>~</code> (que l’on obtient en appuyant sur les touches <kbd>Alt Gr</kbd> et <kbd>3</kbd> sur un clavier de type PC) puis de la liste des variables explicatives séparées par un signe <code>+</code>. Enfin, l’argument <code>data</code> permettra d’indiquer notre tableau de données.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reg &lt;-<span class="st"> </span><span class="kw">glm</span>(sport <span class="op">~</span><span class="st"> </span>sexe <span class="op">+</span><span class="st"> </span>grpage <span class="op">+</span><span class="st"> </span>etud <span class="op">+</span><span class="st"> </span>relig <span class="op">+</span><span class="st"> </span>heures.tv, 
  <span class="dt">data =</span> d, <span class="dt">family =</span> <span class="kw">binomial</span>(logit))
reg</code></pre></div>
<pre><code>
Call:  glm(formula = sport ~ sexe + grpage + etud + relig + heures.tv, 
    family = binomial(logit), data = d)

Coefficients:
                     (Intercept)  
                       -0.797364  
                       sexeHomme  
                        0.439002  
                   grpage[25,45)  
                       -0.420306  
                   grpage[45,65)  
                       -1.085463  
                   grpage[65,93]  
                       -1.379274  
                  etudSecondaire  
                        0.948312  
     etudTechnique/Professionnel  
                        1.047156  
                   etudSupérieur  
                        1.889621  
                          etudNA  
                        2.148545  
     religPratiquant occasionnel  
                       -0.020597  
 religAppartenance sans pratique  
                       -0.006176  
religNi croyance ni appartenance  
                       -0.214067  
                      religRejet  
                       -0.382744  
                religNSP ou NVPR  
                       -0.083361  
                       heures.tv  
                       -0.120724  

Degrees of Freedom: 1992 Total (i.e. Null);  1978 Residual
  (7 observations deleted due to missingness)
Null Deviance:      2607 
Residual Deviance: 2206     AIC: 2236</code></pre>
<div class="note">
<p>Il est possible de spécifier des modèles plus complexes. Par exemple, <code>x:y</code> permet d’indiquer l’interaction entre les variables <em>x</em> et <em>y</em>. <code>x * y</code> sera équivalent à <code>x + y + x:y</code>. Pour aller plus loin, voir <a href="http://ww2.coastal.edu/kingw/statistics/R-tutorials/formulae.html" class="uri">http://ww2.coastal.edu/kingw/statistics/R-tutorials/formulae.html</a>.</p>
</div>
<p>Une présentation plus complète des résultats est obtenue avec la méthode <code data-pkg="stats" data-rdoc="summary.glm">summary</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(reg)</code></pre></div>
<pre><code>
Call:
glm(formula = sport ~ sexe + grpage + etud + relig + heures.tv, 
    family = binomial(logit), data = d)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8783  -0.8864  -0.4814   1.0033   2.4202  

Coefficients:
                                  Estimate
(Intercept)                      -0.797364
sexeHomme                         0.439002
grpage[25,45)                    -0.420306
grpage[45,65)                    -1.085463
grpage[65,93]                    -1.379274
etudSecondaire                    0.948312
etudTechnique/Professionnel       1.047156
etudSupérieur                     1.889621
etudNA                            2.148545
religPratiquant occasionnel      -0.020597
religAppartenance sans pratique  -0.006176
religNi croyance ni appartenance -0.214067
religRejet                       -0.382744
religNSP ou NVPR                 -0.083361
heures.tv                        -0.120724
                                 Std. Error
(Intercept)                        0.323833
sexeHomme                          0.106063
grpage[25,45)                      0.228042
grpage[45,65)                      0.237704
grpage[65,93]                      0.273794
etudSecondaire                     0.197427
etudTechnique/Professionnel        0.189777
etudSupérieur                      0.195190
etudNA                             0.330198
religPratiquant occasionnel        0.189203
religAppartenance sans pratique    0.174709
religNi croyance ni appartenance   0.193096
religRejet                         0.285878
religNSP ou NVPR                   0.410968
heures.tv                          0.033589
                                 z value Pr(&gt;|z|)
(Intercept)                       -2.462 0.013806
sexeHomme                          4.139 3.49e-05
grpage[25,45)                     -1.843 0.065313
grpage[45,65)                     -4.566 4.96e-06
grpage[65,93]                     -5.038 4.71e-07
etudSecondaire                     4.803 1.56e-06
etudTechnique/Professionnel        5.518 3.43e-08
etudSupérieur                      9.681  &lt; 2e-16
etudNA                             6.507 7.67e-11
religPratiquant occasionnel       -0.109 0.913311
religAppartenance sans pratique   -0.035 0.971801
religNi croyance ni appartenance  -1.109 0.267600
religRejet                        -1.339 0.180624
religNSP ou NVPR                  -0.203 0.839260
heures.tv                         -3.594 0.000325
                                    
(Intercept)                      *  
sexeHomme                        ***
grpage[25,45)                    .  
grpage[45,65)                    ***
grpage[65,93]                    ***
etudSecondaire                   ***
etudTechnique/Professionnel      ***
etudSupérieur                    ***
etudNA                           ***
religPratiquant occasionnel         
religAppartenance sans pratique     
religNi croyance ni appartenance    
religRejet                          
religNSP ou NVPR                    
heures.tv                        ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2607.4  on 1992  degrees of freedom
Residual deviance: 2205.9  on 1978  degrees of freedom
  (7 observations deleted due to missingness)
AIC: 2235.9

Number of Fisher Scoring iterations: 4</code></pre>
<p>Dans le cadre d’un modèle logistique, généralement on ne présente pas les <dfn data-index="coefficient, modèle">coefficients</dfn> du modèle mais leur valeur exponentielle, cette dernière correspondant en effet à des <dfn data-index="odds ratio" lang="en">odds ratio</dfn>, également appelés <dfn data-index="rapport des cotes">rapports des cotes</dfn>. L’odds ratio diffère du <dfn>risque relatif</dfn><dfn data-index="relatif, risque"></dfn>. Cependent son interprétation est similaire. Un <em>odds ratio</em> de 1 signifie l’absence d’effet. Un <em>odds ratio</em> largement supérieur à 1 correspond à une augmentation du phénomène étudié et un <em>odds ratio</em> largement inféieur à 1 correspond à une diminution du phénomène étudié<a href="#regression-logistique_fn1" class="footnoteRef" id="regression-logistique_fnref1"><sup>1</sup></a>.</p>
<p>La fonction <code data-pkg="stats">coef</code> permet d’obtenir les coefficients d’un modèle, <code data-pkg="stats">confint</code> leurs intervalles de confiance et <code data-pkg="base" data-rdoc="log">exp</code> de calculer l’exponentiel. Les <em>odds ratio</em> et leurs <dfn data-index="intervalle de confiance d'un odds ratio">intervalles de confiance</dfn><dfn data-index="odds ratio, intervalle de confiance"></dfn> s’obtiennent ainsi :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">exp</span>(<span class="kw">coef</span>(reg))</code></pre></div>
<pre><code>                     (Intercept) 
                       0.4505151 
                       sexeHomme 
                       1.5511577 
                   grpage[25,45) 
                       0.6568456 
                   grpage[45,65) 
                       0.3377455 
                   grpage[65,93] 
                       0.2517614 
                  etudSecondaire 
                       2.5813476 
     etudTechnique/Professionnel 
                       2.8495358 
                   etudSupérieur 
                       6.6168632 
                          etudNA 
                       8.5723745 
     religPratiquant occasionnel 
                       0.9796133 
 religAppartenance sans pratique 
                       0.9938431 
religNi croyance ni appartenance 
                       0.8072940 
                      religRejet 
                       0.6819874 
                religNSP ou NVPR 
                       0.9200190 
                       heures.tv 
                       0.8862785 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">exp</span>(<span class="kw">confint</span>(reg))</code></pre></div>
<pre><code>Waiting for profiling to be done...</code></pre>
<pre><code>                                     2.5 %
(Intercept)                      0.2379725
sexeHomme                        1.2605519
grpage[25,45)                    0.4195082
grpage[45,65)                    0.2115297
grpage[65,93]                    0.1466915
etudSecondaire                   1.7613423
etudTechnique/Professionnel      1.9764492
etudSupérieur                    4.5427464
etudNA                           4.5265421
religPratiquant occasionnel      0.6767575
religAppartenance sans pratique  0.7067055
religNi croyance ni appartenance 0.5531366
religRejet                       0.3872078
religNSP ou NVPR                 0.3998878
heures.tv                        0.8291800
                                     97.5 %
(Intercept)                       0.8480538
sexeHomme                         1.9106855
grpage[25,45)                     1.0275786
grpage[45,65)                     0.5380619
grpage[65,93]                     0.4296919
etudSecondaire                    3.8240276
etudTechnique/Professionnel       4.1639745
etudSupérieur                     9.7745023
etudNA                           16.5563346
religPratiquant occasionnel       1.4217179
religAppartenance sans pratique   1.4026763
religNi croyance ni appartenance  1.1798422
religRejet                        1.1898605
religNSP ou NVPR                  2.0221544
heures.tv                         0.9459484</code></pre>
<p>On pourra faciliter la lecture en combinant les deux :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">exp</span>(<span class="kw">cbind</span>(<span class="kw">coef</span>(reg), <span class="kw">confint</span>(reg)))</code></pre></div>
<pre><code>Waiting for profiling to be done...</code></pre>
<pre><code>                                          
(Intercept)                      0.4505151
sexeHomme                        1.5511577
grpage[25,45)                    0.6568456
grpage[45,65)                    0.3377455
grpage[65,93]                    0.2517614
etudSecondaire                   2.5813476
etudTechnique/Professionnel      2.8495358
etudSupérieur                    6.6168632
etudNA                           8.5723745
religPratiquant occasionnel      0.9796133
religAppartenance sans pratique  0.9938431
religNi croyance ni appartenance 0.8072940
religRejet                       0.6819874
religNSP ou NVPR                 0.9200190
heures.tv                        0.8862785
                                     2.5 %
(Intercept)                      0.2379725
sexeHomme                        1.2605519
grpage[25,45)                    0.4195082
grpage[45,65)                    0.2115297
grpage[65,93]                    0.1466915
etudSecondaire                   1.7613423
etudTechnique/Professionnel      1.9764492
etudSupérieur                    4.5427464
etudNA                           4.5265421
religPratiquant occasionnel      0.6767575
religAppartenance sans pratique  0.7067055
religNi croyance ni appartenance 0.5531366
religRejet                       0.3872078
religNSP ou NVPR                 0.3998878
heures.tv                        0.8291800
                                     97.5 %
(Intercept)                       0.8480538
sexeHomme                         1.9106855
grpage[25,45)                     1.0275786
grpage[45,65)                     0.5380619
grpage[65,93]                     0.4296919
etudSecondaire                    3.8240276
etudTechnique/Professionnel       4.1639745
etudSupérieur                     9.7745023
etudNA                           16.5563346
religPratiquant occasionnel       1.4217179
religAppartenance sans pratique   1.4026763
religNi croyance ni appartenance  1.1798422
religRejet                        1.1898605
religNSP ou NVPR                  2.0221544
heures.tv                         0.9459484</code></pre>
<p>Pour savoir si un <em>odds ratio</em> diffère significativement de 1 (ce qui est identique au fait que le coefficient soit différent de 0), on pourra se référer à la colonne <em>Pr(&gt;|z|)</em> obtenue avec <code data-pkg="stats" data-rdoc="summary.glm">summary</code>.</p>
<p>Si vous disposez de l’extension <code class="pkg">questionr</code>, la fonction <code data-pacakge="questionr">odds.ratio</code> permet de calculer directement les <em>odds ratio</em>, leur intervalles de confiance et les <em>p-value</em> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">odds.ratio</span>(reg)</code></pre></div>
<pre><code>Waiting for profiling to be done...</code></pre>
<pre><code>                                      OR   2.5 %
(Intercept)                      0.45052 0.23797
sexeHomme                        1.55116 1.26055
grpage[25,45)                    0.65685 0.41951
grpage[45,65)                    0.33775 0.21153
grpage[65,93]                    0.25176 0.14669
etudSecondaire                   2.58135 1.76134
etudTechnique/Professionnel      2.84954 1.97645
etudSupérieur                    6.61686 4.54275
etudNA                           8.57237 4.52654
religPratiquant occasionnel      0.97961 0.67676
religAppartenance sans pratique  0.99384 0.70671
religNi croyance ni appartenance 0.80729 0.55314
religRejet                       0.68199 0.38721
religNSP ou NVPR                 0.92002 0.39989
heures.tv                        0.88628 0.82918
                                  97.5 %
(Intercept)                       0.8481
sexeHomme                         1.9107
grpage[25,45)                     1.0276
grpage[45,65)                     0.5381
grpage[65,93]                     0.4297
etudSecondaire                    3.8240
etudTechnique/Professionnel       4.1640
etudSupérieur                     9.7745
etudNA                           16.5563
religPratiquant occasionnel       1.4217
religAppartenance sans pratique   1.4027
religNi croyance ni appartenance  1.1798
religRejet                        1.1899
religNSP ou NVPR                  2.0222
heures.tv                         0.9459
                                         p    
(Intercept)                      0.0138062 *  
sexeHomme                        3.488e-05 ***
grpage[25,45)                    0.0653132 .  
grpage[45,65)                    4.961e-06 ***
grpage[65,93]                    4.713e-07 ***
etudSecondaire                   1.560e-06 ***
etudTechnique/Professionnel      3.432e-08 ***
etudSupérieur                    &lt; 2.2e-16 ***
etudNA                           7.674e-11 ***
religPratiquant occasionnel      0.9133105    
religAppartenance sans pratique  0.9718010    
religNi croyance ni appartenance 0.2675998    
religRejet                       0.1806239    
religNSP ou NVPR                 0.8392596    
heures.tv                        0.0003255 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>Il est possible de représenter graphiquement les différents odds ratios. Pour cela, on va utiliser la fonction <code data-pkg="broom" data-rdoc="gm_tidiers">tidy</code> de l’extension <code class="pkg">broom</code> pour récupérer les coefficients du modèle sous la forme d’un tableau de données exploitable avec <code class="pkg">ggplot2</code>. On précisera <code>conf.int = TRUE</code> pour obtenir les intervalles de confiance et <code>exponentiate = TRUE</code> pour avoir les odds ratio plutôt que les coefficients bruts. <code data-pkg="ggplot2" data-rdoc="geom_crossbar">geom_errorbarh</code> permets de représenter les intervalles de confiance sous forme de barres d’erreurs, <code data-pkg="ggplot2" data-rdoc="geom_abline">geom_vline</code> une ligne verticale au niveau <code>x = 1</code>, <code data-pkg="ggplot2" data-rdoc="scale_continuous">scale_x_log10</code> pour afficher l’axe des <code>x</code> de manière logarithmique, les odds ratios étant de nature multiplicative et non additive.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(broom)
tmp &lt;-<span class="st"> </span><span class="kw">tidy</span>(reg, <span class="dt">conf.int =</span> <span class="ot">TRUE</span>, <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>)
<span class="kw">str</span>(tmp)</code></pre></div>
<pre><code>'data.frame':   15 obs. of  7 variables:
 $ term     : chr  "(Intercept)" "sexeHomme" "grpage[25,45)" "grpage[45,65)" ...
 $ estimate : num  0.451 1.551 0.657 0.338 0.252 ...
 $ std.error: num  0.324 0.106 0.228 0.238 0.274 ...
 $ statistic: num  -2.46 4.14 -1.84 -4.57 -5.04 ...
 $ p.value  : num  1.38e-02 3.49e-05 6.53e-02 4.96e-06 4.71e-07 ...
 $ conf.low : num  0.238 1.261 0.42 0.212 0.147 ...
 $ conf.high: num  0.848 1.911 1.028 0.538 0.43 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(tmp) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> estimate, <span class="dt">y =</span> term, <span class="dt">xmin =</span> conf.low, 
  <span class="dt">xmax =</span> conf.high) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_errorbarh</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_log10</span>()</code></pre></div>
<img src="graphs/regression-logistique/unnamed-chunk-16-1.png" width="1050"><figcaption>
Représentation graphique des odds ratios
</figcaption></figure><p>La fonction <code data-pkg="GGally">ggcoef</code> de l’extension <code class="pkg">GGally</code> permet d’effectuer le graphique précédent directement à partir de notre modèle. Voir l’aide de cette fonction pour la liste complète des paramètres personnalisables.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(GGally)
<span class="kw">ggcoef</span>(reg, <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>)</code></pre></div>
<img src="graphs/regression-logistique/unnamed-chunk-17-1.png" width="1050"><figcaption>
La fonction ggcoef
</figcaption></figure><div class="note">
<p>L’extension <code class="pkg">JLutils</code>, disponible uniquement sur GitHub, propose une fonction intéressante dans ce contexte. Pour l’installer ou la mettre à jour, si ce n’est déjà fait, on aura recours à la commande ci-après.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">"larmarange/JLutils"</span>)</code></pre></div>
<p>La fonction <code data-pkg="JLutils">tidy_detailed</code> est une version <q>élargie</q> de <code data-pkg="broom">tidy</code> qui rajoute des colonnes supplémentaires avec le nom des variables et des modalités.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(<span class="kw">tidy</span>(reg))</code></pre></div>
<pre><code>'data.frame':   15 obs. of  5 variables:
 $ term     : chr  "(Intercept)" "sexeHomme" "grpage[25,45)" "grpage[45,65)" ...
 $ estimate : num  -0.797 0.439 -0.42 -1.085 -1.379 ...
 $ std.error: num  0.324 0.106 0.228 0.238 0.274 ...
 $ statistic: num  -2.46 4.14 -1.84 -4.57 -5.04 ...
 $ p.value  : num  1.38e-02 3.49e-05 6.53e-02 4.96e-06 4.71e-07 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(JLutils)</code></pre></div>
<pre><code>Loading required package: plyr</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(<span class="kw">tidy_detailed</span>(reg))</code></pre></div>
<pre><code>'data.frame':   14 obs. of  10 variables:
 $ term          : chr  "etudNA" "etudSecondaire" "etudSupérieur" "etudTechnique/Professionnel" ...
 $ estimate      : num  2.149 0.948 1.89 1.047 -0.42 ...
 $ std.error     : num  0.33 0.197 0.195 0.19 0.228 ...
 $ statistic     : num  6.51 4.8 9.68 5.52 -1.84 ...
 $ p.value       : num  7.67e-11 1.56e-06 3.63e-22 3.43e-08 6.53e-02 ...
 $ variable      : chr  "etud" "etud" "etud" "etud" ...
 $ variable_label: chr  "etud" "etud" "etud" "etud" ...
 $ level         : chr  NA "Secondaire" "Supérieur" "Technique/Professionnel" ...
 $ level_detail  : chr  "NA vs. Primaire" "Secondaire vs. Primaire" "Supérieur vs. Primaire" "Technique/Professionnel vs. Primaire" ...
 $ label         : chr  "NA vs. Primaire" "Secondaire vs. Primaire" "Supérieur vs. Primaire" "Technique/Professionnel vs. Primaire" ...</code></pre>
<p>Il est possible de combiner <code data-pkg="JLutils">tidy_detailed</code> avec <code data-pkg="GGally">ggcoef</code> pour personnaliser un peu plus le résultat.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">td &lt;-<span class="st"> </span><span class="kw">tidy_detailed</span>(reg, <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>, <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)
td<span class="op">$</span>label &lt;-<span class="st"> </span><span class="kw">factor</span>(td<span class="op">$</span>label, <span class="kw">rev</span>(td<span class="op">$</span>label))  <span class="co"># Pour fixer l'ordre pour ggplot2</span>
<span class="kw">ggcoef</span>(td, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">y =</span> level_detail, <span class="dt">x =</span> estimate, 
  <span class="dt">colour =</span> variable_label), <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="graphs/regression-logistique/unnamed-chunk-20-1.png" width="1050"></p>
</div>
<p>L’extension <code class="pkg">effects</code> propose une représentation graphique résumant les effets de chaque variable du modèle. Pour cela, il suffit d’appliquer la méthode <code data-pkg="effects" data-rdoc="summary.effect">plot</code> au résultat de la fonction <code data-pkg="effects" data-rdoc="effect">allEffects</code>. Nous obtenons alors la <a href="#regression-logistique_reglog_alleffects">figure ci-dessous</a>.</p>
<figure id="regression-logistique_reglog_alleffects"><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(effects)
<span class="kw">plot</span>(<span class="kw">allEffects</span>(reg))</code></pre></div>
<img src="graphs/regression-logistique/plot_allEffects-1.png" width="1050"><figcaption>
Représentation graphique de l’effet de chaque variable du modèle logistique
</figcaption></figure><p>Une manière de tester la qualité d’un modèle est le calcul d’une <dfn>matrice de confusion</dfn><dfn data-index="confusion, matrice"></dfn>, c’est-à-dire le tableau croisé des valeurs observées et celles des valeurs prédites en appliquant le modèle aux données d’origine.</p>
<p>La méthode <code data-pkg="stats" data-rdoc="predict.glm">predict</code> avec l’argument <code>type="response"</code> permet d’appliquer notre modèle logistique à un tableau de données et renvoie pour chaque individu la probabilité qu’il ait vécu le phénomène étudié.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sport.pred &lt;-<span class="st"> </span><span class="kw">predict</span>(reg, <span class="dt">type =</span> <span class="st">"response"</span>, <span class="dt">newdata =</span> d)
<span class="kw">head</span>(sport.pred)</code></pre></div>
<pre><code>         1          2          3          4 
0.61251214 0.73426878 0.16004519 0.70335574 
         5          6 
0.07318189 0.34841147 </code></pre>
<p>Or notre variable étudiée est de type binaire. Nous devons donc transformer nos probabilités prédites en une variable du type « oui / non ». Usuellement, les probabilités prédites seront réunies en deux groupes selon qu’elles soient supérieures ou inférieures à la moitié. La matrice de confusion est alors égale à :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(sport.pred <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>, d<span class="op">$</span>sport)</code></pre></div>
<pre><code>       
         Non  Oui
  FALSE 1074  384
  TRUE   199  336</code></pre>
<p>Nous avons donc 583 (384+199) prédictions incorrectes sur un total de 1993, soit un taux de mauvais classement de 29,3 %.</p>
</div>
<div id="regression-logistique_selection-de-modeles" class="section level2">
<h2>Sélection de modèles</h2>
<p>Il est toujours tentant lorsque l’on recherche les facteurs associés à un phénomène d’inclure un nombre important de variables explicatives potentielles dans un mmodèle logistique. Cependant, un tel modèle n’est pas forcément le plus efficace et certaines variables n’auront probablement pas d’effet significatif sur la variable d’intérêt.</p>
<p>La technique de <dfn>sélection descendante pas à pas</dfn><dfn data-index="pas à pas, sélection descendante"></dfn> est une approche visant à améliorer son modèle explicatif<a href="#regression-logistique_fn2" class="footnoteRef" id="regression-logistique_fnref2"><sup>2</sup></a>. On réalise un premier modèle avec toutes les variables spécifiées, puis on regarde s’il est possible d’améliorer le modèle en supprimant une des variables du modèle. Si plusieurs variables permettent d’améliorer le modèle, on supprimera la variable dont la suppression améliorera le plus le modèle. Puis on recommence le même procédé pour voir si la suppression d’une seconde variable peut encore améliorer le modèle et ainsi de suite. Lorsque le modèle ne peut plus être améliorer par la suppresion d’une variable, on s’arrête.</p>
<p>Il faut également définir un critère pour déterminer la qualité d’un modèle. L’un des plus utilisés est le <dfn lang="en">Akaike Information Criterion</dfn> ou <dfn>AIC</dfn>. Plus l’AIC sera faible, meilleure sera le modèle.</p>
<p>La fonction <code data-pkg="stats">step</code> permet justement de sélectionner le meilleur modèle par une procédure pas à pas descendante basée sur la minimisation de l’AIC. La fonction affiche à l’écran les différentes étapes de la sélection et renvoie le modèle final.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reg2 &lt;-<span class="st"> </span><span class="kw">step</span>(reg)</code></pre></div>
<pre><code>Start:  AIC=2235.94
sport ~ sexe + grpage + etud + relig + heures.tv

            Df Deviance    AIC
- relig      5   2210.2 2230.2
&lt;none&gt;           2205.9 2235.9
- heures.tv  1   2219.3 2247.3
- sexe       1   2223.2 2251.2
- grpage     3   2258.7 2282.7
- etud       4   2329.6 2351.6

Step:  AIC=2230.15
sport ~ sexe + grpage + etud + heures.tv

            Df Deviance    AIC
&lt;none&gt;           2210.2 2230.2
- heures.tv  1   2223.7 2241.7
- sexe       1   2226.1 2244.1
- grpage     3   2260.3 2274.3
- etud       4   2333.8 2345.8</code></pre>
<p>Le modèle initial a un AIC de 2235,9. À la première étape, il apparait que la suppression de la variable religion permet diminuer l’AIC à 2230,2. Lors de la seconde étape, toute suppression d’une autre variable ferait augmenter l’AIC. La procédure s’arrête donc.</p>
</div>
<div id="regression-logistique_regression-logistique-multinomiale" class="section level2">
<h2>Régression logistique multinomiale</h2>
<p>La <dfn>régression logistique multinomiale</dfn> est une extension de la régression logistique aux variables qualitatives à trois modalités ou plus. Dans ce cas de figure, chaque modalité de la variable d’intérêt sera comparée à la modalité de réference. Les <em>odds ratio</em> seront donc exprimés par rapport à cette dernière.</p>
<p>Nous allons prendre pour exemple la variable <em>trav.satisf</em>, à savoir la satisfaction ou l’insatisfaction au travail.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">freq</span>(d<span class="op">$</span>trav.satisf)</code></pre></div>
<pre><code>                 n    % val%
Satisfaction   480 24.0 45.8
Insatisfaction 117  5.9 11.2
Equilibre      451 22.6 43.0
NA             952 47.6   NA</code></pre>
<p>Nous allons choisir comme modalité de référence la position intermédiaire, à savoir l’« équilibre ».</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>trav.satisf &lt;-<span class="st"> </span><span class="kw">relevel</span>(d<span class="op">$</span>trav.satisf, <span class="st">"Equilibre"</span>)</code></pre></div>
<p>Enfin, nous allons aussi en profiter pour raccourcir les étiquettes de la variable <em>trav.imp</em> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(d<span class="op">$</span>trav.imp) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Le plus"</span>, <span class="st">"Aussi"</span>, <span class="st">"Moins"</span>, 
  <span class="st">"Peu"</span>)</code></pre></div>
<p>Pour calculer un modèle logistique multinomial, nous allons utiliser la fonction <code data-pkg="nnet">multinom</code> de l’extension <code class="pkg">nnet</code><a href="#regression-logistique_fn3" class="footnoteRef" id="regression-logistique_fnref3"><sup>3</sup></a>. La syntaxe de <code data-pkg="nnet">multinom</code> est similaire à celle de <code data-pkg="stats">glm</code>, le paramètre <code>family</code> en moins.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(nnet)
regm &lt;-<span class="st"> </span><span class="kw">multinom</span>(trav.satisf <span class="op">~</span><span class="st"> </span>sexe <span class="op">+</span><span class="st"> </span>etud <span class="op">+</span><span class="st"> </span>grpage <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>trav.imp, <span class="dt">data =</span> d)</code></pre></div>
<pre><code># weights:  39 (24 variable)
initial  value 1151.345679 
iter  10 value 977.348901
iter  20 value 969.849189
iter  30 value 969.522965
final  value 969.521855 
converged</code></pre>
<p>Comme pour la régression logistique, il est possible de réaliser une sélection pas à pas descendante :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">regm2 &lt;-<span class="st"> </span><span class="kw">step</span>(regm)</code></pre></div>
<pre><code>Start:  AIC=1987.04
trav.satisf ~ sexe + etud + grpage + trav.imp

trying - sexe 
# weights:  36 (22 variable)
initial  value 1151.345679 
iter  10 value 978.538886
iter  20 value 970.453555
iter  30 value 970.294459
final  value 970.293988 
converged
trying - etud 
# weights:  27 (16 variable)
initial  value 1151.345679 
iter  10 value 987.907714
iter  20 value 981.785467
iter  30 value 981.762800
final  value 981.762781 
converged
trying - grpage 
# weights:  30 (18 variable)
initial  value 1151.345679 
iter  10 value 979.485430
iter  20 value 973.175923
final  value 973.172389 
converged
trying - trav.imp 
# weights:  30 (18 variable)
initial  value 1151.345679 
iter  10 value 998.803976
iter  20 value 994.417973
iter  30 value 994.378914
final  value 994.378869 
converged
           Df      AIC
- grpage   18 1982.345
- sexe     22 1984.588
&lt;none&gt;     24 1987.044
- etud     16 1995.526
- trav.imp 18 2024.758
# weights:  30 (18 variable)
initial  value 1151.345679 
iter  10 value 979.485430
iter  20 value 973.175923
final  value 973.172389 
converged

Step:  AIC=1982.34
trav.satisf ~ sexe + etud + trav.imp

trying - sexe 
# weights:  27 (16 variable)
initial  value 1151.345679 
iter  10 value 976.669670
iter  20 value 973.928385
iter  20 value 973.928377
iter  20 value 973.928377
final  value 973.928377 
converged
trying - etud 
# weights:  18 (10 variable)
initial  value 1151.345679 
iter  10 value 988.413720
final  value 985.085797 
converged
trying - trav.imp 
# weights:  21 (12 variable)
initial  value 1151.345679 
iter  10 value 1001.517287
final  value 998.204280 
converged
           Df      AIC
- sexe     16 1979.857
&lt;none&gt;     18 1982.345
- etud     10 1990.172
- trav.imp 12 2020.409
# weights:  27 (16 variable)
initial  value 1151.345679 
iter  10 value 976.669670
iter  20 value 973.928385
iter  20 value 973.928377
iter  20 value 973.928377
final  value 973.928377 
converged

Step:  AIC=1979.86
trav.satisf ~ etud + trav.imp

trying - etud 
# weights:  15 (8 variable)
initial  value 1151.345679 
iter  10 value 986.124104
final  value 986.034023 
converged
trying - trav.imp 
# weights:  18 (10 variable)
initial  value 1151.345679 
iter  10 value 1000.225356
final  value 998.395273 
converged
           Df      AIC
&lt;none&gt;     16 1979.857
- etud      8 1988.068
- trav.imp 10 2016.791</code></pre>
<p>La plupart des fonctions vues précédemment fonctionnent :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(regm2)</code></pre></div>
<pre><code>Call:
multinom(formula = trav.satisf ~ etud + trav.imp, data = d)

Coefficients:
               (Intercept) etudSecondaire
Satisfaction    -0.1110996     0.04916210
Insatisfaction  -1.1213760    -0.09737523
               etudTechnique/Professionnel
Satisfaction                    0.07793241
Insatisfaction                  0.08392603
               etudSupérieur      etudNA
Satisfaction      0.69950061 -0.53841577
Insatisfaction    0.07755307 -0.04364055
               trav.impAussi trav.impMoins
Satisfaction       0.2578973    -0.1756206
Insatisfaction    -0.2279774    -0.5330349
               trav.impPeu
Satisfaction    -0.5995051
Insatisfaction   1.3401509

Std. Errors:
               (Intercept) etudSecondaire
Satisfaction     0.4520902      0.2635573
Insatisfaction   0.6516992      0.3999875
               etudTechnique/Professionnel
Satisfaction                     0.2408483
Insatisfaction                   0.3579684
               etudSupérieur    etudNA
Satisfaction       0.2472571 0.5910993
Insatisfaction     0.3831110 0.8407592
               trav.impAussi trav.impMoins
Satisfaction       0.4260623     0.4115818
Insatisfaction     0.6213781     0.5941721
               trav.impPeu
Satisfaction     0.5580115
Insatisfaction   0.6587383

Residual Deviance: 1947.857 
AIC: 1979.857 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">odds.ratio</span>(regm2)</code></pre></div>
<pre><code>                                                 OR
Satisfaction/(Intercept)                   0.894850
Satisfaction/etudSecondaire                1.050391
Satisfaction/etudTechnique/Professionnel   1.081050
Satisfaction/etudSupérieur                 2.012747
Satisfaction/etudNA                        0.583672
Satisfaction/trav.impAussi                 1.294206
Satisfaction/trav.impMoins                 0.838936
Satisfaction/trav.impPeu                   0.549083
Insatisfaction/(Intercept)                 0.325831
Insatisfaction/etudSecondaire              0.907216
Insatisfaction/etudTechnique/Professionnel 1.087548
Insatisfaction/etudSupérieur               1.080640
Insatisfaction/etudNA                      0.957298
Insatisfaction/trav.impAussi               0.796142
Insatisfaction/trav.impMoins               0.586821
Insatisfaction/trav.impPeu                 3.819620
                                              2.5 %
Satisfaction/(Intercept)                   0.368918
Satisfaction/etudSecondaire                0.626629
Satisfaction/etudTechnique/Professionnel   0.674272
Satisfaction/etudSupérieur                 1.239720
Satisfaction/etudNA                        0.183242
Satisfaction/trav.impAussi                 0.561485
Satisfaction/trav.impMoins                 0.374447
Satisfaction/trav.impPeu                   0.183932
Insatisfaction/(Intercept)                 0.090838
Insatisfaction/etudSecondaire              0.414229
Insatisfaction/etudTechnique/Professionnel 0.539194
Insatisfaction/etudSupérieur               0.510007
Insatisfaction/etudNA                      0.184243
Insatisfaction/trav.impAussi               0.235544
Insatisfaction/trav.impMoins               0.183124
Insatisfaction/trav.impPeu                 1.050270
                                            97.5 %
Satisfaction/(Intercept)                    2.1706
Satisfaction/etudSecondaire                 1.7607
Satisfaction/etudTechnique/Professionnel    1.7332
Satisfaction/etudSupérieur                  3.2678
Satisfaction/etudNA                         1.8591
Satisfaction/trav.impAussi                  2.9831
Satisfaction/trav.impMoins                  1.8796
Satisfaction/trav.impPeu                    1.6391
Insatisfaction/(Intercept)                  1.1687
Insatisfaction/etudSecondaire               1.9869
Insatisfaction/etudTechnique/Professionnel  2.1936
Insatisfaction/etudSupérieur                2.2897
Insatisfaction/etudNA                       4.9740
Insatisfaction/trav.impAussi                2.6910
Insatisfaction/trav.impMoins                1.8805
Insatisfaction/trav.impPeu                 13.8912
                                                  p
Satisfaction/(Intercept)                   0.805878
Satisfaction/etudSecondaire                0.852027
Satisfaction/etudTechnique/Professionnel   0.746260
Satisfaction/etudSupérieur                 0.004669
Satisfaction/etudNA                        0.362363
Satisfaction/trav.impAussi                 0.544977
Satisfaction/trav.impMoins                 0.669600
Satisfaction/trav.impPeu                   0.282661
Insatisfaction/(Intercept)                 0.085306
Insatisfaction/etudSecondaire              0.807660
Insatisfaction/etudTechnique/Professionnel 0.814635
Insatisfaction/etudSupérieur               0.839581
Insatisfaction/etudNA                      0.958603
Insatisfaction/trav.impAussi               0.713701
Insatisfaction/trav.impMoins               0.369663
Insatisfaction/trav.impPeu                 0.041909
                                             
Satisfaction/(Intercept)                     
Satisfaction/etudSecondaire                  
Satisfaction/etudTechnique/Professionnel     
Satisfaction/etudSupérieur                 **
Satisfaction/etudNA                          
Satisfaction/trav.impAussi                   
Satisfaction/trav.impMoins                   
Satisfaction/trav.impPeu                     
Insatisfaction/(Intercept)                 . 
Insatisfaction/etudSecondaire                
Insatisfaction/etudTechnique/Professionnel   
Insatisfaction/etudSupérieur                 
Insatisfaction/etudNA                        
Insatisfaction/trav.impAussi                 
Insatisfaction/trav.impMoins                 
Insatisfaction/trav.impPeu                 * 
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>De même, il est possible de calculer la matrice de confusion :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(<span class="kw">predict</span>(regm2, <span class="dt">newdata =</span> d), d<span class="op">$</span>trav.satisf)</code></pre></div>
<pre><code>                
                 Equilibre Satisfaction
  Equilibre            262          211
  Satisfaction         171          258
  Insatisfaction        18           11
                
                 Insatisfaction
  Equilibre                  49
  Satisfaction               45
  Insatisfaction             23</code></pre>
</div>
<div id="regression-logistique_survey" class="section level2">
<h2>Données pondérées et l’extension survey</h2>
<p>Lorsque l’on utilise des données pondérées, on aura recours à l’extension <code class="pkg">survey</code><a href="#regression-logistique_fn4" class="footnoteRef" id="regression-logistique_fnref4"><sup>4</sup></a>.</p>
<p>Préparons des données d’exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(survey)
dw &lt;-<span class="st"> </span><span class="kw">svydesign</span>(<span class="dt">ids =</span> <span class="op">~</span><span class="dv">1</span>, <span class="dt">data =</span> d, <span class="dt">weights =</span> <span class="op">~</span>poids)</code></pre></div>
<p>L’extension <code class="pkg">survey</code> fournit une fonction <code data-pkg="survey">svyglm</code> permettant de calculer un modèle statistique tout en prenant en compte le plan d’échantillonnage spécifié. La syntaxe de <code data-pkg="survey">svyglm</code> est proche de celle de <code data-pkg="stats">glm</code>. Cependant, le cadre d’une régression logistique, il est nécessaire d’utiliser <code>family = quasibinomial()</code> afin d’éviter un message d’erreur indiquant un nombre non entier de succès :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reg &lt;-<span class="st"> </span><span class="kw">svyglm</span>(sport <span class="op">~</span><span class="st"> </span>sexe <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>relig <span class="op">+</span><span class="st"> </span>heures.tv, 
  dw, <span class="dt">family =</span> <span class="kw">binomial</span>())</code></pre></div>
<pre><code>Warning in eval(family$initialize): non-integer
#successes in a binomial glm!</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reg &lt;-<span class="st"> </span><span class="kw">svyglm</span>(sport <span class="op">~</span><span class="st"> </span>sexe <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>relig <span class="op">+</span><span class="st"> </span>heures.tv, 
  dw, <span class="dt">family =</span> <span class="kw">quasibinomial</span>())
reg</code></pre></div>
<pre><code>Independent Sampling design (with replacement)
svydesign(ids = ~1, data = d, weights = ~poids)

Call:  svyglm(formula = sport ~ sexe + age + relig + heures.tv, dw, 
    family = quasibinomial())

Coefficients:
                     (Intercept)  
                         1.53590  
                       sexeHomme  
                         0.36526  
                             age  
                        -0.04127  
     religPratiquant occasionnel  
                         0.05577  
 religAppartenance sans pratique  
                         0.16367  
religNi croyance ni appartenance  
                         0.03988  
                      religRejet  
                        -0.14862  
                religNSP ou NVPR  
                        -0.22682  
                       heures.tv  
                        -0.18204  

Degrees of Freedom: 1994 Total (i.e. Null);  1986 Residual
  (5 observations deleted due to missingness)
Null Deviance:      2672 
Residual Deviance: 2378     AIC: NA</code></pre>
<p>Le résultat obtenu est similaire à celui de <code data-pkg="stats">glm</code> et l’on peut utiliser sans problème les fonctions <code data-pkg="survey" data-rdoc="svyglm">coef</code>, <code data-pkg="survey" data-rdoc="confint.glm">confint</code>, <code data-pkg="questionr">odds.ratio</code>, <code data-pkg="survey" data-rdoc="svyglm">predict</code> ou encore <code data-pkg="broom" data-rdoc="glm_tidiers">tidy</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">odds.ratio</span>(reg)</code></pre></div>
<pre><code>                                      OR   2.5 %
(Intercept)                      4.64553 2.57758
sexeHomme                        1.44089 1.12150
age                              0.95957 0.95181
religPratiquant occasionnel      1.05735 0.65902
religAppartenance sans pratique  1.17782 0.75911
religNi croyance ni appartenance 1.04068 0.64638
religRejet                       0.86190 0.42752
religNSP ou NVPR                 0.79707 0.32481
heures.tv                        0.83356 0.77019
                                 97.5 %         p
(Intercept)                      8.3726 3.522e-07
sexeHomme                        1.8513  0.004325
age                              0.9674 &lt; 2.2e-16
religPratiquant occasionnel      1.6965  0.817180
religAppartenance sans pratique  1.8275  0.465321
religNi croyance ni appartenance 1.6755  0.869658
religRejet                       1.7376  0.677858
religNSP ou NVPR                 1.9560  0.620504
heures.tv                        0.9022 6.786e-06
                                    
(Intercept)                      ***
sexeHomme                        ** 
age                              ***
religPratiquant occasionnel         
religAppartenance sans pratique     
religNi croyance ni appartenance    
religRejet                          
religNSP ou NVPR                    
heures.tv                        ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>Dans ses dernières versions, <code class="pkg">survey</code> fournit une méthode <code data-pkg="survey" data-rdoc="anova.svyglm">AIC.svyglm</code> permettant d’estimer un <dfn>AIC</dfn> sur un modèle calculé avec <code data-pkg="survey">svyglm</code>. Il est dès lors possible d’utiliser la fonction <code data-pkg="stats">step</code> pour réaliser une <dfn>sélection descendante pas à pas</dfn><dfn data-index="pas à pas, sélection descendante"></dfn>.</p>
<p>L’extension <code class="pkg">effects</code> n’est quant à elle pas compatible avec <code data-pkg="survey">svyglm</code><a href="#regression-logistique_fn5" class="footnoteRef" id="regression-logistique_fnref5"><sup>5</sup></a>.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="regression-logistique_fn1"><p>Pour plus de détails, voir <a href="http://www.spc.univ-lyon1.fr/polycop/odds%20ratio.htm">http://www.spc.univ-lyon1.fr/polycop/odds%20ratio.htm</a>.<a href="#regression-logistique_fnref1"><U+21A9></a></p></li>
<li id="regression-logistique_fn2"><p>Il existe également des méthodes de <em>sélection ascendante pas à pas</em>, mais nous les aborderons pas ici.<a href="#regression-logistique_fnref2"><U+21A9></a></p></li>
<li id="regression-logistique_fn3"><p>Une alternative est d’avoir recours à l’extension <code class="pkg">mlogit</code> que nous n’aborderons pas ici. Voir <a href="http://www.ats.ucla.edu/stat/r/dae/mlogit.htm" class="uri">http://www.ats.ucla.edu/stat/r/dae/mlogit.htm</a> (en anglais) pour plus de détails.<a href="#regression-logistique_fnref3"><U+21A9></a></p></li>
<li id="regression-logistique_fn4"><p>Voir le chapitre dédié aux <a href="#donnees-ponderees_survey">données pondérées</a>.<a href="#regression-logistique_fnref4"><U+21A9></a></p></li>
<li id="regression-logistique_fn5"><p>Compatibilité qui pourra éventuellement être introduite dans une future version de l’extension.<a href="#regression-logistique_fnref5"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="analyse-en-composantes-principales"><div class="fluid-row" id="analyse-en-composantes-principales_header">



<h1 class="title toc-ignore">Analyse en composantes principales (ACP)</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="analyse-des-correspondances-multiples"><div class="fluid-row" id="analyse-des-correspondances-multiples_header">



<h1 class="title toc-ignore">Analyse des correspondances multiples (ACM)</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#analyse-des-correspondances-multiples_principe-general">Principe général</a></li>
<li><a href="#analyse-des-correspondances-multiples_acm-avec-ade4">ACM avec ade4</a></li>
<li><a href="#analyse-des-correspondances-multiples_factominer">ACM avec FactoMineR</a></li>
</ul>
</div>

<div class="note">
<p>La version originale de ce chapitre a été écrite par Joseph Larmarange dans le cadre du support de cours <a href="https://github.com/larmarange/intro-r/tree/CoursM2">Introduction à l’analyse d’enquêtes avec R</a>.</p>
</div>
<p>Il existe plusieurs techniques d’<dfn>analyse factorielle</dfn><dfn data-index="factorielle, analyse"></dfn> dont les plus courantes sont l’<dfn>analyse en composante principale</dfn> (<dfn>ACP</dfn>) portant sur des <dfn data-index="variable quantitative">variables quantitatives</dfn><dfn data-index="quantitative, variable"></dfn>, l’<dfn>analyse factorielle des correspondances</dfn><dfn data-index="correspondances, analyse factorielle"></dfn> (<dfn>AFC</dfn>) portant sur deux <dfn data-index="variable qualitative">variables qualitatives</dfn><dfn data-index="qualitative, variable"></dfn> et l’<dfn>analyse des correspondances multiples</dfn> (<dfn>ACM</dfn>) portant sur plusieurs variables qualitatives (il s’agit d’une extension de l’AFC). Pour combiner des variables à la fois quantitatives et qualitatives, on pourra avoir recours à l’<dfn>analyse mixte de Hill et Smith</dfn><dfn data-index="Hill et Smith, analyse mixte"></dfn>.</p>
<p>Bien que ces techniques soient disponibles dans les extensions standards de <strong>R</strong>, il est souvent préférable d’avoir recours à deux autres extensions plus complètes, <code class="pkg">ade4</code> et <code class="pkg">FactoMineR</code>, chacune ayant ses avantages et des possibilités différentes. Voici les fonctions les plus fréquentes :</p>
<table>
<thead><tr class="header">
<th align="left">Analyse</th>
<th align="left">Variables</th>
<th align="center">Fonction standard</th>
<th align="center">Fonction <code class="pkg">ade4</code>
</th>
<th align="center">Fonctions <code class="pkg">FactoMineR</code>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ACP</td>
<td align="left">plusieurs variables quantitatives</td>
<td align="center"><code data-pkg="stats">princomp</code></td>
<td align="center"><code data-pkg="ade4">dudi.pca</code></td>
<td align="center"><code data-pkg="FactoMineR">PCA</code></td>
</tr>
<tr class="even">
<td align="left">AFC</td>
<td align="left">deux variables qualitatives</td>
<td align="center"><code data-pkg="MASS">corresp</code></td>
<td align="center"><code data-pkg="ade4">dudi.coa</code></td>
<td align="center"><code data-pkg="FactoMineR">CA</code></td>
</tr>
<tr class="odd">
<td align="left">ACM</td>
<td align="left">plusieurs variables qualitatives</td>
<td align="center"><code data-pkg="MASS">mca</code></td>
<td align="center"><code data-pkg="ade4">dudi.acm</code></td>
<td align="center"><code data-pkg="FactoMineR">MCA</code></td>
</tr>
<tr class="even">
<td align="left">Analyse mixte de Hill et Smith</td>
<td align="left">plusieurs variables quantitatives et/ou qualitatives</td>
<td align="center">—</td>
<td align="center"><code data-pkg="ade4">dudi.mix</code></td>
<td align="center">—</td>
</tr>
</tbody>
</table>
<p>Dans la suite de ce chapitre, nous n’arboderons que l’analyse des correspondances multiples (ACM).</p>
<div class="note">
<p>On trouvera également de nombreux supports de cours en français sur l’analyse factorielle sur le site de François Gilles Carpentier : <a href="http://geai.univ-brest.fr/~carpenti/" class="uri">http://geai.univ-brest.fr/~carpenti/</a>.</p>
</div>
<div id="analyse-des-correspondances-multiples_principe-general" class="section level2">
<h2>Principe général</h2>
<p>L’analyse des correspondances multiples est une technique descriptive visant à résumer l’information contenu dans un grand nombre de variables afin de faciliter l’interprétention des corrélations existantes entre ces différentes variables. On cherche à savoir quelles sont les modalités corrélées entre elles.</p>
<p>L’idée générale est la suivante<a href="#analyse-des-correspondances-multiples_fn1" class="footnoteRef" id="analyse-des-correspondances-multiples_fnref1"><sup>1</sup></a>. L’ensemble des individus peut être représenté dans un espace à plusieurs dimensions où chaque axe représente les différentes variables utilisées pour décrire chaque individu. Plus précisément, pour chaque variable qualitative, il y a autant d’axes que de modalités moins un. Ainsi il faut trois axes pour décrire une variable à quatre modalités. Un tel nuage de points est aussi difficile à interpréter que de lire directement le fichier de données. On ne voit pas les corrélations qu’il peut y avoir entre modalités, par exemple qu’aller au cinéma est plus fréquent chez les personnes habitant en milieu urbain. Afin de mieux représenter ce nuage de points, on va procéder à un changement de systèmes de coordonnées. Les individus seront dès lors projetés et représentés sur un nouveau système d’axe. Ce nouveau système d’axes est choisis de telle manière que la majorité des variations soit concentrées sur les premiers axes. Les deux-trois premiers axes permettront d’expliquer la majorité des différences observées dans l’échantillon, les autres axes n’apportant qu’une faible part additionnelle d’information. Dès lors, l’analyse pourra se concentrer sur ses premiers axes qui constitueront un bon résumé des variations observables dans l’échantillon.</p>
<p>Avant toute ACM, il est indispensable de réaliser une analyse préliminaire de chaque variable, afin de voir si toutes les classes sont aussi bien représentées ou s’il existe un déséquilibre. L’ACM est sensible aux effectifs faibles, aussi il est préférable de regrouper les classes peu représentées le cas échéant.</p>
</div>
<div id="analyse-des-correspondances-multiples_acm-avec-ade4" class="section level2">
<h2>ACM avec ade4</h2>
<p>Si l’extension <code class="pkg">ade4</code> n’est pas présente sur votre PC, il vous faut l’installer :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"ade4"</span>, <span class="dt">dep =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Dans tous les cas, il faut penser à la charger en mémoire :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ade4)</code></pre></div>
<p>Comme précédemment, nous utiliserons le fichier de données <code>hdv2003</code> fourni avec l’extension <code class="pkg">questionr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">data</span>(hdv2003)
d &lt;-<span class="st"> </span>hdv2003</code></pre></div>
<p>En premier lieu, comme dans le <a href="#regression-logistique">chapitre sur la régression logistique</a>, nous allons créer une variable groupe d’âges et regrouper les modalités de la variable « niveau d’étude ».</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>grpage &lt;-<span class="st"> </span><span class="kw">cut</span>(d<span class="op">$</span>age, <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">25</span>, <span class="dv">45</span>, <span class="dv">65</span>, <span class="dv">93</span>), <span class="dt">right =</span> <span class="ot">FALSE</span>, 
  <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>)
d<span class="op">$</span>etud &lt;-<span class="st"> </span>d<span class="op">$</span>nivetud
<span class="kw">levels</span>(d<span class="op">$</span>etud) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Primaire"</span>, <span class="st">"Primaire"</span>, <span class="st">"Primaire"</span>, 
  <span class="st">"Secondaire"</span>, <span class="st">"Secondaire"</span>, <span class="st">"Technique/Professionnel"</span>, 
  <span class="st">"Technique/Professionnel"</span>, <span class="st">"Supérieur"</span>)</code></pre></div>
<p>Ensuite, nous allons créer un tableau de données ne contenant que les variables que nous souhaitons prendre en compte pour notre analyse factorielle.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d2 &lt;-<span class="st"> </span>d[, <span class="kw">c</span>(<span class="st">"grpage"</span>, <span class="st">"sexe"</span>, <span class="st">"etud"</span>, <span class="st">"peche.chasse"</span>, 
  <span class="st">"cinema"</span>, <span class="st">"cuisine"</span>, <span class="st">"bricol"</span>, <span class="st">"sport"</span>, <span class="st">"lecture.bd"</span>)]</code></pre></div>
<p>Le calcul de l’ACM se fait tout simplement avec la fonction <code>dudi.acm</code>{data-pkg=“ade4”&gt;.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">acm &lt;-<span class="st"> </span><span class="kw">dudi.acm</span>(d2)</code></pre></div>
<p>Par défaut, la fonction affichera le graphique des <dfn data-index="valeur propre, ACM">valeurs propres</dfn> de chaque axe (nous y reviendrons) et vous demandera le nombre d’axes que vous souhaitez conserver dans les résultats. Le plus souvent, cinq axes seront largement plus que suffisants. Vous pouvez également éviter cette étape en indiquant directement à <code data-pkg="ade4">dudi.acm</code> de vous renvoyer les cinq premiers axes ainsi :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">acm &lt;-<span class="st"> </span><span class="kw">dudi.acm</span>(d2, <span class="dt">scannf =</span> <span class="ot">FALSE</span>, <span class="dt">nf =</span> <span class="dv">5</span>)</code></pre></div>
<p>Le graphique des valeurs propres peut être reproduit avec <code data-pkg="ade4" data-rdoc="scatter">screeplot</code> :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">screeplot</span>(acm)</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-8-1.png" width="1050"><figcaption>
Valeurs propres ou inerties de chaque axe
</figcaption></figure><p>Les mêmes valeurs pour les premiers axes s’obtiennent également avec <code data-pkg="ade4" data-rdoc="dudi">summary</code><a href="#analyse-des-correspondances-multiples_fn2" class="footnoteRef" id="analyse-des-correspondances-multiples_fnref2"><sup>2</sup></a> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(acm)</code></pre></div>
<pre><code>Class: acm dudi
Call: dudi.acm(df = d2, scannf = FALSE, nf = 5)

Total inertia: 1.451

Eigenvalues:
    Ax1     Ax2     Ax3     Ax4     Ax5 
 0.2474  0.1672  0.1309  0.1263  0.1176 

Projected inertia (%):
    Ax1     Ax2     Ax3     Ax4     Ax5 
 17.055  11.525   9.022   8.705   8.109 

Cumulative projected inertia (%):
    Ax1   Ax1:2   Ax1:3   Ax1:4   Ax1:5 
  17.06   28.58   37.60   46.31   54.42 

(Only 5 dimensions (out of 15) are shown)</code></pre>
<p>L’<dfn>inertie</dfn> totale est de 1,451 et l’axe 1 en explique 0,1474 soit 17 %. L’inertie projetée cumulée nous indique que les deux premiers axes expliquent à eux seuls 29 % des variations observées dans notre échantillon.</p>
<p>Pour comprendre la signification des différents axes, il importe d’identifier quelles sont les variables/ modalités qui contribuent le plus à chaque axe. Une première représentation graphique est le <dfn>cercle de corrélation</dfn><dfn data-index="corrélation, cercle"></dfn> des modalités. Pour cela, on aura recours à <code data-pkg="ade4">s.corcicle</code>. On indiquera d’abord <code>acm$co</code> si l’on souhaite représenter les modalités ou <code>acm$li</code> si l’on souhaite représenter les individus. Les deux chiffres suivant indiquent les deux axes que l’on souhaite afficher (dans le cas présent les deux premiers axes). Enfin, le paramètre <code>clabel</code> permet de modifier la taille des étiquettes.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">s.corcircle</span>(acm<span class="op">$</span>co, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dt">clabel =</span> <span class="fl">0.7</span>)</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-10-1.png" width="1050"><figcaption>
Cercle de corrélations des modalités sur les deux premiers axes
</figcaption></figure><p>On pourra avoir également recours à <code data-pkg="ade4" data-rdoc="dudi.acm">boxplot</code> pour visualiser comment se répartissent les modalités de chaque variable sur un axe donné<a href="#analyse-des-correspondances-multiples_fn3" class="footnoteRef" id="analyse-des-correspondances-multiples_fnref3"><sup>3</sup></a>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(acm)</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-11-1.png" width="1050"><figcaption>
Répartition des modalités selon le premier axe
</figcaption></figure><figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(acm, <span class="dv">2</span>)</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-12-1.png" width="1050"><figcaption>
Répartition des modalités selon le second axe
</figcaption></figure><p>Le tableau <code>acm$cr</code> contient les rapports de corrélation (variant de 0 à 1) entre les variables et les axes choisis au départ de l’ACM. Pour représenter graphiquement ces rapports, utiliser la fonction <code data-pkg="graphics">barplot</code> ainsi : <code>barplot(acm$cr[,num],names.arg=row.names( acm$cr),las=2)</code> où <code>num</code> est le numéro de l’axe à représenter. Pour l’interprétation des axes, se concentrer sur les variables les plus structurantes, c’est-à-dire dont le rapport de corrélation est le plus proche de 1.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) <span class="kw">barplot</span>(acm<span class="op">$</span>cr[, i], <span class="dt">names.arg =</span> <span class="kw">row.names</span>(acm<span class="op">$</span>cr), 
  <span class="dt">las =</span> <span class="dv">2</span>, <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">"Axe"</span>, i))</code></pre></div>
<p><img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-13-1.png" width="1050"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</code></pre></div>
<figcaption>
Rapports de corrélation des variables sur les 4 premiers axes
</figcaption></figure><div class="note">
<p>Le paramètre <code>mfrow</code> de la fonction <code data-pkg="graphics">par</code> permet d’indiquer à <strong>R</strong> que l’on souhaite afficher plusieurs graphiques sur une seule et même fenêtre, plus précisément que l’on souhaite diviser la fenêtre en deux lignes et deux colonnes.</p>
<p>Dans l’exemple précédent, après avoir produit notre graphique, nous avons réinitilisé cette valeur à <code>c(1, 1)</code> (un seul graphique par fenêtre) pour ne pas affecter les prochains graphiques que nous allons produire.</p>
</div>
<p>Pour représenter, les modalités dans le <dfn>plan factoriel</dfn><dfn data-index="factoriel, plan"></dfn>, on utilisera la fonction <code data-pkg="ade4">s.label</code>. Par défaut, les deux premiers axes sont représentés.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">s.label</span>(acm<span class="op">$</span>co, <span class="dt">clabel =</span> <span class="fl">0.7</span>)</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-14-1.png" width="1050"><figcaption>
Répartition des modalités selon les deux premiers axes
</figcaption></figure><p>Il est bien sur possible de préciser les axes à représenter. L’argument <code>boxes</code> permet quant à lui d’indiquer si l’on souhaite tracer une boîte pour chaque modalité.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">s.label</span>(acm<span class="op">$</span>co, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dt">clabel =</span> <span class="fl">0.7</span>, <span class="dt">boxes =</span> <span class="ot">FALSE</span>)</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-15-1.png" width="1050"><figcaption>
Répartition des modalités selon les axes 3 et 4
</figcaption></figure><p>Bien entendu, on peut également représenter les individus. En indiquant <code>clabel=0</code> (une taille nulle pour les étiquettes), <code data-pkg="ade4">s.label</code> remplace chaque observation par un symbole qui peut être spécifié avec <code>pch</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">s.label</span>(acm<span class="op">$</span>li, <span class="dt">clabel =</span> <span class="dv">0</span>, <span class="dt">pch =</span> <span class="dv">17</span>)</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-16-1.png" width="1050"><figcaption>
Répartition des individus selon les deux premiers axes
</figcaption></figure><div class="note">
<p>L’agument <code>pch</code> permet de spécifier le symbole à utiliser. Il peut prendre soit un nombre entier compris entre 0 et 25, soit un charactère textuel.</p>
<p><img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-17-1.png" width="1050"></p>
</div>
<div class="note">
<p>Lorsque l’on réalise une ACM, il n’est pas rare que plusieurs observations soient identiques, c’est-à-dire correspondent à la même combinaison de modalités. Dès lors, ces observations seront projetées sur le même point dans le plan factoriel. Une représentation classique des observations avec <code data-pkg="ade4">s.label</code> ne permettra pas de rendre compte les effectifs de chaque point.</p>
<p>Le package <code class="pkg">JLutils</code>, disponible seulement sur <strong><a href="https://github.com/larmarange/JLutils">GitHub</a></strong>, propose une fonction <code data-pkg="JLutils">s.freq</code> représentant chaque point par un carré proportionnel au nombre d’individus.</p>
<p>Pour installer <code class="pkg">JLutils</code>, on aura recours au package <code class="pkg">devtools</code> et à sa fonction <code data-pkg="devtools">install_github</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools)
<span class="kw">install_github</span>(<span class="st">"larmarange/JLutils"</span>)</code></pre></div>
<p>La fonction <code data-pkg="JLutils">s.freq</code> s’emploie de manière similaire aux autres fonctions graphiques de <code class="pkg">ade4</code>. Le paramètre <code>csize</code> permet d’ajuster la taille des carrés.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(JLutils)</code></pre></div>
<pre><code>Loading required package: ggplot2</code></pre>
<pre><code>Loading required package: plyr</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">s.freq</span>(acm<span class="op">$</span>li)</code></pre></div>
<p><img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-19-1.png" width="1050"></p>
<p>L’interprétation est tout autre, non ?</p>
</div>
<div class="note">
<p>Gaston Sanchez propose un graphique amélioré des modalités dans le plan factoriel à cette adresse : <a href="http://rpubs.com/gaston/MCA" class="uri">http://rpubs.com/gaston/MCA</a>.</p>
</div>
<p>La fonction <code data-pkg="ade4">s.value</code> permet notamment de représenter un troisième axe factoriel. Dans l’exemple ci-après, nous projettons les individus selon les deux premiers axes factoriels. La taille et la couleur des carrés dépendent pour leur part de la coordonnée des individus sur le troisième axe factoriel. Le paramètre <code>csi</code> permet d’ajuster la taille des carrés.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">s.value</span>(acm<span class="op">$</span>li, acm<span class="op">$</span>li[, <span class="dv">3</span>], <span class="dv">1</span>, <span class="dv">2</span>, <span class="dt">csi =</span> <span class="fl">0.5</span>)</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-20-1.png" width="1050"><figcaption>
Répartition des individus selon les trois premiers axes
</figcaption></figure><p><code data-pkg="ade4">s.arrow</code> permet de représenter les vecteurs variables ou les vecteurs individus sous la forme d’une flèche allant de l’origine du plan factoriel aux coordonnées des variables/individus :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">s.arrow</span>(acm<span class="op">$</span>co, <span class="dt">clabel =</span> <span class="fl">0.7</span>)</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-21-1.png" width="1050"><figcaption>
Vecteurs des modalités selon les deux premiers axes
</figcaption></figure><p><code data-pkg="ade4">s.hist</code> permet de représenter des individus (ou des modalités) sur le plan factoriel et d’afficher leur distribution sur chaque axe :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">s.hist</span>(acm<span class="op">$</span>li, <span class="dt">clabel =</span> <span class="dv">0</span>, <span class="dt">pch =</span> <span class="dv">15</span>)</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-22-1.png" width="1050"><figcaption>
Distribution des individus dans le plan factoriel
</figcaption></figure><p><code data-pkg="ade4">s.class</code> et <code data-pkg="ade4">s.chull</code> permettent de représenter les différentes observations classées en plusieurs catégories. Cela permet notamment de projeter certaines variables.</p>
<p><code data-pkg="ade4">s.class</code> représente les observations par des points, lie chaque observation au barycentre de la modalité à laquelle elle appartient et dessine une ellipse représentant la forme générale du nuage de points :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RColorBrewer)
<span class="kw">s.class</span>(acm<span class="op">$</span>li, d2<span class="op">$</span>sexe, <span class="dt">col =</span> <span class="kw">brewer.pal</span>(<span class="dv">4</span>, <span class="st">"Set1"</span>))</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-23-1.png" width="1050"><figcaption>
Individus dans le plan factoriel selon le sexe (s.class)
</figcaption></figure><p><code data-pkg="ade4">s.chull</code> représente les barycentres de chaque catégorie et dessine des lignes de niveaux représentant la distribution des individus de cette catégorie. Les individus ne sont pas directement représentés :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">s.chull</span>(acm<span class="op">$</span>li, d2<span class="op">$</span>sexe, <span class="dt">col =</span> <span class="kw">brewer.pal</span>(<span class="dv">4</span>, <span class="st">"Set1"</span>))</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-24-1.png" width="1050"><figcaption>
Individus dans le plan factoriel selon le sexe (s.chull)
</figcaption></figure><div class="note">
<p>Il est préférable de fournir une liste de couleurs (via le paramètre <code>col</code>) pour rendre le graphique plus lisible. Si vous avez installé l’extension <code class="pkg">RColorBrewer</code>, vous pouvez utiliser les différentes palettes de couleurs proposées. Pour afficher les palettes disponibles, utilisez <code data-pkg="RColorBrewer" data-rdoc="RColorsBrewer">display.brewer.all</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RColorBrewer)
<span class="kw">display.brewer.all</span>(<span class="dv">8</span>)</code></pre></div>
<p><img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-25-1.png" width="1050"></p>
<p>Pour obtenir une <dfn>palette de couleurs</dfn><dfn data-index="couleur, palette"></dfn>, utilisez la fonction <code data-pkg="RColorBrewer" data-rdoc="RColorsBrewer">brewer.pal</code> avec les arguments <code>n</code> (nombre de couleurs demandées) et <code>pal</code>(nom de la palette de couleurs désirée).</p>
<p>Pour plus d’informations sur les palettes <em>Color Brewer</em>, voir <a href="http://colorbrewer2.org/" class="uri">http://colorbrewer2.org/</a>.</p>
</div>
<p>La variable catégorielle transmise à <code data-pkg="ade4">s.class</code> ou <code data-pkg="ade4">s.chull</code> n’est pas obligatoirement une des variables retenues pour l’ACM. Il est tout à fait possible d’utiliser une autre variable. Par exemple :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">s.class</span>(acm<span class="op">$</span>li, d<span class="op">$</span>trav.imp, <span class="dt">col =</span> <span class="kw">brewer.pal</span>(<span class="dv">4</span>, <span class="st">"Set1"</span>))</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-26-1.png" width="1050"><figcaption>
Individus dans le plan factoriel selon l’importance donnée au travail
</figcaption></figure><p>Les fonctions <code data-pkg="ade4">scatter</code> et <code data-pkg="ade4" data-rdoc="scatter">biplot</code> sont équivalentes : elles appliquent <code data-pkg="ade4">s.class</code> à chaque variable utilisée pour l’ACM.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">scatter</span>(acm, <span class="dt">col =</span> <span class="kw">brewer.pal</span>(<span class="dv">4</span>, <span class="st">"Set1"</span>))</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-27-1.png" width="1050"><figcaption>
La fonction scatter appliquée au résultat d’une ACM
</figcaption></figure>
</div>
<div id="analyse-des-correspondances-multiples_factominer" class="section level2">
<h2>ACM avec FactoMineR</h2>
<p>Comme avec <code class="pkg">ade4</code>, il est nécessaire de préparer les données au préalable (voir section précédente).</p>
<p>L’ACM se calcule avec la fonction <code data-pkg="FactoMineR">MCA</code>, l’argument <code>ncp</code> permettant de choisir le nombre d’axes à retenir :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(FactoMineR)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">acm2 &lt;-<span class="st"> </span><span class="kw">MCA</span>(d2, <span class="dt">ncp =</span> <span class="dv">5</span>, <span class="dt">graph =</span> <span class="ot">FALSE</span>)
acm2</code></pre></div>
<pre><code>**Results of the Multiple Correspondence Analysis (MCA)**
The analysis was performed on 2000 individuals, described by 9 variables
*The results are available in the following objects:

   name             
1  "$eig"           
2  "$var"           
3  "$var$coord"     
4  "$var$cos2"      
5  "$var$contrib"   
6  "$var$v.test"    
7  "$ind"           
8  "$ind$coord"     
9  "$ind$cos2"      
10 "$ind$contrib"   
11 "$call"          
12 "$call$marge.col"
13 "$call$marge.li" 
   description                       
1  "eigenvalues"                     
2  "results for the variables"       
3  "coord. of the categories"        
4  "cos2 for the categories"         
5  "contributions of the categories" 
6  "v-test for the categories"       
7  "results for the individuals"     
8  "coord. for the individuals"      
9  "cos2 for the individuals"        
10 "contributions of the individuals"
11 "intermediate results"            
12 "weights of columns"              
13 "weights of rows"                 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">acm2<span class="op">$</span>eig</code></pre></div>
<pre><code>       eigenvalue percentage of variance
dim 1  0.25757489              15.454493
dim 2  0.18363502              11.018101
dim 3  0.16164626               9.698776
dim 4  0.12871623               7.722974
dim 5  0.12135737               7.281442
dim 6  0.11213331               6.727999
dim 7  0.10959377               6.575626
dim 8  0.10340564               6.204338
dim 9  0.09867478               5.920487
dim 10 0.09192693               5.515616
dim 11 0.07501208               4.500725
dim 12 0.06679676               4.007805
dim 13 0.06002063               3.601238
dim 14 0.05832024               3.499215
dim 15 0.03785276               2.271166
       cumulative percentage of variance
dim 1                           15.45449
dim 2                           26.47259
dim 3                           36.17137
dim 4                           43.89434
dim 5                           51.17579
dim 6                           57.90378
dim 7                           64.47941
dim 8                           70.68375
dim 9                           76.60424
dim 10                          82.11985
dim 11                          86.62058
dim 12                          90.62838
dim 13                          94.22962
dim 14                          97.72883
dim 15                         100.00000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(acm2<span class="op">$</span>eig<span class="op">$</span>eigenvalue)</code></pre></div>
<pre><code>[1] 1.666667</code></pre>
<p>En premier lieu, il apparait que l’inertie totale obtenue avec <code data-pkg="FactoMineR">MCA</code> est différente de celle observée avec <code data-pkg="ade4">dudi.acm</code>. Cela est dû à un traitement différents des <dfn data-index="valeur manquante">valeurs manquantes</dfn><dfn data-index="manquante, valeur"></dfn>. Alors que <code data-pkg="ade4">dudi.acm</code> exclu les valeurs manquantes, <code data-pkg="FactoMineR">MCA</code> les considèrent, par défaut, comme une modalité additionnelle. Pour calculer l’ACM uniquement sur les individus n’ayant pas de valeur manquante, on aura recours à <code data-pkg="stats">complete.cases</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">acm2 &lt;-<span class="st"> </span><span class="kw">MCA</span>(d2[<span class="kw">complete.cases</span>(d2), ], <span class="dt">ncp =</span> <span class="dv">5</span>, <span class="dt">graph =</span> <span class="ot">FALSE</span>)
acm2<span class="op">$</span>eig</code></pre></div>
<pre><code>       eigenvalue percentage of variance
dim 1  0.24790700              17.162792
dim 2  0.16758465              11.602014
dim 3  0.13042357               9.029324
dim 4  0.12595105               8.719688
dim 5  0.11338629               7.849820
dim 6  0.10976674               7.599236
dim 7  0.10060204               6.964757
dim 8  0.09802387               6.786268
dim 9  0.09283131               6.426783
dim 10 0.07673502               5.312425
dim 11 0.06609694               4.575942
dim 12 0.05950655               4.119684
dim 13 0.05562942               3.851267
       cumulative percentage of variance
dim 1                           17.16279
dim 2                           28.76481
dim 3                           37.79413
dim 4                           46.51382
dim 5                           54.36364
dim 6                           61.96287
dim 7                           68.92763
dim 8                           75.71390
dim 9                           82.14068
dim 10                          87.45311
dim 11                          92.02905
dim 12                          96.14873
dim 13                         100.00000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(acm2<span class="op">$</span>eig<span class="op">$</span>eigenvalue)</code></pre></div>
<pre><code>[1] 1.444444</code></pre>
<p>Les possibilités graphiques de <code class="pkg">FactoMineR</code> sont différentes de celles de <code class="pkg">ade4</code>. Un recours à la fonction <code data-pkg="FactoMineR" data-rdoc="plot.MCA">plot</code> affichera par défaut les individus, les modalités et les variables. La commande <code>?plot.MCA</code> permet d’accéder au fichier d’aide de cette fonction (i.e. de la méthode générique <code>plot</code> appliquée aux objets de type <code>MCA</code>) et de voir toutes les options graphiques. L’argument <code>choix</code> permet de spécifier ce que l’on souhaite afficher (« ind » pour les individus et les catégories, « var » pour les variables). L’argument <code>invisible</code> quant à lui permet de spécifier ce que l’on souhaite masquer. Les axes à afficher se précisent avec <code>axes</code>. Voir les exemples ci-dessous.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(acm2)</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-31-1.png" width="1050"><figcaption>
Plan factoriel (deux premiers axes)
</figcaption></figure><figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(acm2, <span class="dt">axes =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>))</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-32-1.png" width="1050"><figcaption>
Plan factoriel (axes 3 et 4)
</figcaption></figure><figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(acm2, <span class="dt">choix =</span> <span class="st">"ind"</span>)</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-33-1.png" width="1050"><figcaption>
Plan factoriel (seulement les individus et les catégories)
</figcaption></figure><figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(acm2, <span class="dt">choix =</span> <span class="st">"ind"</span>, <span class="dt">invisible =</span> <span class="st">"ind"</span>)</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-34-1.png" width="1050"><figcaption>
Plan factoriel (seulement les catégories)
</figcaption></figure><figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(acm2, <span class="dt">choix =</span> <span class="st">"var"</span>)</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-35-1.png" width="1050"><figcaption>
Plan factoriel (seulement les variables)
</figcaption></figure><p>La fonction <code data-pkg="FactoMineR">plotellipses</code> trace des ellipses de confiance atour des modalités de variables qualitatives. L’objectif est de voir si les modalités d’une variable qualitative sont significativement différentes les unes des autres.</p>
<p>Par défaut (<code>means=TRUE</code>), les ellipses de confiance sont calculées pour les coordonnées moyennes de chaque catégorie.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotellipses</span>(acm2)</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-36-1.png" width="1050"><figcaption>
Ellipses de confiance (means=TRUE) dans le plan factoriel
</figcaption></figure><p>L’option <code>means=FALSE</code> calculera les ellipses de confiance pour l’ensemble des coordonnées des observations relevant de chaque catégorie.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotellipses</span>(acm2, <span class="dt">means =</span> <span class="ot">FALSE</span>)</code></pre></div>
<img src="graphs/analyse-des-correspondances-multiples/unnamed-chunk-37-1.png" width="1050"><figcaption>
Ellipses de confiance (means=FALSE) dans le plan factoriel
</figcaption></figure><p>La fonction <code data-pkg="FactoMineR">dimdesc</code> aide à décrire et interpréter les dimensions de l’ACM. Cette fonction est très utile quand le nombre de variables est élevé. Elle permet de voir à quelles variables les axes sont le plus liés : quelles variables et quelles modalités décrivent le mieux chaque axe ?</p>
<blockquote>
<p>Pour les variables qualitatives, un modèle d’analyse de variance à un facteur est réalisé pour chaque dimension ; les variables à expliquer sont les coordonnées des individus et la variable explicative est une des variables qualitatives. Un test F permet de voir si la variable a un effet significatif sur la dimension et des tests T sont réalisés modalité par modalité (avec le contraste somme des alpha_i=0). Cela montre si les coordonnées des individus de la sous-population définie par une modalité sont significativement différentes de celles de l’ensemble de la population (<em>i.e.</em> différentes de 0). Les variables et modalités sont triées par probabilité critique et seules celles qui sont significatives sont gardées dans le résultat.</p>
<footer>
Source : <a href="http://factominer.free.fr/factosbest/description-des-dimensions.html" class="uri">http://factominer.free.fr/factosbest/description-des-dimensions.html</a>
</footer>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dimdesc</span>(acm2, <span class="dt">axes =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</code></pre></div>
<pre><code>$`Dim 1`
$`Dim 1`$quali
                      R2       p.value
etud         0.586058164  0.000000e+00
grpage       0.512231318 1.008479e-292
cinema       0.471002163 8.339548e-263
sport        0.398103140 5.940105e-210
bricol       0.179188677  7.142716e-83
cuisine      0.048233515  4.941749e-22
lecture.bd   0.017667936  6.856650e-09
sexe         0.013670717  3.546801e-07
peche.chasse 0.005007337  2.105728e-03

$`Dim 1`$category
                           Estimate       p.value
cinema_Oui               0.35033716 8.339548e-263
sport_Oui                0.33199860 5.940105e-210
[25,45)                  0.33895697 1.959716e-159
Supérieur                0.45630756 1.376719e-118
bricol_Oui               0.21255190  7.142716e-83
Technique/Professionnel  0.17291856  4.703868e-23
cuisine_Oui              0.11015793  4.941749e-22
[16,25)                  0.39553122  3.635181e-15
lecture.bd_Oui           0.22169306  6.856650e-09
Homme                    0.05853263  3.546801e-07
peche.chasse_Oui         0.05543091  2.105728e-03
peche.chasse_Non        -0.05543091  2.105728e-03
Femme                   -0.05853263  3.546801e-07
lecture.bd_Non          -0.22169306  6.856650e-09
[45,65)                 -0.13173232  2.477610e-12
cuisine_Non             -0.11015793  4.941749e-22
bricol_Non              -0.21255190  7.142716e-83
[65,93]                 -0.60275587 2.906563e-165
sport_Non               -0.33199860 5.940105e-210
cinema_Non              -0.35033716 8.339548e-263
Primaire                -0.59465967 5.269497e-268


$`Dim 2`
$`Dim 2`$quali
                     R2       p.value
sexe         0.62723828  0.000000e+00
peche.chasse 0.31109226 1.161746e-154
bricol       0.20276579  8.014713e-95
etud         0.13925513  6.754592e-61
cuisine      0.12908453  1.461380e-58
cinema       0.04039994  1.215838e-18
grpage       0.03776900  1.257795e-15
lecture.bd   0.01995653  7.190474e-10

$`Dim 2`$category
                           Estimate       p.value
Homme                    0.32598031  0.000000e+00
peche.chasse_Oui         0.35922450 1.161746e-154
bricol_Oui               0.18590016  8.014713e-95
cuisine_Non              0.14816688  1.461380e-58
Technique/Professionnel  0.23013181  5.919911e-54
cinema_Non               0.08436024  1.215838e-18
[45,65)                  0.11638978  3.028836e-17
lecture.bd_Non           0.19371997  7.190474e-10
[65,93]                 -0.02872480  1.229757e-02
[25,45)                 -0.05570792  2.294799e-09
lecture.bd_Oui          -0.19371997  7.190474e-10
Secondaire              -0.09715846  1.240732e-10
cinema_Oui              -0.08436024  1.215838e-18
Supérieur               -0.14813997  6.942611e-24
cuisine_Oui             -0.14816688  1.461380e-58
bricol_Non              -0.18590016  8.014713e-95
peche.chasse_Non        -0.35922450 1.161746e-154
Femme                   -0.32598031  0.000000e+00</code></pre>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="analyse-des-correspondances-multiples_fn1"><p>Pour une présentation plus détaillée, voir <br><a href="http://www.math.univ-toulouse.fr/~baccini/zpedago/asdm.pdf" class="uri">http://www.math.univ-toulouse.fr/~baccini/zpedago/asdm.pdf</a>.<a href="#analyse-des-correspondances-multiples_fnref1"><U+21A9></a></p></li>
<li id="analyse-des-correspondances-multiples_fn2"><p>On pourra également avoir recours à la fonction <code data-pkg="ade4">inertia.dudi</code> pour l’ensemble des axes.<a href="#analyse-des-correspondances-multiples_fnref2"><U+21A9></a></p></li>
<li id="analyse-des-correspondances-multiples_fn3"><p>La fonction <code data-pkg="ade4" data-rdoc="score.acm">score</code> constituera également une aide à l’interprétation des axes.<a href="#analyse-des-correspondances-multiples_fnref3"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="classification-ascendante-hierarchique"><div class="fluid-row" id="classification-ascendante-hierarchique_header">



<h1 class="title toc-ignore">Classification ascendante hiérarchique (CAH)</h1>

</div>

<div class="TOC">
<ul>
<li>
<a href="#classification-ascendante-hierarchique_calculer-une-matrice-des-distances">Calculer une matrice des distances</a><ul>
<li><a href="#classification-ascendante-hierarchique_distance-de-gower">Distance de Gower</a></li>
<li><a href="#classification-ascendante-hierarchique_distance-du-">Distance du F²</a></li>
<li><a href="#classification-ascendante-hierarchique_exemple">Exemple</a></li>
</ul>
</li>
<li><a href="#classification-ascendante-hierarchique_calcul-du-dendrogramme">Calcul du dendrogramme</a></li>
<li><a href="#classification-ascendante-hierarchique_decouper-le-dendrogramme">Découper le dendrogramme</a></li>
<li><a href="#classification-ascendante-hierarchique_factominer">CAH avec l’extension FactoMineR</a></li>
</ul>
</div>

<div class="note">
<p>La version originale de ce chapitre a été écrite par Joseph Larmarange dans le cadre du support de cours <a href="https://github.com/larmarange/intro-r/tree/CoursM2">Introduction à l’analyse d’enquêtes avec R</a>.</p>
</div>
<p>Il existe de nombreuses techniques statistiques visant à partinionner une population en différentes classes ou sous-groupes. La <dfn>classification ascendante hiérarchique</dfn> (<dfn>CAH</dfn>) est l’une d’entre elles. On cherche à ce que les individus regroupés au sein d’une même classe (homogénéité intra-classe) soient le plus semblables possibles tandis que les classes soient le plus dissemblables (hétérogénéité inter-classe).</p>
<p>Le principe de la CAH est de rassembler des individus selon un critère de ressemblance défini au préalable qui s’exprimera sous la forme d’une <dfn>matrice de distances</dfn>, exprimant la distance existant entre chaque individu pris deux à deux. Deux observations identiques auront une distance nulle. Plus les deux observations seront dissemblables, plus la distance sera importante. La CAH va ensuite rassembler les individus de manière itérative afin de produire un <dfn>dendrogramme</dfn> ou <dfn>arbre de classification</dfn><dfn data-index="classification, arbre"></dfn>. La classification est <em>ascendante</em> car elle part des observations individuelles ; elle est <em>hiérarchique</em> car elle produit des classes ou groupes de plus en plus vastes, incluant des sous-groupes en leur sein. En découpant cet arbre à une certaine hauteur choisie, on produira la <dfn>partition</dfn> désirée.</p>
<div class="note">
<p>On trouvera également de nombreux supports de cours en français sur la CAH sur le site de François Gilles Carpentier : <a href="http://pagesperso.univ-brest.fr/~carpenti/" class="uri">http://pagesperso.univ-brest.fr/~carpenti/</a>.</p>
</div>
<div id="classification-ascendante-hierarchique_calculer-une-matrice-des-distances" class="section level2">
<h2>Calculer une matrice des distances</h2>
<p>La notion de <dfn>ressemblance</dfn> entre observations est évaluée par une <dfn>distance</dfn> entre individus. Plusieurs type de ditances existent selon les données utilisées.</p>
<p>Il existe de nombreuses distances mathématiques pour les variables quantitatives (euclidiennes, Manhattan…) que nous n’aborderons pas ici<a href="#classification-ascendante-hierarchique_fn1" class="footnoteRef" id="classification-ascendante-hierarchique_fnref1"><sup>1</sup></a>. La plupart peuvent être calculées avec la fonction <code data-pkg="stats">dist</code>.</p>
<p>Usuellement, pour un ensemble de variables qualitatives, on aura recours à la <dfn data-index="distance du Phi²">distance du F²</dfn><dfn data-index="Phi², distance"></dfn> qui est celle utilisée pour l’analyse des correspondances multiples (voir le <a href="">chapitre dédié</a>). Avec l’extension <code class="pkg">ade4</code>, la distance du F² s’obtient avec la fonction <code data-pkg="ade4">dist.dudi</code><a href="#classification-ascendante-hierarchique_fn2" class="footnoteRef" id="classification-ascendante-hierarchique_fnref2"><sup>2</sup></a>. Le cas particulier de la CAH avec l’extension <code class="pkg">FactoMineR</code> sera abordée dans une section spécifique ci-après. Nous évoquerons également la <dfn>distance de Gower</dfn><dfn data-index="Gower, distance"></dfn> qui peut s’appliquer à un ensemble de variables à la fois qualitatives et quantitatives et qui se calcule avec la fonction <code data-pkg="cluster">daisy</code> de l’extension <code class="pkg">cluster</code>. Enfin, dans le chapitre sur l’<a href="#analyse-de-sequences">analyse de séquences</a>, nous verrons également la fonction <code data-pkg="TraMineR">seqdist</code> (extension <code class="pkg">TraMineR</code>) permettant de calculer une distance entre séquences.</p>
<div id="classification-ascendante-hierarchique_distance-de-gower" class="section level3">
<h3>Distance de Gower</h3>
<p>En 1971, Gower a proposé un <dfn>indice de similarité</dfn><dfn data-index="similarité, indice"></dfn> qui porte son nom<a href="#classification-ascendante-hierarchique_fn3" class="footnoteRef" id="classification-ascendante-hierarchique_fnref3"><sup>3</sup></a>. L’objectif de cet indice consiste à mesurer dans quelle mesure deux individus sont semblables. L’indice de Gower varie entre 0 et 1. Si l’indice vaut 1, les deux individus sont identiques. À l’opposé, s’il vaut 0, les deux individus considérés n’ont pas de point commun. Si l’on note <em>S<sub>g</sub></em> l’<dfn>indice de similarité de Gower</dfn><dfn data-index="Gower, indice de similarité"></dfn>, la distance de Gower <em>D<sub>g</sub></em> s’obtient simplement de la manière suivante : <em>D<sub>g</sub></em> = 1 - <em>S<sub>g</sub></em>. Ainsi, la distance sera nulle entre deux individus identiques et elle sera égale à 1 entre deux individus totalement différents. Cette distance s’obtient sous <strong>R</strong> avec la fonction <code data-pkg="cluster">daisy</code> du package <code class="pkg">cluster</code>.</p>
<p>L’indice de similarité de Gower entre deux individus <em>x<sub>1</sub></em> et <em>x<sub>2</sub></em> se calcule de la manière suivante :</p>
<!-- 
$$ S_{g}(x_{1},x_{2})=\frac{1}{p}\sum_{j=1}^{p}s_{12j} $$
converted on http://www2.ph.ed.ac.uk/snuggletex/MathInputDemo
-->
<p><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>S</mi><mi>g</mi></msub><mfenced close=")" open="("><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub></mfenced><mo>=</mo><mfrac><mn>1</mn><mi>p</mi></mfrac><munderover><mo><U+2211></mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><msub><mi>s</mi><mrow><mn>12</mn><mi>j</mi></mrow></msub></mrow></semantics></math></p>
<p><em>p</em> représente le nombre total de caractères (ou de variables) descriptifs utilisés pour comparer les deux individus<a href="#classification-ascendante-hierarchique_fn4" class="footnoteRef" id="classification-ascendante-hierarchique_fnref4"><sup>4</sup></a>. <em>s</em><sub>12<em>j</em></sub> représente la similarité partielle entre les individus 1 et 2 concernant le descripteur <em>j</em>. Cette similarité partielle se calcule différemment s’il s’agit d’une <dfn>variable qualitative</dfn><dfn data-index="qualitative, variable"></dfn> ou <dfn data-index="variable quantitative">quantitative</dfn><dfn data-index="quantitative, variable"></dfn> :</p>
<ul>
<li>
<strong>variable qualitative :</strong> <em>s</em><sub>12<em>j</em></sub> vaut 1 si la variable <em>j</em> prend la même valeur pour les individus 1 et 2, et vaut 0 sinon. Par exemple, si 1 et 2 sont tous les deux « grand », alors <em>s</em><sub>12<em>j</em></sub> vaudra 1. Si 1 est « grand » et 2 « petit », <em>s</em><sub>12<em>j</em></sub> vaudra 0.</li>
<li>
<strong>variable quantitative :</strong> la différence absolue entre les valeurs des deux variables est tout d’abord calculée, soit |<em>y</em><sub>1<em>j</em></sub> - <em>y</em><sub>2<em>j</em></sub>|. Puis l’écart maximum observé sur l’ensemble du fichier est déterminé et noté <em>R</em><sub><em>j</em></sub>. Dès lors, la similarité partielle vaut <em>S</em><sub>12<em>j</em></sub> = 1 - |<em>y</em><sub>1<em>j</em></sub> - <em>y</em><sub>2<em>j</em></sub>| / <em>R</em><sub><em>j</em></sub>.</li>
</ul>
<p>Dans le cas où l’on n’a que des variables qualitatives, la valeur de l’indice de Gower correspond à la proportion de caractères en commun. Supposons des individus 1 et 2 décris ainsi :</p>
<ol style="list-style-type: decimal">
<li>homme / grand / blond / étudiant / urbain</li>
<li>femme / grande / brune / étudiante / rurale</li>
</ol>
<p>Sur les 5 variables utilisées pour les décrire, 1 et 2 ont deux caractéristiques communes : ils sont grand(e)s et étudiant(e)s. Dès lors, l’indice de similarité de Gower entre 1 et 2 vaut 2/5 = 0,4 (soit une distance de 1 - 0,4 = 0,6).</p>
<p>Plusieurs approches peuvent être retenues pour traiter les valeurs manquantes :</p>
<ul>
<li>supprimer tout individu n’étant pas renseigné pour toutes les variables de l’analyse ;</li>
<li>considérer les valeurs manquantes comme une modalité en tant que telle ;</li>
<li>garder les valeurs manquantes en tant que valeurs manquantes.</li>
</ul>
<p>Le choix retenu modifiera les distances de Gower calculées. Supposons que l’on ait :</p>
<ol style="list-style-type: decimal">
<li>homme / grand / blond / étudiant / urbain</li>
<li>femme / grande / brune / étudiante / manquant</li>
</ol>
<p>Si l’on supprime les individus ayant des <dfn data-index="valeur manquante">valeurs manquantes</dfn><dfn data-index="manquante, valeur"></dfn>, 2 est retirée du fichier d’observations et aucune distance n’est calculée.</p>
<p>Si l’on traite les valeurs manquantes comme une modalité particulière, 1 et 2 partagent alors 2 caractères sur les 5 analysés, la distance de Gower entre eux est alors de 1 - 2/5 =1 - 0,4 = 0,6.</p>
<p>Si on garde les valeurs manquantes, l’indice de Gower est dès lors calculé sur les seuls descripteurs renseignés à la fois pour 1 et 2. La distance de Gower sera calculée dans le cas présent uniquement sur les 4 caractères renseignés et vaudra 1 - 2/4 = 0,5.</p>
</div>
<div id="classification-ascendante-hierarchique_distance-du-" class="section level3">
<h3>Distance du F²</h3>
<p>Il s’agit de la distance utilisée dans les analyses de correspondance multiples (ACM). C’est une variante de la <dfn data-index="distance du Chi²">distance du <U+03C7>²</dfn><dfn data-index="Chi², distance"></dfn>. Nous considérons ici que nous avons <em>Q</em> questions (soit <em>Q</em> variables initiales de type facteur). À chaque individu est associé un <dfn>patron</dfn> c’est-à-dire une certaine combinaison de réponses aux <em>Q</em> questions. La distance entre deux individus correspond à la distance entre leurs deux patrons. Si les deux individus présentent le même patron, leur distance sera nulle. La distance du F² peut s’exprimer ainsi :</p>
<!-- 
$$ d_{\Phi^2}^2(L_i,L_j)=\frac{1}{Q}\sum_{k}\frac{(\delta_{ik}-\delta_{jk})^2}{f_k} $$ 
converted on http://www2.ph.ed.ac.uk/snuggletex/MathInputDemo
-->
<p><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>d</mi><msup><mi>F</mi><mn>2</mn></msup><mn>2</mn></msubsup><mfenced close=")" open="("><msub><mi>L</mi><mi>i</mi></msub><msub><mi>L</mi><mi>j</mi></msub></mfenced><mo>=</mo><mfrac><mn>1</mn><mi>Q</mi></mfrac><munder><mo><U+2211></mo><mi>k</mi></munder><mfrac><msup><mfenced close=")" open="("><mrow><msub><mi>d</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>-</mo><msub><mi>d</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub></mrow></mfenced><mn>2</mn></msup><msub><mi>f</mi><mi>k</mi></msub></mfrac></mrow></semantics></math></p>
<p>où <em>L<sub>i</sub></em> et <em>L<sub>j</sub></em> sont deux patrons, <em>Q</em> le nombre total de questions. <em>d<sub>ik</sub></em> vaut 1 si la modalité <em>k</em> est présente dans le patron <em>L<sub>i</sub></em>, 0 sinon. <em>f<sub>k</sub></em> est la fréquence de la modalité <em>k</em> dans l’ensemble de la population.</p>
<p>Exprimé plus simplement, on fait la somme de l’inverse des modalités non communes aux deux patrons, puis on divise par le nombre total de question. Si nous reprenons notre exemple précédent :</p>
<ol style="list-style-type: decimal">
<li>homme / grand / blond / étudiant / urbain</li>
<li>femme / grande / brune / étudiante / rurale</li>
</ol>
<p>Pour calculer la distance entre 1 et 2, il nous faut connaître la proportion des différentes modalités dans l’ensemble de la population étudiée. En l’occurrence :</p>
<ul>
<li>hommes : 52 % / femmes : 48 %</li>
<li>grand : 30 % / moyen : 45 % / petit : 25 %</li>
<li>blond : 15 % / châtain : 45 % / brun : 30 % / blanc : 10 %</li>
<li>étudiant : 20 % / salariés : 65 % / retraités : 15 %</li>
<li>urbain : 80 % / rural : 20 %</li>
</ul>
<p>Les modalités non communes entre les profils de 1 et 2 sont : homme, femme, blond, brun, urbain et rural. La distance du F² entre 1 et 2 est donc la suivante :</p>
<!-- 
$$ d_{\Phi^2}^2(L_1,L_2)=\frac{1}{5}(\frac{1}{0,52}+\frac{1}{0,48}+\frac{1}{0,15}+\frac{1}{0,30}+\frac{1}{0,80}+\frac{1}{0,20})=4,05 $$
converted on http://www2.ph.ed.ac.uk/snuggletex/MathInputDemo
-->
<p><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>d</mi><msup><mi>F</mi><mn>2</mn></msup><mn>2</mn></msubsup><mfenced close=")" open="("><msub><mi>L</mi><mn>1</mn></msub><msub><mi>L</mi><mn>2</mn></msub></mfenced><mo>=</mo><mfrac><mn>1</mn><mn>5</mn></mfrac><mfenced close=")" open="("><mrow><mfrac><mn>1</mn><mrow><mn>0</mn><mo>,</mo><mn>52</mn></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mrow><mn>0</mn><mo>,</mo><mn>48</mn></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mrow><mn>0</mn><mo>,</mo><mn>15</mn></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mrow><mn>0</mn><mo>,</mo><mn>30</mn></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mrow><mn>0</mn><mo>,</mo><mn>80</mn></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mrow><mn>0</mn><mo>,</mo><mn>20</mn></mrow></mfrac></mrow></mfenced><mo>=</mo><mn>4</mn><mo>,</mo><mn>05</mn></mrow></semantics></math></p>
<p>Cette distance, bien que moins intuitive que la distance de Gower évoquée précédemment, est la plus employée pour l’analyse d’enquêtes en sciences sociales. Il faut retenir que la distance entre deux profils est dépendante de la distribution globale de chaque modalité dans la population étudiée. Ainsi, si l’on recalcule les distances entre individus à partir d’un sous-échantillon, le résultat obtenu sera différent. De manière générale, les individus présentant des caractéristiques rares dans la population vont se retrouver éloignés des individus présentant des caractéristiques fortement représentées.</p>
</div>
<div id="classification-ascendante-hierarchique_exemple" class="section level3">
<h3>Exemple</h3>
<p>Nous allons reprendre l’ACM calculée avec <code data-pkg="ade4">dudi.acm</code> (<code class="pkg">ade4</code>) dans le <a href="">chapitre consacré à l’ACM</a> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">data</span>(hdv2003)
d &lt;-<span class="st"> </span>hdv2003
d<span class="op">$</span>grpage &lt;-<span class="st"> </span><span class="kw">cut</span>(d<span class="op">$</span>age, <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">25</span>, <span class="dv">45</span>, <span class="dv">65</span>, <span class="dv">93</span>), <span class="dt">right =</span> <span class="ot">FALSE</span>, 
  <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>)
d<span class="op">$</span>etud &lt;-<span class="st"> </span>d<span class="op">$</span>nivetud
<span class="kw">levels</span>(d<span class="op">$</span>etud) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Primaire"</span>, <span class="st">"Primaire"</span>, <span class="st">"Primaire"</span>, 
  <span class="st">"Secondaire"</span>, <span class="st">"Secondaire"</span>, <span class="st">"Technique/Professionnel"</span>, 
  <span class="st">"Technique/Professionnel"</span>, <span class="st">"Supérieur"</span>)
d2 &lt;-<span class="st"> </span>d[, <span class="kw">c</span>(<span class="st">"grpage"</span>, <span class="st">"sexe"</span>, <span class="st">"etud"</span>, <span class="st">"peche.chasse"</span>, 
  <span class="st">"cinema"</span>, <span class="st">"cuisine"</span>, <span class="st">"bricol"</span>, <span class="st">"sport"</span>, <span class="st">"lecture.bd"</span>)]
<span class="kw">library</span>(ade4)
acm &lt;-<span class="st"> </span><span class="kw">dudi.acm</span>(d2, <span class="dt">scannf =</span> <span class="ot">FALSE</span>, <span class="dt">nf =</span> <span class="dv">5</span>)</code></pre></div>
<p>La matrice des distances s’obtient dès lors avec la fonction <code data-pkg="ade4">dist.dudi</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">md &lt;-<span class="st"> </span><span class="kw">dist.dudi</span>(acm)</code></pre></div>
</div>
</div>
<div id="classification-ascendante-hierarchique_calcul-du-dendrogramme" class="section level2">
<h2>Calcul du dendrogramme</h2>
<p>Il faut ensuite choisir une méthode d’<dfn>agrégation</dfn> pour construire le dendrogramme. De nombreuses solutions existent (saut minimum, distance maximum, moyenne, Ward…). Chacune d’elle produira un dendrogramme différent. Nous ne détaillerons pas ici ces différentes techniques<a href="#classification-ascendante-hierarchique_fn5" class="footnoteRef" id="classification-ascendante-hierarchique_fnref5"><sup>5</sup></a>. Cependant, à l’usage, on privilégiera le plus souvent la <dfn>méthode de Ward</dfn><dfn data-index="Ward, méthode"></dfn><a href="#classification-ascendante-hierarchique_fn6" class="footnoteRef" id="classification-ascendante-hierarchique_fnref6"><sup>6</sup></a>. De manière simplifiée, cette méthode cherche à minimiser l’inertie intra-classe et à maximiser l’inertie inter-classe afin d’obtenir des classes les plus homogènes possibles. Cette méthode est souvent incorrectement présentée comme une <q>méthode de minimisation de la variance</q> alors qu’au sens strict Ward vise <q>l’augmentation mininum de la somme des carrés</q> (“minimum increase of sum-of-squares (of errors)”)<a href="#classification-ascendante-hierarchique_fn7" class="footnoteRef" id="classification-ascendante-hierarchique_fnref7"><sup>7</sup></a>.</p>
<p>En raison de la variété des distances possibles et de la variété des techniques d’agrégation, on pourra être amené à réaliser plusieurs dendrogrammes différents sur un même jeu de données jusqu’à obtenir une classification qui fait « sens ».</p>
<p>La fonction de base pour le calcul d’un dendrogramme est <code data-pkg="stats">hclust</code> en précisant le critère d’agrégation avec <code>method</code>. Dans notre cas, nous allons opter pour la méthode de Ward appliquée au carré des distances (ce qu’on indique avec <code>method = "ward.D2"</code><a href="#classification-ascendante-hierarchique_fn8" class="footnoteRef" id="classification-ascendante-hierarchique_fnref8"><sup>8</sup></a>) :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">arbre &lt;-<span class="st"> </span><span class="kw">hclust</span>(md, <span class="dt">method =</span> <span class="st">"ward.D2"</span>)</code></pre></div>
<div class="note">
<p>Le temps de calcul d’un dendrogramme peut être particulièrement important sur un gros fichier de données. L’extension <code class="pkg">fastcluster</code> permet de réduire significativement le temps de calcul. Il suffit d’installer puis d’appeler cette extension. La fonction <code data-pkg="fastcluster">hclust</code> sera automatiquement remplacée par cette version optimisée. Elle prends les mêmes paramètres :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(fastcluster)
arbre &lt;-<span class="st"> </span><span class="kw">hclust</span>(md, <span class="dt">method =</span> <span class="st">"ward.D2"</span>)</code></pre></div>
</div>
<p>Le dendrogramme obtenu peut être affiché simplement avec <code data-pkg="stats" data-rdoc="hclust">plot</code>. Lorsque le nombre d’individus est important, il peut être utile de ne pas afficher les étiquettes des individus avec <code>labels=FALSE</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(arbre, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="st">"Dendrogramme"</span>)</code></pre></div>
<img src="graphs/classification-ascendante-hierarchique/unnamed-chunk-5-1.png" width="1050"><figcaption>
Dendrogramme obtenu avec hclust
</figcaption></figure><p>La fonction <code data-pkg="cluster">agnes</code> de l’extension <code class="pkg">cluster</code> peut également être utilisée pour calculer le dendrogramme. Cependant, à l’usage, elle semble être un peu plus lente que <code data-pkg="stats">hclust</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(cluster)
arbre2 &lt;-<span class="st"> </span><span class="kw">agnes</span>(md, <span class="dt">method =</span> <span class="st">"ward"</span>)</code></pre></div>
<p>ATTENTION : la méthode implémentée dans la fonction <code data-pkg="cluster">agnes</code> correspond à l’option <code>method = "ward.D2"</code> de <code data-pkg="stats">hclust</code>.</p>
<p>Le résultat obtenu n’est pas au même format que celui de <code data-pkg="stats">hclust</code>. Il est possible de transformer un objet <code data-pkg="cluster" data-rdoc="agnes.object">agnes</code> au format <code data-pkg="stats">hclust</code> avec <code data-pkg="cluster" data-rdoc="agnes.object">as.hclust</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.hclust</span>(arbre2)</code></pre></div>
</div>
<div id="classification-ascendante-hierarchique_decouper-le-dendrogramme" class="section level2">
<h2>Découper le dendrogramme</h2>
<p>Pour obtenir une <dfn>partition</dfn> de la population, il suffit de découper le dendrogramme obtenu à une certaine hauteur. En premier lieu, une analyse de la forme du dendrogramme pourra nous donner une indication sur le nombre de classes à retenir. Dans notre exemple, deux branches bien distinctes apparaissent sur l’arbre.</p>
<p>Pour nous aider, nous pouvons représenter les <dfn data-index="saut d'inertie">sauts d’inertie</dfn><dfn data-index="inertie, saut"></dfn> du dendrogramme selon le nombre de classes retenues.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">inertie &lt;-<span class="st"> </span><span class="kw">sort</span>(arbre<span class="op">$</span>height, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)
<span class="kw">plot</span>(inertie[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>], <span class="dt">type =</span> <span class="st">"s"</span>, <span class="dt">xlab =</span> <span class="st">"Nombre de classes"</span>, 
  <span class="dt">ylab =</span> <span class="st">"Inertie"</span>)</code></pre></div>
<img src="graphs/classification-ascendante-hierarchique/unnamed-chunk-8-1.png" width="1050"><figcaption>
Inertie du dendrogramme
</figcaption></figure><p>On voit trois sauts assez nets à 2, 5 et 8 classes, que nous avons représentés ci-dessous respectivement en vert, en rouge et en bleu.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(inertie[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>], <span class="dt">type =</span> <span class="st">"s"</span>, <span class="dt">xlab =</span> <span class="st">"Nombre de classes"</span>, 
  <span class="dt">ylab =</span> <span class="st">"Inertie"</span>)
<span class="kw">points</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>), inertie[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>)], <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">"green3"</span>, 
  <span class="st">"red3"</span>, <span class="st">"blue3"</span>), <span class="dt">cex =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">3</span>)</code></pre></div>
<img src="graphs/classification-ascendante-hierarchique/unnamed-chunk-9-1.png" width="1050"><figcaption>
Sauts d’inertie du dendrogramme
</figcaption></figure><p>La fonction <code data-pkg="stats">rect.hclust</code> permet de visualiser les différentes partitions directement sur le dendrogramme.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(arbre, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="st">"Partition en 2, 5 ou 8 classes"</span>, 
  <span class="dt">xlab =</span> <span class="st">""</span>, <span class="dt">ylab =</span> <span class="st">""</span>, <span class="dt">sub =</span> <span class="st">""</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">hang =</span> <span class="op">-</span><span class="dv">1</span>)
<span class="kw">rect.hclust</span>(arbre, <span class="dv">2</span>, <span class="dt">border =</span> <span class="st">"green3"</span>)
<span class="kw">rect.hclust</span>(arbre, <span class="dv">5</span>, <span class="dt">border =</span> <span class="st">"red3"</span>)
<span class="kw">rect.hclust</span>(arbre, <span class="dv">8</span>, <span class="dt">border =</span> <span class="st">"blue3"</span>)</code></pre></div>
<img src="graphs/classification-ascendante-hierarchique/unnamed-chunk-10-1.png" width="1050"><figcaption>
Différentes partitions du dendrogramme
</figcaption></figure><p>L’extension <code class="pkg">FactoMineR</code> (que nous aborderons <a href="#classification-ascendante-hierarchique_factominer">dans une section dédiée ci-après</a>) suggère d’utiliser la partition ayant la plus grande <dfn>perte relative d’inertie</dfn><dfn data-index="indertie, perte relative"></dfn>.</p>
<p>L’extension <code class="pkg">JLutils</code> (disponible sur <a href="https://github.com/larmarange/JLutils">GitHub</a>) propose une fonction <code data-pkg="JLutils">best.cutree</code> qui permet de calculer cette indicateur à partir de n’importe quel dendrogramme calculé avec <code data-pkg="stats">hclust</code> ou <code data-pkg="cluster">agnes</code>.</p>
<p>Pour installer <code class="pkg">JLutils</code>, on aura recours au package <code class="pkg">devtools</code> et à sa fonction <code data-pkg="devtools">install_github</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools)
<span class="kw">install_github</span>(<span class="st">"larmarange/JLutils"</span>)</code></pre></div>
<p>Par défaut, <code data-pkg="JLutils">best.cutree</code> regarde quelle serait la meilleure partition entre 3 et 20 classes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(JLutils)</code></pre></div>
<pre><code>Loading required package: ggplot2</code></pre>
<pre><code>Loading required package: plyr</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">best.cutree</span>(arbre)</code></pre></div>
<pre><code>[1] 5</code></pre>
<p>En l’occurence il s’agirait d’une partition en 5 classes. Il est possible de modifier le minimum et le maximum des partitions recherchées avec <code>min</code> et <code>max</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">best.cutree</span>(arbre, <span class="dt">min =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>[1] 2</code></pre>
<p>On peut également représenter le graphique des pertes relatives d’inertie avec <code>graph=TRUE</code>. La meilleure partition selon ce critère est représentée par un point noir et la seconde par un point gris.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">best.cutree</span>(arbre, <span class="dt">min =</span> <span class="dv">2</span>, <span class="dt">graph =</span> <span class="ot">TRUE</span>, <span class="dt">xlab =</span> <span class="st">"Nombre de classes"</span>, 
  <span class="dt">ylab =</span> <span class="st">"Inertie relative"</span>)</code></pre></div>
<p><img src="graphs/classification-ascendante-hierarchique/unnamed-chunk-14-1.png" width="1050"></p>
<pre><code>[1] 2</code></pre>
<figcaption>
Perte relative d’inertie selon le nombre de classes
</figcaption></figure><p>Un découpage en deux classes minimise ce critère. Cependant, si l’on souhaite réaliser une analyse un peu plus fine, un nombre de classes plus élevé serait pertinent. Nous allons donc retenir un découpage en cinq classes. Le découpage s’effectue avec la fonction <code data-pkg="stats">cutree</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">typo &lt;-<span class="st"> </span><span class="kw">cutree</span>(arbre, <span class="dv">5</span>)
<span class="kw">freq</span>(typo)</code></pre></div>
<pre><code>     n    % val%
1 1031 51.5 51.5
2  164  8.2  8.2
3  553 27.7 27.7
4  205 10.2 10.2
5   47  2.4  2.4</code></pre>
<p>La typologie obtenue peut être représentée dans le plan factoriel avec <code data-pkg="ade4">s.class</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">library</span>(RColorBrewer)
<span class="kw">s.class</span>(acm<span class="op">$</span>li, <span class="kw">as.factor</span>(typo), <span class="dt">col =</span> <span class="kw">brewer.pal</span>(<span class="dv">5</span>, 
  <span class="st">"Set1"</span>), <span class="dt">sub =</span> <span class="st">"Axes 1 et 2"</span>)
<span class="kw">s.class</span>(acm<span class="op">$</span>li, <span class="kw">as.factor</span>(typo), <span class="dv">3</span>, <span class="dv">4</span>, <span class="dt">col =</span> <span class="kw">brewer.pal</span>(<span class="dv">5</span>, 
  <span class="st">"Set1"</span>), <span class="dt">sub =</span> <span class="st">"Axes 3 et 4"</span>)</code></pre></div>
<p><img src="graphs/classification-ascendante-hierarchique/unnamed-chunk-16-1.png" width="1050"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</code></pre></div>
<figcaption>
Projection de la typologie obtenue par CAH selon les 4 premiers axes
</figcaption></figure><div class="note">
<p>De nombreuses possibilités graphiques sont possibles avec les dendrogrammes. Des exemples documentés sont disponibles à cette adresse : <a href="http://rpubs.com/gaston/dendrograms" class="uri">http://rpubs.com/gaston/dendrograms</a>.</p>
<p>Romain François a developpé une fonction <code data-pkg="JLutils">A2Rplot</code> permettant de réaliser facilement un dendrogramme avec les branches colorées<a href="#classification-ascendante-hierarchique_fn9" class="footnoteRef" id="classification-ascendante-hierarchique_fnref9"><sup>9</sup></a>. Par commodité, cette fonction est disponible directement au sein de l’extension <code class="pkg">JLutils</code>.</p>
<p>Pour réaliser le graphique, on indiquera le nombre de classes et les couleurs à utiliser pour chaque branche de l’arbre :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">A2Rplot</span>(arbre, <span class="dt">k =</span> <span class="dv">5</span>, <span class="dt">boxes =</span> <span class="ot">FALSE</span>, <span class="dt">col.up =</span> <span class="st">"gray50"</span>, 
  <span class="dt">col.down =</span> <span class="kw">brewer.pal</span>(<span class="dv">5</span>, <span class="st">"Dark2"</span>), <span class="dt">show.labels =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="graphs/classification-ascendante-hierarchique/unnamed-chunk-17-1.png" width="1050"></p>
<p>On pourra aussi noter l’extension <code class="pkg">ggdendro</code> pour représenter des dendrogrammes avec <code class="pkg">ggplot2</code> ou encore l’extension <code class="pkg">dendextend</code> qui permet de manipuler, représenter et comparer des dendrogrammes<a href="#classification-ascendante-hierarchique_fn10" class="footnoteRef" id="classification-ascendante-hierarchique_fnref10"><sup>10</sup></a>.</p>
</div>
</div>
<div id="classification-ascendante-hierarchique_factominer" class="section level2">
<h2>CAH avec l’extension FactoMineR</h2>
<p>L’extension <code class="pkg">FactoMineR</code> fournit une fonction <code data-pkg="FactoMineR">HCPC</code> permettant de réaliser une classification hiérarchique à partir du résultats d’une analyse factorielle réalisée avec la même extension (voir la <a href="#classification-ascendante-hierarchique_factominer">section dédiée du chapitre sur l’ACM</a>).</p>
<p><code data-pkg="FactoMineR">HCPC</code> réalise à la fois le calcul de la matrice des distances, du dendrogramme et le partitionnement de la population en classes. Par défaut, <code data-pkg="FactoMineR">HCPC</code> calcule le dendrogramme à partir du carré des distances du F² et avec la méthode de Ward.</p>
<p>Par défaut, l’arbre est affiché à l’écran et l’arbre sera coupé selon la partition ayant la plus grande perte relative d’inertie (comme avec <code data-pkg="JLutils">best.cutree</code>). Utilisez <code>graph=FALSE</code> pour ne pas afficher le graphique et l’argument <code>nb.clust</code> pour indiquer le nombre de classes désirées.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(FactoMineR)
acm2 &lt;-<span class="st"> </span><span class="kw">MCA</span>(d2[<span class="kw">complete.cases</span>(d2), ], <span class="dt">ncp =</span> <span class="dv">5</span>, <span class="dt">graph =</span> <span class="ot">FALSE</span>)
cah &lt;-<span class="st"> </span><span class="kw">HCPC</span>(acm2, <span class="dt">graph =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>On pourra représenter le dendrogramme avec <code data-pkg="FactoMineR" data-rdoc="plot.HCPC">plot</code> et l’argument <code>choice="tree"</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(cah, <span class="dt">choice =</span> <span class="st">"tree"</span>)</code></pre></div>
<img src="graphs/classification-ascendante-hierarchique/unnamed-chunk-19-1.png" width="1050"><figcaption>
Dendrogramme obtenu avec HCPC (5 axes)
</figcaption></figure><p>Il apparait que le dendrogramme obtenu avec <code data-pacakge="FactoMineR">HCPC</code> diffère de celui que nous avons calculé précédemment en utilisant la matrice des distances fournies par <code data-pkg="ade4">dist.dudi</code>. Cela est dû au fait que <code data-pkg="FactoMineR">HCPC</code> procède différement pour calculer la matrice des distances en ne prenant en compte que les axes retenus dans le cadre de l’ACM. Pour rappel, nous avions retenu que 5 axes dans le cadre de notre ACM :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">acm2 &lt;-<span class="st"> </span><span class="kw">MCA</span>(d2[<span class="kw">complete.cases</span>(d2), ], <span class="dt">ncp =</span> <span class="dv">5</span>, <span class="dt">graph =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><code data-pkg="FactoMineR">HCPC</code> n’a donc pris en compte que ces 5 premiers axes pour calculer les distances entre les individus, considérant que les autres axes n’apportent que du « bruit » rendant la classification instable. Cependant, comme le montre <code>summary(acm2)</code>, nos cinq premiers axes n’expliquent que 54 % de la variance. Il usuellement préférable de garder un plus grande nombre d’axes afin de couvrir au moins 80 à 90 % de la variance<a href="#classification-ascendante-hierarchique_fn11" class="footnoteRef" id="classification-ascendante-hierarchique_fnref11"><sup>11</sup></a>. De son côté, <code data-pkg="ade4">dist.dudi</code> prends en compte l’ensemble des axes pour calculer la matrice des distances. On peut reproduire cela avec <code class="pkg">FactoMineR</code> en indiquant <code>ncp=Inf</code> lors du calcul de l’ACM.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">acm2 &lt;-<span class="st"> </span><span class="kw">MCA</span>(d2[<span class="kw">complete.cases</span>(d2), ], <span class="dt">ncp =</span> <span class="ot">Inf</span>, <span class="dt">graph =</span> <span class="ot">FALSE</span>)
cah &lt;-<span class="st"> </span><span class="kw">HCPC</span>(acm2, <span class="dt">nb.clust =</span> <span class="op">-</span><span class="dv">1</span>, <span class="dt">graph =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>On obtient bien cette fois-ci le même résultat.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(cah, <span class="dt">choice =</span> <span class="st">"tree"</span>)</code></pre></div>
<img src="graphs/classification-ascendante-hierarchique/unnamed-chunk-22-1.png" width="1050"><figcaption>
Dendrogramme obtenu avec HCPC (tous les axes)
</figcaption></figure><p>D’autres graphiques sont disponibles, en faisant varier la valeur de l’argument <code>choice</code> :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(cah, <span class="dt">choice =</span> <span class="st">"3D.map"</span>)</code></pre></div>
<img src="graphs/classification-ascendante-hierarchique/unnamed-chunk-23-1.png" width="1050"><figcaption>
Représentation en 3 dimensions du dendrogramme
</figcaption></figure><figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(cah, <span class="dt">choice =</span> <span class="st">"bar"</span>)</code></pre></div>
<img src="graphs/classification-ascendante-hierarchique/unnamed-chunk-24-1.png" width="1050"><figcaption>
Gains d’inertie
</figcaption></figure><figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(cah, <span class="dt">choice =</span> <span class="st">"map"</span>)</code></pre></div>
<img src="graphs/classification-ascendante-hierarchique/unnamed-chunk-25-1.png" width="1050"><figcaption>
Projection des catégories sur le plan factoriel
</figcaption></figure><p>L’objet renvoyé par <code data-pkg="FactoMineR">HCPC</code> contient de nombreuses informations. La partition peut notamment être récupérée avec <code>cah$data.clust$clust</code>. Il y a également diverses statistiques pour décrire les catégories.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cah</code></pre></div>
<pre><code>**Results for the Hierarchical Clustering on Principal Components**
   name                   
1  "$data.clust"          
2  "$desc.var"            
3  "$desc.var$test.chi2"  
4  "$desc.axes$category"  
5  "$desc.axes"           
6  "$desc.axes$quanti.var"
7  "$desc.axes$quanti"    
8  "$desc.ind"            
9  "$desc.ind$para"       
10 "$desc.ind$dist"       
11 "$call"                
12 "$call$t"              
   description                                              
1  "dataset with the cluster of the individuals"            
2  "description of the clusters by the variables"           
3  "description of the cluster var. by the categorical var."
4  "description of the clusters by the categories."         
5  "description of the clusters by the dimensions"          
6  "description of the cluster var. by the axes"            
7  "description of the clusters by the axes"                
8  "description of the clusters by the individuals"         
9  "parangons of each clusters"                             
10 "specific individuals"                                   
11 "summary statistics"                                     
12 "description of the tree"                                </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">freq</span>(cah<span class="op">$</span>data.clust<span class="op">$</span>clust)</code></pre></div>
<pre><code>     n    % val%
1  513 27.2 27.2
2  201 10.7 10.7
3 1051 55.7 55.7
4   78  4.1  4.1
5   43  2.3  2.3</code></pre>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="classification-ascendante-hierarchique_fn1"><p>Pour une présentation de ces différentes distances, on pourra se référer à <a href="http://old.biodiversite.wallonie.be/outils/methodo/similarite_distance.htm" class="uri">http://old.biodiversite.wallonie.be/outils/methodo/similarite_distance.htm</a> ou encore à ce support de cours par D. Chessel, J. Thioulouse et A.B. Dufour disponible à <a href="http://pbil.univ-lyon1.fr/R/pdf/stage7.pdf" class="uri">http://pbil.univ-lyon1.fr/R/pdf/stage7.pdf</a>.<a href="#classification-ascendante-hierarchique_fnref1"><U+21A9></a></p></li>
<li id="classification-ascendante-hierarchique_fn2"><p>Cette même fonction peut aussi être utilisée pour calculer une distance après une analyse en composantes principales ou une analyse mixte de Hill et Smith.<a href="#classification-ascendante-hierarchique_fnref2"><U+21A9></a></p></li>
<li id="classification-ascendante-hierarchique_fn3"><p>Voir Gower, J. (1971). A General Coefficient of Similarity and Some of Its Properties. <em>Biometrics</em>, 27(4), 857-871. <a href="doi:10.2307/2528823" class="uri">doi:10.2307/2528823</a> (<a href="http://www.jstor.org/stable/2528823" class="uri">http://www.jstor.org/stable/2528823</a>).<a href="#classification-ascendante-hierarchique_fnref3"><U+21A9></a></p></li>
<li id="classification-ascendante-hierarchique_fn4"><p>Pour une description mathématique plus détaillée de cette fonction, notamment en cas de valeur manquante, se référer à l’article original de Gower précédemment cité.<a href="#classification-ascendante-hierarchique_fnref4"><U+21A9></a></p></li>
<li id="classification-ascendante-hierarchique_fn5"><p>On pourra consulter le cours de FG Carpentier déjà cité ou bien des ouvrages d’analyse statistique.<a href="#classification-ascendante-hierarchique_fnref5"><U+21A9></a></p></li>
<li id="classification-ascendante-hierarchique_fn6"><p>Ward, J. (1963). Hierarchical Grouping to Optimize an Objective Function. <em>Journal of the American Statistical Association</em>, 58(301), 236-244. <a href="doi:10.2307/2282967" class="uri">doi:10.2307/2282967</a>. (<a href="http://www.jstor.org/stable/2282967" class="uri">http://www.jstor.org/stable/2282967</a>)<a href="#classification-ascendante-hierarchique_fnref6"><U+21A9></a></p></li>
<li id="classification-ascendante-hierarchique_fn7"><p>Voir par exemple la discussion, en anglais, sur Wikipedia concernant la page présentant la méthode Ward : <a href="https://en.wikipedia.org/wiki/Talk:Ward%27s_method">https://en.wikipedia.org/wiki/Talk:Ward%27s_method</a><a href="#classification-ascendante-hierarchique_fnref7"><U+21A9></a></p></li>
<li id="classification-ascendante-hierarchique_fn8"><p>Depuis la version 3.1 de <strong>R</strong>. L’option <code>method = "ward.D"</code> correspondant à la version disponible dans les versions précédentes de <strong>R</strong>. Mais il est à noter que la méthode décrite par Ward dans son article de 1963 correspond en réalité à <code>method = "ward.D2</code>.<a href="#classification-ascendante-hierarchique_fnref8"><U+21A9></a></p></li>
<li id="classification-ascendante-hierarchique_fn9"><p>Voir <a href="http://addicted2or.free.fr/packages/A2R/lastVersion/R/code.R" class="uri">http://addicted2or.free.fr/packages/A2R/lastVersion/R/code.R</a>.<a href="#classification-ascendante-hierarchique_fnref9"><U+21A9></a></p></li>
<li id="classification-ascendante-hierarchique_fn10"><p>Pour une présentation succincte, voir par exemple <a href="http://www.r-bloggers.com/dendextend-version-1-0-1-user2015-presentation/" class="uri">http://www.r-bloggers.com/dendextend-version-1-0-1-user2015-presentation/</a> (en anglais).<a href="#classification-ascendante-hierarchique_fnref10"><U+21A9></a></p></li>
<li id="classification-ascendante-hierarchique_fn11"><p>Voir <a href="http://factominer.free.fr/classical-methods/classification-hierarchique-sur-composantes-principales.html" class="uri">http://factominer.free.fr/classical-methods/classification-hierarchique-sur-composantes-principales.html</a><a href="#classification-ascendante-hierarchique_fnref11"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="modeles-lineaires-a-effets-mixtes"><div class="fluid-row" id="modeles-lineaires-a-effets-mixtes_header">



<h1 class="title toc-ignore">Modèles linéaires à effets mixtes</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="modeles-gee"><div class="fluid-row" id="modeles-gee_header">



<h1 class="title toc-ignore">Modèles GEE</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="series-temporelles"><div class="fluid-row" id="series-temporelles_header">



<h1 class="title toc-ignore">Séries temporelles</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="modeles-a-temps-discret"><div class="fluid-row" id="modeles-a-temps-discret_header">



<h1 class="title toc-ignore">Modèles à temps discret</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="analyse-de-survie"><div class="fluid-row" id="analyse-de-survie_header">



<h1 class="title toc-ignore">Analyse de survie</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#analyse-de-survie_ressources-en-ligne">Ressources en ligne</a></li>
<li>
<a href="#analyse-de-survie_un-exemple-concret-mortalite-infanto-juvenile">Un exemple concret : mortalité infanto-juvénile</a><ul>
<li><a href="#analyse-de-survie_preparation-des-donnees-avec-data.table">Préparation des données avec data.table</a></li>
<li><a href="#analyse-de-survie_preparation-des-donnees-avec-dplyr">Préparation des données avec dplyr</a></li>
<li><a href="#analyse-de-survie_kaplan-meir">Kaplan-Meir</a></li>
<li><a href="#analyse-de-survie_modele-de-cox">Modèle de Cox</a></li>
<li><a href="#analyse-de-survie_verification-de-la-validite-du-modele">Vérification de la validité du modèle</a></li>
</ul>
</li>
</ul>
</div>

<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>
<div id="analyse-de-survie_ressources-en-ligne" class="section level1">
<h1>Ressources en ligne</h1>
<p>L’extension centrale pour l’<dfn>analyse de survie</dfn><dfn data-index="survie, analyse"></dfn> est <code class="pkg">survival</code>.</p>
<p>Un très bon tutoriel (en anglais et en 3 étapes), introduisant les concepts de l’analyse de survie, des courbes de Kaplan-Meier et des modèles de Cox et leur mise en oeuvre pratique sous <strong>R</strong> est disponible en ligne :</p>
<ul>
<li><a href="http://www.sthda.com/english/wiki/survival-analysis-basics" class="uri">http://www.sthda.com/english/wiki/survival-analysis-basics</a></li>
<li><a href="http://www.sthda.com/english/wiki/cox-proportional-hazards-model" class="uri">http://www.sthda.com/english/wiki/cox-proportional-hazards-model</a></li>
<li><a href="http://www.sthda.com/english/wiki/cox-model-assumptions" class="uri">http://www.sthda.com/english/wiki/cox-model-assumptions</a></li>
</ul>
<p>Pour un autre exemple (toujours en anglais) d’analyse de survie avec <code class="pkg">survival</code>, on pourra se référer à <a href="https://rpubs.com/vinubalan/hrsurvival" class="uri">https://rpubs.com/vinubalan/hrsurvival</a>.</p>
<p>Pour représenter vos résultats avec <code class="pkg">ggplot2</code>, on pourra avoir recours à l’extension <code class="pkg">survminer</code> présentée en détails sur son site officiel (en anglais) : <a href="http://www.sthda.com/english/rpkgs/survminer/" class="uri">http://www.sthda.com/english/rpkgs/survminer/</a>. On pourra également avoir recours à la fonction <code data-pkg="GGally">ggsurv</code> de l’extension <code class="pkg">GGally</code> présentée à l’adresse <a href="http://ggobi.github.io/ggally/#ggallyggsurv" class="uri">http://ggobi.github.io/ggally/#ggallyggsurv</a>.</p>
<p>A noter, il est possible d’utiliser la fonction <code data-pkg="stats">step</code> sur un modèle de Cox, pour une sélection pas à pas d’un meilleur modèle basé sur une minimisation de l’AIC (voir le chapitre sur la <a href="#regression-logistique">régression logistique</a>).</p>
<p>L’excellente extension <code class="pkg">broom</code> peut également être utilisée sur des modèles de survie (Kaplan-Meier ou Cox) pour en convertir les résultats sous la forme d’un tableau de données.</p>
<p>Pour approfondir les possibilités offertes par l’extension <code class="pkg">survival</code>, on pourra également consulter les différentes vignettes fournies avec l’extension (voir <a href="https://cran.r-project.org/package=survival" class="uri">https://cran.r-project.org/package=survival</a>).</p>
</div>
<div id="analyse-de-survie_un-exemple-concret-mortalite-infanto-juvenile" class="section level1">
<h1>Un exemple concret : mortalité infanto-juvénile</h1>
<p>Dans cet exemple, nous allons utiliser le jeu de données <code>fecondite</code> fourni par l’extension <code class="pkg">questionr</code>. Ce jeu de données comporte trois tableaux de données : <code>menages</code>, <code>femmes</code> et <code>enfants</code>.</p>
<p>Nous souhaitons étudier ici la survie des enfants entre la naissance et l’âge de 5 ans. Dans un premier temps, nous comparerons la survie des jeunes filles et des jeunes garçons. Dans un second temps, nous procéderons à une analyse multivariée en prenant en compte les variables suivantes :</p>
<ul>
<li>sexe de l’enfant</li>
<li>milieu de résidence</li>
<li>niveau de vie du ménage</li>
<li>structure du ménage</li>
<li>niveau d’éducation de la mère</li>
<li>âge de la mère à la naissance de l’enfant</li>
<li>enfin, une variable un peu plus compliquée, à savoir si le rang de naissance de l’enfant (second, troisième, quatrième, etc.) est supérieur au nombre idéal d’enfants selon la mère.</li>
</ul>
<p>Nous allons préparer les données selon deux approches : soit en utilisant l’extension <code class="pkg">data.table</code> (voir l’<a href="#introduction-a-data-table">introduction à data.table</a>), soit en utilisant l’extension <code class="pkg">dplyr</code> (voir l’<a href="#introduction-a-dplyr">introduction à dplyr</a>).</p>
<p>Chargeons les données en mémoire et listons les variables disponibles.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">data</span>(fecondite)
<span class="kw">lookfor</span>(menages)</code></pre></div>
<pre><code>   variable                                label
1 id_menage                Identifiant du ménage
2    taille Taille du ménage (nombre de membres)
3 sexe_chef               Sexe du chef de ménage
4 structure    Structure démographique du ménage
5  richesse            Niveau de vie (quintiles)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lookfor</span>(femmes)</code></pre></div>
<pre><code>         variable
1        id_femme
2       id_menage
3           poids
4  date_entretien
5  date_naissance
6             age
7          milieu
8          region
9            educ
10        travail
11          matri
12       religion
13        journal
14          radio
15             tv
16   nb_enf_ideal
17           test
                                                            label
1                                       Identifiant de l'enquêtée
2                                           Identifiant du ménage
3                                               Poids statistique
4                              Date de passation du questionnaire
5                                               Date de naissance
6  Âge révolu (en années) à la date de passation du questionnaire
7                                             Milieu de résidence
8                                             Région de résidence
9                                              Niveau d'éducation
10                                                  A un emploi ?
11                                             Statut matrimonial
12                                                       Religion
13                                                Lit la presse ?
14                                              Ecoute la radio ?
15                                        Regarde la télévision ?
16                                         Nombre idéal d'enfants
17                      A déjà fait un test de dépistage du VIH ?</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lookfor</span>(enfants)</code></pre></div>
<pre><code>        variable
1      id_enfant
2       id_femme
3 date_naissance
4           sexe
5         survie
6      age_deces
                              label
1           Identifiant de l'enfant
2            Identifiant de la mère
3                 Date de naissance
4                  Sexe de l'enfant
5 L'enfant est-il toujours en vie ?
6            Age au décès (en mois)</code></pre>
<div id="analyse-de-survie_preparation-des-donnees-avec-data.table" class="section level2">
<h2>Préparation des données avec data.table</h2>
<p>Tout d’abord, regardons sous quel format elles sont stockées.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(menages)</code></pre></div>
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">describe</span>(menages)</code></pre></div>
<pre><code>[1814 obs. x 5 variables] tbl_df tbl data.frame

$id_menage: Identifiant du ménage
numeric: 1 2 3 4 5 6 7 8 9 10 ...
min: 1 - max: 1814 - NAs: 0 (0%) - 1814 unique values

$taille: Taille du ménage (nombre de membres)
numeric: 7 3 6 5 7 6 15 6 5 19 ...
min: 1 - max: 31 - NAs: 0 (0%) - 30 unique values

$sexe_chef: Sexe du chef de ménage
labelled double: 2 1 1 1 1 2 2 2 1 1 ...
min: 1 - max: 2 - NAs: 0 (0%) - 2 unique values
2 value labels: [1] homme [2] femme

$structure: Structure démographique du ménage
labelled double: 4 2 5 4 4 4 5 2 5 5 ...
min: 1 - max: 5 - NAs: 0 (0%) - 5 unique values
6 value labels: [0] pas d'adulte [1] un adulte [2] deux adultes de sexe opposé [3] deux adultes de même sexe [4] trois adultes ou plus avec lien de parenté [5] adultes sans lien de parenté

$richesse: Niveau de vie (quintiles)
labelled double: 1 2 2 1 1 3 2 5 4 3 ...
min: 1 - max: 5 - NAs: 0 (0%) - 5 unique values
5 value labels: [1] très pauvre [2] pauvre [3] moyen [4] riche [5] très riche</code></pre>
<p>Les tableaux de données sont au format <em>tibble</em> (c’est-à-dire sont de la classe <code>tbl_df</code>) et les variables catégorielles sont du type <code>labelled</code> (voir le chapitre sur les <a href="#facteurs-et-vecteurs-labellises_labelled">vecteurs labellisés</a>). Ce format correspond au format de données si on les avait importées depuis SPSS avec l’extension <code class="pkg">haven</code> (voir le chapitre sur l’<a href="#import-de-donnees_spss">import de données</a>).</p>
<p>En premier lieu, il nous faut convertir les tableaux de données au format <code>data.table</code>, ce qui peut se faire avec la fonction <code data-pkg="data.table">setDT</code><a href="#analyse-de-survie_fn1" class="footnoteRef" id="analyse-de-survie_fnref1"><sup>1</sup></a>. Par ailleurs, nous allons également charger en mémoire l’extension <code class="pkg">labelled</code> pour la gestion des vecteurs labellisés.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(labelled)
<span class="kw">library</span>(data.table)
<span class="kw">setDT</span>(menages)
<span class="kw">setDT</span>(femmes)
<span class="kw">setDT</span>(enfants)</code></pre></div>
<p>En premier lieu, il nous faut calculer la durée d’observation des enfants, à savoir le temps passé entre la date de naissance (variable du fichier <code>enfants</code>) et la date de passation de l’entretien (fournie par le tableau de données <code>femmes</code>). Pour récupérer des variables du fichier <code>femmes</code> dans le fichier <code>enfants</code>, nous allons procéder à une fusion de table (voir le <a href="#fusion-de-tables">chapitre dédié</a>). Pour le calcul de la durée d’observation, nous allons utiliser le package <code class="pkg">lubridate</code> (voir le chapitre <a href="#calculer-un-age">calculer un âge</a> et celui sur la <a href="#gestion-des-dates">gestion des dates</a>). Nous effectuerons l’analyse en mois (puisque l’âge au décès est connu en mois). Dès lors, la durée d’observation sera calculée en mois.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">enfants &lt;-<span class="st"> </span><span class="kw">merge</span>(
  enfants,
  femmes[, .(id_femme, date_entretien)],
  <span class="dt">by =</span> <span class="st">"id_femme"</span>,
  <span class="dt">all.x =</span> <span class="ot">TRUE</span>
)

<span class="co"># duree observation en mois</span>
<span class="kw">library</span>(lubridate)
enfants[, duree_observation <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">time_length</span>(<span class="kw">interval</span>(date_naissance, date_entretien), <span class="dt">unit =</span> <span class="st">"months"</span>)]</code></pre></div>
<p>ATTENTION : il y 11 enfants soi-disant nés après la date d’enquête ! Quelle que soit l’enquête, il est rare de ne pas observer d’incohérences. Dans le cas présent, il est fort possible que la date d’entretien puisse parfois être erronnée (par exemple si l’enquêteur a inscrit une date sur le questionnaire papier le jour du recensement du ménage mais n’ai pu effectué le questionnaire individuel que plus tard). Nous décidons ici de procéder à une correction en ajoutant un mois aux dates d’entretien problématiques. D’autres approches auraient pu être envisagées, comme par exemple exclure ces observations problématiques. Cependant, cela aurait impacté le calcul du range de naissance pour les autres enfants issus de la même mère. Quoiqu’il en soit, il n’y a pas de réponse unique. À vous de vous adapter au contexte particulier de votre analyse.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">enfants[duree_observation <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>, date_entretien <span class="op">:</span><span class="er">=</span><span class="st"> </span>date_entretien <span class="op">%m+%</span><span class="st"> </span><span class="kw">months</span>(<span class="dv">1</span>)]
enfants[, duree_observation <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">time_length</span>(<span class="kw">interval</span>(date_naissance, date_entretien), <span class="dt">unit =</span> <span class="st">"months"</span>)]</code></pre></div>
<p>Regardons maintenant comment les âges au décès ont été collectés.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">freq</span>(enfants<span class="op">$</span>age_deces)</code></pre></div>
<pre><code>       n    % val%
0     62  3.9 43.7
1      5  0.3  3.5
2      6  0.4  4.2
3      5  0.3  3.5
4      4  0.3  2.8
5      5  0.3  3.5
6      5  0.3  3.5
7      4  0.3  2.8
8      3  0.2  2.1
9      6  0.4  4.2
10     1  0.1  0.7
11     5  0.3  3.5
12    10  0.6  7.0
13     3  0.2  2.1
14     1  0.1  0.7
16     1  0.1  0.7
19     2  0.1  1.4
21     1  0.1  0.7
24    10  0.6  7.0
36     2  0.1  1.4
48     1  0.1  0.7
NaN 1442 91.0   NA</code></pre>
<p>Les âges au décès sont ici exprimés en mois révolus. Les décès à un mois révolu correspondent à des décès entre 1 et 2 mois exacts. Par ailleurs, les durées d’observation que nous avons calculées avec <code data-pkg="lubridate">time_length</code> sont des durées exactes, c’est-à-dire avec la partie décimale. Pour une analyse de survie, on ne peut mélanger des durées exactes et des durées révolues. Trois approches peuvent être envisagées :</p>
<ol style="list-style-type: decimal">
<li>faire l’analyse en mois révolus, auquel cas on ne gardera que la partie entière des durées d’observations avec la fonction <code data-pkg="base" data-rdoc="Round">trunc</code> ;</li>
<li>considérer qu’un âge au décès de 3 mois révolus correspond en moyenne à 3,5 mois exacts et donc ajouter 0,5 à tous les âges révolus ;</li>
<li>imputer un âge au décès exact en distribuant aléatoirement les décès à 3 mois révolus entre 3 et 4 mois exacts, autrement dit en ajoutant aléatoirement une partie décimale aux âges révolus.</li>
</ol>
<p>Nous allons ici adopter la troisième approche en considérant que les décès se répartissent de manière uniforme au sein d’un même mois. Nous aurons donc recours à la fonction <code data-pkg="stats" data-rdoc="Uniform">runif</code> qui permets de générer des valeurs aléatoires entre 0 et 1 selon une distribustion uniforme.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">enfants[, age_deces_impute <span class="op">:</span><span class="er">=</span><span class="st"> </span>age_deces <span class="op">+</span><span class="st"> </span><span class="kw">runif</span>(.N)]</code></pre></div>
<p>Pour définir notre objet de survie, il nous faudra deux variables. Une première, temporelle, indiquant la durée à laquelle survient l’évènement étudié (ici le décès) pour ceux ayant vécu l’évènement et la durée d’observation pour ceux n’ayant pas vécu l’évènement (<dfn>censure à droite</dfn><dfn data-index="droite, censure"></dfn>). Par ailleurs, une seconde variable indiquant si les individus ont vécu l’évènement (0 pour non, 1 pour oui). Or, ici, la variable <var>survie</var> est codée 0 pour les décès et 1 pour ceux ayant survécu. Pour plus de détails, voir l’aide de la fonction <code data-pkg="survival">Surv</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">enfants[, deces <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">0</span>]
enfants[survie <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, deces <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">1</span>]
<span class="kw">var_label</span>(enfants<span class="op">$</span>deces) &lt;-<span class="st"> "Est décédé ?"</span>
<span class="kw">val_labels</span>(enfants<span class="op">$</span>deces) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">non =</span> <span class="dv">0</span>, <span class="dt">oui =</span> <span class="dv">1</span>)

enfants[, time <span class="op">:</span><span class="er">=</span><span class="st"> </span>duree_observation]
enfants[deces <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, time <span class="op">:</span><span class="er">=</span><span class="st"> </span>age_deces_impute]</code></pre></div>
<p>Occupons-nous maintenant des variables explicatives que nous allons inclure dans l’analyse. Tout d’abord, ajoutons à la table <code>enfants</code> les variables nécessaires des tables <code>femmes</code> et <code>menages</code>. Notons qu’il nous faudra importer <var>id_menage</var> de la table <code>femmes</code> pour pouvoir fusionner ensuite la table <code>enfants</code> avec la table <code>menages</code>. Par ailleurs, pour éviter une confusion sur la variable <var>date_naissance</var>, nous renommons à la volée cette variable de la table <code>femmes</code> en <var>date_naissance_mere</var>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">enfants &lt;-<span class="st"> </span><span class="kw">merge</span>(
  enfants,
  femmes[, .(
    id_femme, id_menage, milieu, educ, 
    <span class="dt">date_naissance_mere =</span> date_naissance, nb_enf_ideal
  )],
  <span class="dt">by =</span> <span class="st">"id_femme"</span>,
  <span class="dt">all.x =</span> <span class="ot">TRUE</span>
)
enfants &lt;-<span class="st"> </span><span class="kw">merge</span>(
  enfants,
  menages[, .(id_menage, structure, richesse)],
  <span class="dt">by =</span> <span class="st">"id_menage"</span>,
  <span class="dt">all.x =</span> <span class="ot">TRUE</span>
)</code></pre></div>
<p>Les variables catégorielles sont pour l’heure sous formes de vecteurs labellisés. Or, dans un modèle, il est impératif de les convertir en facteurs pour qu’elles soient bien traitées comme des variables catégorielles (autrement elles seraient traitées comme des variables continues). On aura donc recours à la fonction <code data-pkg="labelled">to_factor</code> de l’extension <code class="pkg">labelled</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">enfants[, sexe <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">to_factor</span>(sexe)]
enfants[, richesse <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">to_factor</span>(richesse)]</code></pre></div>
<p>Regardons plus attentivement, la variable <var>structure</var>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">freq</span>(enfants<span class="op">$</span>structure)</code></pre></div>
<pre><code>                                                 n
[0] pas d'adulte                                 0
[1] un adulte                                   45
[2] deux adultes de sexe opposé                505
[3] deux adultes de même sexe                   71
[4] trois adultes ou plus avec lien de parenté 764
[5] adultes sans lien de parenté               199
                                                  %
[0] pas d'adulte                                0.0
[1] un adulte                                   2.8
[2] deux adultes de sexe opposé                31.9
[3] deux adultes de même sexe                   4.5
[4] trois adultes ou plus avec lien de parenté 48.2
[5] adultes sans lien de parenté               12.6
                                               val%
[0] pas d'adulte                                0.0
[1] un adulte                                   2.8
[2] deux adultes de sexe opposé                31.9
[3] deux adultes de même sexe                   4.5
[4] trois adultes ou plus avec lien de parenté 48.2
[5] adultes sans lien de parenté               12.6</code></pre>
<p>Tout d’abord, la modalité <q>pas d’adulte</q> n’est pas représentée dans l’échantillon. On aura donc recours à l’argument <code>drop_unused_labels</code> pour ne pas conserver cette modalité. Par ailleurs, nous considérons que la situation familiale à partir de laquelle nous voudrons comparer les autres dans notre modèle, donc celle qui doit être considérée comme la modalité de référence, est celle du ménage nucléaire. Cette modalité (<q>deux adultes de sexe opposé</q>) n’étant pas la première, nous aurons recours à la fonction <code>relevel</code>{data-pkg = “stats”}.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">enfants[, structure <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">to_factor</span>(structure)]
enfants[, structure <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">relevel</span>(structure, <span class="st">"deux adultes de sexe opposé"</span>)]</code></pre></div>
<p>Regardons la variable <var>educ</var>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">freq</span>(enfants<span class="op">$</span>educ)</code></pre></div>
<pre><code>                  n    % val%
[0] aucun      1084 68.4 68.4
[1] primaire    368 23.2 23.2
[2] secondaire  115  7.3  7.3
[3] supérieur    17  1.1  1.1</code></pre>
<p>La modalité <q>supérieur</q> est peu représentée dans notre échantillon. Nous allons la fusionner avec la modalité <q>secondaire</q> (voir la section <a href="#recodage_regrouper_modalites">Regrouper les modalités d’une variable</a> du chapitre <a href="#recodage">Recodage</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">enfants[, educ2 <span class="op">:</span><span class="er">=</span><span class="st"> </span>educ]
enfants[educ <span class="op">==</span><span class="st"> </span><span class="dv">3</span>, educ2 <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">2</span>]
<span class="kw">val_label</span>(enfants<span class="op">$</span>educ2, <span class="dv">2</span>) &lt;-<span class="st"> "secondaire ou plus"</span>
<span class="kw">val_label</span>(enfants<span class="op">$</span>educ2, <span class="dv">3</span>) &lt;-<span class="st"> </span><span class="ot">NULL</span>
enfants[, educ2 <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">to_factor</span>(educ2)]
<span class="kw">freq</span>(enfants<span class="op">$</span>educ2)</code></pre></div>
<pre><code>                      n    % val%
aucun              1084 68.4 68.4
primaire            368 23.2 23.2
secondaire ou plus  132  8.3  8.3</code></pre>
<p>Calculons maintenant l’âge de la mère à la naissance de l’enfant (voir le chapitre <a href="#calculer-un-age">Caluler un âge</a>) et découpons le en groupes d’âges (voir la section <a href="#recodage_decouper_en_classes">Découper une variable numérique en classes</a> du chapitre <a href="#recodage">Recodage</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">enfants[, age_mere_naissance <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">time_length</span>(
  <span class="kw">interval</span>(date_naissance_mere, date_naissance), 
  <span class="dt">unit =</span> <span class="st">"years"</span>
  )]

enfants<span class="op">$</span>gpage_mere_naissance &lt;-<span class="st"> </span><span class="kw">cut</span>(
  enfants<span class="op">$</span>age_mere_naissance, 
  <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>, <span class="dt">right =</span> <span class="ot">FALSE</span>,
  <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">13</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>)
)
<span class="kw">levels</span>(enfants<span class="op">$</span>gpage_mere_naissance) &lt;-<span class="st"> </span><span class="kw">c</span>(
  <span class="st">"19 ou moins"</span>, <span class="st">"20-29"</span>, <span class="st">"30 et plus"</span>
)
enfants<span class="op">$</span>gpage_mere_naissance &lt;-<span class="st"> </span><span class="kw">relevel</span>(enfants<span class="op">$</span>gpage_mere_naissance, <span class="st">"20-29"</span>)
<span class="kw">freq</span>(enfants<span class="op">$</span>gpage_mere_naissance)</code></pre></div>
<pre><code>              n    % val%
20-29       888 56.1 56.1
19 ou moins 257 16.2 16.2
30 et plus  439 27.7 27.7</code></pre>
<p>Reste à calculer si le rang de naissance de l’enfant est supérieur au nombre idéal d’enfants tel que défini par la mère. On aura recours à la fonction <code data-pkg="base">rank</code> appliquée par groupe (ici calculé séparément pour chaque mère). L’argument <code>ties.method</code> permet d’indiquer comment gérer les égalités (ici les naissances multiples, e.g. les jumeaux). Comme nous voulons comparer le rang de l’enfant au nombre idéal d’enfants, nous allons retenir la méthode <code>"max"</code> pour obtenir, dans le cas présent, le nombre total d’enfants déjà nés<a href="#analyse-de-survie_fn2" class="footnoteRef" id="analyse-de-survie_fnref2"><sup>2</sup></a>. Avant de calculer un rang, il est impératif de trier préalablement le tableau (voir le chapitre <a href="#tris">Tris</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setorder</span>(enfants, id_femme, date_naissance)
enfants[, rang <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">rank</span>(date_naissance, <span class="dt">ties.method =</span> <span class="st">"max"</span>), by =<span class="st"> </span>id_femme]
enfants[, rang_apres_ideal <span class="op">:</span><span class="er">=</span><span class="st"> "non"</span>]
enfants[rang <span class="op">&gt;</span><span class="st"> </span>nb_enf_ideal, rang_apres_ideal <span class="op">:</span><span class="er">=</span><span class="st"> "oui"</span>]
enfants[, rang_apres_ideal <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">factor</span>(rang_apres_ideal)]
enfants[, rang_apres_ideal <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">relevel</span>(rang_apres_ideal, <span class="st">"non"</span>)]</code></pre></div>
</div>
<div id="analyse-de-survie_preparation-des-donnees-avec-dplyr" class="section level2">
<h2>Préparation des données avec dplyr</h2>
<p>Tout d’abord, regardons sous quel format elles sont stockées.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(fecondite)
<span class="kw">class</span>(menages)</code></pre></div>
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">describe</span>(menages)</code></pre></div>
<pre><code>[1814 obs. x 5 variables] tbl_df tbl data.frame

$id_menage: Identifiant du ménage
numeric: 1 2 3 4 5 6 7 8 9 10 ...
min: 1 - max: 1814 - NAs: 0 (0%) - 1814 unique values

$taille: Taille du ménage (nombre de membres)
numeric: 7 3 6 5 7 6 15 6 5 19 ...
min: 1 - max: 31 - NAs: 0 (0%) - 30 unique values

$sexe_chef: Sexe du chef de ménage
labelled double: 2 1 1 1 1 2 2 2 1 1 ...
min: 1 - max: 2 - NAs: 0 (0%) - 2 unique values
2 value labels: [1] homme [2] femme

$structure: Structure démographique du ménage
labelled double: 4 2 5 4 4 4 5 2 5 5 ...
min: 1 - max: 5 - NAs: 0 (0%) - 5 unique values
6 value labels: [0] pas d'adulte [1] un adulte [2] deux adultes de sexe opposé [3] deux adultes de même sexe [4] trois adultes ou plus avec lien de parenté [5] adultes sans lien de parenté

$richesse: Niveau de vie (quintiles)
labelled double: 1 2 2 1 1 3 2 5 4 3 ...
min: 1 - max: 5 - NAs: 0 (0%) - 5 unique values
5 value labels: [1] très pauvre [2] pauvre [3] moyen [4] riche [5] très riche</code></pre>
<p>Les tableaux de données sont déjà au format <em>tibble</em> (c’est-à-dire sont de la classe <code>tbl_df</code>)<a href="#analyse-de-survie_fn3" class="footnoteRef" id="analyse-de-survie_fnref3"><sup>3</sup></a> et les variables catégorielles sont du type <code>labelled</code> (voir le chapitre sur les <a href="#facteurs-et-vecteurs-labellises_labelled">vecteurs labellisés</a>). Ce format correspond au format de données si on les avait importées depuis SPSS avec l’extension <code class="pkg">haven</code> (voir le chapitre sur l’<a href="#import-de-donnees_spss">import de données</a>).</p>
<p>Nous allons charger en mémoire l’extension <code class="pkg">labelled</code> pour la gestion des vecteurs labellisés en plus de <code class="pkg">dplyr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(labelled)</code></pre></div>
<p>En premier lieu, il nous faut calculer la durée d’observation des enfants, à savoir le temps passé entre la date de naissance (variable du fichier <code>enfants</code>) et la date de passation de l’entretien (fournie par le tableau de données <code>femmes</code>). Pour récupérer des variables du fichier <code>femmes</code> dans le fichier <code>enfants</code>, nous allons procéder à une fusion de table (voir le <a href="#fusion-de-tables">chapitre dédié</a>). Pour le calcul de la durée d’observation, nous allons utiliser le package <code class="pkg">lubridate</code> (voir le chapitre <a href="#calculer-un-age">calculer un âge</a> et celui sur la <a href="#gestion-des-dates">gestion des dates</a>). Nous effectuerons l’analyse en mois (puisque l’âge au décès est connu en mois). Dès lors, la durée d’observation sera calculée en mois.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lubridate)
enfants &lt;-<span class="st"> </span>enfants <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(
    femmes <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(id_femme, date_entretien),
    <span class="dt">by =</span> <span class="st">"id_femme"</span>
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">duree_observation =</span> <span class="kw">time_length</span>(
    <span class="kw">interval</span>(date_naissance, date_entretien), 
    <span class="dt">unit =</span> <span class="st">"months"</span>
  ))</code></pre></div>
<pre><code>Warning: Column `id_femme` has different
attributes on LHS and RHS of join</code></pre>
<p>ATTENTION : il y 11 enfants soi-disant nés après la date d’enquête ! Quelle que soit l’enquête, il est rare de ne pas observer d’incohérences. Dans le cas présent, il est fort possible que la date d’entretien puisse parfois être erronnée (par exemple si l’enquêteur a inscrit une date sur le questionnaire papier le jour du recensement du ménage mais n’ai pu effectué le questionnaire individuel que plus tard). Nous décidons ici de procéder à une correction en ajoutant un mois aux dates d’entretien problématiques. D’autres approches auraient pu être envisagées, comme par exemple exclure ces observations problématiques. Cependant, cela aurait impacté le calcul du range de naissance pour les autres enfants issus de la même mère. Quoiqu’il en soit, il n’y a pas de réponse unique. À vous de vous adapter au contexte particulier de votre analyse.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">enfants<span class="op">$</span>date_entretien[enfants<span class="op">$</span>duree_observation <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-
<span class="st">  </span>enfants<span class="op">$</span>date_entretien[enfants<span class="op">$</span>duree_observation <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>] <span class="op">%m+%</span><span class="st"> </span><span class="kw">months</span>(<span class="dv">1</span>)
enfants &lt;-<span class="st"> </span>enfants <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">duree_observation =</span> <span class="kw">time_length</span>(
    <span class="kw">interval</span>(date_naissance, date_entretien), 
    <span class="dt">unit =</span> <span class="st">"months"</span>
  ))</code></pre></div>
<p>Regardons maintenant comment les âges au décès ont été collectés.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">freq</span>(enfants<span class="op">$</span>age_deces)</code></pre></div>
<pre><code>       n    % val%
0     62  3.9 43.7
1      5  0.3  3.5
2      6  0.4  4.2
3      5  0.3  3.5
4      4  0.3  2.8
5      5  0.3  3.5
6      5  0.3  3.5
7      4  0.3  2.8
8      3  0.2  2.1
9      6  0.4  4.2
10     1  0.1  0.7
11     5  0.3  3.5
12    10  0.6  7.0
13     3  0.2  2.1
14     1  0.1  0.7
16     1  0.1  0.7
19     2  0.1  1.4
21     1  0.1  0.7
24    10  0.6  7.0
36     2  0.1  1.4
48     1  0.1  0.7
NaN 1442 91.0   NA</code></pre>
<p>Les âges au décès sont ici exprimés en mois révolus. Les décès à un mois révolu correspondent à des décès entre 1 et 2 mois exacts. Par ailleurs, les durées d’observation que nous avons calculées avec <code data-pkg="lubridate">time_length</code> sont des durées exactes, c’est-à-dire avec la partie décimale. Pour une analyse de survie, on ne peut mélanger des durées exactes et des durées révolues. Trois approches peuvent être envisagées :</p>
<ol style="list-style-type: decimal">
<li>faire l’analyse en mois révolus, auquel cas on ne gardera que la partie entière des durées d’observations avec la fonction <code data-pkg="base" data-rdoc="Round">trunc</code> ;</li>
<li>considérer qu’un âge au décès de 3 mois révolus correspond en moyenne à 3,5 mois exacts et donc ajouter 0,5 à tous les âges révolus ;</li>
<li>imputer un âge au décès exact en distribuant aléatoirement les décès à 3 mois révolus entre 3 et 4 mois exacts, autrement dit en ajoutant aléatoirement une partie décimale aux âges révolus.</li>
</ol>
<p>Nous allons ici adopter la troisième approche en considérant que les décès se répartissent de manière uniforme au sein d’un même mois. Nous aurons donc recours à la fonction <code data-pkg="stats" data-rdoc="Uniform">runif</code> qui permets de générer des valeurs aléatoires entre 0 et 1 selon une distribustion uniforme.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">enfants &lt;-<span class="st"> </span>enfants <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_deces_impute =</span> age_deces <span class="op">+</span><span class="st"> </span><span class="kw">runif</span>(<span class="kw">n</span>()))</code></pre></div>
<p>Pour définir notre objet de survie, il nous faudra deux variables. Une première, temporelle, indiquant la durée à laquelle survient l’évènement étudié (ici le décès) pour ceux ayant vécu l’évènement et la durée d’observation pour ceux n’ayant pas vécu l’évènement (<dfn>censure à droite</dfn><dfn data-index="droite, censure"></dfn>). Par ailleurs, une seconde variable indiquant si les individus ont vécu l’évènement (0 pour non, 1 pour oui). Or, ici, la variable <var>survie</var> est codée 0 pour les décès et 1 pour ceux ayant survécu. Pour plus de détails, voir l’aide de la fonction <code data-pkg="survival">Surv</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">enfants &lt;-<span class="st"> </span>enfants <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">deces =</span> <span class="kw">if_else</span>(survie <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">set_variable_labels</span>(<span class="dt">deces =</span> <span class="st">"Est décédé ?"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">set_value_labels</span>(<span class="dt">deces =</span> <span class="kw">c</span>(<span class="dt">non =</span> <span class="dv">0</span>, <span class="dt">oui =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">time =</span> <span class="kw">if_else</span>(deces <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, age_deces_impute, duree_observation))</code></pre></div>
<p>Occupons-nous maintenant des variables explicatives que nous allons inclure dans l’analyse. Tout d’abord, ajoutons à la table <code>enfants</code> les variables nécessaires des tables <code>femmes</code> et <code>menages</code>. Notons qu’il nous faudra importer <var>id_menage</var> de la table <code>femmes</code> pour pouvoir fusionner ensuite la table <code>enfants</code> avec la table <code>menages</code>. Par ailleurs, pour éviter une confusion sur la variable <var>date_naissance</var>, nous renommons à la volée cette variable de la table <code>femmes</code> en <var>date_naissance_mere</var>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">enfants &lt;-<span class="st"> </span>enfants <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(
    <span class="kw">select</span>(femmes,
      id_femme, id_menage, milieu, educ, 
      <span class="dt">date_naissance_mere =</span> date_naissance, nb_enf_ideal
    ),
    <span class="dt">by =</span> <span class="st">"id_femme"</span>
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(
    <span class="kw">select</span>(menages, id_menage, structure, richesse),
    <span class="dt">by =</span> <span class="st">"id_menage"</span>
  )</code></pre></div>
<pre><code>Warning: Column `id_femme` has different
attributes on LHS and RHS of join</code></pre>
<p>Les variables catégorielles sont pour l’heure sous formes de vecteurs labellisés. Or, dans un modèle, il est impératif de les convertir en facteurs pour qu’elles soient bien traitées comme des variables catégorielles (autrement elles seraient traitées comme des variables continues). On aura donc recours à la fonction <code data-pkg="labelled">to_factor</code> de l’extension <code class="pkg">labelled</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">enfants &lt;-<span class="st"> </span>enfants <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sexe =</span> <span class="kw">to_factor</span>(sexe), <span class="dt">richesse =</span> <span class="kw">to_factor</span>(richesse))</code></pre></div>
<p>Regardons plus attentivement, la variable <var>structure</var>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">freq</span>(enfants<span class="op">$</span>structure)</code></pre></div>
<pre><code>                                                 n
[0] pas d'adulte                                 0
[1] un adulte                                   45
[2] deux adultes de sexe opposé                505
[3] deux adultes de même sexe                   71
[4] trois adultes ou plus avec lien de parenté 764
[5] adultes sans lien de parenté               199
                                                  %
[0] pas d'adulte                                0.0
[1] un adulte                                   2.8
[2] deux adultes de sexe opposé                31.9
[3] deux adultes de même sexe                   4.5
[4] trois adultes ou plus avec lien de parenté 48.2
[5] adultes sans lien de parenté               12.6
                                               val%
[0] pas d'adulte                                0.0
[1] un adulte                                   2.8
[2] deux adultes de sexe opposé                31.9
[3] deux adultes de même sexe                   4.5
[4] trois adultes ou plus avec lien de parenté 48.2
[5] adultes sans lien de parenté               12.6</code></pre>
<p>Tout d’abord, la modalité <q>pas d’adulte</q> n’est pas représentée dans l’échantillon. On aura donc recours à l’argument <code>drop_unused_labels</code> pour ne pas conserver cette modalité. Par ailleurs, nous considérons que la situation familiale à partir de laquelle nous voudrons comparer les autres dans notre modèle, donc celle qui doit être considérée comme la modalité de référence, est celle du ménage nucléaire. Cette modalité (<q>deux adultes de sexe opposé</q>) n’étant pas la première, nous aurons recours à la fonction <code>relevel</code>{data-pkg = “stats”}.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">enfants &lt;-<span class="st"> </span>enfants <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">structure =</span> <span class="kw">relevel</span>(
    <span class="kw">to_factor</span>(structure, <span class="dt">drop_unused_labels =</span> <span class="ot">TRUE</span>),
    <span class="st">"deux adultes de sexe opposé"</span>
  ))</code></pre></div>
<p>Regardons la variable <var>educ</var>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">freq</span>(enfants<span class="op">$</span>educ)</code></pre></div>
<pre><code>                  n    % val%
[0] aucun      1084 68.4 68.4
[1] primaire    368 23.2 23.2
[2] secondaire  115  7.3  7.3
[3] supérieur    17  1.1  1.1</code></pre>
<p>La modalité <q>supérieur</q> est peu représentée dans notre échantillon. Nous allons la fusionner avec la modalité <q>secondaire</q> (voir la section <a href="#recodage_regrouper_modalites">Regrouper les modalités d’une variable</a> du chapitre <a href="#recodage">Recodage</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">enfants &lt;-<span class="st"> </span>enfants <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">educ2 =</span> <span class="kw">ifelse</span>(educ <span class="op">==</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">2</span>, educ)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">set_value_labels</span>(<span class="dt">educ2 =</span> <span class="kw">c</span>(
    <span class="dt">aucun =</span> <span class="dv">0</span>,
    <span class="dt">primaire =</span> <span class="dv">1</span>,
    <span class="st">"secondaire ou plus"</span> =<span class="st"> </span><span class="dv">2</span>
  )) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">educ2 =</span> <span class="kw">to_factor</span>(educ2))
<span class="kw">freq</span>(enfants<span class="op">$</span>educ2)</code></pre></div>
<pre><code>                      n    % val%
aucun              1084 68.4 68.4
primaire            368 23.2 23.2
secondaire ou plus  132  8.3  8.3</code></pre>
<p>Calculons maintenant l’âge de la mère à la naissance de l’enfant (voir le chapitre <a href="#calculer-un-age">Caluler un âge</a>) et découpons le en groupes d’âges (voir la section <a href="#recodage_decouper_en_classes">Découper une variable numérique en classes</a> du chapitre <a href="#recodage">Recodage</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">enfants &lt;-<span class="st"> </span>enfants <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">age_mere_naissance =</span> <span class="kw">time_length</span>(
      <span class="kw">interval</span>(date_naissance_mere, date_naissance), 
      <span class="dt">unit =</span> <span class="st">"years"</span>
    ),
    <span class="dt">gpage_mere_naissance =</span> <span class="kw">cut</span>(
      age_mere_naissance, 
      <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>, <span class="dt">right =</span> <span class="ot">FALSE</span>,
      <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">13</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>)
    )
  )
  
<span class="kw">levels</span>(enfants<span class="op">$</span>gpage_mere_naissance) &lt;-<span class="st"> </span><span class="kw">c</span>(
  <span class="st">"19 ou moins"</span>, <span class="st">"20-29"</span>, <span class="st">"30 et plus"</span>
)
enfants<span class="op">$</span>gpage_mere_naissance &lt;-<span class="st"> </span><span class="kw">relevel</span>(enfants<span class="op">$</span>gpage_mere_naissance, <span class="st">"20-29"</span>)
<span class="kw">freq</span>(enfants<span class="op">$</span>gpage_mere_naissance)</code></pre></div>
<pre><code>              n    % val%
20-29       888 56.1 56.1
19 ou moins 257 16.2 16.2
30 et plus  439 27.7 27.7</code></pre>
<p>Reste à calculer si le rang de naissance de l’enfant est supérieur au nombre idéal d’enfants tel que défini par la mère. On aura recours à la fonction <code data-pkg="base">rank</code> appliquée par groupe (ici calculé séparément pour chaque mère). L’argument <code>ties.method</code> permet d’indiquer comment gérer les égalités (ici les naissances multiples, e.g. les jumeaux). Comme nous voulons comparer le rang de l’enfant au nombre idéal d’enfants, nous allons retenir la méthode <code>"max"</code> pour obtenir, dans le cas présent, le nombre total d’enfants déjà nés<a href="#analyse-de-survie_fn4" class="footnoteRef" id="analyse-de-survie_fnref4"><sup>4</sup></a>. Avant de calculer un rang, il est impératif de trier préalablement le tableau (voir le chapitre <a href="#tris">Tris</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">enfants &lt;-<span class="st"> </span>enfants <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(id_femme, date_naissance) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(id_femme) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">rang =</span> <span class="kw">rank</span>(date_naissance, <span class="dt">ties.method =</span> <span class="st">"max"</span>),
    <span class="dt">rang_apres_ideal =</span> <span class="kw">ifelse</span>(rang <span class="op">&gt;</span><span class="st"> </span>nb_enf_ideal, <span class="st">"oui"</span>, <span class="st">"non"</span>),
    <span class="dt">rang_apres_ideal =</span> <span class="kw">factor</span>(rang_apres_ideal, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">"non"</span>, <span class="st">"oui"</span>))
  )</code></pre></div>
</div>
<div id="analyse-de-survie_kaplan-meir" class="section level2">
<h2>Kaplan-Meir</h2>
<p>La courbe de survie de <dfn>Kaplan-Meir</dfn> s’obtient avec la fonction <code data-pkg="survival">survfit</code> de l’extension <code class="pkg">survival</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(survival)
km_global &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>(time, deces) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> enfants)
km_global</code></pre></div>
<pre><code>Call: survfit(formula = Surv(time, deces) ~ 1, data = enfants)

      n  events  median 0.95LCL 0.95UCL 
   1584     142      NA      NA      NA </code></pre>
<p>Pour la représenter, on pourra avoir recours à la fonction <code data-pkg="survminer">ggsurvplot</code> de l’extension <code>survminer</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(survminer)</code></pre></div>
<pre><code>Loading required package: ggplot2</code></pre>
<pre><code>Loading required package: ggpubr</code></pre>
<pre><code>Loading required package: magrittr</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsurvplot</span>(km_global)</code></pre></div>
<img src="graphs/analyse-de-survie/unnamed-chunk-33-1.png" width="1050"><figcaption>
Courbe de survie de Kaplan-Meier
</figcaption></figure><p>On peut facilement représenter à la place la courbe cumulée des évènements (l’inverse de la courbe de survie) et la table des effectifs en fonction du temps.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsurvplot</span>(km_global, <span class="dt">fun =</span> <span class="st">"event"</span>, <span class="dt">risk.table =</span> <span class="ot">TRUE</span>, <span class="dt">surv.scale =</span> <span class="st">"percent"</span>)</code></pre></div>
<img src="graphs/analyse-de-survie/unnamed-chunk-34-1.png" width="1050"><figcaption>
Courbe cumulée des évènements et table des effectifs
</figcaption></figure><p>Pour comparer deux groupes (ici les filles et les garçons), il suffit d’indiquer la variable de comparaison à <code data-pkg="survival">survfit</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">km_sexe &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>(time, deces) <span class="op">~</span><span class="st"> </span>sexe, <span class="dt">data =</span> enfants)
km_sexe</code></pre></div>
<pre><code>Call: survfit(formula = Surv(time, deces) ~ sexe, data = enfants)

                n events median 0.95LCL 0.95UCL
sexe=masculin 762     94     NA      NA      NA
sexe=féminin  822     48     NA      NA      NA</code></pre>
<p>La fonction <code data-pkg="survival">survdiff</code> permets de calculer le <dfn data-index="test du logrank (comparaison de courbes de survie)">test du logrank</dfn><dfn data-index="logrank, test (comparaison de courbes de survie)"></dfn><dfn data-index="comparaison de courbes de survie (test du logrank)"></dfn> afin de comparer des courbes de survie. La mortalité infanto-juvénile diffère-t-elle significativement selon le sexe de l’enfant ?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">survdiff</span>(<span class="kw">Surv</span>(time, deces) <span class="op">~</span><span class="st"> </span>sexe, <span class="dt">data =</span> enfants)</code></pre></div>
<pre><code>Call:
survdiff(formula = Surv(time, deces) ~ sexe, data = enfants)

                N Observed Expected (O-E)^2/E
sexe=masculin 762       94     66.2      11.6
sexe=féminin  822       48     75.8      10.2
              (O-E)^2/V
sexe=masculin      21.8
sexe=féminin       21.8

 Chisq= 21.8  on 1 degrees of freedom, p= 3e-06 </code></pre>
<p>Une fois encore, on aura recours à <code data-pkg="survminer">ggsurvplot</code> pour représenter les courbes de survie.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsurvplot</span>(km_sexe, <span class="dt">conf.int =</span> <span class="ot">TRUE</span>, <span class="dt">risk.table =</span> <span class="ot">TRUE</span>, <span class="dt">pval =</span> <span class="ot">TRUE</span>, <span class="dt">data =</span> enfants)</code></pre></div>
<img src="graphs/analyse-de-survie/unnamed-chunk-37-1.png" width="1050"><figcaption>
Courbes de Kaplan-Meier selon le sexe
</figcaption></figure>
</div>
<div id="analyse-de-survie_modele-de-cox" class="section level2">
<h2>Modèle de Cox</h2>
<p>Un <dfn>modèle de Cox</dfn><dfn data-index="Cox, modèle"></dfn> se calcule aisément avec <code>coxph</code>{survival}.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod1 &lt;-<span class="st"> </span><span class="kw">coxph</span>(
  <span class="kw">Surv</span>(time, deces) <span class="op">~</span><span class="st"> </span>sexe <span class="op">+</span><span class="st"> </span>milieu <span class="op">+</span><span class="st"> </span>richesse <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>structure <span class="op">+</span><span class="st"> </span>educ2 <span class="op">+</span><span class="st"> </span>gpage_mere_naissance <span class="op">+</span><span class="st"> </span>rang_apres_ideal, 
  <span class="dt">data =</span> enfants
)
mod1</code></pre></div>
<pre><code>Call:
coxph(formula = Surv(time, deces) ~ sexe + milieu + richesse + 
    structure + educ2 + gpage_mere_naissance + rang_apres_ideal, 
    data = enfants)

                                                        coef
sexeféminin                                         -0.80957
milieu                                               0.65624
richessepauvre                                      -0.08222
richessemoyen                                        0.31864
richesseriche                                        0.35348
richessetrès riche                                   0.46459
structureun adulte                                  -0.15023
structuredeux adultes de même sexe                   0.60459
structuretrois adultes ou plus avec lien de parenté  0.04943
structureadultes sans lien de parenté               -0.13137
educ2primaire                                       -0.03025
educ2secondaire ou plus                             -0.20390
gpage_mere_naissance19 ou moins                     -0.31025
gpage_mere_naissance30 et plus                      -0.00259
rang_apres_idealoui                                  1.35511
                                                    exp(coef)
sexeféminin                                           0.44505
milieu                                                1.92753
richessepauvre                                        0.92107
richessemoyen                                         1.37526
richesseriche                                         1.42402
richessetrès riche                                    1.59136
structureun adulte                                    0.86051
structuredeux adultes de même sexe                    1.83051
structuretrois adultes ou plus avec lien de parenté   1.05067
structureadultes sans lien de parenté                 0.87689
educ2primaire                                         0.97020
educ2secondaire ou plus                               0.81554
gpage_mere_naissance19 ou moins                       0.73327
gpage_mere_naissance30 et plus                        0.99742
rang_apres_idealoui                                   3.87717
                                                    se(coef)
sexeféminin                                          0.17781
milieu                                               0.26993
richessepauvre                                       0.25042
richessemoyen                                        0.24787
richesseriche                                        0.29842
richessetrès riche                                   0.42858
structureun adulte                                   0.60033
structuredeux adultes de même sexe                   0.37644
structuretrois adultes ou plus avec lien de parenté  0.19667
structureadultes sans lien de parenté                0.30548
educ2primaire                                        0.20575
educ2secondaire ou plus                              0.36689
gpage_mere_naissance19 ou moins                      0.26806
gpage_mere_naissance30 et plus                       0.19156
rang_apres_idealoui                                  0.60240
                                                        z
sexeféminin                                         -4.55
milieu                                               2.43
richessepauvre                                      -0.33
richessemoyen                                        1.29
richesseriche                                        1.18
richessetrès riche                                   1.08
structureun adulte                                  -0.25
structuredeux adultes de même sexe                   1.61
structuretrois adultes ou plus avec lien de parenté  0.25
structureadultes sans lien de parenté               -0.43
educ2primaire                                       -0.15
educ2secondaire ou plus                             -0.56
gpage_mere_naissance19 ou moins                     -1.16
gpage_mere_naissance30 et plus                      -0.01
rang_apres_idealoui                                  2.25
                                                          p
sexeféminin                                         5.3e-06
milieu                                                0.015
richessepauvre                                        0.743
richessemoyen                                         0.199
richesseriche                                         0.236
richessetrès riche                                    0.278
structureun adulte                                    0.802
structuredeux adultes de même sexe                    0.108
structuretrois adultes ou plus avec lien de parenté   0.802
structureadultes sans lien de parenté                 0.667
educ2primaire                                         0.883
educ2secondaire ou plus                               0.578
gpage_mere_naissance19 ou moins                       0.247
gpage_mere_naissance30 et plus                        0.989
rang_apres_idealoui                                   0.024

Likelihood ratio test=38.2  on 15 df, p=0.000855
n= 1584, number of events= 142 </code></pre>
<p>De nombreuses variables ne sont pas significatives. Voyons si nous pouvons, avec la fonction <code data-pkg="stats">step</code>, améliorer notre modèle par minimisation de l’<dfn>AIC</dfn> ou <dfn lang="en">Akaike Information Criterion</dfn> (voir la section <a href="#regression-logistique_selection-de-modeles">Sélection de modèles</a> du chapitre sur la <a href="#regression-logistique">Régression logistique</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod2 &lt;-<span class="st"> </span><span class="kw">step</span>(mod1)</code></pre></div>
<pre><code>Start:  AIC=2027.07
Surv(time, deces) ~ sexe + milieu + richesse + structure + educ2 + 
    gpage_mere_naissance + rang_apres_ideal

                       Df    AIC
- structure             4 2022.0
- richesse              4 2022.7
- educ2                 2 2023.4
- gpage_mere_naissance  2 2024.6
&lt;none&gt;                    2027.1
- rang_apres_ideal      1 2028.6
- milieu                1 2031.3
- sexe                  1 2047.1

Step:  AIC=2022.01
Surv(time, deces) ~ sexe + milieu + richesse + educ2 + gpage_mere_naissance + 
    rang_apres_ideal

                       Df    AIC
- richesse              4 2017.0
- educ2                 2 2018.2
- gpage_mere_naissance  2 2019.5
&lt;none&gt;                    2022.0
- rang_apres_ideal      1 2023.4
- milieu                1 2025.6
- sexe                  1 2042.2

Step:  AIC=2017
Surv(time, deces) ~ sexe + milieu + educ2 + gpage_mere_naissance + 
    rang_apres_ideal

                       Df    AIC
- educ2                 2 2013.3
- gpage_mere_naissance  2 2014.8
&lt;none&gt;                    2017.0
- rang_apres_ideal      1 2018.0
- milieu                1 2018.8
- sexe                  1 2037.6

Step:  AIC=2013.28
Surv(time, deces) ~ sexe + milieu + gpage_mere_naissance + rang_apres_ideal

                       Df    AIC
- gpage_mere_naissance  2 2011.2
&lt;none&gt;                    2013.3
- rang_apres_ideal      1 2014.3
- milieu                1 2015.7
- sexe                  1 2033.8

Step:  AIC=2011.17
Surv(time, deces) ~ sexe + milieu + rang_apres_ideal

                   Df    AIC
&lt;none&gt;                2011.2
- rang_apres_ideal  1 2012.3
- milieu            1 2013.9
- sexe              1 2031.6</code></pre>
<p>On peut obtenir facilement les coefficients du modèle avec l’excellente fonction <code data-pkg="broom">tidy</code> de l’extension <code class="pkg">broom</code>. Ne pas oublier de préciser <code>exponentiate = TRUE</code>. En effet, dans le cas d’un modèle de Cox, l’exponentiel des coefficients corresponds au <dfn>ratio des risques instantannés</dfn> ou <dfn lang="en">hazard ratio (HR)</dfn> en anglais.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(broom)
<span class="kw">tidy</span>(mod2, <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>                 term  estimate std.error
1         sexeféminin 0.4429992 0.1774811
2              milieu 1.5206198 0.1987723
3 rang_apres_idealoui 3.4410694 0.5840690
  statistic      p.value  conf.low  conf.high
1 -4.587459 4.486738e-06 0.3128461  0.6272998
2  2.108533 3.498491e-02 1.0299718  2.2449981
3  2.115816 3.436049e-02 1.0952998 10.8107009</code></pre>
<p>Pour représenter ces rapports de risque, on peut ici encore avoir recours à la fonction <code data-pkg="GGally">ggcoef</code> de l’extension <code class="pkg">GGally</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(GGally)</code></pre></div>
<pre><code>
Attaching package: 'GGally'</code></pre>
<pre><code>The following object is masked from 'package:dplyr':

    nasa</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggcoef</span>(<span class="kw">tidy</span>(mod2, <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>), <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="graphs/analyse-de-survie/unnamed-chunk-41-1.png" width="1050"></p>
<p>NB : dû à un bug<a href="#analyse-de-survie_fn5" class="footnoteRef" id="analyse-de-survie_fnref5"><sup>5</sup></a> en cours de résolution dans l’extension <code class="pkg">broom</code>, il est nécessaire d’appliquer <code>tidy</code> au modèle avant de le passer à <code>ggcoef</code>. En effet, si l’on fait directement <code>ggcoef(mod2, exponentiate = TRUE)</code>, les intervalles de confiance ne seront pas correctement représentés.</p>
<figcaption>
Coefficients du modèle
</figcaption></figure>
</div>
<div id="analyse-de-survie_verification-de-la-validite-du-modele" class="section level2">
<h2>Vérification de la validité du modèle</h2>
<p>Un modèle de Cox n’est valable que sous l’hypothèse de la proportionnalité des risques relatifs. Selon cette hypothèse les <dfn>résidus de Schoenfeld</dfn><dfn data-index="Schoenfeld, résidus"> ne dépendent pas du tout. Cette hypothèse peut être testée avec la fonction <code data-pkg="survival">cox.zph</code>.</dfn></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test &lt;-<span class="st"> </span><span class="kw">cox.zph</span>(mod2)
test</code></pre></div>
<pre><code>                        rho chisq     p
sexeféminin          0.0608 0.524 0.469
milieu              -0.0305 0.132 0.717
rang_apres_idealoui -0.0359 0.181 0.670
GLOBAL                   NA 0.827 0.843</code></pre>
<p>Une valeur de p inférieure à 5 % indique que l’hypothèse n’est pas vérifiée. Il apparaît que p est supérieur à 5 % globalement et pour chaque variable prise individuellement. Notre modèle est donc valide.</p>
<p>Il est possible de représenter la distribution des résidus de Schoenfeld à l’aide de <code data-pkg="survminer">ggcoxzph</code> de l’extension <code class="pkg">survminer</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggcoxzph</span>(test)</code></pre></div>
<img src="graphs/analyse-de-survie/unnamed-chunk-43-1.png" width="1050"><figcaption>
Résidus de Schoenfeld
</figcaption></figure>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="analyse-de-survie_fn1"><p>Pour utiliser simultanément <code class="pkg">data.table</code> et <code class="pkg">dplyr</code>, nous aurions préféré la fonction <code data-pkg="dtplyr">tbl_dt</code> de l’extension <code>dtplyr</code>.<a href="#analyse-de-survie_fnref1"><U+21A9></a></p></li>
<li id="analyse-de-survie_fn2"><p>Ici, pour plus de simplicité, nous n’avons pas pris en compte les décès éventuels des enfants de rang inférieur avant la naissance considérée.<a href="#analyse-de-survie_fnref2"><U+21A9></a></p></li>
<li id="analyse-de-survie_fn3"><p>Si cela n’avait pas été le cas, nous aurions eu recours à la fonction <code data-pkg="dplyr">tbl_df</code>.<a href="#analyse-de-survie_fnref3"><U+21A9></a></p></li>
<li id="analyse-de-survie_fn4"><p>Ici, pour plus de simplicité, nous n’avons pas pris en compte les décès éventuels des enfants de rang inférieur avant la naissance considérée.<a href="#analyse-de-survie_fnref4"><U+21A9></a></p></li>
<li id="analyse-de-survie_fn5"><p><a href="https://github.com/tidyverse/broom/issues/219" class="uri">https://github.com/tidyverse/broom/issues/219</a><a href="#analyse-de-survie_fnref5"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="analyse-de-sequences"><div class="fluid-row" id="analyse-de-sequences_header">



<h1 class="title toc-ignore">Analyse de séquences</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#analyse-de-sequences_lanalyse-de-sequences">L’analyse de séquences</a></li>
<li><a href="#analyse-de-sequences_installer-traminer-et-recuperer-les-donnees">Installer TraMineR et récupérer les données</a></li>
<li><a href="#analyse-de-sequences_appariement-optimal-et-classification">Appariement optimal et classification</a></li>
<li><a href="#analyse-de-sequences_representations-graphiques">Représentations graphiques</a></li>
<li><a href="#analyse-de-sequences_bibliographie">Bibliographie</a></li>
</ul>
</div>

<div class="note">
<p>La version originale de ce chapitre est une reprise, avec l’aimable autorisation de son auteur, d’un article de Nicolas Robette intitulé <em>L’analyse de séquences : une introduction avec le logiciel R et le package TraMineR</em> et publié sur le blog Quanti (<a href="http://quanti.hypotheses.org/686/" class="uri">http://quanti.hypotheses.org/686/</a>).</p>
</div>
<p>Depuis les années 1980, l’étude quantitative des <dfn data-index="trajectoire biographique">trajectoires biographiques</dfn> (<dfn lang="en">life course analysis</dfn>) a pris une ampleur considérable dans le champ des sciences sociales. Les collectes de données micro-individuelles longitudinales se sont développées, principalement sous la forme de panels ou d’enquêtes rétrospectives. Parallèlement à cette multiplication des données disponibles, la méthodologie statistique a connu de profondes évolutions. L’<dfn>analyse des biographies</dfn><dfn data-index="biographie, analyse"></dfn> (<dfn lang="en">event history analysis</dfn>) — qui ajoute une dimension diachronique aux modèles économétriques mainstream — s’est rapidement imposée comme l’approche dominante : il s’agit de modéliser la durée des situations ou le risque d’occurrence des événements.</p>
<div id="analyse-de-sequences_lanalyse-de-sequences" class="section level2">
<h2>L’analyse de séquences</h2>
<p>Cependant, ces dernières années ont vu la diffusion d’un large corpus de méthodes descriptives d’<dfn>analyse de séquences</dfn><dfn data-index="séquence, analyse"></dfn>, au sein desquelles l’<dfn>appariement optimal</dfn><dfn data-index="optimal, appariement"></dfn> (<dfn lang="en">optimal matching</dfn><dfn data-index="matching, optimal" lang="en"></dfn>) occupe une place centrale<a href="#analyse-de-sequences_fn1" class="footnoteRef" id="analyse-de-sequences_fnref1"><sup>1</sup></a>. L’objectif principal de ces méthodes est d’identifier — dans la diversité d’un corpus de séquences constituées de séries d’états successifs — les régularités, les ressemblances, puis le plus souvent de construire des typologies de « séquences-types ». L’analyse de séquences constitue donc un moyen de décrire mais aussi de mieux comprendre le déroulement de divers processus.</p>
<p>La majeure partie des applications de l’analyse de séquences traite de trajectoires biographiques ou de carrières professionnelles. Dans ces cas, chaque trajectoire ou chaque carrière est décrite par une séquence, autrement dit par une suite chronologiquement ordonnée de « moments » élémentaires, chaque moment correspondant à un « état » déterminé de la trajectoire (par exemple, pour les carrières professionnelles : être en emploi, au chômage ou en inactivité). Mais on peut bien sûr imaginer des types de séquences plus originaux : Andrew Abbott<a href="#analyse-de-sequences_fn2" class="footnoteRef" id="analyse-de-sequences_fnref2"><sup>2</sup></a>, le sociologue américain qui a introduit l’<em>optimal matching</em> dans les sciences scientifiques ou des séquences de pas de danses traditionnelles.</p>
<p>En France, les premiers travaux utilisant l’appariement optimal sont ceux de Claire Lemercier<a href="#analyse-de-sequences_fn3" class="footnoteRef" id="analyse-de-sequences_fnref3"><sup>3</sup></a> sur les carrières des membres des institutions consulaires parisiennes au <span style="font-variant: small-caps;">xix</span><sup>e</sup> siècle (Lemercier, 2005), et de Laurent Lesnard<a href="#analyse-de-sequences_fn4" class="footnoteRef" id="analyse-de-sequences_fnref4"><sup>4</sup></a> sur les emplois du temps (Lesnard, 2008). Mais dès les années 1980, les chercheurs du Céreq construisaient des typologies de trajectoires d’insertion à l’aide des méthodes d’analyse des données « à la française » (analyse des correspondances, etc.)<a href="#analyse-de-sequences_fn5" class="footnoteRef" id="analyse-de-sequences_fnref5"><sup>5</sup></a>. Au final, on dénombre maintenant plus d’une centaine d’articles de sciences sociales contenant ou discutant des techniques empruntées à l’analyse de séquences.</p>
<p>Pour une présentation des différentes méthodes d’analyse de séquences disponibles et de leur mise en oeuvre pratique, il existe un petit manuel en français, publié en 2011 dernière aux éditions du Ceped (collection « Les clefs pour »<a href="#analyse-de-sequences_fn6" class="footnoteRef" id="analyse-de-sequences_fnref6"><sup>6</sup></a>) et disponible en pdf<a href="#analyse-de-sequences_fn7" class="footnoteRef" id="analyse-de-sequences_fnref7"><sup>7</sup></a> (Robette, 2011). De plus, un article récemment publié dans le <em>Bulletin de Méthodologie Sociologique</em> compare de manière systématique les résultats obtenus par les principales méthodes d’analyse de séquences (Robette &amp; Bry, 2012). La conclusion en est qu’avec des données empiriques aussi structurées que celles que l’on utilise en sciences sociales, l’approche est robuste, c’est-à-dire qu’un changement de méthode aura peu d’influence sur les principaux résultats. Cependant, l’article tente aussi de décrire les spécificités de chaque méthode et les différences marginales qu’elles font apparaître, afin de permettre aux chercheurs de mieux adapter leurs choix méthodologiques à leur question de recherche.</p>
<p>Afin d’illustrer la démarche de l’analyse de séquences, nous allons procéder ici à la description « pas à pas » d’un corpus de carrières professionnelles, issues de l’enquête <em>Biographies et entourage</em> (Ined, 2000)<a href="#analyse-de-sequences_fn8" class="footnoteRef" id="analyse-de-sequences_fnref8"><sup>8</sup></a>. Et pour ce faire, on va utiliser le logiciel <strong>R</strong>, qui propose la solution actuellement la plus complète et la plus puissante en matière d’analyse de séquences. Les méthodes d’analyse de séquences par analyses factorielles ou de correspondances ne nécessitent pas de logiciel spécifique : tous les logiciels de statistiques généralistes peuvent être utilisés (<strong>SAS</strong>, <strong>SPSS</strong>, <strong>Stata</strong>, <strong>R</strong>, etc.). En revanche, il n’existe pas de fonctions pour l’appariement optimal dans <strong>SAS</strong> ou <strong>SPSS</strong>. Certains logiciels gratuits implémentent l’appariement optimal (comme <strong>Chesa</strong><a href="#analyse-de-sequences_fn9" class="footnoteRef" id="analyse-de-sequences_fnref9"><sup>9</sup></a> ou <strong>TDA</strong><a href="#analyse-de-sequences_fn10" class="footnoteRef" id="analyse-de-sequences_fnref10"><sup>10</sup></a>) mais il faut alors recourir à d’autres programmes pour dérouler l’ensemble de l’analyse (classification, représentation graphique). <strong>Stata</strong> propose le module <strong>sq</strong><a href="#analyse-de-sequences_fn11" class="footnoteRef" id="analyse-de-sequences_fnref11"><sup>11</sup></a>, qui dispose d’un éventail de fonctions intéressantes. Mais c’est <strong>R</strong> et le package <code class="pkg">TraMineR</code><a href="#analyse-de-sequences_fn12" class="footnoteRef" id="analyse-de-sequences_fnref12"><sup>12</sup></a>, développé par des collègues de l’Université de Genève (Gabadinho et al, 2011), qui fournit la solution la plus complète et la plus puissante à ce jour : on y trouve l’appariement optimal mais aussi d’autres algorithmes alternatifs, ainsi que de nombreuses fonctions de description des séquences et de représentation graphique.</p>
</div>
<div id="analyse-de-sequences_installer-traminer-et-recuperer-les-donnees" class="section level2">
<h2>Installer TraMineR et récupérer les données</h2>
<p>Tout d’abord, à quoi ressemblent nos données ? On a reconstruit à partir de l’enquête les carrières de 1000 hommes. Pour chacune, on connaît la position professionnelle chaque année, de l’âge de 14 ans jusqu’à 50 ans. Cette position est codée de la manière suivante : les codes 1 à 6 correspondent aux groupes socioprofessionnels de la nomenclature des PCS de l’INSEE 13 (agriculteurs exploitants ; artisans, commerçants et chefs d’entreprise ; cadres et professions intellectuelles supérieures ; professions intermédiaires ; employés ; ouvriers) ; on y a ajouté « études » (code 7), « inactivité » (code 8) et « service militaire » (code 9). Le fichier de données comporte une ligne par individu et une colonne par année : la variable <em>csp1</em> correspond à la position à 14 ans, la variable <em>csp2</em> à la position à 15 ans, etc. Par ailleurs, les enquêtés étant tous nés entre 1930 et 1950, on ajoute à notre base une variable « génération » à trois modalités, prenant les valeurs suivantes : 1=“1930-1938” ; 2=“1939-1945” ; 3=“1946-1950”. Au final, la base est constituée de 500 lignes et de 37 + 1 = 38 colonnes et se présente sous la forme d’un fichier texte au format <strong>csv</strong> (téléchargeable à <a href="http://larmarange.github.io/analyse-R/data/trajpro.csv" class="uri">http://larmarange.github.io/analyse-R/data/trajpro.csv</a>).</p>
<p>Une fois <strong>R</strong> ouvert, on commence par installer les extensions nécessaires à ce programme (opération à ne réaliser que lors de leur première utilisation) et par les charger en mémoire. L’extension <code class="pkg">TraMineR</code> propose de nombreuses fonctions pour l’analyse de séquences. L’extension <code class="pkg">cluster</code> comprend un certain nombre de méthodes de classification automatique<a href="#analyse-de-sequences_fn13" class="footnoteRef" id="analyse-de-sequences_fnref13"><sup>13</sup></a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">"TraMineR"</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(TraMineR)</code></pre></div>
<pre><code>
TraMineR stable version 1.8-13 (Built: 2017-05-10)</code></pre>
<pre><code>Website: http://traminer.unige.ch</code></pre>
<pre><code>Please type 'citation("TraMineR")' for citation information.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(cluster)</code></pre></div>
<p>On importe ensuite les données, on recode la variable « génération » pour lui donner des étiquettes plus explicites. On jette également un coup d’oeil à la structure du tableau de données :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">donnees &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">"http://larmarange.github.io/analyse-R/data/trajpro.csv"</span>, 
  <span class="dt">header =</span> T)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">donnees<span class="op">$</span>generation &lt;-<span class="st"> </span><span class="kw">factor</span>(donnees<span class="op">$</span>generation, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"1930-38"</span>, 
  <span class="st">"1939-45"</span>, <span class="st">"1946-50"</span>))
<span class="kw">str</span>(donnees)</code></pre></div>
<pre><code>'data.frame':   1000 obs. of  38 variables:
 $ csp1      : int  1 7 6 7 7 6 7 7 7 6 ...
 $ csp2      : int  1 7 6 7 7 6 7 7 6 6 ...
 $ csp3      : int  1 7 6 6 7 6 7 7 6 6 ...
 $ csp4      : int  1 7 6 6 7 6 7 7 6 6 ...
 $ csp5      : int  1 7 6 6 7 6 7 7 6 6 ...
 $ csp6      : int  1 7 6 6 7 6 9 7 6 6 ...
 $ csp7      : int  6 9 6 6 7 6 9 7 9 6 ...
 $ csp8      : int  6 9 9 6 7 6 9 7 4 6 ...
 $ csp9      : int  6 6 9 6 7 6 9 3 4 9 ...
 $ csp10     : int  6 6 9 6 7 6 4 3 4 9 ...
 $ csp11     : int  6 6 6 6 3 6 4 3 4 6 ...
 $ csp12     : int  6 6 6 6 3 6 4 3 4 6 ...
 $ csp13     : int  6 6 6 6 3 6 4 3 4 6 ...
 $ csp14     : int  6 4 6 6 3 6 4 3 4 6 ...
 $ csp15     : int  6 4 6 6 3 6 4 3 4 6 ...
 $ csp16     : int  6 4 6 6 3 6 6 3 4 6 ...
 $ csp17     : int  6 4 6 6 3 6 6 3 4 6 ...
 $ csp18     : int  6 4 6 6 3 6 6 3 4 6 ...
 $ csp19     : int  6 4 6 6 3 6 6 3 4 6 ...
 $ csp20     : int  6 4 6 6 3 6 6 3 4 6 ...
 $ csp21     : int  6 4 6 6 6 6 6 3 4 6 ...
 $ csp22     : int  6 4 6 6 6 6 6 3 4 4 ...
 $ csp23     : int  6 4 6 6 6 6 6 3 4 4 ...
 $ csp24     : int  6 6 6 6 5 6 6 3 4 4 ...
 $ csp25     : int  6 6 6 6 5 6 6 3 4 4 ...
 $ csp26     : int  6 6 6 6 5 6 6 3 4 4 ...
 $ csp27     : int  6 6 6 6 5 6 6 3 4 4 ...
 $ csp28     : int  6 6 6 6 5 6 6 3 4 4 ...
 $ csp29     : int  6 6 6 6 5 6 6 3 4 4 ...
 $ csp30     : int  4 6 6 6 5 6 6 3 4 4 ...
 $ csp31     : int  4 6 6 6 5 6 6 3 4 4 ...
 $ csp32     : int  4 6 6 6 5 6 6 3 4 4 ...
 $ csp33     : int  4 6 6 6 5 6 6 3 4 4 ...
 $ csp34     : int  4 6 6 6 5 6 6 3 4 4 ...
 $ csp35     : int  4 6 6 6 5 6 6 3 4 4 ...
 $ csp36     : int  4 6 6 6 5 6 6 3 4 4 ...
 $ csp37     : int  4 6 6 6 5 6 6 3 4 4 ...
 $ generation: Factor w/ 3 levels "1930-38","1939-45",..: 2 1 1 3 2 3 1 1 2 1 ...</code></pre>
<p>On a bien 1000 observations et 38 variables. On définit maintenant des <em>labels</em> pour les différents états qui composent les séquences et on crée un objet « séquence » avec <code data-pkg="TraMineR">seqdef</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"agric"</span>, <span class="st">"acce"</span>, <span class="st">"cadr"</span>, <span class="st">"pint"</span>, <span class="st">"empl"</span>, 
  <span class="st">"ouvr"</span>, <span class="st">"etud"</span>, <span class="st">"inact"</span>, <span class="st">"smil"</span>)
seq &lt;-<span class="st"> </span><span class="kw">seqdef</span>(donnees[, <span class="dv">1</span><span class="op">:</span><span class="dv">37</span>], <span class="dt">states =</span> labels)</code></pre></div>
<pre><code> [&gt;] state coding:</code></pre>
<pre><code>       [alphabet]  [label]  [long label] </code></pre>
<pre><code>     1  1           agric    agric</code></pre>
<pre><code>     2  2           acce     acce</code></pre>
<pre><code>     3  3           cadr     cadr</code></pre>
<pre><code>     4  4           pint     pint</code></pre>
<pre><code>     5  5           empl     empl</code></pre>
<pre><code>     6  6           ouvr     ouvr</code></pre>
<pre><code>     7  7           etud     etud</code></pre>
<pre><code>     8  8           inact    inact</code></pre>
<pre><code>     9  9           smil     smil</code></pre>
<pre><code> [&gt;] 1000 sequences in the data set</code></pre>
<pre><code> [&gt;] min/max sequence length: 37/37</code></pre>
</div>
<div id="analyse-de-sequences_appariement-optimal-et-classification" class="section level2">
<h2>Appariement optimal et classification</h2>
<p>Ces étapes préalables achevées, on peut comparer les séquences en calculant les dissimilarités entre paires de séquences. On va ici utiliser la méthode la plus répandue, l’appariement optimal (<em>optimal matching</em>). Cette méthode consiste, pour chaque paire de séquences, à compter le nombre minimal de modifications (substitutions, suppressions, insertions) qu’il faut faire subir à l’une des séquences pour obtenir l’autre. On peut considérer que chaque modification est équivalente, mais il est aussi possible de prendre en compte le fait que les « distances » entre les différents états n’ont pas toutes la même « valeur » (par exemple, la distance sociale entre emploi à temps plein et chômage est plus grande qu’entre emploi à temps plein et emploi à temps partiel), en assignant aux différentes modifications des « coûts » distincts. Dans notre exemple, on va créer avec <code data-pkg="TraMineR">seqsubm</code> une « matrice des coûts de substitution » dans laquelle tous les coûts sont constants et égaux à 2<a href="#analyse-de-sequences_fn14" class="footnoteRef" id="analyse-de-sequences_fnref14"><sup>14</sup></a> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">couts &lt;-<span class="st"> </span><span class="kw">seqsubm</span>(seq, <span class="dt">method =</span> <span class="st">"CONSTANT"</span>, <span class="dt">cval =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code> [&gt;] creating 9x9 substitution-cost matrix using 2 as constant value</code></pre>
<p>Ensuite, on calcule la <dfn>matrice de distances</dfn><dfn data-index="distance, matrice"></dfn> entre les séquences (i.e contenant les « dissimilarités » entre les séquences) avec <code data-pkg="TraMineR">seqdist</code>, avec un coût d’insertion/suppression (<em>indel</em>) que l’on fixe ici à 1,1 :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">seq.om &lt;-<span class="st"> </span><span class="kw">seqdist</span>(seq, <span class="dt">method =</span> <span class="st">"OM"</span>, <span class="dt">indel =</span> <span class="fl">1.1</span>, 
  <span class="dt">sm =</span> couts)</code></pre></div>
<pre><code> [&gt;] 1000 sequences with 9 distinct events/states</code></pre>
<pre><code> [&gt;] 818 distinct sequences</code></pre>
<pre><code> [&gt;] min/max sequence length: 37/37</code></pre>
<pre><code> [&gt;] computing distances using OM metric</code></pre>
<pre><code> [&gt;] total time: 1.63 secs</code></pre>
<p>Cette matrice des distances ou des dissimilarités entre séquences peut ensuite être utilisée pour une <dfn>classification ascendante hiérarchique</dfn> (<dfn>CAH</dfn>), qui permet de regrouper les séquences en un certain nombre de « classes » en fonction de leur proximité :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">seq.agnes &lt;-<span class="st"> </span><span class="kw">agnes</span>(<span class="kw">as.dist</span>(seq.om), <span class="dt">method =</span> <span class="st">"ward"</span>, 
  <span class="dt">keep.diss =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Avec la fonction <code data-pkg="stats" data-rdoc="dendrogram">plot</code>, il est possible de tracer l’arbre de la classification (<dfn>dendrogramme</dfn>).</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">as.dendrogram</span>(seq.agnes), <span class="dt">leaflab =</span> <span class="st">"none"</span>)</code></pre></div>
<img src="graphs/analyse-de-sequences/unnamed-chunk-10-1.png" width="1050"><figcaption>
Dendrogramme de la classification des séquences
</figcaption></figure><p>De même, on peut représenter les <dfn data-index="saut d'inertie">sauts d’inertie</dfn><dfn data-index="inertie, saut">.</dfn></p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">sort</span>(seq.agnes<span class="op">$</span>height, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>], 
  <span class="dt">type =</span> <span class="st">"s"</span>, <span class="dt">xlab =</span> <span class="st">"nb de classes"</span>, <span class="dt">ylab =</span> <span class="st">"inertie"</span>)</code></pre></div>
<img src="graphs/analyse-de-sequences/unnamed-chunk-11-1.png" width="1050"><figcaption>
Sauts d’inertie de la classification des séquences
</figcaption></figure><p>L’observation, sur ce dendogramme ou sur la courbe des sauts d’inertie, des sauts d’inertie des dernières étapes de la classification peut servir de guide pour déterminer le nombre de classes que l’on va retenir pour la suite des analyses. Une première inflexion dans la courbe des sauts d’inertie apparaît au niveau d’une partition en 5 classes. On voit aussi une seconde inflexion assez nette à 7 classes. Mais il faut garder en tête le fait que ces outils ne sont que des guides, le choix devant avant tout se faire après différents essais, en fonction de l’intérêt des résultats par rapport à la question de recherche et en arbitrant entre exhaustivité et parcimonie.</p>
<p>On fait ici le choix d’une <dfn>partition</dfn> en 5 classes :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nbcl &lt;-<span class="st"> </span><span class="dv">5</span>
seq.part &lt;-<span class="st"> </span><span class="kw">cutree</span>(seq.agnes, nbcl)
seq.part &lt;-<span class="st"> </span><span class="kw">factor</span>(seq.part, <span class="dt">labels =</span> <span class="kw">paste</span>(<span class="st">"classe"</span>, 
  <span class="dv">1</span><span class="op">:</span>nbcl, <span class="dt">sep =</span> <span class="st">"."</span>))</code></pre></div>
</div>
<div id="analyse-de-sequences_representations-graphiques" class="section level2">
<h2>Représentations graphiques</h2>
<p>Pour se faire une première idée de la nature des classes de la typologie, il existe un certain nombre de représentations graphiques. Les chronogrammes (<em>state distribution plots</em>) présentent une série de coupes transversales : pour chaque âge, on a les proportions d’individus de la classe dans les différentes situations (agriculteur, étudiant, etc.). Ce graphique s’obtient avec <code data-pkg="TraMineR" data-rdoc="seqplot">seqdplot</code> :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">seqdplot</span>(seq, <span class="dt">group =</span> seq.part, <span class="dt">xtlab =</span> <span class="dv">14</span><span class="op">:</span><span class="dv">50</span>, <span class="dt">border =</span> <span class="ot">NA</span>, 
  <span class="dt">withlegend =</span> T)</code></pre></div>
<img src="graphs/analyse-de-sequences/unnamed-chunk-13-1.png" width="1050"><figcaption>
Chronogrammes
</figcaption></figure><p>Chacune des classes semble caractérisée par un groupe professionnel principal : profession intermédiaire pour la classe 1, ouvrier pour la 2, employé pour la 3, cadre pour la 4 et indépendant pour la 5. Cependant, on aperçoit aussi des « couches » d’autres couleurs, indiquant que l’ensemble des carrières ne sont probablement pas stables.</p>
<p>Les « <dfn dataindex="tapis des séquences">tapis</dfn><dfn data-index="séquence, tapis"></dfn> » (<dfn lang="en">index plots</dfn>), obtenus avec <code data-pkg="TraMineR" data-rdoc="seqplot">seqiplot</code>, permettent de mieux visualiser la dimension individuelle des séquences. Chaque segment horizontal représente une séquence, découpée en sous-segments correspondant aux aux différents états successifs qui composent la séquence.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">seqiplot</span>(seq, <span class="dt">group =</span> seq.part, <span class="dt">xtlab =</span> <span class="dv">14</span><span class="op">:</span><span class="dv">50</span>, <span class="dt">tlim =</span> <span class="dv">0</span>, 
  <span class="dt">space =</span> <span class="dv">0</span>, <span class="dt">border =</span> <span class="ot">NA</span>, <span class="dt">withlegend =</span> T, <span class="dt">yaxis =</span> <span class="ot">FALSE</span>)</code></pre></div>
<img src="graphs/analyse-de-sequences/unnamed-chunk-14-1.png" width="1050"><figcaption>
Tapis des séquences triés
</figcaption></figure><p>Il est possible de trier les séquences pour rendre les tapis plus lisibles (on trie ici par <dfn lang="en">multidimensional scaling</dfn> à l’aide de la fonction <code data-pkg="stats">cmdscale</code>).</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ordre &lt;-<span class="st"> </span><span class="kw">cmdscale</span>(<span class="kw">as.dist</span>(seq.om), <span class="dt">k =</span> <span class="dv">1</span>)
<span class="kw">seqiplot</span>(seq, <span class="dt">group =</span> seq.part, <span class="dt">sortv =</span> ordre, <span class="dt">xtlab =</span> <span class="dv">14</span><span class="op">:</span><span class="dv">50</span>, 
  <span class="dt">tlim =</span> <span class="dv">0</span>, <span class="dt">space =</span> <span class="dv">0</span>, <span class="dt">border =</span> <span class="ot">NA</span>, <span class="dt">withlegend =</span> T, 
  <span class="dt">yaxis =</span> <span class="ot">FALSE</span>)</code></pre></div>
<img src="graphs/analyse-de-sequences/unnamed-chunk-15-1.png" width="1050"><figcaption>
Tapis des séquences triés par multidimensional scaling
</figcaption></figure><p>On voit mieux apparaître ainsi l’hétérogénéité de certaines classes. Les classes 1, 3 et 4, par exemple, semblent regrouper des carrières relativement stables (respectivement de professions intermédiaires, d’employés et de cadres) et des carrières plus « mobiles » commencées comme ouvrier (classes 1 et 3, en orange) ou comme profession intermédiaire (classe 4, en rouge). De même, la majorité des membres de la dernière classe commencent leur carrière dans un groupe professionnel distinct de celui qu’ils occuperont par la suite (indépendants). Ces distinctions apparaissent d’ailleurs si on relance le programme avec un nombre plus élevé de classes (en remplaçant le 5 de la ligne <code>nbcl &lt;- 5</code> par 7, seconde inflexion de la courbe des sauts d’inertie, et en exécutant de nouveau le programme à partir de cette ligne) : les stables et les mobiles se trouvent alors dans des classes distinctes.</p>
<p>Le package <code class="pkg">JLutils</code>, disponible sur <a href="https://github.com/larmarange/JLutils"><strong>GitHub</strong></a>, propose une fonction <code data-pkg="JLutils">seq_heatmap</code> permettant de représenter le tapis de l’ensemble des séquences selon l’ordre du dendrogramme.</p>
<p>Pour installer <code class="pkg">JLutils</code>, on aura recours au package <code class="pkg">devtools</code> et à sa fonction <code data-pkg="devtools">install_github</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools)
<span class="kw">install_github</span>(<span class="st">"larmarange/JLutils"</span>)</code></pre></div>
<p>On peut ensuite générer le graphique ainsi :</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(JLutils)</code></pre></div>
<pre><code>Loading required package: ggplot2</code></pre>
<pre><code>Loading required package: plyr</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">seq_heatmap</span>(seq, seq.agnes, <span class="dt">labCol =</span> <span class="dv">14</span><span class="op">:</span><span class="dv">50</span>)</code></pre></div>
<img src="graphs/analyse-de-sequences/unnamed-chunk-17-1.png" width="1050"><figcaption>
Tapis des séquences trié selon le dendrogramme
</figcaption></figure><p>La distance moyenne des séquences d’une classe au centre de cette classe, obtenue avec <code data-pkg="TraMineR">disscenter</code>, permet de mesurer plus précisément l’<dfn>homogénéité des classes</dfn><dfn data-index="classe, homogénéité"></dfn> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(<span class="kw">aggregate</span>(<span class="kw">disscenter</span>(<span class="kw">as.dist</span>(seq.om), <span class="dt">group =</span> seq.part), 
  <span class="kw">list</span>(seq.part), mean)[, <span class="op">-</span><span class="dv">1</span>], <span class="dv">1</span>)</code></pre></div>
<pre><code>[1] 13.1  8.9 15.6  9.7 16.5</code></pre>
<p>Cela nous confirme que les classes 1, 3 et 5 sont nettement plus hétérogènes que les autres, alors que la classe 2 est la plus homogène.</p>
<p>D’autres représentations graphiques existent pour poursuivre l’examen de la typologie. On peut visualiser les 10 séquences les plus fréquentes de chaque classe avec <code data-pkg="TraMineR" data-rdoc="seqplot">seqfplot</code>.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">seqfplot</span>(seq, <span class="dt">group =</span> seq.part, <span class="dt">withlegend =</span> T)</code></pre></div>
<img src="graphs/analyse-de-sequences/unnamed-chunk-19-1.png" width="1050"><figcaption>
Séquences les plus fréquentes de chaque classe
</figcaption></figure><p>On peut aussi visualiser avec <code data-pkg="TraMineR" data-rdoc="seqplot">seqmsplot</code> l’état modal (celui qui correspond au plus grand nombre de séquences de la classe) à chaque âge.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">seqmsplot</span>(seq, <span class="dt">group =</span> seq.part, <span class="dt">xtlab =</span> <span class="dv">14</span><span class="op">:</span><span class="dv">50</span>, <span class="dt">withlegend =</span> T, 
  <span class="dt">title =</span> <span class="st">"classe"</span>)</code></pre></div>
<img src="graphs/analyse-de-sequences/unnamed-chunk-20-1.png" width="1050"><figcaption>
Statut modal à chaque âge
</figcaption></figure><p>On peut également représenter avec <code data-pkg="TraMineR" data-rdoc="seqplot">seqmtplot</code> les durées moyennes passées dans les différents états.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">seqmtplot</span>(seq, <span class="dt">group =</span> seq.part, <span class="dt">withlegend =</span> T)</code></pre></div>
<img src="graphs/analyse-de-sequences/unnamed-chunk-21-1.png" width="1050"><figcaption>
Durée moyenne dans chaque statut
</figcaption></figure><p>Enfin, l’<dfn>entropie transversale</dfn><dfn data-index="transversale, entropie"></dfn> décrit l’évolution de l’homogénéité de la classe. Pour un âge donné, une entropie proche de 0 signifie que tous les individus de la classe (ou presque) sont dans la même situation. À l’inverse, l’entropie est de 1 si les individus sont dispersés dans toutes les situations. Ce type de graphique produit par <code data-pkg="TraMineR" data-rdoc="seqplot">seqHtplot</code> peut être pratique pour localiser les moments de transition, l’insertion professionnelle ou une mobilité sociale ascendante.</p>
<figure><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">seqHtplot</span>(seq, <span class="dt">group =</span> seq.part, <span class="dt">xtlab =</span> <span class="dv">14</span><span class="op">:</span><span class="dv">50</span>, <span class="dt">withlegend =</span> T)</code></pre></div>
<img src="graphs/analyse-de-sequences/unnamed-chunk-22-1.png" width="1050"><figcaption>
Entropie transversale
</figcaption></figure><p>On souhaite maintenant connaître la distribution de la typologie (en effectifs et en pourcentages) :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">freq</span>(seq.part)</code></pre></div>
<pre><code>           n    % val%
classe.1 280 28.0 28.0
classe.2 199 19.9 19.9
classe.3 114 11.4 11.4
classe.4 341 34.1 34.1
classe.5  66  6.6  6.6</code></pre>
<p>On poursuit ensuite la description des classes en croisant la typologie avec la variable <em>generation</em> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cprop</span>(<span class="kw">table</span>(seq.part, donnees<span class="op">$</span>generation))</code></pre></div>
<pre><code>          
seq.part   1930-38 1939-45 1946-50 Ensemble
  classe.1  25.6    27.1    31.0    28.0   
  classe.2  20.9    20.0    18.9    19.9   
  classe.3   7.9    13.6    12.9    11.4   
  classe.4  38.2    31.9    32.1    34.1   
  classe.5   7.4     7.5     5.2     6.6   
  Total    100.0   100.0   100.0   100.0   </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(<span class="kw">table</span>(seq.part, donnees<span class="op">$</span>generation))</code></pre></div>
<pre><code>
    Pearson's Chi-squared test

data:  table(seq.part, donnees$generation)
X-squared = 12.032, df = 8, p-value = 0.1498</code></pre>
<p>Le lien entre le fait d’avoir un certain type de carrières et la cohorte de naissance est significatif à un seuil de 15 %. On constate par exemple l’augmentation continue de la proportion de carrières de type « professions intermédiaires » (classe 1) et, entre les deux cohortes les plus anciennes, l’augmentation de la part des carrières de type « employés » (classe 3) et la baisse de la part des carrières de type « cadres » (classe 4).</p>
<p>Bien d’autres analyses sont envisageables : croiser la typologie avec d’autres variables (origine sociale, etc.), construire l’espace des carrières possibles, étudier les interactions entre trajectoires familiales et professionnelles, analyser la variance des dissimilarités entre séquences en fonction de plusieurs variables « explicatives<a href="#analyse-de-sequences_fn15" class="footnoteRef" id="analyse-de-sequences_fnref15"><sup>15</sup></a> »…</p>
<p>Mais l’exemple proposé est sans doute bien suffisant pour une première introduction !</p>
</div>
<div id="analyse-de-sequences_bibliographie" class="section level2">
<h2>Bibliographie</h2>
<ul>
<li>Abbott A., 2001, <em>Time matters. On theory and method</em>, The University of Chicago Press.</li>
<li>Abbott A., Hrycak A., 1990, « Measuring ressemblance in sequence data: an optimal matching analysis of musicians’ careers», <em>American journal of sociology</em>, (96), p.144-185. <a href="http://www.jstor.org/stable/10.2307/2780695" class="uri">http://www.jstor.org/stable/10.2307/2780695</a>
</li>
<li>Abbott A., Tsay A., 2000, « Sequence analysis and optimal matching methods in sociology: Review and prospect », <em>Sociological methods &amp; research</em>, 29(1), p.3-33. <a href="http://smr.sagepub.com/content/29/1/3.short" class="uri">http://smr.sagepub.com/content/29/1/3.short</a>
</li>
<li>Gabadinho, A., Ritschard, G., Müller, N.S. &amp; Studer, M., 2011, « Analyzing and visualizing state sequences in R with TraMineR », <em>Journal of Statistical Software</em>, 40(4), p.1-37. <a href="http://archive-ouverte.unige.ch/downloader/vital/pdf/tmp/4hff8pe6uhukqiavvgaluqmjq2/out.pdf" class="uri">http://archive-ouverte.unige.ch/downloader/vital/pdf/tmp/4hff8pe6uhukqiavvgaluqmjq2/out.pdf</a>
</li>
<li>Grelet Y., 2002, « Des typologies de parcours. Méthodes et usages », <em>Document Génération</em> 92, (20), 47 p. <a href="http://www.cmh.greco.ens.fr/programs/Grelet_typolparc.pdf" class="uri">http://www.cmh.greco.ens.fr/programs/Grelet_typolparc.pdf</a>
</li>
<li>Lelièvre É., Vivier G., 2001, « Évaluation d’une collecte à la croisée du quantitatif et du qualitatif : l’enquête Biographies et entourage », <em>Population</em>, (6), p.1043-1073. <a href="http://www.persee.fr/web/revues/home/prescript/article/pop_0032-4663_2001_num_56_6_7217" class="uri">http://www.persee.fr/web/revues/home/prescript/article/pop_0032-4663_2001_num_56_6_7217</a>
</li>
<li>Lemercier C., 2005, « Les carrières des membres des institutions consulaires parisiennes au XIX<sup>e</sup> siècle », <em>Histoire et mesure</em>, XX (1-2), p.59-95. <a href="http://histoiremesure.revues.org/786" class="uri">http://histoiremesure.revues.org/786</a>
</li>
<li>Lesnard L., 2008, « Off-Scheduling within Dual-Earner Couples: An Unequal and Negative Externality for Family Time », <em>American Journal of Sociology</em>, 114(2), p.447-490. <a href="http://laurent.lesnard.free.fr/IMG/pdf/lesnard_2008_off-scheduling_within_dual-earner_couples-2.pdf" class="uri">http://laurent.lesnard.free.fr/IMG/pdf/lesnard_2008_off-scheduling_within_dual-earner_couples-2.pdf</a>
</li>
<li>Lesnard L., Saint Pol T. (de), 2006, « Introduction aux Méthodes d’Appariement Optimal (Optimal Matching Analysis) », <em>Bulletin de Méthodologie Sociologique</em>, 90, p.5-25. <a href="http://bms.revues.org/index638.html" class="uri">http://bms.revues.org/index638.html</a>
</li>
<li>Robette N., 2011, <em>Explorer et décrire les parcours de vie : les typologies de trajectoires</em>, Ceped (Les Clefs pour), 86 p. <a href="http://nicolas.robette.free.fr/Docs/Robette2011_Manuel_TypoTraj.pdf" class="uri">http://nicolas.robette.free.fr/Docs/Robette2011_Manuel_TypoTraj.pdf</a>
</li>
<li>Robette N., 2012, « Du prosélytisme à la sécularisation. Le processus de diffusion de l’Optimal Matching Analysis », <em>document de travail</em>. <a href="http://nicolas.robette.free.fr/Docs/Proselytisme_secularisation_NRobette.pdf" class="uri">http://nicolas.robette.free.fr/Docs/Proselytisme_secularisation_NRobette.pdf</a>
</li>
<li>Robette N., Bry X., 2012, « Harpoon or bait? A comparison of various metrics to fish for life course patterns », <em>Bulletin de Méthodologie Sociologique</em>, 116, p.5-24. <a href="http://nicolas.robette.free.fr/Docs/Harpoon_maggot_RobetteBry.pdf" class="uri">http://nicolas.robette.free.fr/Docs/Harpoon_maggot_RobetteBry.pdf</a>
</li>
<li>Robette N., Thibault N., 2008, « L’analyse exploratoire de trajectoires professionnelles : analyse harmonique qualitative ou appariement optimal ? », <em>Population</em>, 64(3), p.621-646. <a href="http://www.cairn.info/revue-population-2008-4-p-621.htm" class="uri">http://www.cairn.info/revue-population-2008-4-p-621.htm</a>
</li>
<li>Savage M., 2009, « Contemporary Sociology and the Challenge of Descriptive Assemblage », <em>European Journal of Social Theory</em>, 12(1), p.155-174. <a href="http://est.sagepub.com/content/12/1/155.short" class="uri">http://est.sagepub.com/content/12/1/155.short</a>
</li>
</ul>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="analyse-de-sequences_fn1"><p>Pour une analyse des conditions sociales de la diffusion de l’analyse de séquences dans le champ des sciences sociales, voir Robette, 2012.<a href="#analyse-de-sequences_fnref1"><U+21A9></a></p></li>
<li id="analyse-de-sequences_fn2"><p><a href="http://home.uchicago.edu/~aabbott/" class="uri">http://home.uchicago.edu/~aabbott/</a><a href="#analyse-de-sequences_fnref2"><U+21A9></a></p></li>
<li id="analyse-de-sequences_fn3"><p><a href="http://lemercier.ouvaton.org/document.php?id=62" class="uri">http://lemercier.ouvaton.org/document.php?id=62</a><a href="#analyse-de-sequences_fnref3"><U+21A9></a></p></li>
<li id="analyse-de-sequences_fn4"><p><a href="http://laurent.lesnard.free.fr/article.php3?id_article=22" class="uri">http://laurent.lesnard.free.fr/article.php3?id_article=22</a><a href="#analyse-de-sequences_fnref4"><U+21A9></a></p></li>
<li id="analyse-de-sequences_fn5"><p>Voir par exemple l’article d’Yvette Grelet (2002).<a href="#analyse-de-sequences_fnref5"><U+21A9></a></p></li>
<li id="analyse-de-sequences_fn6"><p><a href="http://www.ceped.org/?rubrique57" class="uri">http://www.ceped.org/?rubrique57</a><a href="#analyse-de-sequences_fnref6"><U+21A9></a></p></li>
<li id="analyse-de-sequences_fn7"><p><a href="http://nicolas.robette.free.fr/Docs/Robette2011_Manuel_TypoTraj.pdf" class="uri">http://nicolas.robette.free.fr/Docs/Robette2011_Manuel_TypoTraj.pdf</a><a href="#analyse-de-sequences_fnref7"><U+21A9></a></p></li>
<li id="analyse-de-sequences_fn8"><p>Pour une analyse plus poussée de ces données, avec deux méthodes différentes, voir Robette &amp; Thibault, 2008. Pour une présentation de l’enquête, voir Lelièvre &amp; Vivier, 2001.<a href="#analyse-de-sequences_fnref8"><U+21A9></a></p></li>
<li id="analyse-de-sequences_fn9"><p><a href="http://home.fsw.vu.nl/ch.elzinga/" class="uri">http://home.fsw.vu.nl/ch.elzinga/</a><a href="#analyse-de-sequences_fnref9"><U+21A9></a></p></li>
<li id="analyse-de-sequences_fn10"><p><a href="http://steinhaus.stat.ruhr-uni-bochum.de/tda.html" class="uri">http://steinhaus.stat.ruhr-uni-bochum.de/tda.html</a><a href="#analyse-de-sequences_fnref10"><U+21A9></a></p></li>
<li id="analyse-de-sequences_fn11"><p><a href="http://www.stata-journal.com/article.html?article=st0111" class="uri">http://www.stata-journal.com/article.html?article=st0111</a><a href="#analyse-de-sequences_fnref11"><U+21A9></a></p></li>
<li id="analyse-de-sequences_fn12"><p><a href="http://mephisto.unige.ch/traminer/" class="uri">http://mephisto.unige.ch/traminer/</a><a href="#analyse-de-sequences_fnref12"><U+21A9></a></p></li>
<li id="analyse-de-sequences_fn13"><p>Pour une présentation plus détaillée, voir le chapitre sur la <a href="#classification-ascendante-hierarchique">classification ascendante hiérarchique (CAH)</a>.<a href="#analyse-de-sequences_fnref13"><U+21A9></a></p></li>
<li id="analyse-de-sequences_fn14"><p>Le fonctionnement de l’algorithme d’appariement optimal — et notamment le choix des coûts — est décrit dans le chapitre 9 du manuel de <code class="pkg">TraMineR</code> (<a href="http://mephisto.unige.ch/pub/TraMineR/doc/TraMineR-Users-Guide.pdf" class="uri">http://mephisto.unige.ch/pub/TraMineR/doc/TraMineR-Users-Guide.pdf</a>).<a href="#analyse-de-sequences_fnref14"><U+21A9></a></p></li>
<li id="analyse-de-sequences_fn15"><p>L’articulation entre méthodes « descriptives » et méthodes « explicatives » est un prolongement possible de l’analyse de séquences. Cependant, l’analyse de séquences était envisagée par Abbott comme une alternative à la sociologie quantitative <em>mainstream</em>, i.e le « paradigme des variables » et ses hypothèses implicites souvent difficilement tenables (Abbott, 2001). Une bonne description solidement fondée théoriquement vaut bien des « modèles explicatifs » (Savage, 2009).<a href="#analyse-de-sequences_fnref15"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="analyse-de-reseaux"><div class="fluid-row" id="analyse-de-reseaux_header">



<h1 class="title toc-ignore">Analyse de réseaux</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="analyse-spatiale"><div class="fluid-row" id="analyse-spatiale_header">



<h1 class="title toc-ignore">Analyse spatiale</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="ggplot2-la-grammaire-des-graphiques"><div class="fluid-row" id="ggplot2-la-grammaire-des-graphiques_header">



<h1 class="title toc-ignore">ggplot2 : la grammaire des graphiques</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="etendre-ggplot2"><div class="fluid-row" id="etendre-ggplot2_header">



<h1 class="title toc-ignore">Étendre ggplot2</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="lattice-graphiques-et-formules"><div class="fluid-row" id="lattice-graphiques-et-formules_header">



<h1 class="title toc-ignore">lattice : graphiques et formules</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="diagrammes"><div class="fluid-row" id="diagrammes_header">



<h1 class="title toc-ignore">Diagrammes</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="representer-des-flux"><div class="fluid-row" id="representer-des-flux_header">



<h1 class="title toc-ignore">Représenter des flux</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="reseaux-dynamiques"><div class="fluid-row" id="reseaux-dynamiques_header">



<h1 class="title toc-ignore">Réseaux dynamiques</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="ggvis-les-graphiques-interactifs"><div class="fluid-row" id="ggvis-les-graphiques-interactifs_header">



<h1 class="title toc-ignore">ggvis : les graphiques interactifs</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="htmlwidgets-la-puissance-du-javascript"><div class="fluid-row" id="htmlwidgets-la-puissance-du-javascript_header">



<h1 class="title toc-ignore">htmlwidgets : la puissance de javascript</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="cartes"><div class="fluid-row" id="cartes_header">



<h1 class="title toc-ignore">Cartes</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="conditions-et-comparaisons"><div class="fluid-row" id="conditions-et-comparaisons_header">



<h1 class="title toc-ignore">Conditions et comparaisons</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>
<p>Une condition est une expression logique dont le résultat est soit <code>TRUE</code> (vrai) soit <code>FALSE</code> (faux).</p>
<p>Une condition comprend la plupart du temps un <dfn>opérateur de comparaison</dfn><dfn data-index="comparaison, opérateur"></dfn>. Les plus courants sont les suivants :</p>
<table>
<thead><tr class="header">
<th align="left">Opérateur de comparaison</th>
<th align="left">Signification</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>==</code></td>
<td align="left">égal à</td>
</tr>
<tr class="even">
<td align="left"><code>!=</code></td>
<td align="left">différent de</td>
</tr>
<tr class="odd">
<td align="left"><code>&gt;</code></td>
<td align="left">strictement supérieur à</td>
</tr>
<tr class="even">
<td align="left"><code>&lt;</code></td>
<td align="left">strictement inférieur à</td>
</tr>
<tr class="odd">
<td align="left"><code>&gt;=</code></td>
<td align="left">supérieur ou égal à</td>
</tr>
<tr class="even">
<td align="left"><code>&lt;=</code></td>
<td align="left">inférieur ou égal à</td>
</tr>
</tbody>
</table>
<p>Voyons tout de suite un exemple :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">data</span>(hdv2003)
d &lt;-<span class="st"> </span>hdv2003
<span class="kw">str</span>(d<span class="op">$</span>sexe <span class="op">==</span><span class="st"> "Homme"</span>)</code></pre></div>
<pre><code> logi [1:2000] FALSE FALSE TRUE TRUE FALSE FALSE ...</code></pre>
<p>Que s’est-il passé ? Nous avons fourni à <strong>R</strong> une condition qui signifie « la valeur de la variable <em>sexe</em> vaut “Homme” ». Et il nous a renvoyé un vecteur avec autant d’éléments qu’il y’a d’observations dans <code>d</code>, et dont la valeur est <code>TRUE</code> si l’observation correspond à un homme et <code>FALSE</code> dans les autres cas.</p>
<p>Prenons un autre exemple. On n’affichera cette fois que les premiers éléments de notre variable d’intérêt à l’aide de la fonction <code data-pkg="utils">head</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(d<span class="op">$</span>age)</code></pre></div>
<pre><code>[1] 28 23 59 34 71 35</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(d<span class="op">$</span>age <span class="op">&gt;</span><span class="st"> </span><span class="dv">40</span>)</code></pre></div>
<pre><code>[1] FALSE FALSE  TRUE FALSE  TRUE FALSE</code></pre>
<p>On voit bien ici qu’à chaque élément du vecteur <code>d$age</code> dont la valeur est supérieure à 40 correspond un élément <code>TRUE</code> dans le résultat de la condition.</p>
<p>On peut combiner ou modifier des conditions à l’aide des <dfn data-index="opérateur logique">opérateurs logiques</dfn><dfn data-index="logique, opérateur"></dfn> habituels :</p>
<table>
<thead><tr class="header">
<th align="left">Opérateur logique</th>
<th align="left">Signification</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>&amp;</code></td>
<td align="left">et logique</td>
</tr>
<tr class="even">
<td align="left"><code>|</code></td>
<td align="left">ou logique</td>
</tr>
<tr class="odd">
<td align="left"><code>!</code></td>
<td align="left">négation logique</td>
</tr>
</tbody>
</table>
<p>Comment les utilise-t-on ? Voyons tout de suite des exemples. Supposons que je veuille déterminer quels sont dans mon échantillon les hommes ouvriers spécialisés :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>sexe <span class="op">==</span><span class="st"> "Homme"</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>qualif <span class="op">==</span><span class="st"> "Ouvrier specialise"</span></code></pre></div>
<p>Si je souhaite identifier les personnes qui bricolent ou qui font la cuisine :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>bricol <span class="op">==</span><span class="st"> "Oui"</span> <span class="op">|</span><span class="st"> </span>d<span class="op">$</span>cuisine <span class="op">==</span><span class="st"> "Oui"</span></code></pre></div>
<p>Si je souhaite isoler les femmes qui ont entre 20 et 34 ans :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>sexe <span class="op">==</span><span class="st"> "Femme"</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>age <span class="op">&gt;=</span><span class="st"> </span><span class="dv">20</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>age <span class="op">&lt;=</span><span class="st"> </span><span class="dv">34</span></code></pre></div>
<p>Si je souhaite récupérer les enquêtés qui ne sont pas cadres, on peut utiliser l’une des deux formes suivantes :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>qualif <span class="op">!=</span><span class="st"> "Cadre"</span>
<span class="op">!</span>(d<span class="op">$</span>qualif <span class="op">==</span><span class="st"> "Cadre"</span>)</code></pre></div>
<p>Lorsqu’on mélange « et » et « ou » il est nécessaire d’utiliser des parenthèses pour différencier les blocs. La condition suivante identifie les femmes qui sont soit cadre, soit employée :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>sexe <span class="op">==</span><span class="st"> "Femme"</span> <span class="op">&amp;</span><span class="st"> </span>(d<span class="op">$</span>qualif <span class="op">==</span><span class="st"> "Employe"</span> <span class="op">|</span><span class="st"> </span>d<span class="op">$</span>qualif <span class="op">==</span><span class="st"> </span>
<span class="st">  "Cadre"</span>)</code></pre></div>
<p>L’opérateur <code data-pkg="base" data-rdoc="match">%in%</code> peut être très utile : il teste si une valeur fait partie des éléments d’un vecteur. Ainsi on pourrait remplacer la condition précédente par :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>sexe <span class="op">==</span><span class="st"> "Femme"</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>qualif <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"Employe"</span>, <span class="st">"Cadre"</span>)</code></pre></div>
<p>Enfin, signalons qu’on peut utiliser les fonctions <code data-pkg="base">table</code> ou <code data-pkg="base">summary</code> pour avoir une idée du résultat de notre condition :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(d<span class="op">$</span>sexe)</code></pre></div>
<pre><code>
Homme Femme 
  899  1101 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(d<span class="op">$</span>sexe <span class="op">==</span><span class="st"> "Homme"</span>)</code></pre></div>
<pre><code>
FALSE  TRUE 
 1101   899 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(d<span class="op">$</span>sexe <span class="op">==</span><span class="st"> "Homme"</span>)</code></pre></div>
<pre><code>   Mode   FALSE    TRUE 
logical    1101     899 </code></pre>

</article>
<article id="formules"><div class="fluid-row" id="formules_header">



<h1 class="title toc-ignore">Formules</h1>

</div>

<div class="TOC">
<ul>
<li>
<a href="#formules_statistiques-descriptives">Statistiques descriptives</a><ul>
<li><a href="#formules_tableaux-croises-avec-xtabs">Tableaux croisés avec xtabs</a></li>
<li><a href="#formules_statistiques-bivariees-avec-aggregate">Statistiques bivariées avec aggregate</a></li>
</ul>
</li>
<li>
<a href="#formules_panels-graphiques-avec-lattice">Panels graphiques avec lattice</a><ul>
<li><a href="#formules_visualisation-bivariee">Visualisation bivariée</a></li>
<li><a href="#formules_visualisation-par-petits-multiples">Visualisation par <q>petits multiples</q></a></li>
</ul>
</li>
<li><a href="#formules_pour-aller-plus-loin">Pour aller plus loin</a></li>
</ul>
</div>

<p>Ce chapitre vise à illustrer l’utilisation de la <dfn>notation <q>formule</q></dfn> de <strong>R</strong>, qui désigne l’emploi de cette notation par l’expression <code data-pkg="stats">formula</code>. Cette notation est utilisée par de très nombreuses fonctions de <strong>R</strong> : on en a notamment vu plusieurs exemples dans le <a href="graphiques-bivaries.html">chapitre sur les graphiques bivariés</a>, car l’extension <code class="pkg">ggplot2</code> se sert de cette notation dans ses paramètres <code data-pkg="ggplot2">facet_wrap</code> et <code data-pkg="ggplot2">facet_grid</code>.</p>
<p>Dans ce chapitre, on verra comment se servir de la notation <q>formule</q> dans deux contextes différents. D’une part, on verra que deux fonctions basiques de <strong>R</strong> se servent de cette notation pour produire des tableaux croisés et des statistiques bivariées. D’autre part, on verra que l’extension <code class="pkg">lattice</code> se sert de cette notation pour créer des graphiques <q>panelisés</q>, dits graphiques à <q>petits multiples</q>.</p>
<p>Dans plusieurs autres chapitres, les opérations décrites ci-dessus sont effectuées avec les extensions <code class="pkg">dplyr</code> d’une part, et <code class="pkg">ggplot2</code> d’autre part. On se servira également de ces extensions dans ce chapitre, de manière à mener une comparaison des différentes manières d’effectuer certaines opérations dans <strong>R</strong>, avec ou sans la notation <q>formule</q> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(ggplot2)</code></pre></div>
<div id="formules_statistiques-descriptives" class="section level2">
<h2>Statistiques descriptives</h2>
<p>Les premiers exemples de ce chapitre montrent l’utilisation de cette notation pour produire des tableaux croisés et des statistiques descriptives. Le jeu de données utilisé, <code data-pkg="questionr">hdv2003</code>, a déjà été utilisé dans plusieurs chapitres, et font partie de l’extension <code class="pkg">questionr</code>. Chargeons cette extension et le jeu de données <code data-pkg="questionr">hdv2003</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(questionr)
<span class="kw">data</span>(hdv2003)</code></pre></div>
<p>Pour rappel, ce jeu de données contient des individus, leur âge, leur statut professionnel, et le nombre d’heures quotidiennes passées à regarder la télévision.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(hdv2003, <span class="dv">75</span>)</code></pre></div>
<pre><code>Observations: 2,000
Variables: 20
$ id            &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 1...
$ age           &lt;int&gt; 28, 23, 59, 34, 71, 35, 60, 47, 20, 28, 65, 47, ...
$ sexe          &lt;fctr&gt; Femme, Femme, Homme, Homme, Femme, Femme, Femme...
$ nivetud       &lt;fctr&gt; Enseignement superieur y compris technique supe...
$ poids         &lt;dbl&gt; 2634.3982, 9738.3958, 3994.1025, 5731.6615, 4329...
$ occup         &lt;fctr&gt; Exerce une profession, Etudiant, eleve, Exerce ...
$ qualif        &lt;fctr&gt; Employe, NA, Technicien, Technicien, Employe, E...
$ freres.soeurs &lt;int&gt; 8, 2, 2, 1, 0, 5, 1, 5, 4, 2, 3, 4, 1, 5, 2, 3, ...
$ clso          &lt;fctr&gt; Oui, Oui, Non, Non, Oui, Non, Oui, Non, Oui, No...
$ relig         &lt;fctr&gt; Ni croyance ni appartenance, Ni croyance ni app...
$ trav.imp      &lt;fctr&gt; Peu important, NA, Aussi important que le reste...
$ trav.satisf   &lt;fctr&gt; Insatisfaction, NA, Equilibre, Satisfaction, NA...
$ hard.rock     &lt;fctr&gt; Non, Non, Non, Non, Non, Non, Non, Non, Non, No...
$ lecture.bd    &lt;fctr&gt; Non, Non, Non, Non, Non, Non, Non, Non, Non, No...
$ peche.chasse  &lt;fctr&gt; Non, Non, Non, Non, Non, Non, Oui, Oui, Non, No...
$ cuisine       &lt;fctr&gt; Oui, Non, Non, Oui, Non, Non, Oui, Oui, Non, No...
$ bricol        &lt;fctr&gt; Non, Non, Non, Oui, Non, Non, Non, Oui, Non, No...
$ cinema        &lt;fctr&gt; Non, Oui, Non, Oui, Non, Oui, Non, Non, Oui, Ou...
$ sport         &lt;fctr&gt; Non, Oui, Oui, Oui, Non, Oui, Non, Non, Non, Ou...
$ heures.tv     &lt;dbl&gt; 0.0, 1.0, 0.0, 2.0, 3.0, 2.0, 2.9, 1.0, 2.0, 2.0...</code></pre>
<div id="formules_tableaux-croises-avec-xtabs" class="section level3">
<h3>Tableaux croisés avec xtabs</h3>
<p>Utilisons, pour ce premier exemple, la variable <var>occup</var> du jeu de données <code data-pkg="questionr">hdv2003</code>, qui correspond au statut professionnel des individus inclus dans l’échantillon. La fonction de base pour compter les individus par statut est la fonction <code data-pkg="base">table</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(hdv2003<span class="op">$</span>occup)</code></pre></div>
<pre><code>
Exerce une profession               Chomeur 
                 1049                   134 
      Etudiant, eleve              Retraite 
                   94                   392 
  Retire des affaires              Au foyer 
                   77                   171 
        Autre inactif 
                   83 </code></pre>
<p>Avec la fonction <code data-pkg="stats">xtabs</code>, le même résultat est produit à partir de la notation suivante :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xtabs</span>(<span class="op">~</span>occup, <span class="dt">data =</span> hdv2003)</code></pre></div>
<pre><code>occup
Exerce une profession               Chomeur 
                 1049                   134 
      Etudiant, eleve              Retraite 
                   94                   392 
  Retire des affaires              Au foyer 
                   77                   171 
        Autre inactif 
                   83 </code></pre>
<p>Le premier argument est une formule, au sens où <strong>R</strong> entend cette expression. Le second argument, <code>data</code>, correspond au jeu de données auquel la formule doit être appliquée. On pourra se passer d’écrire explicitement cet argument dans les exemples suivants.</p>
<p>L’avantage de la fonction <code data-pkg="stats">xtabs</code> n’est pas évident dans ce premier exemple. En réalité, cette fonction devient utile lorsque l’on souhaite construire un ou plusieurs tableau(x) croisé(s). Par exemple, pour croiser la variable <var>occup</var> avec la variable <var>sexe</var>, une solution constiste à écrire :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(hdv2003, <span class="kw">table</span>(occup, sexe))</code></pre></div>
<pre><code>                       sexe
occup                   Homme Femme
  Exerce une profession   520   529
  Chomeur                  54    80
  Etudiant, eleve          48    46
  Retraite                208   184
  Retire des affaires      39    38
  Au foyer                  0   171
  Autre inactif            30    53</code></pre>
<p>Ou alors, ce qui revient au même :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(hdv2003<span class="op">$</span>occup, hdv2003<span class="op">$</span>sexe)</code></pre></div>
<p>Avec <code data-pkg="stats">xtabs</code>, la même opération s’écrit de la manière suivante :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xtabs</span>(<span class="op">~</span>occup <span class="op">+</span><span class="st"> </span>sexe, hdv2003)</code></pre></div>
<pre><code>                       sexe
occup                   Homme Femme
  Exerce une profession   520   529
  Chomeur                  54    80
  Etudiant, eleve          48    46
  Retraite                208   184
  Retire des affaires      39    38
  Au foyer                  0   171
  Autre inactif            30    53</code></pre>
<p>Cette écriture est plus courte que le code équivalent dans <code class="pkg">dplyr</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">group_by</span>(hdv2003, occup) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Homme =</span> <span class="kw">sum</span>(sexe <span class="op">==</span><span class="st"> "Homme"</span>),
            <span class="dt">Femme =</span> <span class="kw">sum</span>(sexe <span class="op">==</span><span class="st"> "Femme"</span>))</code></pre></div>
<pre><code># A tibble: 7 × 3
                  occup Homme Femme
                 &lt;fctr&gt; &lt;int&gt; &lt;int&gt;
1 Exerce une profession   520   529
2               Chomeur    54    80
3       Etudiant, eleve    48    46
4              Retraite   208   184
5   Retire des affaires    39    38
6              Au foyer     0   171
7         Autre inactif    30    53</code></pre>
<p>De plus, <code data-pkg="stats">xtabs</code> permet de créer plusieurs tableaux croisés en une seule formule :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xtabs</span>(<span class="op">~</span>occup <span class="op">+</span><span class="st"> </span>sexe <span class="op">+</span><span class="st"> </span>trav.imp, hdv2003)</code></pre></div>
<pre><code>, , trav.imp = Le plus important

                       sexe
occup                   Homme Femme
  Exerce une profession    13    16
  Chomeur                   0     0
  Etudiant, eleve           0     0
  Retraite                  0     0
  Retire des affaires       0     0
  Au foyer                  0     0
  Autre inactif             0     0

, , trav.imp = Aussi important que le reste

                       sexe
occup                   Homme Femme
  Exerce une profession   159   100
  Chomeur                   0     0
  Etudiant, eleve           0     0
  Retraite                  0     0
  Retire des affaires       0     0
  Au foyer                  0     0
  Autre inactif             0     0

, , trav.imp = Moins important que le reste

                       sexe
occup                   Homme Femme
  Exerce une profession   328   380
  Chomeur                   0     0
  Etudiant, eleve           0     0
  Retraite                  0     0
  Retire des affaires       0     0
  Au foyer                  0     0
  Autre inactif             0     0

, , trav.imp = Peu important

                       sexe
occup                   Homme Femme
  Exerce une profession    20    32
  Chomeur                   0     0
  Etudiant, eleve           0     0
  Retraite                  0     0
  Retire des affaires       0     0
  Au foyer                  0     0
  Autre inactif             0     0</code></pre>
<p>Cet exemple permet simplement de réaliser que la variable <var>trav.imp</var>, qui contient les réponses à une question portant sur l’importance du travail, n’a été mesurée (c’est-à-dire que la question n’a été posée) qu’aux seuls individus actifs de l’échantillon.</p>
</div>
<div id="formules_statistiques-bivariees-avec-aggregate" class="section level3">
<h3>Statistiques bivariées avec aggregate</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">aggregate</span>(heures.tv <span class="op">~</span><span class="st"> </span>sexe, mean, <span class="dt">data =</span> hdv2003)</code></pre></div>
<pre><code>   sexe heures.tv
1 Homme  2.219330
2 Femme  2.268727</code></pre>
<p>Ici, le premier argument est à nouveau une formule. Le second argument correspond à la statistique descriptive que l’on souhaite obtenir, et le dernier argument indique le jeu de données auquel appliquer les deux autres arguments. On peut d’ailleurs obtenir le même résultat en respectant de manière plus stricte l’ordre des arguments dans la syntaxe de la fonction <code data-pkg="stats">aggregate</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">aggregate</span>(heures.tv <span class="op">~</span><span class="st"> </span>sexe, hdv2003, mean)</code></pre></div>
<pre><code>   sexe heures.tv
1 Homme  2.219330
2 Femme  2.268727</code></pre>
<p>Cette écriture est, à nouveau, plus compacte que le code équivalent dans <code class="pkg">dplyr</code>, qui demande de spécifier le retrait des valeurs manquantes :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">group_by</span>(hdv2003, sexe) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">heures.tv =</span> <span class="kw">mean</span>(heures.tv, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</code></pre></div>
<p>À nouveau, on va pouvoir combiner plusieurs variables dans la formule que l’on passe à <code data-pkg="stats">aggregate</code>, ce qui va permettre d’obtenir la moyenne des heures de télévision quotidiennes par sexe et par statut professionnel :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">aggregate</span>(heures.tv <span class="op">~</span><span class="st"> </span>sexe <span class="op">+</span><span class="st"> </span>occup, hdv2003, mean)</code></pre></div>
<pre><code>    sexe                 occup heures.tv
1  Homme Exerce une profession  1.920463
2  Femme Exerce une profession  1.724953
3  Homme               Chomeur  2.853846
4  Femme               Chomeur  2.888608
5  Homme       Etudiant, eleve  1.400000
6  Femme       Etudiant, eleve  1.256522
7  Homme              Retraite  2.826442
8  Femme              Retraite  2.877174
9  Homme   Retire des affaires  2.410256
10 Femme   Retire des affaires  2.844737
11 Femme              Au foyer  2.822222
12 Homme         Autre inactif  3.133333
13 Femme         Autre inactif  3.339623</code></pre>
<p>La même opération demanderait toujours un peu plus de code avec <code class="pkg">dplyr</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">group_by</span>(hdv2003, occup, sexe) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">heures.tv =</span> <span class="kw">mean</span>(heures.tv, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</code></pre></div>
<p>La fonction <code data-pkg="stats">aggregate</code> permet bien sûr d’utiliser une autre fonction que la moyenne, comme dans cet exemple, suivi de son équivalent avec <code class="pkg">dplyr</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># âge médian par sexe et statut professionnel</span>
<span class="kw">aggregate</span>(age <span class="op">~</span><span class="st"> </span>sexe <span class="op">+</span><span class="st"> </span>occup, hdv2003, median)</code></pre></div>
<pre><code>    sexe                 occup  age
1  Homme Exerce une profession 42.0
2  Femme Exerce une profession 41.0
3  Homme               Chomeur 35.5
4  Femme               Chomeur 40.0
5  Homme       Etudiant, eleve 20.0
6  Femme       Etudiant, eleve 20.5
7  Homme              Retraite 68.0
8  Femme              Retraite 69.0
9  Homme   Retire des affaires 70.0
10 Femme   Retire des affaires 74.0
11 Femme              Au foyer 51.0
12 Homme         Autre inactif 56.0
13 Femme         Autre inactif 58.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># code équivalent avec l'extension 'dplyr'</span>
<span class="kw">group_by</span>(hdv2003, occup, sexe) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">age =</span> <span class="kw">median</span>(age, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</code></pre></div>
<p>La fonction <code data-pkg="stats">aggregate</code> permet, par ailleurs, d’obtenir des résultats à plusieurs colonnes. Dans l’exemple ci-dessus, on illustre ce principe avec la fonction <code data-pkg="stats">range</code>, qui renvoie deux résultats (la valeur minimale et la valeur maximale de la variable, qui est toujours la variable <var>age</var>), chacun présentés dans une colonne :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">aggregate</span>(age <span class="op">~</span><span class="st"> </span>sexe <span class="op">+</span><span class="st"> </span>occup, hdv2003, range)</code></pre></div>
<pre><code>    sexe                 occup age.1 age.2
1  Homme Exerce une profession    18    63
2  Femme Exerce une profession    18    67
3  Homme               Chomeur    18    63
4  Femme               Chomeur    18    63
5  Homme       Etudiant, eleve    18    34
6  Femme       Etudiant, eleve    18    35
7  Homme              Retraite    48    92
8  Femme              Retraite    41    96
9  Homme   Retire des affaires    57    91
10 Femme   Retire des affaires    57    93
11 Femme              Au foyer    22    90
12 Homme         Autre inactif    39    71
13 Femme         Autre inactif    19    97</code></pre>
<p>Cette fonction ne peut pas être facilement écrite dans <code class="pkg">dplyr</code> sans réécrire chacune des colonnes, ce que le bloc de code suivant illustre. On y gagne en lisibilité dans les intitulés de colonnes :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">group_by</span>(hdv2003, occup, sexe) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">min =</span> <span class="kw">min</span>(age, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">max =</span> <span class="kw">max</span>(age, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</code></pre></div>
</div>
</div>
<div id="formules_panels-graphiques-avec-lattice" class="section level2">
<h2>Panels graphiques avec lattice</h2>
<p>Les exemples suivants montreront ensuite comment la notation <q>formule</q> peut servir à produire des graphiques par panel avec l’extension <code class="pkg">lattice</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lattice)</code></pre></div>
<div class="note">
<p>L’extension <code class="pkg">lattice</code> présente l’avantage d’être installée par défaut avec <strong>R</strong>. Il n’est donc pas nécessaire de l’installer préalablement.</p>
</div>
<p>Chargeons les mêmes données que le <a href="graphiques-bivaries.html">chapitre sur les graphiques bivariés</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># charger l'extension lisant le format CSV</span>
<span class="kw">library</span>(readr)

<span class="co"># emplacement souhaité pour le jeu de données</span>
file =<span class="st"> "data/debt.csv"</span>

<span class="co"># télécharger le jeu de données s'il n'existe pas</span>
<span class="cf">if</span>(<span class="op">!</span><span class="kw">file.exists</span>(file))
  <span class="kw">download.file</span>(<span class="st">"http://www.stat.cmu.edu/~cshalizi/uADA/13/hw/11/debt.csv"</span>,
                file, <span class="dt">mode =</span> <span class="st">"wb"</span>)

<span class="co"># charger les données dans l'objet 'debt'</span>
debt =<span class="st"> </span><span class="kw">read_csv</span>(file)</code></pre></div>
<pre><code>Warning: Missing column names filled in: 'X1' [1]</code></pre>
<pre><code>Parsed with column specification:
cols(
  X1 = col_integer(),
  Country = col_character(),
  Year = col_integer(),
  growth = col_double(),
  ratio = col_double()
)</code></pre>
<p>Rejetons rapidement un coup d’oeil à ces données, qui sont structurées par pays (variable <var>Country</var>Year). On y trouve deux variables, <var>growth</var> (le taux de croissance du produit intérieur brut réel), et <var>ratio</var> (le ratio entre la dette publique et le produit intérieur brut), ainsi qu’une première colonne vide, ne contenant que des numéros lignes, dont on va se débarrasser :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># inspection des données</span>
<span class="kw">glimpse</span>(debt, <span class="dv">75</span>)</code></pre></div>
<pre><code>Observations: 1,171
Variables: 5
$ X1      &lt;int&gt; 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157,...
$ Country &lt;chr&gt; "Australia", "Australia", "Australia", "Australia", "A...
$ Year    &lt;int&gt; 1946, 1947, 1948, 1949, 1950, 1951, 1952, 1953, 1954, ...
$ growth  &lt;dbl&gt; -3.5579515, 2.4594746, 6.4375341, 6.6119938, 6.9202012...
$ ratio   &lt;dbl&gt; 190.41908, 177.32137, 148.92981, 125.82870, 109.80940,...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># suppression de la première colonne</span>
debt =<span class="st"> </span>debt[, <span class="op">-</span><span class="dv">1</span>]</code></pre></div>
<div id="formules_visualisation-bivariee" class="section level3">
<h3>Visualisation bivariée</h3>
<p>Le même graphique s’écrit de la manière suivante avec l’extension <code class="pkg">lattice</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xyplot</span>(growth <span class="op">~</span><span class="st"> </span>Year, <span class="dt">data =</span> debt)</code></pre></div>
<p><img src="graphs/formules/unnamed-chunk-23-1.png" width="1050"></p>
</div>
<div id="formules_visualisation-par-petits-multiples" class="section level3">
<h3>Visualisation par <q>petits multiples</q>
</h3>
<p>Appliquons désormais la même visualisation par <q>petits multiples</q> que vue dans le chapitre :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xyplot</span>(growth <span class="op">~</span><span class="st"> </span>Year <span class="op">|</span><span class="st"> </span>Country, <span class="dt">data =</span> debt)</code></pre></div>
<p><img src="graphs/formules/unnamed-chunk-24-1.png" width="1050"></p>
<p>Enfin, rajoutons quelques options au graphique, afin de montrer comment l’extension <code class="pkg">lattice</code> fonctionne :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xyplot</span>(growth <span class="op">~</span><span class="st"> </span>Year <span class="op">|</span><span class="st"> </span>Country, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">"o"</span>, <span class="st">"l"</span>), 
  <span class="dt">main =</span> <span class="st">"Données Reinhart et Rogoff corrigées, 1946-2009"</span>, 
  <span class="dt">ylab =</span> <span class="st">"Taux de croissance du PIB"</span>, <span class="dt">xlab =</span> <span class="ot">NULL</span>, 
  <span class="dt">data =</span> debt)</code></pre></div>
<p><img src="graphs/formules/unnamed-chunk-25-1.png" width="1050"></p>
</div>
</div>
<div id="formules_pour-aller-plus-loin" class="section level2">
<h2>Pour aller plus loin</h2>
<p>Comme vient de le voir dans ce chapitre, la notation <q>formule</q> apparaît çà et là dans les différentes fonctions de <strong>R</strong> est de ses extensions. Il est par conséquent utile d’en connaître les rudiments, et en particulier les opérateurs <code>~</code> (<em>tilde</em>) et <code>+</code>, ne serait-ce que pour pouvoir se servir des différentes fonctions présentées sur cette page.</p>
<p>La notation <q>formule</q> devient cruciale dès que l’on souhaite rédiger des modèles : la formule <code>y ~ x</code>, par exemple, qui est équivalente à la formule <code>y ~ 1 + x</code>, correspond à l’équation mathématique <span class="math inline"><em>Y</em> = <em>a</em> + <em>b</em><em>X</em></span>. On trouvera de nombreux exemples d’usage de cette notation dans les chapitres consacrés, notamment, à la régression linéaire ou à la <a href="#regression-logistique">régression logistique</a>.</p>
<p>De la même manière, l’opérateur <code>|</code> (<em>pipe</em>) utilisé par l’extension <code class="pkg">lattice</code> joue aussi un rôle très important dans la rédaction de modèles multi-niveaux, où il sert à indiquer les variables à pentes ou à coefficients aléatoires. Ces modèles sont présentés dans un <a href="#modeles-lineaires-a-effets-mixtes">chapitre dédié</a>.</p>
</div>

</article>
<article id="structures-conditionnelles"><div class="fluid-row" id="structures-conditionnelles_header">



<h1 class="title toc-ignore">Structures conditionnelles</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="expressions-regulieres"><div class="fluid-row" id="expressions-regulieres_header">



<h1 class="title toc-ignore">Expressions régulières</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="ecrire-ses-propres-fonctions"><div class="fluid-row" id="ecrire-ses-propres-fonctions_header">



<h1 class="title toc-ignore">Écrire ses propres fonctions</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="rmarkdown-les-rapports-automatises"><div class="fluid-row" id="rmarkdown-les-rapports-automatises_header">



<h1 class="title toc-ignore">R Markdown : les rapports automatisés</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="shiny-les-interfaces-interactives"><div class="fluid-row" id="shiny-les-interfaces-interactives_header">



<h1 class="title toc-ignore">Shiny : les interfaces interactives</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="git"><div class="fluid-row" id="git_header">



<h1 class="title toc-ignore">Git</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="developper-un-package"><div class="fluid-row" id="developper-un-package_header">



<h1 class="title toc-ignore">Développer un package</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="calculer-un-age"><div class="fluid-row" id="calculer-un-age_header">



<h1 class="title toc-ignore">Calculer un âge</h1>

</div>

<div class="TOC">
<ul>
<li><a href="#calculer-un-age_rappel-sur-les-ages">Rappel sur les âges</a></li>
<li><a href="#calculer-un-age_le-package-lubridate">Le package lubridate</a></li>
<li>
<a href="#calculer-un-age_calcul-dun-age-exact">Calcul d’un âge exact</a><ul>
<li><a href="#calculer-un-age_cas-particulier-des-personnes-nees-un-29-fevrier">Cas particulier des personnes nées un 29 février</a></li>
</ul>
</li>
<li><a href="#calculer-un-age_age-revolu-ou-age-au-dernier-anniversaire">Âge révolu ou âge au dernier anniversaire</a></li>
<li><a href="#calculer-un-age_age-par-difference-de-millesimes">Âge par différence de millésimes</a></li>
<li><a href="#calculer-un-age_calcul-dun-age-moyen">Calcul d’un âge moyen</a></li>
<li><a href="#calculer-un-age_notes">Notes</a></li>
</ul>
</div>

<div class="note">
<p>La version originale de cette astuce a été publiée par Joseph Larmarange sur <a href="http://joseph.larmarange.net/?Calculer-proprement-un-age-sous-R" class="uri">http://joseph.larmarange.net/?Calculer-proprement-un-age-sous-R</a>.</p>
</div>
<p>Le calcul d’un <dfn>âge</dfn> sous <strong>R</strong> n’est pas forcément aussi trivial qu’il n’y parait.</p>
<div id="calculer-un-age_rappel-sur-les-ages" class="section level2">
<h2>Rappel sur les âges</h2>
<p>Il convient en premier lieu de rappeler les principaux âges utilisés les démographes :</p>
<blockquote>
<p>L’âge – on précise parfois âge chronologique – est une des caractéristiques fondamentales de la structure des populations. On l’exprime généralement en années, ou en années et mois, voire en mois et jours, pour les enfants en bas âge ; parfois en années et fractions décimales d’année. Les démographes arrondissent d’ordinaire l’âge à l’unité inférieure, l’exprimant ainsi en années révolues, ou années accomplies, le cas échéant en mois révolus, ou mois accomplis. Cet âge est aussi l’âge au dernier anniversaire. On trouve aussi, dans les statistiques, l’âge atteint dans l’année, qui est égal à la différence de millésimes entre l’année considérée et l’année de naissance. […] On est parfois conduit à préciser que l’on considère un âge exact, pour éviter toute confusion avec un âge en années révolues, qui représente en fait une classe d’âges exacts.</p>
<footer>
Source : <a href="http://fr-ii.demopaedia.org/wiki/32#322"><cite>Demopædia</cite> (322)</a>
</footer>
</blockquote>
</div>
<div id="calculer-un-age_le-package-lubridate" class="section level2">
<h2>Le package lubridate</h2>
<p>Le package <code class="pkg">lubridate</code> est spécialement développé pour faciliter la manipulation et le calcul autour des <dfn data-index="date, variable">dates</dfn>. La version de développement intègre depuis peu une fonction <code data-pkg="lubridate">time_length</code> adaptée au calcul des âges exacts.</p>
<div class="note">
<p>La fonction <code data-pkg="lubridate">time_length</code> étant récente, elle n’est pas encore disponible dans la version stable du package. Pour installer la version de développement de <code class="pkg">lubridate</code>, on aura recours au package <code class="pkg">devtools</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools)
<span class="kw">install_github</span>(<span class="st">"tidyverse/lubridate"</span>)</code></pre></div>
</div>
<p>Nous noterons <code>naiss</code> la date de naissance et <code>evt</code> la date à laquelle nous calculerons l’âge.</p>
</div>
<div id="calculer-un-age_calcul-dun-age-exact" class="section level2">
<h2>Calcul d’un âge exact</h2>
<p>On appelle <dfn>âge exact</dfn><dfn data-index="exact, âge"></dfn> l’expression d’un âge avec sa partie décimale.</p>
<p>Une approche simple consiste à calculer une différence en jours puis à diviser par 365. Or, le souci c’est que toutes les années n’ont pas le même nombre de jours. Regardons par exemple ce qui se passe si l’on calcule l’âge au 31 décembre 1999 d’une personne née le 1<sup>er</sup> janvier 1900.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lubridate)</code></pre></div>
<pre><code>
Attaching package: 'lubridate'</code></pre>
<pre><code>The following object is masked from 'package:base':

    date</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">naiss &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">"1900-01-01"</span>)
evt &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">"1999-12-31"</span>)
<span class="kw">time_length</span>(<span class="kw">interval</span>(naiss, evt), <span class="st">"days"</span>)</code></pre></div>
<pre><code>[1] 36523</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">time_length</span>(<span class="kw">interval</span>(naiss, evt), <span class="st">"days"</span>)<span class="op">/</span><span class="dv">365</span></code></pre></div>
<pre><code>[1] 100.063</code></pre>
<p>Or, au 31 décembre 1999, cette personne n’a pas encore fêté son centième anniversaire. Le calcul précédent ne prend pas en compte les années bissextiles. Une approche plus correcte serait de considérer que les années durent en moyenne 365,25 jours.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">time_length</span>(<span class="kw">interval</span>(naiss, evt), <span class="st">"days"</span>)<span class="op">/</span><span class="fl">365.25</span></code></pre></div>
<pre><code>[1] 99.99452</code></pre>
<p>Si cette approche semble fonctionner avec cet exemple, ce n’est plus le cas dans d’autres situations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">evt &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">"1903-01-01"</span>)
<span class="kw">time_length</span>(<span class="kw">interval</span>(naiss, evt), <span class="st">"days"</span>)<span class="op">/</span><span class="fl">365.25</span></code></pre></div>
<pre><code>[1] 2.997947</code></pre>
<p>Or, à la date du premier janvier 1903, cette personne a bien fêté son troisième anniversaire.</p>
<p>Pour calculer proprement un âge en années (ou en mois), il est dès lors nécessaire de prendre en compte la date <dfn>anniversaire</dfn> et le fait que la durée de chaque année (ou mois) est variable. C’est justement ce que fait la fonction <code data-pkg="lubridate">time_length</code> appliquée à un objet de type <code data-pkg="lubridate" data-rdoc="Interval-class">Interval</code>. On détermine le dernier et le prochain anniversaire et l’on rajoute, à l’âge atteint au dernier anniversaire, le ratio entre le nombre de jours entre l’événement et le dernier anniversaire par le nombre de jours entre le prochain et le dernier anniversaire.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">naiss &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">"1900-01-01"</span>)
evt &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">"1999-12-31"</span>)
<span class="kw">time_length</span>(<span class="kw">interval</span>(naiss, evt), <span class="st">"years"</span>)</code></pre></div>
<pre><code>[1] 99.99726</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">evt &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">"1903-01-01"</span>)
<span class="kw">time_length</span>(<span class="kw">interval</span>(naiss, evt), <span class="st">"years"</span>)</code></pre></div>
<pre><code>[1] 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">evt &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">"1918-11-11"</span>)
<span class="kw">time_length</span>(<span class="kw">interval</span>(naiss, evt), <span class="st">"years"</span>)</code></pre></div>
<pre><code>[1] 18.86027</code></pre>
<p>Attention, cela n’est valable que si l’on présente à la fonction <code data-pkg="lubridate">time_length</code> un objet de type <code data-pkg="lubridate" data-rdoc="Interval-class">Interval</code> (pour lequel on connait dès lors la date de début et la date de fin). Si l’on passe une durée (objet de type <code data-pkg="lubridate" data-rdoc="Duration-class">Duration</code>) à la fonction <code data-pkg="lubridate">time_length</code>, le calcul s’effectuera alors en prenant en compte la durée moyenne d’une année (plus précisément 365 jours).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">naiss &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">"1900-01-01"</span>)
evt &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">"1999-12-31"</span>)
<span class="kw">time_length</span>(<span class="kw">interval</span>(naiss, evt), <span class="st">"years"</span>)</code></pre></div>
<pre><code>[1] 99.99726</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">time_length</span>(evt <span class="op">-</span><span class="st"> </span>naiss, <span class="st">"years"</span>)</code></pre></div>
<pre><code>[1] 100.063</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">time_length</span>(<span class="kw">as.duration</span>(<span class="kw">interval</span>(naiss, evt)), <span class="st">"years"</span>)</code></pre></div>
<pre><code>[1] 100.063</code></pre>
<div id="calculer-un-age_cas-particulier-des-personnes-nees-un-29-fevrier" class="section level3">
<h3>Cas particulier des personnes nées un 29 février</h3>
<p>Pour les personnes nées un 29 février, il existe un certain flou concernant leur date d’anniversaire pour les années non bissextiles. Doit-on considérer qu’il s’agit du 28 février ou du 1<sup>er</sup> mars ?</p>
<p>Au sens strict, on peut considérer que leur anniversaire a lieu entre le 28 février soir à minuit et le 1<sup>er</sup> mars à 0 heure du matin, autrement dit que le 28 février ils n’ont pas encore fêté leur anniversaire. C’est la position adoptée par la fonction <code data-pkg="lubridate">time_length</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">naiss &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">"1992-02-29"</span>)
evt &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">"2014-02-28"</span>)
<span class="kw">time_length</span>(<span class="kw">interval</span>(naiss, evt), <span class="st">"years"</span>)</code></pre></div>
<pre><code>[1] 21.99726</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">evt &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">"2014-03-01"</span>)
<span class="kw">time_length</span>(<span class="kw">interval</span>(naiss, evt), <span class="st">"years"</span>)</code></pre></div>
<pre><code>[1] 22</code></pre>
<p>Cette approche permets également d’être cohérent avec la manière dont les dates sont prises en compte informatiquement. On considère en effet que lorsque seule la date est précisée (sans mention de l’heure), l’heure correspondante est <code>0:00</code>. Autrement dit, <code>"2014-03-01"</code> est équivalent à <code>"2014-03-01 00:00:00"</code>. L’approche adoptée permet donc d’être cohérent lorsque l’anniversaire est calculé en tenant compte des heures.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">naiss &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">"1992-02-29"</span>)
evt &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">"2014-02-28 23:00:00"</span>)
<span class="kw">time_length</span>(<span class="kw">interval</span>(naiss, evt), <span class="st">"years"</span>)</code></pre></div>
<pre><code>[1] 21.99989</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">evt &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">"2014-03-01 00:00:00"</span>)
<span class="kw">time_length</span>(<span class="kw">interval</span>(naiss, evt), <span class="st">"years"</span>)</code></pre></div>
<pre><code>[1] 22</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">evt &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">"2014-03-01 01:00:00"</span>)
<span class="kw">time_length</span>(<span class="kw">interval</span>(naiss, evt), <span class="st">"years"</span>)</code></pre></div>
<pre><code>[1] 22.00011</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">naiss &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">"1992-02-29 12:00:00"</span>)
evt &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">"2014-03-01 01:00:00"</span>)
<span class="kw">time_length</span>(<span class="kw">interval</span>(naiss, evt), <span class="st">"years"</span>)</code></pre></div>
<pre><code>[1] 22.00011</code></pre>
</div>
</div>
<div id="calculer-un-age_age-revolu-ou-age-au-dernier-anniversaire" class="section level2">
<h2>Âge révolu ou âge au dernier anniversaire</h2>
<p>Une fois que l’on sait calculer un âge exact, le calcul d’un <dfn>âge révolu</dfn><dfn data-index="révolu, âge"></dfn> ou <dfn>âge au dernier anniversaire</dfn> est assez simple. Il suffit de ne garder que la partie entière de l’âge exact (approche conseillée).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">naiss &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">"1980-01-09"</span>)
evt &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">"2015-01-01"</span>)
<span class="kw">time_length</span>(<span class="kw">interval</span>(naiss, evt), <span class="st">"years"</span>)</code></pre></div>
<pre><code>[1] 34.97808</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">trunc</span>(<span class="kw">time_length</span>(<span class="kw">interval</span>(naiss, evt), <span class="st">"years"</span>))</code></pre></div>
<pre><code>[1] 34</code></pre>
<p>Une autre approche consiste à convertir l’intervalle en objet de type <code data-pkg="lubridate" data-rdoc="Period-class">Period</code> et à ne prendre en compte que les années.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.period</span>(<span class="kw">interval</span>(naiss, evt))</code></pre></div>
<pre><code>[1] "34y 11m 23d 0H 0M 0S"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.period</span>(<span class="kw">interval</span>(naiss, evt))<span class="op">@</span>year</code></pre></div>
<pre><code>[1] 34</code></pre>
</div>
<div id="calculer-un-age_age-par-difference-de-millesimes" class="section level2">
<h2>Âge par différence de millésimes</h2>
<p>L’<dfn>âge par différence de millésimes</dfn>, encore appelé <dfn>âge atteint dans l’année</dfn>, s’obtient tout simplement en soustrayant l’année de naissance à l’année de l’événement.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">naiss &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">"1980-01-09"</span>)
evt &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">"2015-01-01"</span>)
<span class="kw">year</span>(evt) <span class="op">-</span><span class="st"> </span><span class="kw">year</span>(naiss)</code></pre></div>
<pre><code>[1] 35</code></pre>
</div>
<div id="calculer-un-age_calcul-dun-age-moyen" class="section level2">
<h2>Calcul d’un âge moyen</h2>
<p>Le calcul d’un <dfn>âge moyen</dfn><dfn data-index="moyenne, âge"></dfn> s’effectue normalement à partir d’âges exacts. Il arrive fréquemment que l’on ne dispose dans les données d’enquêtes que de l’âge révolu. Auquel cas, il faut bien penser à rajouter 0,5 au résultat obtenu. En effet, un âge révolu peut être vu comme une classe d’âges exacts : les individus ayant 20 ans révolus ont entre 20 et 21 ans exacts, soit en moyenne 20,5 ans !</p>
</div>
<div id="calculer-un-age_notes" class="section level2">
<h2>Notes</h2>
<p>L’ensemble des fonctions présentées peuvent être appliquées à des vecteurs et, par conséquent, aux colonnes d’un tableau de données (<em>data.frame</em>).</p>
<p>Le package <code class="pkg">eeptools</code> fournit de son côté une fonction <code data-pkg="eeptools">age_calc</code><a href="#calculer-un-age_fn1" class="footnoteRef" id="calculer-un-age_fnref1"><sup>1</sup></a> qui permet le calcul des âges exacts et révolus.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(eeptools)</code></pre></div>
<pre><code>Loading required package: ggplot2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">naiss &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">"1980-01-09"</span>)
evt &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">"2015-01-01"</span>)
<span class="kw">age_calc</span>(naiss, evt, <span class="dt">units =</span> <span class="st">"years"</span>, <span class="dt">precise =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>[1] 34.97814</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">time_length</span>(<span class="kw">interval</span>(naiss, evt), <span class="st">"years"</span>)</code></pre></div>
<pre><code>[1] 34.97808</code></pre>
<p>La méthode utilisée par <code data-pkg="eeptools">age_calc</code> donne des résultats légèrement différent de ceux de <code data-pkg="lubridate">time_length</code>. Il est donc conseillé d’utiliser de préférence le package <code class="pkg">lubridate</code>.</p>
<p>En l’absence du package <code class="pkg">lubridate</code>, il reste facile de calculer une durée en jours avec les fonctions de base de <strong>R</strong> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">naiss &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">"1900-01-01"</span>)
evt &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">"1999-12-31"</span>)
evt <span class="op">-</span><span class="st"> </span>naiss</code></pre></div>
<pre><code>Time difference of 36523 days</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.integer</span>(evt <span class="op">-</span><span class="st"> </span>naiss)</code></pre></div>
<pre><code>[1] 36523</code></pre>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="calculer-un-age_fn1"><p><a href="https://github.com/jknowles/eeptools/blob/master/R/age_calc.R" class="uri">https://github.com/jknowles/eeptools/blob/master/R/age_calc.R</a><a href="#calculer-un-age_fnref1"><U+21A9></a></p></li>
</ol>
</div>

</article>
<article id="diagramme-de-lexis"><div class="fluid-row" id="diagramme-de-lexis_header">



<h1 class="title toc-ignore">Diagramme de Lexis</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>
<p>Pour réaliser des <dfn data-index="diagramme de Lexis">diagrammes de Lexis</dfn><dfn data-index="Lexis, diagramme"></dfn>, voir l’extension <code class="pkg">LexisPlotR</code> et sa vignette (en anglais) : <a href="https://cran.r-project.org/web/packages/LexisPlotR/vignettes/LexisPlotR.html" class="uri">https://cran.r-project.org/web/packages/LexisPlotR/vignettes/LexisPlotR.html</a>.</p>

</article>
<article id="prevR-cartes-de-prevalence"><div class="fluid-row" id="prevR-cartes-de-prevalence_header">



<h1 class="title toc-ignore">prevR : cartes de prévalence à partir des EDS</h1>

</div>


<div class="important">
<p>Ce chapitre est en cours d’écriture.</p>
</div>

</article>
<article id="index-des-concepts"><div class="fluid-row" id="index-des-concepts_header">



<h1 class="title toc-ignore">Index des concepts</h1>

</div>


<nav class="index"><ul class="pagination pagination-sm">
<li>
<a href="#index-des-concepts_A">A</a>
</li>
<li>
<a href="#index-des-concepts_B">B</a>
</li>
<li>
<a href="#index-des-concepts_C">C</a>
</li>
<li>
<a href="#index-des-concepts_D">D</a>
</li>
<li>
<a href="#index-des-concepts_E">E</a>
</li>
<li>
<a href="#index-des-concepts_F">F</a>
</li>
<li>
<a href="#index-des-concepts_G">G</a>
</li>
<li>
<a href="#index-des-concepts_H">H</a>
</li>
<li>
<a href="#index-des-concepts_I">I</a>
</li>
<li>
<a href="#index-des-concepts_K">K</a>
</li>
<li>
<a href="#index-des-concepts_L">L</a>
</li>
<li>
<a href="#index-des-concepts_M">M</a>
</li>
<li>
<a href="#index-des-concepts_N">N</a>
</li>
<li>
<a href="#index-des-concepts_O">O</a>
</li>
<li>
<a href="#index-des-concepts_P">P</a>
</li>
<li>
<a href="#index-des-concepts_Q">Q</a>
</li>
<li>
<a href="#index-des-concepts_R">R</a>
</li>
<li>
<a href="#index-des-concepts_S">S</a>
</li>
<li>
<a href="#index-des-concepts_T">T</a>
</li>
<li>
<a href="#index-des-concepts_U">U</a>
</li>
<li>
<a href="#index-des-concepts_V">V</a>
</li>
<li>
<a href="#index-des-concepts_W">W</a>
</li>
</ul>
<p></p></nav><div id="index-des-concepts_index_concepts" class="liste_index">
<h2 id="index-des-concepts_A">
A
</h2>
<p><dfn>ACM</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><dfn>ACP</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><dfn>AFC</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><dfn>âge</dfn></p>
<ul>
<li><a href="#calculer-un-age">Calculer un âge</a></li>
</ul>
<p><dfn>âge atteint dans l’année</dfn></p>
<ul>
<li><a href="#calculer-un-age">Calculer un âge</a></li>
</ul>
<p><dfn>âge au dernier anniversaire</dfn></p>
<ul>
<li><a href="#calculer-un-age">Calculer un âge</a></li>
</ul>
<p><dfn>âge exact</dfn></p>
<ul>
<li><a href="#calculer-un-age">Calculer un âge</a></li>
</ul>
<p><dfn>AIC</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>aide</dfn></p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
</ul>
<p><dfn>aide en ligne</dfn></p>
<ul>
<li><a href="#ou-trouver-de-l-aide">Où trouver de l’aide ?</a></li>
</ul>
<p><dfn lang="en">Akaike Information Criterion</dfn></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>aléatoire, échantillonnage</dfn></p>
<ul>
<li><a href="#definir-un-plan-d-echantillonnage-complexe">Définir un plan d’échantillonnage complexe</a></li>
</ul>
<p><dfn>analyse de séquences</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><dfn>analyse de survie</dfn></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<p><dfn>analyse des biographies</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><dfn>analyse des correspondances multiples</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><dfn>analyse en composante principale</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><dfn>analyse factorielle</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><dfn>analyse factorielle des correspondances</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><dfn>analyse mixte de Hill et Smith</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><dfn>appariement optimal</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><dfn>arbre de classification</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>argument</dfn></p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
</ul>
<p><dfn>argument nommé</dfn></p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
</ul>
<p><dfn>argument non nommé</dfn></p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
</ul>
<p><dfn>assignation par indexation</dfn></p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
</ul>
<p><dfn>assignation, opérateur</dfn></p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
</ul>
<p><dfn>attribut</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>autocomplétion</dfn></p>
<ul>
<li><a href="#organiser-ses-fichiers">Organiser ses fichiers</a></li>
<li><a href="#premier-contact">Premier contact</a></li>
<li><a href="#presentation-et-philosophie">Présentation et Philosophie</a></li>
</ul>
<h2 id="index-des-concepts_B">
B
</h2>
<p><dfn>barres cumulées, graphique</dfn></p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><dfn>barres, diagramme en</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><dfn>bâton, diagramme</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>bâtons, diagramme en</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><dfn>binaire, régression logistique</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>biographie, analyse</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><dfn>bitmap</dfn></p>
<ul>
<li><a href="#export-de-graphiques">Export de graphiques</a></li>
</ul>
<p><dfn>boîte à moustache</dfn></p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><dfn>boîte à moustaches</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>booléenne, valeur</dfn></p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>booléenne, variable</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn lang="en">boxplot</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<h2 id="index-des-concepts_C">
C
</h2>
<p><dfn>CAH</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>camembert, graphique</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>caractères, chaîne</dfn></p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>catégorielle, variable</dfn></p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<p><dfn>censure à droite</dfn></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<p><dfn>cercle de corrélation</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><dfn>chaîne de caractères</dfn></p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn lang="en">character</dfn></p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>chemin relatif</dfn></p>
<ul>
<li><a href="#organiser-ses-fichiers">Organiser ses fichiers</a></li>
</ul>
<p><dfn>Chi², distance</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>Chi², résidus</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>Chi², test</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><dfn>classe de valeurs</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>classe, homogénéité</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><dfn>classification ascendante hiérarchique</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>classification, arbre</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>Cleveland, diagramme</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn lang="en">cluster</dfn></p>
<ul>
<li><a href="#definir-un-plan-d-echantillonnage-complexe">Définir un plan d’échantillonnage complexe</a></li>
</ul>
<p><dfn>coefficient de contingence de Cramer</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>coefficient de corrélation</dfn></p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><dfn>coefficient, modèle</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>coloration syntaxique</dfn></p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
<li><a href="#presentation-et-philosophie">Présentation et Philosophie</a></li>
</ul>
<p><dfn>commentaire</dfn></p>
<ul>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><dfn>comparaison de courbes de survie (test du logrank)</dfn></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<p><dfn>comparaison de médianes, test</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>comparaison de moyennes</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><dfn>comparaison de proportions, test</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>comparaison, opérateur</dfn></p>
<ul>
<li><a href="#conditions-et-comparaisons">Conditions et comparaisons</a></li>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn lang="en">Comprehensive R Archive Network</dfn></p>
<ul>
<li><a href="#extensions">Extensions</a></li>
</ul>
<p><dfn>condition, indexation</dfn></p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>confusion, matrice</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>console</dfn></p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
</ul>
<p><dfn>corrélation, cercle</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><dfn>corrélation, coefficient</dfn></p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><dfn>corrélation, matrice de</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><dfn>correspondances, analyse factorielle</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><dfn>couleur, palette</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><dfn>courbe de densité</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><dfn>Cox, modèle</dfn></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<p><dfn>Cramer, coefficient de contingence</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>CRAN</dfn></p>
<ul>
<li><a href="#extensions">Extensions</a></li>
</ul>
<p><dfn>croisé, tableau</dfn></p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><dfn>CSV, fichier</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<h2 id="index-des-concepts_D">
D
</h2>
<p><dfn lang="en">data frame</dfn></p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><dfn lang="en">data.frame</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>date, variable</dfn></p>
<ul>
<li><a href="#calculer-un-age">Calculer un âge</a></li>
</ul>
<p><dfn>dendrogramme</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>densité, courbe de</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><dfn>densité, estimation locale</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><dfn>descriptive, statistique</dfn></p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn lang="en">design</dfn></p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><dfn>diagramme de Cleveland</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>diagramme de Lexis</dfn></p>
<ul>
<li><a href="#diagramme-de-lexis">Diagramme de Lexis</a></li>
</ul>
<p><dfn>diagramme en barres</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><dfn>diagramme en bâtons</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>diagramme en secteur</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>distance</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>distance de Gower</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>distance du Chi²</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>distance du Phi²</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>distance, matrice</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><dfn>distribution</dfn></p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>donnée labelissée</dfn></p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<p><dfn>données pondérées</dfn></p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><dfn>données, exporter</dfn></p>
<ul>
<li><a href="#export-de-donnees">Export de données</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>données, tableau</dfn></p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
</ul>
<p><dfn>droite de régression</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><dfn>droite, censure</dfn></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<h2 id="index-des-concepts_E">
E
</h2>
<p><dfn>écart-type</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>écart interquartile</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>échantillonnage aléatoire simple</dfn></p>
<ul>
<li><a href="#definir-un-plan-d-echantillonnage-complexe">Définir un plan d’échantillonnage complexe</a></li>
</ul>
<p><dfn>échantillonnage équiprobable</dfn></p>
<ul>
<li><a href="#definir-un-plan-d-echantillonnage-complexe">Définir un plan d’échantillonnage complexe</a></li>
</ul>
<p><dfn>échantillonnage par grappes</dfn></p>
<ul>
<li><a href="#definir-un-plan-d-echantillonnage-complexe">Définir un plan d’échantillonnage complexe</a></li>
</ul>
<p><dfn>échantillonnage stratifié</dfn></p>
<ul>
<li><a href="#definir-un-plan-d-echantillonnage-complexe">Définir un plan d’échantillonnage complexe</a></li>
</ul>
<p><dfn>échantillonnage, plan</dfn></p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><dfn>éditeur de script</dfn></p>
<ul>
<li><a href="#presentation-et-philosophie">Présentation et Philosophie</a></li>
</ul>
<p><dfn lang="en">empirical cumulative distribution function</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>entier</dfn></p>
<ul>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><dfn>entier, nombre</dfn></p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>entropie transversale</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><dfn>environnement de développement</dfn></p>
<ul>
<li><a href="#presentation-et-philosophie">Présentation et Philosophie</a></li>
</ul>
<p><dfn>environnement de travail</dfn></p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
</ul>
<p><dfn>équiprobable, échantillonnage</dfn></p>
<ul>
<li><a href="#definir-un-plan-d-echantillonnage-complexe">Définir un plan d’échantillonnage complexe</a></li>
</ul>
<p><dfn>estimation locale de densité</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><dfn>estimation par noyau</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>étendue</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>étiquette de valeur</dfn></p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>étiquette de variable</dfn></p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>étiquettes de valeurs</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn lang="en">event history analysis</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><dfn>exact, âge</dfn></p>
<ul>
<li><a href="#calculer-un-age">Calculer un âge</a></li>
</ul>
<p><dfn>explicative, variable</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>export de graphiques</dfn></p>
<ul>
<li><a href="#export-de-graphiques">Export de graphiques</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>exporter des données</dfn></p>
<ul>
<li><a href="#export-de-donnees">Export de données</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>extension</dfn></p>
<ul>
<li><a href="#extensions">Extensions</a></li>
</ul>
<h2 id="index-des-concepts_F">
F
</h2>
<p><dfn>facteur</dfn></p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn lang="en">factor</dfn></p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><dfn>factoriel, plan</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><dfn>factorielle, analyse</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><dfn>fichier CSV</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>fichier de commandes</dfn></p>
<ul>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><dfn>fichier texte</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>fichiers <strong>Shapefile</strong></dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>Fisher, test exact</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>fonction</dfn></p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
</ul>
<p><dfn>fonction de répartition empirique</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>formule</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><dfn>fréquence, tableau</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>fusion de tables</dfn></p>
<ul>
<li><a href="#fusion-de-tables">Fusion de tables</a></li>
</ul>
<h2 id="index-des-concepts_G">
G
</h2>
<p><dfn>gestionnaire de versions</dfn></p>
<ul>
<li><a href="#organiser-ses-fichiers">Organiser ses fichiers</a></li>
</ul>
<p><dfn>Gower, distance</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>Gower, indice de similarité</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>graphique en mosaïque</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><dfn>graphique en violon</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><dfn>graphique, export</dfn></p>
<ul>
<li><a href="#export-de-graphiques">Export de graphiques</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>grappe, échantillonnage</dfn></p>
<ul>
<li><a href="#definir-un-plan-d-echantillonnage-complexe">Définir un plan d’échantillonnage complexe</a></li>
</ul>
<h2 id="index-des-concepts_H">
H
</h2>
<p><dfn lang="en">hazard ratio (HR)</dfn></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<p><dfn>Hill et Smith, analyse mixte</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><dfn>histogramme</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>historique des commandes</dfn></p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
</ul>
<p><dfn>homogénéité des classes</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<h2 id="index-des-concepts_I">
I
</h2>
<p><dfn>image bitmap</dfn></p>
<ul>
<li><a href="#export-de-graphiques">Export de graphiques</a></li>
</ul>
<p><dfn>image matricielle</dfn></p>
<ul>
<li><a href="#export-de-graphiques">Export de graphiques</a></li>
</ul>
<p><dfn>image vectorielle</dfn></p>
<ul>
<li><a href="#export-de-graphiques">Export de graphiques</a></li>
</ul>
<p><dfn>indépendance</dfn></p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><dfn>indertie, perte relative</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn lang="en">index plots</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><dfn>indexation</dfn></p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>indexation bidimensionnelle</dfn></p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
</ul>
<p><dfn>indexation directe</dfn></p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>indexation par condition</dfn></p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>indexation par nom</dfn></p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
</ul>
<p><dfn>indexation par position</dfn></p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>indexation, assignation</dfn></p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
</ul>
<p><dfn>indice de similarité</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>indice de similarité de Gower</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>inertie</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><dfn>inertie, saut</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>installation</dfn></p>
<ul>
<li><a href="#installation-de-R-et-RStudio">Installation de R et RStudio</a></li>
</ul>
<p><dfn lang="en">integer</dfn></p>
<ul>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>interface</dfn></p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
</ul>
<p><dfn>interquartilen écart</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>intervalle de confiance</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
</ul>
<p><dfn>intervalle de confiance d’un odds ratio</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>intervalle de confiance d’une moyenne</dfn></p>
<ul>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
</ul>
<p><dfn>intervalle de confiance d’une proportion</dfn></p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
</ul>
<p><dfn>invite de commande</dfn></p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
</ul>
<h2 id="index-des-concepts_K">
K
</h2>
<p><dfn>Kaplan-Meir</dfn></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<h2 id="index-des-concepts_L">
L
</h2>
<p><dfn>labelled data</dfn></p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<p><dfn>labellisé, vecteur</dfn></p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>labellisée, donnée</dfn></p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<p><dfn>labellisée, variable</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn lang="en">level, factor</dfn></p>
<ul>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><dfn>Lexis, diagramme</dfn></p>
<ul>
<li><a href="#diagramme-de-lexis">Diagramme de Lexis</a></li>
</ul>
<p><dfn>libre, logiciel</dfn></p>
<ul>
<li><a href="#presentation-et-philosophie">Présentation et Philosophie</a></li>
</ul>
<p><dfn lang="en">life course analysis</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><dfn>linéaire, régression</dfn></p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><dfn>liste</dfn></p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
</ul>
<p><dfn lang="en">logical</dfn></p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>logiciel libre</dfn></p>
<ul>
<li><a href="#presentation-et-philosophie">Présentation et Philosophie</a></li>
</ul>
<p><dfn>logique, opérateur</dfn></p>
<ul>
<li><a href="#conditions-et-comparaisons">Conditions et comparaisons</a></li>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>logique, valeur</dfn></p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>logistique, régression</dfn></p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>logrank, test (comparaison de courbes de survie)</dfn></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<p><dfn>loi normale</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<h2 id="index-des-concepts_M">
M
</h2>
<p><dfn>Mann-Whitney, test</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>manquante, valeur</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn lang="en">matching, optimal</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><dfn>matrice de confusion</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>matrice de corrélation</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><dfn>matrice de distances</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>maximum</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>médiane</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>médiane, test de comparaison</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>métadonnée</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>méthode de Ward</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>minimum</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>mise à jour, R</dfn></p>
<ul>
<li><a href="#installation-de-R-et-RStudio">Installation de R et RStudio</a></li>
</ul>
<p><dfn>modalité</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>modalité de référence</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>modalité, facteur</dfn></p>
<ul>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><dfn>modèle de Cox</dfn></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<p><dfn>modèle linéaire généralisé</dfn></p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>mosaïque, graphique</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><dfn>moustaches, boîte</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>moyenne</dfn></p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>moyenne, âge</dfn></p>
<ul>
<li><a href="#calculer-un-age">Calculer un âge</a></li>
</ul>
<p><dfn>moyenne, comparaison</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><dfn>moyenne, intervalle de confiance</dfn></p>
<ul>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
</ul>
<p><dfn lang="en">multidimensional scaling</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><dfn>multinomiale, régression logistique</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<h2 id="index-des-concepts_N">
N
</h2>
<p><dfn>NA</dfn></p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
</ul>
<p><dfn>nom, indexation</dfn></p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>nombre entier</dfn></p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>nombre réel</dfn></p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>normale, loi</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>normalité, test de Shapiro-Wilk</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>notation formule</dfn></p>
<ul>
<li><a href="#formules">Formules</a></li>
</ul>
<p><dfn>notation scientifique</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>noyau, estimation</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>nuage de points</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><dfn lang="en">numeric</dfn></p>
<ul>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>numérique, variable</dfn></p>
<ul>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<h2 id="index-des-concepts_O">
O
</h2>
<p><dfn>observation</dfn></p>
<ul>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><dfn lang="en">odds ratio</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>odds ratio, intervalle de confiance</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>opérateur de comparaison</dfn></p>
<ul>
<li><a href="#conditions-et-comparaisons">Conditions et comparaisons</a></li>
</ul>
<p><dfn>opérateur logique</dfn></p>
<ul>
<li><a href="#conditions-et-comparaisons">Conditions et comparaisons</a></li>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn lang="en">optimal matching</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><dfn>optimal, appariement</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><dfn>ordinaire, régression logistique</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>ordonner le tri à plat</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<h2 id="index-des-concepts_P">
P
</h2>
<p><dfn lang="en">package</dfn></p>
<ul>
<li><a href="#extensions">Extensions</a></li>
</ul>
<p><dfn>palette de couleurs</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><dfn>partition</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>pas à pas, sélection descendante</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>patron</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>perte relative d’inertie</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>Phi², distance</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>plan d’échantillonnage</dfn></p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><dfn>plan factoriel</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><dfn>points, nuage de</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><dfn>pondération</dfn></p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><dfn>position, indexation</dfn></p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>projets</dfn></p>
<ul>
<li><a href="#organiser-ses-fichiers">Organiser ses fichiers</a></li>
</ul>
<p><dfn>prompt</dfn></p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
</ul>
<p><dfn>proportion, intervalle de confiance</dfn></p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
</ul>
<p><dfn>proportion, test de comparaison</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>proxy</dfn></p>
<ul>
<li><a href="#installation-de-R-et-RStudio">Installation de R et RStudio</a></li>
</ul>
<h2 id="index-des-concepts_Q">
Q
</h2>
<p><dfn>qualitative, variable</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>quantile</dfn></p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>quantitative, variable</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>quartile</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<h2 id="index-des-concepts_R">
R
</h2>
<p><dfn>rapport des cotes</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>recodage de variables</dfn></p>
<ul>
<li><a href="#recodage">Recodage</a></li>
</ul>
<p><dfn>recyclage</dfn></p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
</ul>
<p><dfn lang="en">recycling rule</dfn></p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
</ul>
<p><dfn>réel, nombre</dfn></p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>référence, modalité</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>régression linéaire</dfn></p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><dfn>régression logistique</dfn></p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>régression logistique binaire</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>régression logistique multinomiale</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>régression logistique ordinaire</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>régression, droite</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><dfn>relatif, risque</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>répartition empirique, fonction</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>répertoire de travail</dfn></p>
<ul>
<li><a href="#organiser-ses-fichiers">Organiser ses fichiers</a></li>
</ul>
<p><dfn>résidus de Schoenfeld</dfn></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<p><dfn>résolution</dfn></p>
<ul>
<li><a href="#export-de-graphiques">Export de graphiques</a></li>
</ul>
<p><dfn>ressemblance</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>révolu, âge</dfn></p>
<ul>
<li><a href="#calculer-un-age">Calculer un âge</a></li>
</ul>
<p><dfn>risque relatif</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<h2 id="index-des-concepts_S">
S
</h2>
<p><dfn>SAS, fichier</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>saut d’inertie</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>Schoenfeld, résidus</dfn></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<p><dfn>scientifique, notation</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>script</dfn></p>
<ul>
<li><a href="#organiser-ses-fichiers">Organiser ses fichiers</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><dfn>scripts</dfn></p>
<ul>
<li><a href="#presentation-et-philosophie">Présentation et Philosophie</a></li>
</ul>
<p><dfn>secteur, diagramme</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>section</dfn></p>
<ul>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><dfn>sélection descendante pas à pas</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>séparateur de champs</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>séparateur décimal</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>séquence, analyse</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><dfn>séquence, tapis</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><dfn>Shapiro-Wilk, test de normalité</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>similarité, indice</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>sous-échantillon</dfn></p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><dfn>SPSS, fichier</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>statistique bivariée</dfn></p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><dfn>statistique descriptive</dfn></p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>statistique univariée</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>strate</dfn></p>
<ul>
<li><a href="#definir-un-plan-d-echantillonnage-complexe">Définir un plan d’échantillonnage complexe</a></li>
</ul>
<p><dfn>stratifié, échantillonnage</dfn></p>
<ul>
<li><a href="#definir-un-plan-d-echantillonnage-complexe">Définir un plan d’échantillonnage complexe</a></li>
</ul>
<p><dfn>structure d’un objet</dfn></p>
<ul>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><dfn>Student, test-t</dfn></p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><dfn>Student, test t</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>survie, analyse</dfn></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<h2 id="index-des-concepts_T">
T
</h2>
<p><dfn>tableau croisé</dfn></p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><dfn>tableau croisé, coefficient de contingence de Cramer</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>tableau croisé, graphique en mosaïque</dfn></p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><dfn>tableau croisé, test exact de Fisher</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>tableau de donnée</dfn></p>
<ul>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><dfn>tableau de données, fusion</dfn></p>
<ul>
<li><a href="#fusion-de-tables">Fusion de tables</a></li>
</ul>
<p><dfn>tableau de données, tri</dfn></p>
<ul>
<li><a href="#tris">Tris</a></li>
</ul>
<p><dfn>tableau de fréquences</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn lang="en">tagged missing value</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn lang="en">tagged NA</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>tapis</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><dfn lang="en">task view</dfn></p>
<ul>
<li><a href="#extensions">Extensions</a></li>
</ul>
<p><dfn>test d’égalité des variances</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>test de comparaison de deux proportions</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>test de normalité de Shapiro-Wilk</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>test de Wilcoxon/Mann-Whitney</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>test du Chi²</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><dfn>test du Chi², résidus</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>test exact de Fisher</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>test t de Student</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><dfn>texte</dfn></p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>texte tabulé, fichier</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>texte, fichier</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn lang="en">tibble</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>tidyverse</dfn></p>
<ul>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>total</dfn></p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><dfn>trajectoire biographique</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><dfn>transversale, entropie</dfn></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><dfn>tri à plat</dfn></p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>tri à plat, ordonner</dfn></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<h2 id="index-des-concepts_U">
U
</h2>
<p><dfn>univariée, statistique</dfn></p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<h2 id="index-des-concepts_V">
V
</h2>
<p><dfn>valeur booléenne</dfn></p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>valeur logique</dfn></p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>valeur manquante</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>valeur manquante déclarée</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>valeur, étiquette</dfn></p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>variable</dfn></p>
<ul>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><dfn>variable catégorielle</dfn></p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<p><dfn>variable d’intérêt</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>variable explicative</dfn></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><dfn>variable labellisée</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>variable numérique</dfn></p>
<ul>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><dfn>variable qualitative</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>variable quantitative</dfn></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><dfn>variable, étiquette</dfn></p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>variable, recodage</dfn></p>
<ul>
<li><a href="#recodage">Recodage</a></li>
</ul>
<p><dfn>variance</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><dfn>variance, test d’égalité</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><dfn>vecteur</dfn></p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><dfn>vecteur labellisé</dfn></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><dfn>vector</dfn></p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
</ul>
<p><dfn lang="en">viewer</dfn></p>
<ul>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><dfn lang="en">violin plot</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><dfn>violon, graphique en</dfn></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<h2 id="index-des-concepts_W">
W
</h2>
<p><dfn>Ward, méthode</dfn></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><dfn>Wilcoxon, test</dfn></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
</div>

</article>
<article id="index-des-fonctions"><div class="fluid-row" id="index-des-fonctions_header">



<h1 class="title toc-ignore">Index des fonctions</h1>

</div>


<nav class="index"><ul class="pagination pagination-sm">
<li>
<a href="#index-des-fonctions_%">%</a>
</li>
<li>
<a href="#index-des-fonctions_.">.</a>
</li>
<li>
<a href="#index-des-fonctions_A">A</a>
</li>
<li>
<a href="#index-des-fonctions_B">B</a>
</li>
<li>
<a href="#index-des-fonctions_C">C</a>
</li>
<li>
<a href="#index-des-fonctions_D">D</a>
</li>
<li>
<a href="#index-des-fonctions_E">E</a>
</li>
<li>
<a href="#index-des-fonctions_F">F</a>
</li>
<li>
<a href="#index-des-fonctions_G">G</a>
</li>
<li>
<a href="#index-des-fonctions_H">H</a>
</li>
<li>
<a href="#index-des-fonctions_I">I</a>
</li>
<li>
<a href="#index-des-fonctions_J">J</a>
</li>
<li>
<a href="#index-des-fonctions_K">K</a>
</li>
<li>
<a href="#index-des-fonctions_L">L</a>
</li>
<li>
<a href="#index-des-fonctions_M">M</a>
</li>
<li>
<a href="#index-des-fonctions_N">N</a>
</li>
<li>
<a href="#index-des-fonctions_O">O</a>
</li>
<li>
<a href="#index-des-fonctions_P">P</a>
</li>
<li>
<a href="#index-des-fonctions_Q">Q</a>
</li>
<li>
<a href="#index-des-fonctions_R">R</a>
</li>
<li>
<a href="#index-des-fonctions_S">S</a>
</li>
<li>
<a href="#index-des-fonctions_T">T</a>
</li>
<li>
<a href="#index-des-fonctions_U">U</a>
</li>
<li>
<a href="#index-des-fonctions_V">V</a>
</li>
<li>
<a href="#index-des-fonctions_W">W</a>
</li>
<li>
<a href="#index-des-fonctions_X">X</a>
</li>
<li>
<a href="#index-des-fonctions_Y">Y</a>
</li>
</ul>
<p></p></nav><div id="index-des-fonctions_index_fonctions" class="liste_index">
<h2 id="index-des-fonctions_%">
%
</h2>
<p><code data-pkg="base" data-rdoc="match">%in%</code> (base)</p>
<ul>
<li><a href="#conditions-et-comparaisons">Conditions et comparaisons</a></li>
</ul>
<h2 id="index-des-fonctions_.">
.
</h2>
<p><code data-pkg="data.table" data-rdoc="special">.N</code> (data.table)</p>
<ul>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
</ul>
<h2 id="index-des-fonctions_A">
A
</h2>
<p><code data-pkg="JLutils">A2Rplot</code> (JLutils)</p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><code data-pkg="graphics">abline</code> (graphics)</p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><code data-pkg="base">add.NA</code> (base)</p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="factor">addNA</code> (base)</p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<p><code data-pkg="questionr">addNAstr</code> (questionr)</p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<p><code data-pkg="ggplot2">aes</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
</ul>
<p><code data-pkg="eeptools">age_calc</code> (eeptools)</p>
<ul>
<li><a href="#calculer-un-age">Calculer un âge</a></li>
</ul>
<p><code data-pkg="stats">aggregate</code> (stats)</p>
<ul>
<li><a href="#formules">Formules</a></li>
</ul>
<p><code data-pkg="cluster">agnes</code> (cluster)</p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><code data-pkg="survey" data-rdoc="anova.svyglm">AIC.svyglm</code> (survey)</p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="effects" data-rdoc="effect">allEffects</code> (effects)</p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="base">append</code> (base)</p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
</ul>
<p><code data-pkg="dplyr">arrange</code> (dplyr)</p>
<ul>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
<li><a href="#tris">Tris</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="character">as.character</code> (base)</p>
<ul>
<li><a href="#recodage">Recodage</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="table">as.data.frame</code> (base)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="data.table">as.data.table</code> (data.table)</p>
<ul>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
</ul>
<p><code data-pkg="cluster" data-rdoc="agnes.object">as.hclust</code> (cluster)</p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><code data-pkg="base">as.integer</code> (base)</p>
<ul>
<li><a href="#definir-un-plan-d-echantillonnage-complexe">Définir un plan d’échantillonnage complexe</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="matrix">as.matrix</code> (base)</p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="numeric">as.numeric</code> (base)</p>
<ul>
<li><a href="#recodage">Recodage</a></li>
</ul>
<p><code data-pkg="haven" data-rdoc="labelled">as_factor</code> (haven)</p>
<ul>
<li><a href="#recodage">Recodage</a></li>
</ul>
<h2 id="index-des-fonctions_B">
B
</h2>
<p><code data-pkg="graphics">barplot</code> (graphics)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="JLutils">best.cutree</code> (JLutils)</p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><code data-pkg="ade4" data-rdoc="scatter">biplot</code> (ade4)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="ade4" data-rdoc="dudi.acm">boxplot</code> (ade4)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="graphics">boxplot</code> (graphics)</p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code data-pkg="RColorBrewer" data-rdoc="RColorsBrewer">brewer.pal</code> (RColorBrewer)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="base">by</code> (base)</p>
<ul>
<li><a href="#sous-ensembles">Sous-ensembles</a></li>
</ul>
<h2 id="index-des-fonctions_C">
C
</h2>
<p><code data-pkg="base">c</code> (base)</p>
<ul>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
<li><a href="#premier-contact">Premier contact</a></li>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><code data-pkg="FactoMineR">CA</code> (FactoMineR)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="base">cbind</code> (base)</p>
<ul>
<li><a href="#fusion-de-tables">Fusion de tables</a></li>
</ul>
<p><code data-pkg="questionr">chisq.residuals</code> (questionr)</p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><code data-pkg="stats">chisq.test</code> (stats)</p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><code data-pkg="base">class</code> (base)</p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><code data-pkg="stats">cmdscale</code> (stats)</p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><code data-pkg="stats">coef</code> (stats)</p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="survey" data-rdoc="svyglm">coef</code> (survey)</p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="grDevices">colors</code> (grDevices)</p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code data-pkg="stats">complete.cases</code> (stats)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><code data-pkg="stats">confint</code> (stats)</p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="survey" data-rdoc="surveysummary">confint</code> (survey)</p>
<ul>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="graphics">contour</code> (graphics)</p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><code data-pkg="ggplot2">coord_flip</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="stats">cor</code> (stats)</p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><code data-pkg="MASS">corresp</code> (MASS)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="survival">cox.zph</code> (survival)</p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<p><code data-pkg="questionr">cprop</code> (questionr)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><code data-pkg="questionr">cramer.v</code> (questionr)</p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><code data-pkg="base">cut</code> (base)</p>
<ul>
<li><a href="#recodage">Recodage</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="stats">cutree</code> (stats)</p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<h2 id="index-des-fonctions_D">
D
</h2>
<p><code data-pkg="cluster">daisy</code> (cluster)</p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><code data-pkg="utils">data</code> (utils)</p>
<ul>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><code data-pkg="base">data.frame</code> (base)</p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
</ul>
<p><code data-pkg="stats">density</code> (stats)</p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code data-pkg="questionr">describe</code> (questionr)</p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><code data-pkg="grDevices" data-rdoc="dev">dev.off</code> (grDevices)</p>
<ul>
<li><a href="#export-de-graphiques">Export de graphiques</a></li>
</ul>
<p><code data-pkg="grDevices" data-rdoc="dev2">dev.print</code> (grDevices)</p>
<ul>
<li><a href="#export-de-graphiques">Export de graphiques</a></li>
</ul>
<p><code data-pkg="base">dim</code> (base)</p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><code data-pkg="FactoMineR">dimdesc</code> (FactoMineR)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="RColorBrewer" data-rdoc="RColorsBrewer">display.brewer.all</code> (RColorBrewer)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="TraMineR">disscenter</code> (TraMineR)</p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><code data-pkg="stats">dist</code> (stats)</p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><code data-pkg="ade4">dist.dudi</code> (ade4)</p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><code data-pkg="dplyr">distinct</code> (dplyr)</p>
<ul>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
</ul>
<p><code data-pkg="graphics">dotchart</code> (graphics)</p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code data-pkg="base">dput</code> (base)</p>
<ul>
<li><a href="#recodage">Recodage</a></li>
</ul>
<p><code data-pkg="ade4">dudi.acm</code> (ade4)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><code data-pkg="ade4">dudi.coa</code> (ade4)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="ade4">dudi.mix</code> (ade4)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="ade4">dudi.pca</code> (ade4)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="base">duplicated</code> (base)</p>
<ul>
<li><a href="#doublons">Doublons</a></li>
</ul>
<p><code data-pkg="lubridate" data-rdoc="Duration">Duration</code> (lubridate)</p>
<ul>
<li><a href="#calculer-un-age">Calculer un âge</a></li>
</ul>
<h2 id="index-des-fonctions_E">
E
</h2>
<p><code data-pkg="utils">example</code> (utils)</p>
<ul>
<li><a href="#ou-trouver-de-l-aide">Où trouver de l’aide ?</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="log">exp</code> (base)</p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<h2 id="index-des-fonctions_F">
F
</h2>
<p><code data-pkg="ggplot2">facet_grid</code> (ggplot2)</p>
<ul>
<li><a href="#formules">Formules</a></li>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2">facet_wrap</code> (ggplot2)</p>
<ul>
<li><a href="#formules">Formules</a></li>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
</ul>
<p><code data-pkg="base">factor</code> (base)</p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
<li><a href="#recodage">Recodage</a></li>
</ul>
<p><code data-pkg="graphics">filled.contour</code> (graphics)</p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><code data-pkg="dplyr">filter</code> (dplyr)</p>
<ul>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
<li><a href="#sous-ensembles">Sous-ensembles</a></li>
</ul>
<p><code data-pkg="data.table">first</code> (data.table)</p>
<ul>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
</ul>
<p><code data-pkg="stats">fisher.test</code> (stats)</p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><code data-pkg="base">format</code> (base)</p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
</ul>
<p><code data-pkg="stats">formula</code> (stats)</p>
<ul>
<li><a href="#formules">Formules</a></li>
</ul>
<p><code data-pkg="questionr">freq</code> (questionr)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
<li><a href="#recodage">Recodage</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<h2 id="index-des-fonctions_G">
G
</h2>
<p><code data-pkg="ggplot2" data-rdoc="geom_ribbon">geom_area</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2">geom_bar</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2">geom_bin2d</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2">geom_boxplot</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2">geom_density</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2">geom_density_2d</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2" data-rdoc="geom_crossbar">geom_errorbarh</code> (ggplot2)</p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="ggplot2">geom_hex</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2" data-rdoc="geom_freqpoly">geom_histogram</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2" data-rdoc="geom_path">geom_line</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2">geom_point</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2">geom_rug</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2">geom_smooth</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2">geom_violin</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2" data-rdoc="geom_vline">geom_vline</code> (ggplot2)</p>
<ul>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="raster">getValues</code> (raster)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="base">getwd</code> (base)</p>
<ul>
<li><a href="#organiser-ses-fichiers">Organiser ses fichiers</a></li>
</ul>
<p><code data-pkg="GGally">ggcoef</code> (GGally)</p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="GGally">ggcorr</code> (GGally)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="survminer">ggcoxzph</code> (survminer)</p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<p><code data-pkg="GGally">ggpairs</code> (GGally)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2">ggplot</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2" data-rdoc="ggsave">ggsave</code> (ggplot2)</p>
<ul>
<li><a href="#export-de-graphiques">Export de graphiques</a></li>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
</ul>
<p><code data-pkg="GGally">ggsurv</code> (GGally)</p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<p><code data-pkg="survminer">ggsurvplot</code> (survminer)</p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<p><code data-pkg="ggplot2" data-rdoc="labs">ggtitle</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="dplyr">glimpse</code> (dplyr)</p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<p><code data-pkg="tibble">glimpse</code> (tibble)</p>
<ul>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
</ul>
<p><code data-pkg="stats">glm</code> (stats)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="dplyr">group_by</code> (dplyr)</p>
<ul>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
</ul>
<h2 id="index-des-fonctions_H">
H
</h2>
<p><code data-pkg="fastcluster">hclust</code> (fastcluster)</p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><code data-pkg="stats">hclust</code> (stats)</p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><code data-pkg="FactoMineR">HCPC</code> (FactoMineR)</p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><code data-pkg="questionr">hdv2003</code> (questionr)</p>
<ul>
<li><a href="#formules">Formules</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><code data-pkg="utils">head</code> (utils)</p>
<ul>
<li><a href="#conditions-et-comparaisons">Conditions et comparaisons</a></li>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><code data-pkg="utils">help</code> (utils)</p>
<ul>
<li><a href="#ou-trouver-de-l-aide">Où trouver de l’aide ?</a></li>
<li><a href="#premier-contact">Premier contact</a></li>
</ul>
<p><code data-pkg="utils">help.search</code> (utils)</p>
<ul>
<li><a href="#ou-trouver-de-l-aide">Où trouver de l’aide ?</a></li>
</ul>
<p><code data-pkg="utils">help.start</code> (utils)</p>
<ul>
<li><a href="#ou-trouver-de-l-aide">Où trouver de l’aide ?</a></li>
</ul>
<p><code data-pkg="graphics">hist</code> (graphics)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<h2 id="index-des-fonctions_I">
I
</h2>
<p><code data-pkg="questionr">icut</code> (questionr)</p>
<ul>
<li><a href="#recodage">Recodage</a></li>
</ul>
<p><code data-pkg="base">ifelse</code> (base)</p>
<ul>
<li><a href="#recodage">Recodage</a></li>
</ul>
<p><code data-pkg="graphics">image</code> (graphics)</p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><code data-pkg="ade4">inertia.dudi</code> (ade4)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="dplyr" data-rdoc="join">inner_join</code> (dplyr)</p>
<ul>
<li><a href="#fusion-de-tables">Fusion de tables</a></li>
</ul>
<p><code data-pkg="utils">install.packages</code> (utils)</p>
<ul>
<li><a href="#extensions">Extensions</a></li>
</ul>
<p><code data-pkg="devtools">install_github</code> (devtools)</p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
</ul>
<p><code data-pkg="base">interaction</code> (base)</p>
<ul>
<li><a href="#recodage">Recodage</a></li>
</ul>
<p><code data-pkg="lubridate" data-rdoc="Interval">Interval</code> (lubridate)</p>
<ul>
<li><a href="#calculer-un-age">Calculer un âge</a></li>
</ul>
<p><code data-pkg="questionr">iorder</code> (questionr)</p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<p><code data-pkg="questionr">irec</code> (questionr)</p>
<ul>
<li><a href="#recodage">Recodage</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="NA">is.na</code> (base)</p>
<ul>
<li><a href="#recodage">Recodage</a></li>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="numeric">is.numeric</code> (base)</p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<h2 id="index-des-fonctions_J">
J
</h2>
<p><code data-pkg="grDevices" data-rdoc="png">jpeg</code> (grDevices)</p>
<ul>
<li><a href="#export-de-graphiques">Export de graphiques</a></li>
</ul>
<h2 id="index-des-fonctions_K">
K
</h2>
<p><code data-pkg="MASS">kde2d</code> (MASS)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<h2 id="index-des-fonctions_L">
L
</h2>
<p><code data-pkg="haven">labelled</code> (haven)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="labelled">labelled</code> (labelled)</p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<p><code data-pkg="ggplot2">labs</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="data.table">last</code> (data.table)</p>
<ul>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
</ul>
<p><code data-pkg="dplyr" data-rdoc="join">left_join</code> (dplyr)</p>
<ul>
<li><a href="#fusion-de-tables">Fusion de tables</a></li>
</ul>
<p><code data-pkg="base">length</code> (base)</p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#premier-contact">Premier contact</a></li>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="Constants">letters</code> (base)</p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="Constants">LETTERS</code> (base)</p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><code data-pkg="base">levels</code> (base)</p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
<li><a href="#tris">Tris</a></li>
</ul>
<p><code data-pkg="base">library</code> (base)</p>
<ul>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#organiser-ses-fichiers">Organiser ses fichiers</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><code data-pkg="base">list</code> (base)</p>
<ul>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
</ul>
<p><code data-pkg="stats">lm</code> (stats)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><code data-pkg="base">load</code> (base)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="questionr">lookfor</code> (questionr)</p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
</ul>
<p><code data-pkg="questionr" data-rdoc="rprop">lprop</code> (questionr)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><code data-pkg="questionr">ltabs</code> (questionr)</p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<h2 id="index-des-fonctions_M">
M
</h2>
<p><code data-pkg="base" data-rdoc="Extremes">max</code> (base)</p>
<ul>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
<li><a href="#premier-contact">Premier contact</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code data-pkg="MASS">mca</code> (MASS)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="FactoMineR">MCA</code> (FactoMineR)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="base">mean</code> (base)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
<li><a href="#ou-trouver-de-l-aide">Où trouver de l’aide ?</a></li>
<li><a href="#premier-contact">Premier contact</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
<li><a href="#sous-ensembles">Sous-ensembles</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code data-pkg="stats">median</code> (stats)</p>
<ul>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code data-pkg="base">merge</code> (base)</p>
<ul>
<li><a href="#fusion-de-tables">Fusion de tables</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="data.table">merge</code> (data.table)</p>
<ul>
<li><a href="#fusion-de-tables">Fusion de tables</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="Extremes">min</code> (base)</p>
<ul>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
<li><a href="#premier-contact">Premier contact</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="Constants">month.abb</code> (base)</p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="Constants">month.name</code> (base)</p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><code data-pkg="vcd">mosaic</code> (vcd)</p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><code data-pkg="graphics">mosaicplot</code> (graphics)</p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><code data-pkg="nnet">multinom</code> (nnet)</p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="dplyr">mutate</code> (dplyr)</p>
<ul>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
</ul>
<h2 id="index-des-fonctions_N">
N
</h2>
<p><code data-pkg="base">NA</code> (base)</p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><code data-pkg="labelled" data-rdoc="na_values">na_range</code> (labelled)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="labelled">na_values</code> (labelled)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="base">names</code> (base)</p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
<li><a href="#recodage">Recodage</a></li>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="nrow">ncol</code> (base)</p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><code data-pkg="labelled">nolabel_to_na</code> (labelled)</p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<p><code data-pkg="base">nrow</code> (base)</p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><code data-pkg="dplyr">nth</code> (dplyr)</p>
<ul>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
</ul>
<p><code data-pkg="base">NULL</code> (base)</p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<h2 id="index-des-fonctions_O">
O
</h2>
<p><code data-pkg="questionr">odds.ratio</code> (questionr)</p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="base">order</code> (base)</p>
<ul>
<li><a href="#tris">Tris</a></li>
</ul>
<p><code data-pkg="data.table" data-rdoc="setorder">order</code> (data.table)</p>
<ul>
<li><a href="#tris">Tris</a></li>
</ul>
<h2 id="index-des-fonctions_P">
P
</h2>
<p><code data-pkg="graphics">pairs</code> (graphics)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><code data-pkg="graphics">par</code> (graphics)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><code data-pkg="FactoMineR">PCA</code> (FactoMineR)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="grDevices">pdf</code> (grDevices)</p>
<ul>
<li><a href="#export-de-graphiques">Export de graphiques</a></li>
</ul>
<p><code data-pkg="scales" data-rdoc="percent_format">percent</code> (scales)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="lubridate" data-rdoc="Period">Period</code> (lubridate)</p>
<ul>
<li><a href="#calculer-un-age">Calculer un âge</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="Constants">pi</code> (base)</p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><code data-pkg="graphics">pie</code> (graphics)</p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code data-pkg="effects" data-rdoc="summary.effect">plot</code> (effects)</p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="FactoMineR" data-rdoc="plot.MCA">plot</code> (FactoMineR)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><code data-pkg="graphics">plot</code> (graphics)</p>
<ul>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code data-pkg="stats" data-rdoc="dendrogram">plot</code> (stats)</p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code data-pkg="FactoMineR">plotellipses</code> (FactoMineR)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="grDevices">png</code> (grDevices)</p>
<ul>
<li><a href="#export-de-graphiques">Export de graphiques</a></li>
</ul>
<p><code data-pkg="grDevices">postscript</code> (grDevices)</p>
<ul>
<li><a href="#export-de-graphiques">Export de graphiques</a></li>
</ul>
<p><code data-pkg="stats" data-rdoc="predict.glm">predict</code> (stats)</p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="survey" data-rdoc="svyglm">predict</code> (survey)</p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="stats">princomp</code> (stats)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="questionr" data-rdoc="print.proptab">print</code> (questionr)</p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><code data-pkg="questionr">prop</code> (questionr)</p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><code data-pkg="JLutils">prop.ci</code> (JLutils)</p>
<ul>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
</ul>
<p><code data-pkg="JLutils">prop.ci.lower</code> (JLutils)</p>
<ul>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
</ul>
<p><code data-pkg="JLutils">prop.ci.upper</code> (JLutils)</p>
<ul>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
</ul>
<p><code data-pkg="base">prop.table</code> (base)</p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code data-pkg="stats">prop.test</code> (stats)</p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
</ul>
<h2 id="index-des-fonctions_Q">
Q
</h2>
<p><code data-pkg="ggplot2">qplot</code> (ggplot2)</p>
<ul>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
</ul>
<p><code data-pkg="questionr">quant.cut</code> (questionr)</p>
<ul>
<li><a href="#recodage">Recodage</a></li>
</ul>
<p><code data-pkg="stats">quantile</code> (stats)</p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<h2 id="index-des-fonctions_R">
R
</h2>
<p><code data-pkg="base">range</code> (base)</p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code data-pkg="stats">range</code> (stats)</p>
<ul>
<li><a href="#formules">Formules</a></li>
</ul>
<p><code data-pkg="base">rank</code> (base)</p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<p><code data-pkg="raster">raster</code> (raster)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="cbind">rbind</code> (base)</p>
<ul>
<li><a href="#fusion-de-tables">Fusion de tables</a></li>
</ul>
<p><code data-pkg="utils" data-rdoc="read.table">read.csv</code> (utils)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
</ul>
<p><code data-pkg="utils" data-rdoc="read.table">read.csv2</code> (utils)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="foreign">read.dbf</code> (foreign)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="utils" data-rdoc="read.table">read.delim</code> (utils)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="utils" data-rdoc="read.table">read.delim2</code> (utils)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="foreign">read.dta</code> (foreign)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="foreign">read.spss</code> (foreign)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="utils" data-rdoc="read.table">read.table</code> (utils)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="xlsx">read.xlsx</code> (xlsx)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="xlsx" data-rdoc="read.xlsx">read.xlsx2</code> (xlsx)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="foreign">read.xport</code> (foreign)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="readr" data-rdoc="read_delim">read_csv</code> (readr)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
</ul>
<p><code data-pkg="readr" data-rdoc="read_delim">read_csv2</code> (readr)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="readr" data-rdoc="read_delim">read_delim</code> (readr)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="haven">read_dta</code> (haven)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="readxl">read_excel</code> (readxl)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="haven">read_sas</code> (haven)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="haven">read_spss</code> (haven)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="haven" data-rdoc="read_dta">read_stata</code> (haven)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="readr" data-rdoc="read_delim">read_tsv</code> (readr)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="maptools">readAsciiGrid</code> (maptools)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="maptools">readShapeLines</code> (maptools)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="maptools">readShapePoints</code> (maptools)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="maptools">readShapePoly</code> (maptools)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="maptools">readShapeSpatial</code> (maptools)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="stats">rect.hclust</code> (stats)</p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><code data-pkg="stats">relevel</code> (stats)</p>
<ul>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="mosaic">relrisk</code> (mosaic)</p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><code data-pkg="utils">remove.packages</code> (utils)</p>
<ul>
<li><a href="#extensions">Extensions</a></li>
</ul>
<p><code data-pkg="dplyr" data-rdoc="dplyr">rename</code> (dplyr)</p>
<ul>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
</ul>
<p><code data-pkg="questionr">rename.variable</code> (questionr)</p>
<ul>
<li><a href="#recodage">Recodage</a></li>
</ul>
<p><code data-pkg="base">rep</code> (base)</p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="library">require</code> (base)</p>
<ul>
<li><a href="#extensions">Extensions</a></li>
</ul>
<p><code data-pkg="base">row.names</code> (base)</p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
</ul>
<p><code data-pkg="questionr">rprop</code> (questionr)</p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><code data-pkg="graphics">rug</code> (graphics)</p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code data-pkg="stats" data-rdoc="Uniform">runif</code> (stats)</p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<h2 id="index-des-fonctions_S">
S
</h2>
<p><code data-pkg="ade4">s.arrow</code> (ade4)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="ade4">s.chull</code> (ade4)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="ade4">s.class</code> (ade4)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><code data-pkg="ade4">s.corcicle</code> (ade4)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="JLutils">s.freq</code> (JLutils)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="ade4">s.hist</code> (ade4)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="ade4">s.label</code> (ade4)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="ade4">s.value</code> (ade4)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="dplyr" data-rdoc="sample">sample_frac</code> (dplyr)</p>
<ul>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
</ul>
<p><code data-pkg="dplyr" data-rdoc="sample">sample_n</code> (dplyr)</p>
<ul>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
</ul>
<p><code data-pkg="base">save</code> (base)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="save">save.image</code> (base)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="ggplot2">scale_colour_brewer</code> (ggplot2)</p>
<ul>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2" data-rdoc="continuous_scale">scale_x_continuous</code> (ggplot2)</p>
<ul>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2" data-rdoc="scale_continuous">scale_x_log10</code> (ggplot2)</p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="ggplot2" data-rdoc="scale_continuous">scale_y_continuous</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="ade4">scatter</code> (ade4)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="ade4" data-rdoc="score.acm">score</code> (ade4)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="ade4" data-rdoc="scatter">screeplot</code> (ade4)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="stats">sd</code> (stats)</p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code data-pkg="dplyr">select</code> (dplyr)</p>
<ul>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
</ul>
<p><code data-pkg="base">seq</code> (base)</p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><code data-pkg="JLutils">seq_heatmap</code> (JLutils)</p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><code data-pkg="TraMineR">seqdef</code> (TraMineR)</p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><code data-pkg="TraMineR">seqdist</code> (TraMineR)</p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><code data-pkg="TraMineR" data-rdoc="seqplot">seqdplot</code> (TraMineR)</p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><code data-pkg="TraMineR" data-rdoc="seqplot">seqfplot</code> (TraMineR)</p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><code data-pkg="TraMineR" data-rdoc="seqplot">seqHtplot</code> (TraMineR)</p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><code data-pkg="TraMineR" data-rdoc="seqplot">seqiplot</code> (TraMineR)</p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><code data-pkg="TraMineR" data-rdoc="seqplot">seqmsplot</code> (TraMineR)</p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><code data-pkg="TraMineR" data-rdoc="seqplot">seqmtplot</code> (TraMineR)</p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><code data-pkg="TraMineR">seqsubm</code> (TraMineR)</p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
</ul>
<p><code data-pkg="data.table">setDF</code> (data.table)</p>
<ul>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
</ul>
<p><code data-pkg="data.table">setDT</code> (data.table)</p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
</ul>
<p><code data-pkg="data.table">setorder</code> (data.table)</p>
<ul>
<li><a href="#tris">Tris</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="getwd">setwd</code> (base)</p>
<ul>
<li><a href="#organiser-ses-fichiers">Organiser ses fichiers</a></li>
</ul>
<p><code data-pkg="stats">shapiro.test</code> (stats)</p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><code data-pkg="dplyr">slice</code> (dplyr)</p>
<ul>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
</ul>
<p><code data-pkg="graphics">smoothScatter</code> (graphics)</p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><code data-pkg="base">sort</code> (base)</p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
<li><a href="#tris">Tris</a></li>
</ul>
<p><code data-pkg="labelled">sort_val_labels</code> (labelled)</p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<p><code data-pkg="base">source</code> (base)</p>
<ul>
<li><a href="#organiser-ses-fichiers">Organiser ses fichiers</a></li>
</ul>
<p><code data-pkg="sp" data-rdoc="SpatialGridDataFrame">SpatialGridDataFrame</code> (sp)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="ggplot2" data-rdoc="geom_bar">stat_count</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2" data-rdoc="geom_density_2d">stat_density_2d</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="ggplot2">stat_ecdf</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="stats">step</code> (stats)</p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="utils">str</code> (utils)</p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code data-pkg="base">subset</code> (base)</p>
<ul>
<li><a href="#sous-ensembles">Sous-ensembles</a></li>
</ul>
<p><code data-pkg="survey" data-rdoc="subset.survey.design">subset</code> (survey)</p>
<ul>
<li><a href="#definir-un-plan-d-echantillonnage-complexe">Définir un plan d’échantillonnage complexe</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><code data-pkg="dplyr">summarise</code> (dplyr)</p>
<ul>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
</ul>
<p><code data-pkg="ade4" data-rdoc="dudi">summary</code> (ade4)</p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
</ul>
<p><code data-pkg="base">summary</code> (base)</p>
<ul>
<li><a href="#conditions-et-comparaisons">Conditions et comparaisons</a></li>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
<li><a href="#recodage">Recodage</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code data-pkg="stats" data-rdoc="summary.glm">summary</code> (stats)</p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="survival">Surv</code> (survival)</p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<p><code data-pkg="survival">survdiff</code> (survival)</p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<p><code data-pkg="survival">survfit</code> (survival)</p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<p><code data-pkg="grDevices" data-rdoc="cairo">svg</code> (grDevices)</p>
<ul>
<li><a href="#export-de-graphiques">Export de graphiques</a></li>
</ul>
<p><code data-pkg="survey" data-rdoc="svyhist">svyboxplot</code> (survey)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><code data-pkg="survey">svyby</code> (survey)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><code data-pkg="survey" data-rdoc="svytable">svychisq</code> (survey)</p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><code data-pkg="survey">svyciprop</code> (survey)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
</ul>
<p><code data-pkg="survey">svydesign</code> (survey)</p>
<ul>
<li><a href="#definir-un-plan-d-echantillonnage-complexe">Définir un plan d’échantillonnage complexe</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><code data-pkg="survey">svyglm</code> (survey)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="survey">svyhist</code> (survey)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><code data-pkg="survey" data-rdoc="surveysummary">svymean</code> (survey)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><code data-pkg="survey">svyplot</code> (survey)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><code data-pkg="survey">svyquantile</code> (survey)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><code data-pkg="survey">svyratio</code> (survey)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><code data-pkg="survey">svytable</code> (survey)</p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><code data-pkg="survey" data-rdoc="surveysummary">svytotal</code> (survey)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><code data-pkg="survey">svyttest</code> (survey)</p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><code data-pkg="survey" data-rdoc="surveysummary">svyvar</code> (survey)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<h2 id="index-des-fonctions_T">
T
</h2>
<p><code data-pkg="stats">t.test</code> (stats)</p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
</ul>
<p><code data-pkg="base">table</code> (base)</p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#conditions-et-comparaisons">Conditions et comparaisons</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
<li><a href="#formules">Formules</a></li>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
<li><a href="#recodage">Recodage</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code data-pkg="haven">tagged_na</code> (haven)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="utils" data-rdoc="head">tail</code> (utils)</p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<p><code data-pkg="base">tapply</code> (base)</p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#sous-ensembles">Sous-ensembles</a></li>
</ul>
<p><code data-pkg="dplyr">tbl_df</code> (dplyr)</p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code data-pkg="dtplyr">tbl_dt</code> (dtplyr)</p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
</ul>
<p><code data-pkg="ggplot2">theme</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="broom">tidy</code> (broom)</p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="JLutils">tidy_detailed</code> (JLutils)</p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="grDevices" data-rdoc="png">tiff</code> (grDevices)</p>
<ul>
<li><a href="#export-de-graphiques">Export de graphiques</a></li>
</ul>
<p><code data-pkg="lubridate">time_length</code> (lubridate)</p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#calculer-un-age">Calculer un âge</a></li>
</ul>
<p><code data-pkg="labelled">to_factor</code> (labelled)</p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#recodage">Recodage</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="Round">trunc</code> (base)</p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<p><code data-pkg="base">typeof</code> (base)</p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<h2 id="index-des-fonctions_U">
U
</h2>
<p><code data-pkg="base">unname</code> (base)</p>
<ul>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><code data-pkg="utils">update.packages</code> (utils)</p>
<ul>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#installation-de-R-et-RStudio">Installation de R et RStudio</a></li>
</ul>
<p><code data-pkg="labelled" data-rdoc="remove_labels">user_na_to_na</code> (labelled)</p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<h2 id="index-des-fonctions_V">
V
</h2>
<p><code data-pkg="labelled" data-rdoc="val_labels">val_label</code> (labelled)</p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<p><code data-pkg="labelled">val_labels</code> (labelled)</p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<p><code data-pkg="labelled">val_labels_to_na</code> (labelled)</p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<p><code data-pkg="base" data-rdoc="cor">var</code> (base)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><code data-pkg="stats" data-rdoc="cor">var</code> (stats)</p>
<ul>
<li><a href="#premier-contact">Premier contact</a></li>
</ul>
<p><code data-pkg="stats">var.test</code> (stats)</p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<p><code data-pkg="labelled">var_label</code> (labelled)</p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<p><code data-pkg="utils">View</code> (utils)</p>
<ul>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
</ul>
<h2 id="index-des-fonctions_W">
W
</h2>
<p><code data-pkg="grDevices" data-rdoc="windows">win.metafile</code> (grDevices)</p>
<ul>
<li><a href="#export-de-graphiques">Export de graphiques</a></li>
</ul>
<p><code data-pkg="utils" data-rdoc="write.table">write.csv</code> (utils)</p>
<ul>
<li><a href="#export-de-donnees">Export de données</a></li>
</ul>
<p><code data-pkg="foreign">write.dbf</code> (foreign)</p>
<ul>
<li><a href="#export-de-donnees">Export de données</a></li>
</ul>
<p><code data-pkg="foreign">write.dta</code> (foreign)</p>
<ul>
<li><a href="#export-de-donnees">Export de données</a></li>
</ul>
<p><code data-pkg="foreign">write.foreign</code> (foreign)</p>
<ul>
<li><a href="#export-de-donnees">Export de données</a></li>
</ul>
<p><code data-pkg="utils">write.table</code> (utils)</p>
<ul>
<li><a href="#export-de-donnees">Export de données</a></li>
</ul>
<p><code data-pkg="xlsx">write.xlsx</code> (xlsx)</p>
<ul>
<li><a href="#export-de-donnees">Export de données</a></li>
</ul>
<p><code data-pkg="readr">write_csv</code> (readr)</p>
<ul>
<li><a href="#export-de-donnees">Export de données</a></li>
</ul>
<p><code data-pkg="haven">write_dta</code> (haven)</p>
<ul>
<li><a href="#export-de-donnees">Export de données</a></li>
</ul>
<p><code data-pkg="haven">write_sav</code> (haven)</p>
<ul>
<li><a href="#export-de-donnees">Export de données</a></li>
</ul>
<p><code data-pkg="maptools" data-rdoc="readAsciiGrid">writeAsciiGrid</code> (maptools)</p>
<ul>
<li><a href="#export-de-donnees">Export de données</a></li>
</ul>
<p><code data-pkg="maptools" data-rdoc="readShapeLines">writeLinesShape</code> (maptools)</p>
<ul>
<li><a href="#export-de-donnees">Export de données</a></li>
</ul>
<p><code data-pkg="maptools" data-rdoc="readShapePoints">writePointsShape</code> (maptools)</p>
<ul>
<li><a href="#export-de-donnees">Export de données</a></li>
</ul>
<p><code data-pkg="maptools" data-rdoc="readShapePoly">writePolyShape</code> (maptools)</p>
<ul>
<li><a href="#export-de-donnees">Export de données</a></li>
</ul>
<p><code data-pkg="questionr">wtd.mean</code> (questionr)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><code data-pkg="questionr">wtd.table</code> (questionr)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><code data-pkg="questionr" data-rdoc="wtd.mean">wtd.var</code> (questionr)</p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<h2 id="index-des-fonctions_X">
X
</h2>
<p><code data-pkg="ggplot2" data-rdoc="labs">xlab</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code data-pkg="stats">xtabs</code> (stats)</p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#formules">Formules</a></li>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#recodage">Recodage</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<h2 id="index-des-fonctions_Y">
Y
</h2>
<p><code data-pkg="ggplot2" data-rdoc="labs">ylab</code> (ggplot2)</p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
</div>

</article>
<article id="index-des-extensions"><div class="fluid-row" id="index-des-extensions_header">



<h1 class="title toc-ignore">Index des extensions</h1>

</div>


<nav class="index"><ul class="pagination pagination-sm">
<li>
<a href="#index-des-extensions_A">A</a>
</li>
<li>
<a href="#index-des-extensions_B">B</a>
</li>
<li>
<a href="#index-des-extensions_C">C</a>
</li>
<li>
<a href="#index-des-extensions_D">D</a>
</li>
<li>
<a href="#index-des-extensions_E">E</a>
</li>
<li>
<a href="#index-des-extensions_F">F</a>
</li>
<li>
<a href="#index-des-extensions_G">G</a>
</li>
<li>
<a href="#index-des-extensions_H">H</a>
</li>
<li>
<a href="#index-des-extensions_J">J</a>
</li>
<li>
<a href="#index-des-extensions_L">L</a>
</li>
<li>
<a href="#index-des-extensions_M">M</a>
</li>
<li>
<a href="#index-des-extensions_N">N</a>
</li>
<li>
<a href="#index-des-extensions_P">P</a>
</li>
<li>
<a href="#index-des-extensions_Q">Q</a>
</li>
<li>
<a href="#index-des-extensions_R">R</a>
</li>
<li>
<a href="#index-des-extensions_S">S</a>
</li>
<li>
<a href="#index-des-extensions_T">T</a>
</li>
<li>
<a href="#index-des-extensions_U">U</a>
</li>
<li>
<a href="#index-des-extensions_V">V</a>
</li>
<li>
<a href="#index-des-extensions_X">X</a>
</li>
</ul>
<p></p></nav><div id="index-des-extensions_index_extensions" class="liste_index">
<h2 id="index-des-extensions_A">
A
</h2>
<p><code class="pkg">ade4</code></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#extensions">Extensions</a></li>
</ul>
<h2 id="index-des-extensions_B">
B
</h2>
<p><code class="pkg">base</code></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#conditions-et-comparaisons">Conditions et comparaisons</a></li>
<li><a href="#definir-un-plan-d-echantillonnage-complexe">Définir un plan d’échantillonnage complexe</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#doublons">Doublons</a></li>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
<li><a href="#formules">Formules</a></li>
<li><a href="#fusion-de-tables">Fusion de tables</a></li>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#organiser-ses-fichiers">Organiser ses fichiers</a></li>
<li><a href="#ou-trouver-de-l-aide">Où trouver de l’aide ?</a></li>
<li><a href="#premier-contact">Premier contact</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
<li><a href="#recodage">Recodage</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
<li><a href="#sous-ensembles">Sous-ensembles</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
<li><a href="#tris">Tris</a></li>
<li><a href="#vecteurs-indexation-et-assignation">Vecteurs, indexation et assignation</a></li>
</ul>
<p><code class="pkg">broom</code></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<h2 id="index-des-extensions_C">
C
</h2>
<p><code class="pkg">cluster</code></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<h2 id="index-des-extensions_D">
D
</h2>
<p><code class="pkg">data.table</code></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#doublons">Doublons</a></li>
<li><a href="#fusion-de-tables">Fusion de tables</a></li>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
<li><a href="#recodage">Recodage</a></li>
<li><a href="#sous-ensembles">Sous-ensembles</a></li>
<li><a href="#tris">Tris</a></li>
</ul>
<p><code class="pkg">dendextend</code></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><code class="pkg">devtools</code></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#calculer-un-age">Calculer un âge</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
</ul>
<p><code class="pkg">dplyr</code></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#doublons">Doublons</a></li>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
<li><a href="#formules">Formules</a></li>
<li><a href="#fusion-de-tables">Fusion de tables</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#scraping">Scraping</a></li>
<li><a href="#sous-ensembles">Sous-ensembles</a></li>
<li><a href="#tris">Tris</a></li>
</ul>
<p><code class="pkg">dtplyr</code></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
</ul>
<h2 id="index-des-extensions_E">
E
</h2>
<p><code class="pkg">ecdf</code></p>
<ul>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code class="pkg">eeptools</code></p>
<ul>
<li><a href="#calculer-un-age">Calculer un âge</a></li>
</ul>
<p><code class="pkg">effects</code></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<h2 id="index-des-extensions_F">
F
</h2>
<p><code class="pkg">FactoMineR</code></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
</ul>
<p><code class="pkg">fastcluster</code></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><code class="pkg">forcats</code></p>
<ul>
<li><a href="#extensions">Extensions</a></li>
</ul>
<p><code class="pkg">foreign</code></p>
<ul>
<li><a href="#export-de-donnees">Export de données</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<h2 id="index-des-extensions_G">
G
</h2>
<p><code class="pkg">GGally</code></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code class="pkg">ggalt</code></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code class="pkg">ggdendro</code></p>
<ul>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<p><code class="pkg">ggfortify</code></p>
<ul>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
</ul>
<p><code class="pkg">gglat</code></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code class="pkg">ggmap</code></p>
<ul>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
</ul>
<p><code class="pkg">ggplot2</code></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
<li><a href="#export-de-graphiques">Export de graphiques</a></li>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#formules">Formules</a></li>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code class="pkg">ggthemes</code></p>
<ul>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
</ul>
<p><code class="pkg">ggvis</code></p>
<ul>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
</ul>
<p><code class="pkg">graphics</code></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code class="pkg">grDevices</code></p>
<ul>
<li><a href="#export-de-graphiques">Export de graphiques</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<h2 id="index-des-extensions_H">
H
</h2>
<p><code class="pkg">haven</code></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#export-de-donnees">Export de données</a></li>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
<li><a href="#recodage">Recodage</a></li>
</ul>
<p><code class="pkg">Hmisc</code></p>
<ul>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<h2 id="index-des-extensions_J">
J
</h2>
<p><code class="pkg">JLutils</code></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<h2 id="index-des-extensions_L">
L
</h2>
<p><code class="pkg">labelled</code></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
<li><a href="#recodage">Recodage</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code class="pkg">lattice</code></p>
<ul>
<li><a href="#formules">Formules</a></li>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
</ul>
<p><code class="pkg">LexisPlotR</code></p>
<ul>
<li><a href="#diagramme-de-lexis">Diagramme de Lexis</a></li>
</ul>
<p><code class="pkg">lubridate</code></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#calculer-un-age">Calculer un âge</a></li>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#gestion-des-dates">Gestion des dates</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
<li><a href="#scraping">Scraping</a></li>
</ul>
<h2 id="index-des-extensions_M">
M
</h2>
<p><code class="pkg">magrittr</code></p>
<ul>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
</ul>
<p><code class="pkg">maptools</code></p>
<ul>
<li><a href="#export-de-donnees">Export de données</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code class="pkg">MASS</code></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><code class="pkg">memisc</code></p>
<ul>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
</ul>
<p><code class="pkg">mlogit</code></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code class="pkg">mosaic</code></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
</ul>
<h2 id="index-des-extensions_N">
N
</h2>
<p><code class="pkg">nnet</code></p>
<ul>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<h2 id="index-des-extensions_P">
P
</h2>
<p><code class="pkg">packrat</code></p>
<ul>
<li><a href="#organiser-ses-fichiers">Organiser ses fichiers</a></li>
</ul>
<p><code class="pkg">productplots</code></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code class="pkg">purrr</code></p>
<ul>
<li><a href="#extensions">Extensions</a></li>
</ul>
<h2 id="index-des-extensions_Q">
Q
</h2>
<p><code class="pkg">question</code></p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<p><code class="pkg">questionr</code></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#conditions-et-comparaisons">Conditions et comparaisons</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#facteurs-et-vecteurs-labellises">Facteurs et vecteurs labellisés</a></li>
<li><a href="#formules">Formules</a></li>
<li><a href="#fusion-de-tables">Fusion de tables</a></li>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
<li><a href="#recodage">Recodage</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
<li><a href="#sous-ensembles">Sous-ensembles</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
<li><a href="#tris">Tris</a></li>
</ul>
<h2 id="index-des-extensions_R">
R
</h2>
<p><code class="pkg">raster</code></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code class="pkg">RColorBrewer</code></p>
<ul>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
</ul>
<p><code class="pkg">readr</code></p>
<ul>
<li><a href="#export-de-donnees">Export de données</a></li>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#formules">Formules</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
<li><a href="#scraping">Scraping</a></li>
</ul>
<p><code class="pkg">readxl</code></p>
<ul>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
</ul>
<p><code class="pkg">reshape2</code></p>
<ul>
<li><a href="#extensions">Extensions</a></li>
</ul>
<p><code class="pkg">rvest</code></p>
<ul>
<li><a href="#scraping">Scraping</a></li>
</ul>
<h2 id="index-des-extensions_S">
S
</h2>
<p><code class="pkg">scales</code></p>
<ul>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
</ul>
<p><code class="pkg">sp</code></p>
<ul>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
<p><code class="pkg">stats</code></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
<li><a href="#analyse-des-correspondances-multiples">Analyse des correspondances multiples (ACM)</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#formules">Formules</a></li>
<li><a href="#graphiques-bivaries-ggplot2">Graphiques univariés et bivariés avec ggplot2</a></li>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
<li><a href="#premier-contact">Premier contact</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
<li><a href="#recodage">Recodage</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<p><code class="pkg">stringr</code></p>
<ul>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#scraping">Scraping</a></li>
</ul>
<p><code class="pkg">survey</code></p>
<ul>
<li><a href="#comparaisons-moyennes-et-proportions">Comparaisons (moyennes et proportions)</a></li>
<li><a href="#definir-un-plan-d-echantillonnage-complexe">Définir un plan d’échantillonnage complexe</a></li>
<li><a href="#donnees-ponderees">Données pondérées</a></li>
<li><a href="#intervalles-de-confiance">Intervalles de confiance</a></li>
<li><a href="#regression-logistique">Régression logistique</a></li>
</ul>
<p><code class="pkg">survival</code></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<p><code class="pkg">survminer</code></p>
<ul>
<li><a href="#analyse-de-survie">Analyse de survie</a></li>
</ul>
<h2 id="index-des-extensions_T">
T
</h2>
<p><code class="pkg">tibble</code></p>
<ul>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#introduction-a-data-table">Introduction à data.table</a></li>
<li><a href="#introduction-a-dplyr">Introduction à dplyr</a></li>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
</ul>
<p><code class="pkg">tidyr</code></p>
<ul>
<li><a href="#extensions">Extensions</a></li>
</ul>
<p><code class="pkg">tidyverse</code></p>
<ul>
<li><a href="#extensions">Extensions</a></li>
</ul>
<p><code class="pkg">TraMineR</code></p>
<ul>
<li><a href="#analyse-de-sequences">Analyse de séquences</a></li>
<li><a href="#classification-ascendante-hierarchique">Classification ascendante hiérarchique (CAH)</a></li>
</ul>
<h2 id="index-des-extensions_U">
U
</h2>
<p><code class="pkg">utils</code></p>
<ul>
<li><a href="#conditions-et-comparaisons">Conditions et comparaisons</a></li>
<li><a href="#export-de-donnees">Export de données</a></li>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
<li><a href="#installation-de-R-et-RStudio">Installation de R et RStudio</a></li>
<li><a href="#intro-ggplot2">Introduction à ggplot2</a></li>
<li><a href="#listes-et-tableaux-de-donnes">Listes et Tableaux de données</a></li>
<li><a href="#ou-trouver-de-l-aide">Où trouver de l’aide ?</a></li>
<li><a href="#premier-contact">Premier contact</a></li>
<li><a href="#premier-travail-avec-les-donnees">Premier travail avec des données</a></li>
<li><a href="#statistique-univariee">Statistique univariée</a></li>
</ul>
<h2 id="index-des-extensions_V">
V
</h2>
<p><code class="pkg">vcd</code></p>
<ul>
<li><a href="#statistique-bivariee">Statistique bivariée</a></li>
</ul>
<h2 id="index-des-extensions_X">
X
</h2>
<p><code class="pkg">xlsx</code></p>
<ul>
<li><a href="#export-de-donnees">Export de données</a></li>
<li><a href="#import-de-donnees">Import de données</a></li>
</ul>
</div>

</article>
</div>

<script language="javascript" type="text/javascript">
$(document).ready(function () {
  // add bootstrap table styles to pandoc tables
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');

    // Identifier les <pre> fermant
    $('pre').next("*:not(pre)").prev().addClass('last'); // Dernier <pre> de chaque groupe contigu de <pre>
    $('pre').parent().each(function (){
      $(this).children('pre').last().addClass('last');
    }); // Si <pre> est le dernier enfant de son parent

    // Ajout liens rdocumentation
    $("code[data-pkg]").each(function( index ) {
      pack = $(this).attr('data-pkg');
      if ($(this).attr('data-rdoc') !== undefined) {
        rdocumentation = $(this).attr('data-rdoc');
        page = ' (' + $(this).attr('data-pkg') + ')';
      } else {
        rdocumentation = $(this).text();
        page = '';
      }
      fonction = $(this).text();
      $(this).wrap('<a href="http://www.rdocumentation.org/packages/'+pack+'/functions/'+rdocumentation+'">');
    });

    $("code.pkg").each(function( index ) {
      $(this).wrap('<a href="http://www.rdocumentation.org/packages/'+$(this).text()+'">');
    });

    // Figures (numérotation intra chapitre + ajout id pour liste des figures)
    $("article").each(function(){
      chap = $(this).attr('id');
      $(this).find("figure").each(function(index){
        if ($(this).children("figcaption").length > 0)
          $(this).children("figcaption:first").prepend('<span class="figure-number">Figure '+(index+1)+'.</span> ');
        else
          $(this).append($("<figcaption>").append('<span class="figure-number">Figure '+(index+1)+'</span>'));
        if ($(this).attr('id') == undefined) $(this).attr('id', chap + '_fig_' + (index+1));
      });
    });

    // Footnotes (prince xml only)
    if (typeof Prince !== "undefined") {
      $(".footnotes li").each(function(){
        lien = $(this).find("a[href*='fnref']").attr('href');
        $(this).find("a[href*='fnref']").remove();
        $(lien).after('<div class="fn">' + $(this).html() + '</div>');
      });
      $(".footnoteRef").remove();
      $(".footnotes").remove();
    }

});

</script>

</body>
</html>
